Õ
`D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\TempNoticeOfPaymentDetails_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 0
$TempNoticeOfPaymentDetails_ViewModel 5
{ 
} 
} ¢
eD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\TempNoticeOfDisbursementDetails_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 5
)TempNoticeOfDisbursementDetails_ViewModel :
{ 
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
int 
? 
NodId 
{ 
get 
;  
set! $
;$ %
}& '
public		 
int		 
?		 
CreditorRefId		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
decimal 
? 
Amount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
decimal 
? 
	AmountIDR !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
DisbursementDate )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
? 
APDPLNo 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
DateTime 
? 
	APDPLDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
RealisasiNo "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
? 
RealisasiDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 

ContractNo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
ContractDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public!! 
int!! 
?!! 
CreatedById!! 
{!!  !
get!!" %
;!!% &
set!!' *
;!!* +
}!!, -
public## 
DateTime## 
?## 
UpdatedTime## $
{##% &
get##' *
;##* +
set##, /
;##/ 0
}##1 2
public%% 
int%% 
?%% 
UpdatedById%% 
{%%  !
get%%" %
;%%% &
set%%' *
;%%* +
}%%, -
public'' 
int'' 
?'' 
IsActive'' 
{'' 
get'' "
;''" #
set''$ '
;''' (
}'') *
public)) 
int)) 
?)) 
	IsDeleted)) 
{)) 
get))  #
;))# $
set))% (
;))( )
}))* +
}** 
}++ –(
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\ResultStatus.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
ResultStatus 
{ 
public 
string 

StatusCode  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
string1 7
.7 8
Empty8 =
;= >
public		 
string		 
Message		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
=		, -
string		. 4
.		4 5
Empty		5 :
;		: ;
public

 
string

 
ValueGeneratorOtp

 '
{

( )
get

* -
;

- .
set

/ 2
;

2 3
}

4 5
=

6 7
string

8 >
.

> ?
Empty

? D
;

D E
} 
public 

class 
ResultStatus 
< 
T 
>  
:! "
ResultStatus# /
where0 5
T6 7
:8 9
class: ?
{ 
public 
T 
Data 
{ 
get 
; 
set  
;  !
}" #
} 
public 

class 
ListResultStatus !
<! "
T" #
># $
:% &
ResultStatus' 3
where4 9
T: ;
:< =
class> C
{ 
public 
List 
< 
T 
> 
Data 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
Count 
{ 
get 
; 
set  #
;# $
}% &
} 
public 

class 
ResultStatusInt  
{ 
public 
int 

StatusCode 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class "
ResultStatusDataString '
<' (
T( )
>) *
{ 
public 
string 

StatusCode  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
string   
Message   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public!! 
T!! 
Data!! 
{!! 
get!! 
;!! 
set!!  
;!!  !
}!!" #
}## 
public%% 

class%% 
ResultStatusDataInt%% $
<%%$ %
T%%% &
>%%& '
{&& 
public'' 
int'' 

StatusCode'' 
{'' 
get''  #
;''# $
set''% (
;''( )
}''* +
public(( 
string(( 
Message(( 
{(( 
get((  #
;((# $
set((% (
;((( )
}((* +
[)) 	
JsonProperty))	 
()) 
$str)) $
)))$ %
]))% &
public** 
int** 

ODataCount** 
{** 
get**  #
;**# $
set**% (
;**( )
}*** +
public++ 
T++ 
Data++ 
{++ 
get++ 
;++ 
set++  
;++  !
}++" #
public,, 
List,, 
<,, 
T,, 
>,, 
Value,, 
{,, 
get,, "
;,," #
set,,$ '
;,,' (
},,) *
}.. 
public00 

class00 
ResultStatusDataNod00 $
{11 
public22 
string22 
Key22 
{22 
get22 
;22  
set22! $
;22$ %
}22& '
public33 
string33 
Id33 
{33 
get33 
;33 
set33  #
;33# $
}33% &
public44 
string44 
Status44 
{44 
get44 "
;44" #
set44$ '
;44' (
}44) *
}66 
public88 

class88 
ResultStatusDataNop88 $
{99 
public:: 
string:: 
Key:: 
{:: 
get:: 
;::  
set::! $
;::$ %
}::& '
public;; 
string;; 
Id;; 
{;; 
get;; 
;;; 
set;;  #
;;;# $
};;% &
public<< 
string<< 
Status<< 
{<< 
get<< "
;<<" #
set<<$ '
;<<' (
}<<) *
}>> 
}?? ã
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\ReadNoDExcell_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class #
ReadNoDExcell_ViewModel (
{ 
public 
int 
? 
FileUploadNodid #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public		 
string		 
?		 
NodNo		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public 
DateTime 
? 
NodDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
	ValueDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Cur 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Beneficiary "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
? 
LastSentDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
CreatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
UpdatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
? 
	IsDeleted 
{ 
get  #
;# $
set% (
;( )
}* +
public!! 
string!! 
?!! 
Status!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
public## 
virtual## 
TblFileUploadNod## '
?##' (
FileUploadNod##) 6
{##7 8
get##9 <
;##< =
set##> A
;##A B
}##C D
public%% 
virtual%% 
List%% 
<%% )
TblNoticeOfDisbursementDetail%% 9
>%%9 :

NodDetails%%; E
{%%F G
get%%H K
;%%K L
set%%M P
;%%P Q
}%%R S
=%%T U
new%%V Y
List%%Z ^
<%%^ _)
TblNoticeOfDisbursementDetail%%_ |
>%%| }
(%%} ~
)%%~ 
;	%% Ä
}&& 
}'' °
MD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\Profile_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
Profile_ViewModels #
{ 
public 
string 
? 
Username 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
RoleName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
?		 
NoHp		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
string

 
?

 
Alamat

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
bool 
? 
IsActive 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
? 
IsVerifEmail !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool 
? 
IsVerifNoTelp "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} âà
UD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfPayment_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class %
NoticeOfPayment_ViewModel *
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
?		 
IdNopDetailFromApi		 )
{		* +
get		, /
;		/ 0
set		1 4
;		4 5
}		6 7
public

 
long

 
?

 
IdDetailFromGet

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
public 
long 
IdDetailNop 
{  !
get" %
;% &
set' *
;* +
}, -
public 
long 
? 
NopId 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
NopNo 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
DueDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
decimal 
? 
InterestRate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
? 
InterestDays $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
RekId 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
Cur 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
decimal 
? 
Outstanding #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
decimal 
? 
	Principal !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
decimal 
? 
Interest  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
decimal 
? 
Fee 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Status 
{ 
get  #
;# $
set% (
;( )
}* +
public 
DateTime 
? 
LastSentDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
	AccountNo  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
AccountName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 

RekNameAcc !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Acc 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
CreatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   
DateTime   
?   
UpdatedTime   $
{  % &
get  ' *
;  * +
set  , /
;  / 0
}  1 2
public!! 
long!! 
?!! 
UpdatedById!!  
{!!! "
get!!# &
;!!& '
set!!( +
;!!+ ,
}!!- .
public"" 
int"" 
?"" 
IsActive"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public## 
int## 
?## 
	IsDeleted## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public$$ 
	IFormFile$$ 
File$$ 
{$$ 
get$$  #
;$$# $
set$$% (
;$$( )
}$$* +
public%% 
string%% 
?%% 
RandomString%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public'' 
virtual'' 
TblFileUploadNop'' '
?''' (
FileUploadNop'') 6
{''7 8
get''9 <
;''< =
set''> A
;''A B
}''C D
public(( 
virtual(( 
ICollection(( "
<((" #$
TblNoticeOfPaymentDetail((# ;
>((; <%
TblNoticeOfPaymentDetails((= V
{((W X
get((Y \
;((\ ]
set((^ a
;((a b
}((c d
=((e f
new((g j
List((k o
<((o p%
TblNoticeOfPaymentDetail	((p à
>
((à â
(
((â ä
)
((ä ã
;
((ã å
})) 
public++ 

partial++ 
class++  
TblNoticeOfPaymentVM++ -
{,, 
public-- 
long-- 
Id-- 
{-- 
get-- 
;-- 
set-- !
;--! "
}--# $
public.. 
long.. 
?.. 
NopId.. 
{.. 
get..  
;..  !
set.." %
;..% &
}..' (
public00 
string00 
?00 
NopNo00 
{00 
get00 "
;00" #
set00$ '
;00' (
}00) *
public22 
DateTime22 
?22 
DueDate22  
{22! "
get22# &
;22& '
set22( +
;22+ ,
}22- .
public44 
string44 
?44 
InterestRate44 #
{44$ %
get44& )
;44) *
set44+ .
;44. /
}440 1
public66 
string66 
?66 
InterestDays66 #
{66$ %
get66& )
;66) *
set66+ .
;66. /
}660 1
public88 
string88 
?88 
Cur88 
{88 
get88  
;88  !
set88" %
;88% &
}88' (
public:: 
DateTime:: 
?:: 
CreatedTime:: $
{::% &
get::' *
;::* +
set::, /
;::/ 0
}::1 2
public<< 
int<< 
?<< 
CreatedById<< 
{<<  !
get<<" %
;<<% &
set<<' *
;<<* +
}<<, -
public>> 
DateTime>> 
?>> 
UpdatedTime>> $
{>>% &
get>>' *
;>>* +
set>>, /
;>>/ 0
}>>1 2
public@@ 
int@@ 
?@@ 
UpdatedById@@ 
{@@  !
get@@" %
;@@% &
set@@' *
;@@* +
}@@, -
publicBB 
intBB 
?BB 
IsActiveBB 
{BB 
getBB "
;BB" #
setBB$ '
;BB' (
}BB) *
publicDD 
intDD 
?DD 
	IsDeletedDD 
{DD 
getDD  #
;DD# $
setDD% (
;DD( )
}DD* +
publicFF 
stringFF 
?FF 
StatusFF 
{FF 
getFF  #
;FF# $
setFF% (
;FF( )
}FF* +
publicHH 
stringHH 
?HH 
	AccountNoHH  
{HH! "
getHH# &
;HH& '
setHH( +
;HH+ ,
}HH- .
publicJJ 
stringJJ 
?JJ 
AccountNameJJ "
{JJ# $
getJJ% (
;JJ( )
setJJ* -
;JJ- .
}JJ/ 0
publicLL 
stringLL 
?LL 
IdNopFromApiLL #
{LL$ %
getLL& )
;LL) *
setLL+ .
;LL. /
}LL0 1
publicNN 
DateTimeNN 
?NN 
LastSentDateNN %
{NN& '
getNN( +
;NN+ ,
setNN- 0
;NN0 1
}NN2 3
publicPP 
intPP 
?PP 
RekIdPP 
{PP 
getPP 
;PP  
setPP! $
;PP$ %
}PP& '
publicRR 
stringRR 
?RR 

RekNameAccRR !
{RR" #
getRR$ '
;RR' (
setRR) ,
;RR, -
}RR. /
}UU 
publicWW 

partialWW 
classWW &
TblNoticeOfPaymentDetailVMWW 3
{XX 
publicYY 
longYY 
?YY 
NopIdYY 
{YY 
getYY  
;YY  !
setYY" %
;YY% &
}YY' (
public[[ 
string[[ 
?[[ 
CreditorRef[[ "
{[[# $
get[[% (
;[[( )
set[[* -
;[[- .
}[[/ 0
public]] 
string]] 
?]] 
Outstanding]] "
{]]# $
get]]% (
;]]( )
set]]* -
;]]- .
}]]/ 0
public__ 
string__ 
?__ 
	Principal__  
{__! "
get__# &
;__& '
set__( +
;__+ ,
}__- .
publicaa 
stringaa 
?aa 
Interestaa 
{aa  !
getaa" %
;aa% &
setaa' *
;aa* +
}aa, -
publiccc 
stringcc 
?cc 
Feecc 
{cc 
getcc  
;cc  !
setcc" %
;cc% &
}cc' (
publicee 
DateTimeee 
?ee 
CreatedTimeee $
{ee% &
getee' *
;ee* +
setee, /
;ee/ 0
}ee1 2
publicgg 
intgg 
?gg 
CreatedByIdgg 
{gg  !
getgg" %
;gg% &
setgg' *
;gg* +
}gg, -
publicii 
DateTimeii 
?ii 
UpdatedTimeii $
{ii% &
getii' *
;ii* +
setii, /
;ii/ 0
}ii1 2
publickk 
intkk 
?kk 
UpdatedByIdkk 
{kk  !
getkk" %
;kk% &
setkk' *
;kk* +
}kk, -
publicmm 
intmm 
?mm 
IsActivemm 
{mm 
getmm "
;mm" #
setmm$ '
;mm' (
}mm) *
publicoo 
intoo 
?oo 
	IsDeletedoo 
{oo 
getoo  #
;oo# $
setoo% (
;oo( )
}oo* +
publicqq 
longqq 
Idqq 
{qq 
getqq 
;qq 
setqq !
;qq! "
}qq# $
}rr 
publicss 

classss )
NoticeOfPaymentFile_ViewModelss .
{tt 
publicuu 
Int64uu 
?uu 
Numberuu 
{uu 
getuu "
;uu" #
setuu$ '
;uu' (
}uu) *
publicvv 
intvv 
?vv 
Idvv 
{vv 
getvv 
;vv 
setvv !
;vv! "
}vv# $
publicww 
stringww 
?ww 
FileNameww 
{ww  !
getww" %
;ww% &
setww' *
;ww* +
}ww, -
publicxx 
intxx 
?xx 
FileSizexx 
{xx 
getxx "
;xx" #
setxx$ '
;xx' (
}xx) *
publicyy 
stringyy 
?yy 
FilePathyy 
{yy  !
getyy" %
;yy% &
setyy' *
;yy* +
}yy, -
publiczz 
stringzz 
?zz 
FileExtzz 
{zz  
getzz! $
;zz$ %
setzz& )
;zz) *
}zz+ ,
public{{ 
int{{ 
?{{ 
IsActive{{ 
{{{ 
get{{ "
;{{" #
set{{$ '
;{{' (
}{{) *
public|| 
int|| 
?|| 
	IsDeleted|| 
{|| 
get||  #
;||# $
set||% (
;||( )
}||* +
public}} 
string}} 
?}} 
RandomString}} #
{}}$ %
get}}& )
;}}) *
set}}+ .
;}}. /
}}}0 1
}~~ 
public
ÄÄ 

class
ÄÄ 1
#NoticeOfPaymentFileUpload_ViewModel
ÄÄ 4
{
ÅÅ 
public
ÇÇ 
	IFormFile
ÇÇ 
File
ÇÇ 
{
ÇÇ 
get
ÇÇ  #
;
ÇÇ# $
set
ÇÇ% (
;
ÇÇ( )
}
ÇÇ* +
public
ÉÉ 
string
ÉÉ 
?
ÉÉ 
uniq
ÉÉ 
{
ÉÉ 
get
ÉÉ !
;
ÉÉ! "
set
ÉÉ# &
;
ÉÉ& '
}
ÉÉ( )
}
ÑÑ 
public
ÜÜ 

class
ÜÜ -
NoticeOfPaymentToAPI_ViewModels
ÜÜ 0
{
áá 
public
àà 
string
àà 
NopNo
àà 
{
àà 
get
àà !
;
àà! "
set
àà# &
;
àà& '
}
àà( )
public
ââ 
DateTime
ââ 
?
ââ 
DueDate
ââ  
{
ââ! "
get
ââ# &
;
ââ& '
set
ââ( +
;
ââ+ ,
}
ââ- .
public
ää 
decimal
ää 
?
ää 
InterestRate
ää $
{
ää% &
get
ää' *
;
ää* +
set
ää, /
;
ää/ 0
}
ää1 2
public
ãã 
decimal
ãã 
?
ãã 
InterestDays
ãã $
{
ãã% &
get
ãã' *
;
ãã* +
set
ãã, /
;
ãã/ 0
}
ãã1 2
public
åå 
string
åå 
Cur
åå 
{
åå 
get
åå 
;
åå  
set
åå! $
;
åå$ %
}
åå& '
public
çç 
int
çç 
?
çç 
RekId
çç 
{
çç 
get
çç 
;
çç  
set
çç! $
;
çç$ %
}
çç& '
public
éé 
List
éé 
<
éé &
TblNoticeOfPaymentDetail
éé ,
>
éé, -
	NopDetail
éé. 7
{
éé8 9
get
éé: =
;
éé= >
set
éé? B
;
ééB C
}
ééD E
}
èè 
public
íí 

class
íí *
CreditorRefDetail_ViewModels
íí -
{
ìì 
public
îî 
DateTime
îî 
?
îî 
DueDate
îî  
{
îî! "
get
îî# &
;
îî& '
set
îî( +
;
îî+ ,
}
îî- .
public
ïï 
string
ïï 
?
ïï 
CreditorRef
ïï "
{
ïï# $
get
ïï% (
;
ïï( )
set
ïï* -
;
ïï- .
}
ïï/ 0
public
ññ 
decimal
ññ 
?
ññ 
Outstanding
ññ #
{
ññ$ %
get
ññ& )
;
ññ) *
set
ññ+ .
;
ññ. /
}
ññ0 1
public
óó 
decimal
óó 
?
óó 
	Principal
óó !
{
óó" #
get
óó$ '
;
óó' (
set
óó) ,
;
óó, -
}
óó. /
public
òò 
decimal
òò 
?
òò 
Interest
òò  
{
òò! "
get
òò# &
;
òò& '
set
òò( +
;
òò+ ,
}
òò- .
public
ôô 
decimal
ôô 
?
ôô 
Fee
ôô 
{
ôô 
get
ôô !
;
ôô! "
set
ôô# &
;
ôô& '
}
ôô( )
}
öö 
public
úú 

class
úú *
NoticeOfPaymentJOB_ViewModel
úú -
{
ùù 
public
ûû 
string
ûû 
Id
ûû 
{
ûû 
get
ûû 
;
ûû 
set
ûû  #
;
ûû# $
}
ûû% &
public
üü 
string
üü 
Status
üü 
{
üü 
get
üü "
;
üü" #
set
üü$ '
;
üü' (
}
üü) *
}
†† 
}°° ¡
[D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfPaymentDetail_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class +
NoticeOfPaymentDetail_ViewModel 0
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public

 
long

 
?

 
NopId

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
decimal 
? 
Outstanding #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
decimal 
? 
	Principal !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
decimal 
? 
Interest  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
decimal 
? 
Fee 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
CreatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
UpdatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public   
int   
?   
	IsDeleted   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
public"" 
virtual"" 
TblNoticeOfPayment"" )
?"") *
Nop""+ .
{""/ 0
get""1 4
;""4 5
set""6 9
;""9 :
}""; <
}## 
}$$ ™	
`D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfPaymentDetailForm_ViewModel .cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 0
$NoticeOfPaymenttDetailForm_ViewModel 5
{ 
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
decimal 
? 
Outstanding #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public

 
decimal

 
?

 
	Principal

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
decimal 
? 
Interest  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
decimal 
? 
Fee 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ùK
ZD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfDisbursement_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class *
NoticeOfDisbursement_ViewModel /
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
int		 
?		 
Id		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public 
int 
? 
FileUploadNodid #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
? 
NodNo 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
NodDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
	ValueDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Cur 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Beneficiary "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
? 
LastSentDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
int 
? 
NodId 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
? 
CreditorRefId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Amount 
{ 
get  #
;# $
set% (
;( )
}* +
public!! 
string!! 
?!! 
	AmountIDR!!  
{!!! "
get!!# &
;!!& '
set!!( +
;!!+ ,
}!!- .
public## 
DateTime## 
?## 
DisbursementDate## )
{##* +
get##, /
;##/ 0
set##1 4
;##4 5
}##6 7
public%% 
string%% 
?%% 
Apdplno%% 
{%%  
get%%! $
;%%$ %
set%%& )
;%%) *
}%%+ ,
public'' 
DateTime'' 
?'' 
	Apdpldate'' "
{''# $
get''% (
;''( )
set''* -
;''- .
}''/ 0
public)) 
string)) 
?)) 
RealisasiNo)) "
{))# $
get))% (
;))( )
set))* -
;))- .
}))/ 0
public++ 
DateTime++ 
?++ 
RealisasiDate++ &
{++' (
get++) ,
;++, -
set++. 1
;++1 2
}++3 4
public-- 
string-- 
?-- 

ContractNo-- !
{--" #
get--$ '
;--' (
set--) ,
;--, -
}--. /
public// 
DateTime// 
?// 
ContractDate// %
{//& '
get//( +
;//+ ,
set//- 0
;//0 1
}//2 3
public11 
DateTime11 
?11 
CreatedTime11 $
{11% &
get11' *
;11* +
set11, /
;11/ 0
}111 2
public33 
int33 
?33 
CreatedById33 
{33  !
get33" %
;33% &
set33' *
;33* +
}33, -
public55 
DateTime55 
?55 
UpdatedTime55 $
{55% &
get55' *
;55* +
set55, /
;55/ 0
}551 2
public77 
int77 
?77 
UpdatedById77 
{77  !
get77" %
;77% &
set77' *
;77* +
}77, -
public99 
int99 
?99 
IsActive99 
{99 
get99 "
;99" #
set99$ '
;99' (
}99) *
public;; 
int;; 
?;; 
	IsDeleted;; 
{;; 
get;;  #
;;;# $
set;;% (
;;;( )
};;* +
public== 
string== 
?== 
Status== 
{== 
get==  #
;==# $
set==% (
;==( )
}==* +
public>> 
string>> 
?>> 
RandomString>> #
{>>$ %
get>>& )
;>>) *
set>>+ .
;>>. /
}>>0 1
public?? 
	IFormFile?? 
File?? 
{?? 
get??  #
;??# $
set??% (
;??( )
}??* +
publicAA 
virtualAA 
TblFileUploadNodAA '
?AA' (
FileUploadNodAA) 6
{AA7 8
getAA9 <
;AA< =
setAA> A
;AAA B
}AAC D
publicCC 
virtualCC 
ICollectionCC "
<CC" #)
TblNoticeOfDisbursementDetailCC# @
>CC@ A*
TblNoticeOfDisbursementDetailsCCB `
{CCa b
getCCc f
;CCf g
setCCh k
;CCk l
}CCm n
=CCo p
newCCq t
ListCCu y
<CCy z*
TblNoticeOfDisbursementDetail	CCz ó
>
CCó ò
(
CCò ô
)
CCô ö
;
CCö õ
}DD 
publicFF 

classFF .
"NoticeOfDisbursementFile_ViewModelFF 3
{GG 
publicHH 
Int64HH 
?HH 
NumberHH 
{HH 
getHH "
;HH" #
setHH$ '
;HH' (
}HH) *
publicII 
intII 
?II 
IdII 
{II 
getII 
;II 
setII !
;II! "
}II# $
publicJJ 
stringJJ 
?JJ 
FileNameJJ 
{JJ  !
getJJ" %
;JJ% &
setJJ' *
;JJ* +
}JJ, -
publicKK 
intKK 
?KK 
FileSizeKK 
{KK 
getKK "
;KK" #
setKK$ '
;KK' (
}KK) *
publicLL 
stringLL 
?LL 
FilePathLL 
{LL  !
getLL" %
;LL% &
setLL' *
;LL* +
}LL, -
publicMM 
stringMM 
?MM 
FileExtMM 
{MM  
getMM! $
;MM$ %
setMM& )
;MM) *
}MM+ ,
publicNN 
intNN 
?NN 
IsActiveNN 
{NN 
getNN "
;NN" #
setNN$ '
;NN' (
}NN) *
publicOO 
intOO 
?OO 
	IsDeletedOO 
{OO 
getOO  #
;OO# $
setOO% (
;OO( )
}OO* +
publicPP 
stringPP 
?PP 
RandomStringPP #
{PP$ %
getPP& )
;PP) *
setPP+ .
;PP. /
}PP0 1
}QQ 
publicSS 

classSS 4
(NoticeOfDisbursementFileUpload_ViewModelSS 9
{TT 
publicUU 
	IFormFileUU 
FileUU 
{UU 
getUU  #
;UU# $
setUU% (
;UU( )
}UU* +
publicVV 
stringVV 
?VV 
uniqVV 
{VV 
getVV !
;VV! "
setVV# &
;VV& '
}VV( )
}WW 
publicYY 

classYY 0
$NoticeOfDisbursementToAPI_ViewModelsYY 5
{ZZ 
public[[ 
string[[ 
NodNo[[ 
{[[ 
get[[ !
;[[! "
set[[# &
;[[& '
}[[( )
public\\ 
DateTime\\ 
?\\ 
NodDate\\  
{\\! "
get\\# &
;\\& '
set\\( +
;\\+ ,
}\\- .
public]] 
DateTime]] 
?]] 
	ValueDate]] "
{]]# $
get]]% (
;]]( )
set]]* -
;]]- .
}]]/ 0
public^^ 
string^^ 
Cur^^ 
{^^ 
get^^ 
;^^  
set^^! $
;^^$ %
}^^& '
public__ 
List__ 
<__ )
TblNoticeOfDisbursementDetail__ 1
>__1 2
	NodDetail__3 <
{__= >
get__? B
;__B C
set__D G
;__G H
}__I J
}`` 
publicaa 

classaa -
!NoticeOfDisbursementJOB_ViewModelaa 2
{bb 
publiccc 
stringcc 
Idcc 
{cc 
getcc 
;cc 
setcc  #
;cc# $
}cc% &
publicdd 
stringdd 
Statusdd 
{dd 
getdd "
;dd" #
setdd$ '
;dd' (
}dd) *
}ee 
}ff é
aD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfDisbursementDetail_ViewModels.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 1
%NoticeOfDisbursementDetail_ViewModels 6
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
int		 
?		 
Id		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public 
int 
? 
NodId 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
? 
CreditorRefId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
decimal 
? 
Amount 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
decimal 
? 
	AmountIdr !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
DisbursementDate )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
? 
Apdplno 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
DateTime 
? 
	Apdpldate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
RealisasiNo "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
? 
RealisasiDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 

ContractNo !
{" #
get$ '
;' (
set) ,
;, -
}. /
public!! 
DateTime!! 
?!! 
ContractDate!! %
{!!& '
get!!( +
;!!+ ,
set!!- 0
;!!0 1
}!!2 3
public## 
DateTime## 
?## 
CreatedTime## $
{##% &
get##' *
;##* +
set##, /
;##/ 0
}##1 2
public%% 
int%% 
?%% 
CreatedById%% 
{%%  !
get%%" %
;%%% &
set%%' *
;%%* +
}%%, -
public'' 
DateTime'' 
?'' 
UpdatedTime'' $
{''% &
get''' *
;''* +
set'', /
;''/ 0
}''1 2
public)) 
int)) 
?)) 
UpdatedById)) 
{))  !
get))" %
;))% &
set))' *
;))* +
})), -
public++ 
int++ 
?++ 
IsActive++ 
{++ 
get++ "
;++" #
set++$ '
;++' (
}++) *
public-- 
int-- 
?-- 
	IsDeleted-- 
{-- 
get--  #
;--# $
set--% (
;--( )
}--* +
public// 
virtual// #
TblNoticeOfDisbursement// .
?//. /
Nod//0 3
{//4 5
get//6 9
;//9 :
set//; >
;//> ?
}//@ A
}00 
}11 å
dD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoticeOfDisbursementDetailForm_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 4
(NoticeOfDisbursementDetailForm_ViewModel 9
{ 
public 
int 
? 
CreditorRefId !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
CreditorRef "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
decimal		 
?		 
Amount		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public 
decimal 
? 
	AmountIdr !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Apdplno 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
RealisasiNo "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 

ContractNo !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ˝
MD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoDView_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
NoDView_ViewModel "
{ 
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
? 
NodNo 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
?		 
Cur		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
?

 
Beneficiary

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
DateTime 
? 
NodDate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
	ValueDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public #
TblNoticeOfDisbursement & 
NoticeOfDisbursement' ;
{< =
get> A
;A B
setC F
;F G
}H I
public 
List 
< )
TblNoticeOfDisbursementDetail 1
>1 2.
"tblNoticeOfDisbursementDetailsList3 U
{V W
getX [
;[ \
set] `
;` a
}b c
} 
} ”
UD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\NoDHeaderDetail_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class %
NoDHeaderDetail_ViewModel *
{ 
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
? 
NodNo 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Cur 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Beneficiary "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
DateTime		 
?		 
NodDate		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
DateTime

 
?

 
	ValueDate

 "
{

# $
get

% (
;

( )
set

* -
;

- .
}

/ 0
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public 
List 
< 1
%NoticeOfDisbursementDetail_ViewModels 9
>9 :
?: ;

NodDetails< F
{G H
getI L
;L M
setN Q
;Q R
}S T
} 
} Í
QD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\Navigation_ViewModels.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class !
Navigation_ViewModels &
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
long 
? 
ParentNavigationId '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 

ParentName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
int		 
?		 
Type		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
string

 
TypeName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Route 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
? 
RoleId 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
? 
Orderby 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Icon 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
? 
Createdtime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
Createdbyid  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
Updatedtime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
Updatedbyid  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DateTime 
? 
Deletedtime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
Deletedbyid  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 
Isactive 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
? 
	Isdeleted 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ·1
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterUser_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class %
BulkMasterUser_ViewModels *
{ 
public 
	IFormFile 
DataFileUser %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
? 
RoleId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
RandomString #
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
TypeUser 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
?		 

TypeDinkes		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
?

 
ProvinceKode

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 
string 
? 
DistrictKode #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
? 
SubDistrictKode &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 
PuskesmasKode $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
public 

class  
MasterUser_ViewModel %
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public 
string 
? 
Fullname 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Username 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
NoTelp 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Role 
{ 
get !
;! "
set# &
;& '
}( )
public   
string   
?   
Provinsi   
{    !
get  " %
;  % &
set  ' *
;  * +
}  , -
public!! 
string!! 
?!! 
Kota!! 
{!! 
get!! !
;!!! "
set!!# &
;!!& '
}!!( )
public"" 
string"" 
?"" 
	Puskesmas""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public$$ 
int$$ 
?$$ 
TypeUser$$ 
{$$ 
get$$ "
;$$" #
set$$$ '
;$$' (
}$$) *
public&& 
string&& 
?&& 
TypeUserName&& #
{&&$ %
get&&& )
;&&) *
set&&+ .
;&&. /
}&&0 1
public(( 
int(( 
?(( 
RoleId(( 
{(( 
get((  
;((  !
set((" %
;((% &
}((' (
public** 
string** 
?** 
RoleName** 
{**  !
get**" %
;**% &
set**' *
;*** +
}**, -
public,, 
string,, 
?,, 
UnitId,, 
{,, 
get,,  #
;,,# $
set,,% (
;,,( )
},,* +
public.. 
DateTime.. 
?.. 
CreatedTime.. $
{..% &
get..' *
;..* +
set.., /
;../ 0
}..1 2
public00 
DateTime00 
?00 
UpdatedTime00 $
{00% &
get00' *
;00* +
set00, /
;00/ 0
}001 2
public22 
DateTime22 
?22 
DeletedTime22 $
{22% &
get22' *
;22* +
set22, /
;22/ 0
}221 2
public44 
long44 
?44 
CreatedById44  
{44! "
get44# &
;44& '
set44( +
;44+ ,
}44- .
public66 
long66 
?66 
UpdatedById66  
{66! "
get66# &
;66& '
set66( +
;66+ ,
}66- .
public88 
long88 
?88 
DeletedById88  
{88! "
get88# &
;88& '
set88( +
;88+ ,
}88- .
public:: 
bool:: 
?:: 
IsActive:: 
{:: 
get::  #
;::# $
set::% (
;::( )
}::* +
public<< 
bool<< 
?<< 
	IsDeleted<< 
{<<  
get<<! $
;<<$ %
set<<& )
;<<) *
}<<+ ,
public>> 
DateTime>> 
?>> 
	LastLogin>> "
{>># $
get>>% (
;>>( )
set>>* -
;>>- .
}>>/ 0
public@@ 
int@@ 
?@@ 
IsActivated@@ 
{@@  !
get@@" %
;@@% &
set@@' *
;@@* +
}@@, -
}AA 
}CC ¸
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterUnit_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class  
MasterUnit_ViewModel %
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public 
long 
? 
Id 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
StatusOutlet #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public		 
bool		 
?		 
IsActive		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
}

 
public 

class &
CreateMasterUnit_ViewModel +
{ 
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
	ShortName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
Alamat 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
? 
ParentId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
StatusOutlet #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
? 
NoTelp 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Kode 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
KodeWilayah "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 

KodeCabang !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
FullKode 
{  !
get" %
;% &
set' *
;* +
}, -
public 
bool 
? 
IsActive 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 

class &
UpdateMasterUnit_ViewModel +
:, -&
CreateMasterUnit_ViewModel. H
{ 
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}$ %
} 
} ˙
[D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterSystemParameter_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class +
MasterSystemParameter_ViewModel 0
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
?		 
Key		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public 
string 
? 
Value 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
? 
OrderBy 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
DeletedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
CreatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
UpdatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
DeletedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 
IsActive 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
? 
	IsDeleted 
{  
get! $
;$ %
set& )
;) *
}+ ,
}   
}!! €
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterRole_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class  
MasterRole_ViewModel %
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public 
long 
? 
Id 
{ 
get 
; 
set "
;" #
}$ %
public

 
string

 
?

 
Name

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
string 
? 
Kode 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
DeletedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
CreatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
UpdatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
DeletedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 
IsActive 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
? 
	IsDeleted 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}   Ê
RD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterLookup_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class "
MasterLookup_ViewModel '
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
?		 
Name		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public 
int 
? 
Value 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Type 
{ 
get !
;! "
set# &
;& '
}( )
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DateTime 
? 
DeletedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
long 
? 
CreatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
UpdatedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
long 
? 
DeletedById  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
? 
	IsDeleted 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
bool 
? 
IsActive 
{ 
get  #
;# $
set% (
;( )
}* +
}   
}!! ï
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\MasterMenu_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class  
MasterMenu_ViewModel %
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
long 
? 
Id 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
TypeName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

ParentName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
string		 
Nama		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
Tipe

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
int 
? 
TipeId 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Route 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Icon 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
public 
long 
? 
ParentId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
OrderBy 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CreatedTime !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	CreatedBy 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
UpdatedTime !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	UpdatedBy 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} ¯Z
KD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\Login_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
Login_ViewModel  
{ 
public 
string 
? 
Username 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 

HDUsername !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 

HDPassword !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
?		 
TokenCapcha		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public

 
string

 
?

 
OtpValid

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 
? 
KodeOtp 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 

ObjectSend !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
TypeSend 
{  !
get" %
;% &
set' *
;* +
}, -
} 
public 

class "
DetailLogin_ViewModels '
{ 
public 
long 
? 
UserId 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Username 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Fullname 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
public 
long 
? 
	PegawaiId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
PegawaiName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
? 
RoleId 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
KodeRole 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
RoleName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
NoHP 
{ 
get !
;! "
set# &
;& '
}( )
public 
string	 
? 
IsOTP 
{ 
get 
; 
set !
;! "
}# $
public 
string	 
? 
IsVerifEmail 
{ 
get  #
;# $
set% (
;( )
}* +
public   
string  	 
?   
IsVerifNoTelp   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
public!! 
bool!!	 
?!! 
IsActive!! 
{!! 
get!! 
;!! 
set!! "
;!!" #
}!!$ %
public"" 
bool"" 
?"" 
	IsDeleted"" 
{""  
get""! $
;""$ %
set""& )
;"") *
}""+ ,
public## 
bool## 
?## 
	LDAPLogin## 
{##  
get##! $
;##$ %
set##& )
;##) *
}##+ ,
public$$ 
DateTime$$ 
?$$ 
	LastLogin$$ "
{$$# $
get$$% (
;$$( )
set$$* -
;$$- .
}$$/ 0
public%% 
DateTime%% 
?%% 

LastActive%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public&& 
bool&& 
?&& 
isLogout&& 
{&& 
get&&  #
;&&# $
set&&% (
;&&( )
}&&* +
public'' 
long'' 
?'' 
UnitId'' 
{'' 
get'' !
;''! "
set''# &
;''& '
}''( )
public(( 
int(( 
?(( 
Counter(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
})) 
public++ 
class++ %
DetailLoginOTP_ViewModels++ '
{,, 
public-- 
int--	 
Kode-- 
{-- 
get-- 
;-- 
set-- 
;-- 
}-- 
public.. 
string..	 
OTPInput.. 
{.. 
get.. 
;.. 
set..  #
;..# $
}..% &
public// 
string//	 
OTP// 
{// 
get// 
;// 
set// 
;// 
}//  !
public00 
string00	 
UserId00 
{00 
get00 
;00 
set00 !
;00! "
}00# $
public11 
string11	 
	ipAddress11 
{11 
get11 
;11  
set11! $
;11$ %
}11& '
public22 
string22	 
Username22 
{22 
get22 
;22 
set22  #
;22# $
}22% &
public33 
string33	 

ReqEncrypt33 
{33 
get33  
;33  !
set33" %
;33% &
}33' (
public44 
string44	 
PasswordLama44 
{44 
get44 "
;44" #
set44$ '
;44' (
}44) *
public55 
string55	 
PasswordInput55 
{55 
get55  #
;55# $
set55% (
;55( )
}55* +
public66 
string66	 
PasswordKonfirmasi66 "
{66# $
get66% (
;66( )
set66* -
;66- .
}66/ 0
public77 
string77	 
Password77 
{77 
get77 
;77 
set77  #
;77# $
}77% &
public88 
string88	 
ConfirmPassword88 
{88  !
get88" %
;88% &
set88' *
;88* +
}88, -
}:: 
public<< 
class<< !
SliderLogin_ViewModel<< #
{== 
public>> 
int>>	 
Kode>> 
{>> 
get>> 
;>> 
set>> 
;>> 
}>> 
public?? 
string??	 
Validate?? 
{?? 
get?? 
;?? 
set??  #
;??# $
}??% &
public@@ 
string@@ 

Pengumuman@@  
{@@! "
get@@# &
;@@& '
set@@( +
;@@+ ,
}@@- .
publicAA 
stringAA	 
TypeSentAA 
{AA 
getAA 
;AA 
setAA  #
;AA# $
}AA% &
publicBB 
stringBB	 

ObjectSentBB 
{BB 
getBB  
;BB  !
setBB" %
;BB% &
}BB' (
publicCC 
stringCC	 
UsernameCC 
{CC 
getCC 
;CC 
setCC  #
;CC# $
}CC% &
publicDD 
stringDD	 
ShowOtpDD 
{DD 
getDD 
;DD 
setDD "
;DD" #
}DD$ %
publicEE 
stringEE	 
ShowOtpEmailEE 
{EE 
getEE "
;EE" #
setEE$ '
;EE' (
}EE) *
publicFF 
stringFF	 
	ShowOtpWaFF 
{FF 
getFF 
;FF  
setFF! $
;FF$ %
}FF& '
publicGG 
ListGG	 
<GG "
SliderImage_ViewModelsGG $
>GG$ %

ListSliderGG& 0
{GG1 2
getGG3 6
;GG6 7
setGG8 ;
;GG; <
}GG= >
}HH 
publicKK 

classKK 
Tutorial_ViewModelsKK $
{LL 
publicMM 
ListMM 
<MM "
SliderImage_ViewModelsMM *
>MM* +
ListPdfMM, 3
{MM4 5
getMM6 9
;MM9 :
setMM; >
;MM> ?
}MM@ A
publicNN 
ListNN 
<NN "
SliderImage_ViewModelsNN *
>NN* +
	ListVideoNN, 5
{NN6 7
getNN8 ;
;NN; <
setNN= @
;NN@ A
}NNB C
}OO 
publicQQ 

classQQ "
SliderImage_ViewModelsQQ '
{RR 
publicSS 
intSS	 
IdSS 
{SS 
getSS 
;SS 
setSS 
;SS 
}SS 
publicTT 
stringTT	 
NameFileTT 
{TT 
getTT 
;TT 
setTT  #
;TT# $
}TT% &
publicUU 
stringUU	 
	ImagePathUU 
{UU 
getUU 
;UU  
setUU! $
;UU$ %
}UU& '
}WW 
publicYY 
classYY 
TokenVMYY 
{ZZ 
public[[ 
string[[	 
Username[[ 
{[[ 
get[[ 
;[[ 
set[[  #
;[[# $
}[[% &
public\\ 
DateTime\\	 
DateTime\\ 
{\\ 
get\\  
;\\  !
set\\" %
;\\% &
}\\' (
}]] 
public__ 
class__ 
WhatsappResponse__ 
{`` 
publicaa 
boolaa	 
sentaa 
{aa 
getaa 
;aa 
setaa 
;aa 
}aa  
publicbb 
stringbb	 
messagebb 
{bb 
getbb 
;bb 
setbb "
;bb" #
}bb$ %
publiccc 
stringcc	 
descriptioncc 
{cc 
getcc !
;cc! "
setcc# &
;cc& '
}cc( )
publicdd 
stringdd	 
iddd 
{dd 
getdd 
;dd 
setdd 
;dd 
}dd  
}ee 
}ff äI
VD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\ListDataDropdownServerSide.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 
class &
ListDataDropdownServerSide (
{ 
public 
List	 
< "
DataDropdownServerSide $
>$ %
items& +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
int	 
total_count 
{ 
get 
; 
set  #
;# $
}% &
}		 
public

 
class

 $
ListDropdownServerSideVM

 &
{ 
public 
List	 
<  
DropdownServerSideVM "
>" #
items$ )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
int	 
total_count 
{ 
get 
; 
set  #
;# $
}% &
} 
public 

class *
ListDataDropdownServerSideDeva /
{ 
public 
List 
< &
DataDropdownServerSideDeva .
>. /
items0 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public 
int 
total_count 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public 

class &
DataDropdownServerSideDeva +
{ 
public 
string 
id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
text 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
format_selected %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
	nama_text 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LoanId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
RekId 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Rekening 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
CreditorRef !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
DSign 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Amount 
{ 
get "
;" #
set$ '
;' (
}) *
public   
string   
acc   
{   
get   
;    
set  ! $
;  $ %
}  & '
public!! 
string!! 
Cur!! 
{!! 
get!! 
;!!  
set!!! $
;!!$ %
}!!& '
}"" 
public## 

class## "
DataDropdownServerSide## '
{$$ 
public%% 
long%%	 
id%% 
{%% 
get%% 
;%% 
set%% 
;%% 
}%% 
public&& 
string&&	 
text&& 
{&& 
get&& 
;&& 
set&& 
;&&  
}&&! "
public'' 
string''	 
format_selected'' 
{''  !
get''" %
;''% &
set''' *
;''* +
}'', -
public(( 
string((	 
	nama_text(( 
{(( 
get(( 
;((  
set((! $
;(($ %
}((& '
public)) 
string))	 
LoanId)) 
{)) 
get)) 
;)) 
set)) !
;))! "
}))# $
public** 
string** 
RekId** 
{** 
get** !
;**! "
set**# &
;**& '
}**( )
public++ 
string++ 
Rekening++ 
{++  
get++! $
;++$ %
set++& )
;++) *
}+++ ,
public,, 
string,, 
CreditorRef,, !
{,," #
get,,$ '
;,,' (
set,,) ,
;,,, -
},,. /
public-- 
DateTime--	 
?-- 
DSign-- 
{-- 
get-- 
;-- 
set--  #
;--# $
}--% &
public.. 
string..	 
Amount.. 
{.. 
get.. 
;.. 
set.. !
;..! "
}..# $
public// 
string//	 
Cur// 
{// 
get// 
;// 
set// 
;// 
}//  !
}00 
public11 
class11  
DropdownServerSideVM11 "
{22 
public33 
string33	 
id33 
{33 
get33 
;33 
set33 
;33 
}33  
public44 
string44	 
text44 
{44 
get44 
;44 
set44 
;44  
}44! "
public55 
string55	 
format_selected55 
{55  !
get55" %
;55% &
set55' *
;55* +
}55, -
public66 
string66	 
	nama_text66 
{66 
get66 
;66  
set66! $
;66$ %
}66& '
}77 
public88 
class88 #
DropdownServerSideIntVM88 %
{99 
public:: 
int::	 
?:: 
id:: 
{:: 
get:: 
;:: 
set:: 
;:: 
}:: 
public;; 
string;;	 
text;; 
{;; 
get;; 
;;; 
set;; 
;;;  
};;! "
public<< 
string<<	 
format_selected<< 
{<<  !
get<<" %
;<<% &
set<<' *
;<<* +
}<<, -
public== 
string==	 
	nama_text== 
{== 
get== 
;==  
set==! $
;==$ %
}==& '
}>> 
public?? 
class?? 
DataDropdownParent??  
{@@ 
publicAA 
longAA 
NumberAA 
{AA 
getAA  
;AA  !
setAA" %
;AA% &
}AA' (
publicBB 
longBB 
IdBB 
{BB 
getBB 
;BB 
setBB !
;BB! "
}BB# $
publicCC 
stringCC 
textCC 
{CC 
getCC  
;CC  !
setCC" %
;CC% &
}CC' (
}DD 
publicEE 

classEE "
DataDropdownParentListEE '
{FF 
publicGG 
ListGG 
<GG 
DataDropdownParentGG &
>GG& '
itemsGG( -
{GG. /
getGG0 3
;GG3 4
setGG5 8
;GG8 9
}GG: ;
publicII 
intII	 
total_countII 
{II 
getII 
;II 
setII  #
;II# $
}II$ %
}KK 
publicMM 
classMM 
DropDownRoleMM 
{NN 
publicOO 
longOO	 
idOO 
{OO 
setOO 
;OO 
getOO 
;OO 
}OO 
publicPP 
stringPP	 
textPP 
{PP 
setPP 
;PP 
getPP 
;PP  
}PP! "
}QQ 
publicSS 

classSS 
DropDownParentSS 
{TT 
publicUU 
longUU	 
NumberUU 
{UU 
getUU 
;UU 
setUU 
;UU  
}UU! "
publicVV 
longVV 
idVV 
{VV 
getVV 
;VV 
setVV !
;VV! "
}VV# $
publicWW 
stringWW 
textWW 
{WW 
getWW  
;WW  !
setWW" %
;WW% &
}WW' (
}XX 
publicZZ 
classZZ 
DropDownParentListZZ  
{[[ 
public\\ 
List\\ 
<\\ 
DropDownParent\\ "
>\\" #
items\\$ )
{\\* +
get\\, /
;\\/ 0
set\\1 4
;\\4 5
}\\6 7
public]] 
int]] 
total_count]] 
{]]  
get]]! $
;]]$ %
set]]& )
;]]) *
}]]+ ,
}^^ 
}`` €
KD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\LDAPLoginReq_VM.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
LDAPLoginReq_VM  
{ 
public 
string 
username 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}		 ∞
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\FileUploadNop_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class #
FileUploadNop_ViewModel (
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
?		 
FileName		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public 
int 
? 
FileSize 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
FilePath 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 

UploadTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
? 

UploadById 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
Status 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
ErrorMessage #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
CreatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
UpdatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public!! 
int!! 
?!! 
	IsDeleted!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
}"" 
}## ∞
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\FileUploadNod_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class #
FileUploadNod_ViewModel (
{ 
public 
Int64 
? 
Number 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
? 
Id 
{ 
get 
; 
set !
;! "
}# $
public		 
string		 
?		 
FileName		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public 
int 
? 
FileSize 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
FilePath 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 

UploadTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
? 

UploadById 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
Status 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
ErrorMessage #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DateTime 
? 
CreatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
CreatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
UpdatedTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
? 
UpdatedById 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
IsActive 
{ 
get "
;" #
set$ '
;' (
}) *
public!! 
int!! 
?!! 
	IsDeleted!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
}"" 
}## ¸
TD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\ExportToPDFNoP_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class $
ExportToPDFNoP_ViewModel )
{ 
public 
string 
	UserLogin 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
TanggalCetak		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public 
string 
Domain 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Logo 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
TblNoticeOfPayment &
>& '
ListData( 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
} 
} Â
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\DownloadList_ViewModels.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class #
Downloadlist_LoadDataVM (
{ 
public 
Int64 
Number 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
DateTime 
? 
GeneratedDate &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DateTime 
? 
ExpiredDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
string		 
?		 
FileName		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 
?

 
	Extension

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
int 
? 
Status 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Path 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ≠
[D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\CreateNoticeOfPayment_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class +
CreateNoticeOfPayment_ViewModel 0
{ 
public 
TblNoticeOfPayment !
NoticeOfPayment" 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public $
TblNoticeOfPaymentDetail '!
NoticeOfPaymentDetail( =
{> ?
get@ C
;C D
setE H
;H I
}J K
}		 
}

 Å	
TD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\ExportToPDFNoD_ViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class $
ExportToPDFNoD_ViewModel )
{ 
public 
string 
	UserLogin 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
TanggalCetak		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public 
string 
Domain 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Logo 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< #
TblNoticeOfDisbursement +
>+ ,
ListData- 5
{6 7
get9 <
;< =
set> A
;A B
}C D
} 
} Ω
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\ViewModels\BaseResponse.cs
	namespace 	
DashboardDevaBNI
 
. 

ViewModels %
{ 
public 

class 
BaseResponse 
< 
T 
>  
{ 
public 
int 
Code 
{ 
get 
; 
set "
;" #
}$ %
=& '
$num( )
;) *
public 
string 
Message 
{ 
get  #
;# $
set% (
;( )
}* +
public 
T 
Data 
{ 
get 
; 
set  
;  !
}" #
} 
}

 ﬁb
8D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Program.cs
string 
logDirectory 
= 
Environment !
.! ""
GetEnvironmentVariable" 8
(8 9
$str9 R
)R S
??T V
$strW ]
;] ^
string 
serviceName 
= 
Environment  
.  !"
GetEnvironmentVariable! 7
(7 8
$str8 K
)K L
??M O
$strP `
;` a
string 
endpoint 
= 
Environment 
. "
GetEnvironmentVariable 4
(4 5
$str5 R
)R S
??T V
$strW s
;s t
string 
environment 
= 
Environment  
.  !"
GetEnvironmentVariable! 7
(7 8
$str8 P
)P Q
??R T
$strU b
;b c
string 
serviceVersion 
= 
Environment #
.# $"
GetEnvironmentVariable$ :
(: ;
$str; Q
)Q R
??S U
$strV ]
;] ^
Log 
. 
Logger 

= 
new 
LoggerConfiguration $
($ %
)% &
. 
WriteTo 
. 	
File	 
( 
new  
CompactJsonFormatter 
( 
) 
, 
$"  "
{" #
logDirectory# /
}/ 0
$str0 9
"9 :
,: ;
rollingInterval< K
:K L
RollingIntervalM \
.\ ]
Day] `
) 
. 
WriteTo 
. 	
OpenTelemetry	 
( 
options 
=> !
{ 
options 
. 
Endpoint 
= 
endpoint 
;  
options 
. 	
Protocol	 
= 
OtlpProtocol  
.  !
Grpc! %
;% &
options 
. 	
IncludedData	 
= 
IncludedData $
.$ %
TraceIdField% 1
|2 3
IncludedData4 @
.@ A
SpanIdFieldA L
|M N
IncludedDataO [
.[ \"
SourceContextAttribute\ r
;r s
options 
. 
ResourceAttributes 
=  
new! $

Dictionary% /
</ 0
string0 6
,6 7
object8 >
>> ?
{ 
{   
$str   
,   
serviceName   
}   
,    
{!! 	
$str!!	 
,!! 
serviceVersion!! *
}!!* +
,!!+ ,
{"" 	
$str""	 
,"" 
$num"" 
}"" 
,"" 
{## 	
$str##	 
,## 
true## 
}## 
,## 
{$$ 	
$str$$	 
,$$ 
$num$$ 
}$$ 
,$$ 
{%% 	
$str%%	 !
,%%! "
environment%%# .
}%%. /
,%%/ 0
{&& 	
$str&&	 
,&& 
serviceName&&  +
}&&+ ,
,&&, -
{'' 	
$str''	 
,'' 
serviceName'' )
}'') *
}(( 
;(( 
})) 
))) 
.** 
WriteTo** 
.** 	
Console**	 
(** 
new**  
CompactJsonFormatter** )
(**) *
)*** +
)**+ ,
.++ 
CreateLogger++ 
(++ 
)++ 
;++ 
try-- 
{.. 
var// 
builder// 
=// 
WebApplication//  
.//  !
CreateBuilder//! .
(//. /
args/// 3
)//3 4
;//4 5
builder11 
.11 
Configuration11 
.11 #
AddEnvironmentVariables11 1
(111 2
prefix112 8
:118 9
$str11: A
)11A B
;11B C
builder33 
.33 	
Services33	 
.33 

AddSerilog33 
(33 
)33 
;33 
builder55 
.55 	
Services55	 
.55 
AddOpenTelemetry55 "
(55" #
)55# $
.66 	
ConfigureResource66	 
(66 
resource66 #
=>66$ &
resource66' /
.66/ 0
AddAttributes660 =
(66= >
new66> A

Dictionary66B L
<66L M
string66M S
,66S T
object66U [
>66[ \
{77 	
{88 
$str88 
,88 
serviceName88 (
}88( )
,88) *
{99 
$str99 
,99 
serviceVersion99  .
}99. /
,99/ 0
{:: 
$str:: %
,::% &
environment::' 2
}::2 3
,::3 4
{;; 
$str;; "
,;;" #
serviceName;;$ /
};;/ 0
,;;0 1
{<< 
$str<<  
,<<  !
serviceName<<" -
}<<- .
}== 	
)==	 

)==
 
.>> 	
WithMetrics>>	 
(>> 
metrics>> 
=>>> 
{?? 
metrics@@ 
.@@ (
AddAspNetCoreInstrumentation@@ 0
(@@0 1
)@@1 2
;@@2 3
metricsAA 
.AA (
AddHttpClientInstrumentationAA 0
(AA0 1
)AA1 2
;AA2 3
metricsBB 
.BB %
AddRuntimeInstrumentationBB -
(BB- .
)BB. /
;BB/ 0
metricsCC 
.CC %
AddProcessInstrumentationCC -
(CC- .
)CC. /
;CC/ 0
metricsDD 
.DD 
AddOtlpExporterDD #
(DD# $
optionsDD$ +
=>DD, .
{EE 
optionsFF 
.FF 
EndpointFF $
=FF% &
newFF' *
UriFF+ .
(FF. /
endpointFF/ 7
)FF7 8
;FF8 9
optionsGG 
.GG 
ExportProcessorTypeGG /
=GG0 1
ExportProcessorTypeGG2 E
.GGE F
SimpleGGF L
;GGL M
optionsHH 
.HH 
ProtocolHH $
=HH% &
OpenTelemetryHH' 4
.HH4 5
ExporterHH5 =
.HH= >
OtlpExportProtocolHH> P
.HHP Q
GrpcHHQ U
;HHU V
}II 
)II 
;II 
}JJ 	
)JJ	 

.KK 	
WithTracingKK	 
(KK 
tracingKK 
=>KK 
{LL 
tracingMM 
.MM (
AddAspNetCoreInstrumentationMM *
(MM* +
)MM+ ,
;MM, -
tracingNN 
.NN (
AddHttpClientInstrumentationNN *
(NN* +
)NN+ ,
;NN, -
tracingOO 
.OO 1
%AddEntityFrameworkCoreInstrumentationOO 9
(OO9 :
)OO: ;
;OO; <
tracingPP 
.PP 
AddOtlpExporterPP #
(PP# $
optionsPP$ +
=>PP, .
{QQ 
optionsRR 
.RR 
EndpointRR $
=RR% &
newRR' *
UriRR+ .
(RR. /
endpointRR/ 7
)RR7 8
;RR8 9
optionsSS 
.SS 
ExportProcessorTypeSS /
=SS0 1
ExportProcessorTypeSS2 E
.SSE F
SimpleSSF L
;SSL M
optionsTT 
.TT 
ProtocolTT $
=TT% &
OpenTelemetryTT' 4
.TT4 5
ExporterTT5 =
.TT= >
OtlpExportProtocolTT> P
.TTP Q
GrpcTTQ U
;TTU V
}UU 
)UU 
;UU 
}VV 
)VV 
;VV 
builderYY 
.YY 
ServicesYY 
.YY #
AddControllersWithViewsYY ,
(YY, -
)YY- .
;YY. /
builderZZ 
.ZZ 
ServicesZZ 
.ZZ #
AddControllersWithViewsZZ ,
(ZZ, -
)ZZ- .
.ZZ. /&
AddRazorRuntimeCompilationZZ/ I
(ZZI J
)ZZJ K
;ZZK L
builder[[ 
.[[ 
Services[[ 
.[[ "
AddHttpContextAccessor[[ +
([[+ ,
)[[, -
;[[- .
builder\\ 
.\\ 
Services\\ 
.\\ 
AddSingleton\\ !
<\\! " 
IHttpContextAccessor\\" 6
,\\6 7
HttpContextAccessor\\8 K
>\\K L
(\\L M
)\\M N
;\\N O
builder]] 
.]] 
Services]] 
.]] 
AddSingleton]] !
(]]! "
typeof]]" (
(]]( )

IConverter]]) 3
)]]3 4
,]]4 5
new]]6 9!
SynchronizedConverter]]: O
(]]O P
new]]P S
PdfTools]]T \
(]]\ ]
)]]] ^
)]]^ _
)]]_ `
;]]` a
builder^^ 
.^^ 
Services^^ 
.^^ %
AddDistributedMemoryCache^^ .
(^^. /
)^^/ 0
;^^0 1
builder__ 
.__ 
Services__ 
.__ 

AddSession__ 
(__  
options__  '
=>__( *
{`` 
optionsaa 
.aa 
IdleTimeoutaa 
=aa 
TimeSpanaa &
.aa& '
FromMinutesaa' 2
(aa2 3
intaa3 6
.aa6 7
Parseaa7 <
(aa< =
	GetConfigaa= F
.aaF G

AppSettingaaG Q
[aaQ R
$straaR u
]aau v
)aav w
)aaw x
;aax y
optionsbb 
.bb 
Cookiebb 
.bb 
HttpOnlybb 
=bb  !
truebb" &
;bb& '
optionscc 
.cc 
Cookiecc 
.cc 
IsEssentialcc "
=cc# $
truecc% )
;cc) *
}ff 
)ff 
;ff 
builderhh 
.hh 
Serviceshh 
.hh 
AddDbContexthh !
<hh! "%
DbDashboardDevaBniContexthh" ;
>hh; <
(hh< =
)hh= >
;hh> ?
varjj 
appjj 
=jj 
builderjj 
.jj 
Buildjj 
(jj 
)jj 
;jj 
if{{ 
({{ 
!{{ 	
app{{	 
.{{ 
Environment{{ 
.{{ 
IsDevelopment{{ &
({{& '
){{' (
){{( )
{|| 
app}} 
.}} 
UseExceptionHandler}} 
(}}  
$str}}  -
)}}- .
;}}. /
app 
. 
UseHsts 
( 
) 
; 
}
ÄÄ 
app
ÅÅ 
.
ÅÅ !
UseHttpsRedirection
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
app
ÇÇ 
.
ÇÇ 
UseStaticFiles
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
app
ÉÉ 
.
ÉÉ 

UseSession
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
app
ÑÑ 
.
ÑÑ 

UseRouting
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
app
ÜÜ 
.
ÜÜ &
UseSerilogRequestLogging
ÜÜ  
(
ÜÜ  !
)
ÜÜ! "
;
ÜÜ" #
app
àà 
.
àà 
UseAuthorization
àà 
(
àà 
)
àà 
;
àà 
app
ââ 
.
ââ  
MapControllerRoute
ââ 
(
ââ 
name
ää 
:
ää 
$str
ää 
,
ää 
pattern
ãã 
:
ãã 
$str
ãã :
)
ãã: ;
;
ãã; <
app
çç 
.
çç 
Run
çç 
(
çç 
)
çç 
;
çç 
}ëë 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë 
{íí 
Log
ìì 
.
ìì 
Error
ìì 
(
ìì 
ex
ìì 
,
ìì 
$str
ìì %
)
ìì% &
;
ìì& '
}îî 
finally
îî 	
{
îî
 
Log
ïï 
.
ïï 
CloseAndFlush
ïï 
(
ïï 
)
ïï 
;
ïï 
}ññ ˇ
YD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TempTblNoticeOfDisbursementDetail.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class -
!TempTblNoticeOfDisbursementDetail 6
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
?

 
NodId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 

int 
? 
CreditorRefId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
? 
CreditorRef 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
? 
Amount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
? 
	AmountIdr 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
DisbursementDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

string 
? 
Apdplno 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 
	Apdpldate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
RealisasiNo 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
RealisasiDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 

ContractNo 
{ 
get  #
;# $
set% (
;( )
}* +
public   

DateTime   
?   
ContractDate   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public"" 

DateTime"" 
?"" 
CreatedTime""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public$$ 

int$$ 
?$$ 
CreatedById$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
public&& 

DateTime&& 
?&& 
UpdatedTime&&  
{&&! "
get&&# &
;&&& '
set&&( +
;&&+ ,
}&&- .
public(( 

int(( 
?(( 
UpdatedById(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
public** 

int** 
?** 
IsActive** 
{** 
get** 
;** 
set**  #
;**# $
}**% &
public,, 

int,, 
?,, 
	IsDeleted,, 
{,, 
get,, 
;,,  
set,,! $
;,,$ %
},,& '
}-- Ç
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblUserSession.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblUserSession #
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

long

 
?

 
UserId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

string 
? 
	SessionId 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DateTime 
? 

LastActive 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
Info 
{ 
get 
; 
set "
;" #
}$ %
public 

long 
? 
RoleId 
{ 
get 
; 
set "
;" #
}$ %
public 

bool 
? 
IsLogout 
{ 
get 
;  
set! $
;$ %
}& '
public 

bool 
? 
SendEmailCounter !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

int 
? 
Counter 
{ 
get 
; 
set "
;" #
}$ %
} ı
TD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfPaymentDetailTemp.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class (
TblNoticeOfPaymentDetailTemp 1
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
NopId

 
{

 
get

 
;

 
set

 
;

  
}

! "
public 

string 
? 
CreditorRef 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
? 
Outstanding 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
? 
	Principal 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
? 
Interest 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
? 
Fee 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
CreatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
UpdatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public   

int   
?   
	IsDeleted   
{   
get   
;    
set  ! $
;  $ %
}  & '
public"" 

string"" 
?"" 
RandomString"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
}## Ñ
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfPaymentDetail.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class $
TblNoticeOfPaymentDetail -
{ 
public 

long 
? 
NopId 
{ 
get 
; 
set !
;! "
}# $
public

 

string

 
?

 
CreditorRef

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 

decimal 
? 
Outstanding 
{  !
get" %
;% &
set' *
;* +
}, -
public 

decimal 
? 
	Principal 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
? 
Interest 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
? 
Fee 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
CreatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
UpdatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
public   

long   
Id   
{   
get   
;   
set   
;   
}    
public"" 

string"" 
?"" 
IdNopDetailFromApi"" %
{""& '
get""( +
;""+ ,
set""- 0
;""0 1
}""2 3
}## œ
JD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfPayment.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblNoticeOfPayment '
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
NopNo

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

DateTime 
? 
DueDate 
{ 
get "
;" #
set$ '
;' (
}) *
public 

decimal 
? 
InterestRate  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

decimal 
? 
InterestDays  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

string 
? 
Cur 
{ 
get 
; 
set !
;! "
}# $
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
CreatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
UpdatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
public   

string   
?   
Status   
{   
get   
;    
set  ! $
;  $ %
}  & '
public"" 

string"" 
?"" 
	AccountNo"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public$$ 

string$$ 
?$$ 
AccountName$$ 
{$$  
get$$! $
;$$$ %
set$$& )
;$$) *
}$$+ ,
public&& 

string&& 
?&& 
IdNopFromApi&& 
{&&  !
get&&" %
;&&% &
set&&' *
;&&* +
}&&, -
public(( 

DateTime(( 
?(( 
LastSentDate(( !
{((" #
get(($ '
;((' (
set(() ,
;((, -
}((. /
public** 

int** 
?** 
RekId** 
{** 
get** 
;** 
set**  
;**  !
}**" #
public,, 

string,, 
?,, 

RekNameAcc,, 
{,, 
get,,  #
;,,# $
set,,% (
;,,( )
},,* +
}-- È
YD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfDisbursementDetailTemp.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class -
!TblNoticeOfDisbursementDetailTemp 6
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
NodId

 
{

 
get

 
;

 
set

 
;

  
}

! "
public 

int 
? 
CreditorRefId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
? 
CreditorRef 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
? 
Amount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
? 
	AmountIdr 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
DisbursementDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

string 
? 
Apdplno 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 
	Apdpldate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
RealisasiNo 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
RealisasiDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 

ContractNo 
{ 
get  #
;# $
set% (
;( )
}* +
public   

DateTime   
?   
ContractDate   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public"" 

int"" 
?"" 
IsActive"" 
{"" 
get"" 
;"" 
set""  #
;""# $
}""% &
public$$ 

int$$ 
?$$ 
	IsDeleted$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public&& 

string&& 
?&& 
RandomString&& 
{&&  !
get&&" %
;&&% &
set&&' *
;&&* +
}&&, -
}'' ù
UD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfDisbursementDetail.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class )
TblNoticeOfDisbursementDetail 2
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
NodId

 
{

 
get

 
;

 
set

 
;

  
}

! "
public 

int 
? 
CreditorRefId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
? 
CreditorRef 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

decimal 
? 
Amount 
{ 
get  
;  !
set" %
;% &
}' (
public 

decimal 
? 
	AmountIdr 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
DisbursementDate %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

string 
? 
Apdplno 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 
	Apdpldate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
RealisasiNo 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
RealisasiDate "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

string 
? 

ContractNo 
{ 
get  #
;# $
set% (
;( )
}* +
public   

DateTime   
?   
ContractDate   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public"" 

DateTime"" 
?"" 
CreatedTime""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
public$$ 

int$$ 
?$$ 
CreatedById$$ 
{$$ 
get$$ !
;$$! "
set$$# &
;$$& '
}$$( )
public&& 

DateTime&& 
?&& 
UpdatedTime&&  
{&&! "
get&&# &
;&&& '
set&&( +
;&&+ ,
}&&- .
public(( 

int(( 
?(( 
UpdatedById(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
public** 

int** 
?** 
IsActive** 
{** 
get** 
;** 
set**  #
;**# $
}**% &
public,, 

int,, 
?,, 
	IsDeleted,, 
{,, 
get,, 
;,,  
set,,! $
;,,$ %
},,& '
public.. 

string.. 
?.. 
IdNodDetailFromApi.. %
{..& '
get..( +
;..+ ,
set..- 0
;..0 1
}..2 3
}// ◊
OD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNoticeOfDisbursement.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class #
TblNoticeOfDisbursement ,
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
?

 
FileUploadNodid

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 

string 
? 
NodNo 
{ 
get 
; 
set  #
;# $
}% &
public 

DateTime 
? 
NodDate 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DateTime 
? 
	ValueDate 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Cur 
{ 
get 
; 
set !
;! "
}# $
public 

string 
? 
Beneficiary 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
LastSentDate !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
CreatedById 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
UpdatedById 
{ 
get !
;! "
set# &
;& '
}( )
public   

int   
?   
IsActive   
{   
get   
;   
set    #
;  # $
}  % &
public"" 

int"" 
?"" 
	IsDeleted"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
public$$ 

string$$ 
?$$ 
Status$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public&& 

string&& 
?&& 
IdNodFromApi&& 
{&&  !
get&&" %
;&&% &
set&&' *
;&&* +
}&&, -
}'' ˛
OD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNavigationAssignment.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class #
TblNavigationAssignment ,
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

long

 
?

 
NavigationId

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 

long 
? 
RoleId 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
UpdatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
DeletedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
public 

bool 
? 
	IsDeleted 
{ 
get  
;  !
set" %
;% &
}' (
} ±
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblNavigation.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblNavigation "
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

long

 
?

 
ParentNavigationId

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
public 

int 
? 
Type 
{ 
get 
; 
set 
;  
}! "
public 

string 
? 
Name 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
Route 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
Visible 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
Icon 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
? 
OrderBy 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public   

long   
?   
UpdatedById   
{   
get   "
;  " #
set  $ '
;  ' (
}  ) *
public"" 

long"" 
?"" 
DeletedById"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public$$ 

bool$$ 
?$$ 
IsActive$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public&& 

bool&& 
?&& 
	IsDeleted&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
}'' ˜
JD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterUserVerif.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblMasterUserVerif '
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Username

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

string 
? 
Email 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
NoTelp 
{ 
get 
;  
set! $
;$ %
}& '
public 

bool 
? 
IsEmailVerif 
{ 
get  #
;# $
set% (
;( )
}* +
public 

bool 
? 
IsNoTelpVerif 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
UpdatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
DeletedById 
{ 
get "
;" #
set$ '
;' (
}) *
public   

bool   
?   
IsActive   
{   
get   
;    
set  ! $
;  $ %
}  & '
public"" 

bool"" 
?"" 
	IsDeleted"" 
{"" 
get""  
;""  !
set""" %
;""% &
}""' (
}## Î
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterUser.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblMasterUser "
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Fullname

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

string 
? 
Username 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
Email 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
Password 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
NoTelp 
{ 
get 
;  
set! $
;$ %
}& '
public 

int 
? 
TypeUser 
{ 
get 
; 
set  #
;# $
}% &
public 

long 
? 
RoleId 
{ 
get 
; 
set "
;" #
}$ %
public 

long 
? 
UnitId 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public   

long   
?   
CreatedById   
{   
get   "
;  " #
set  $ '
;  ' (
}  ) *
public"" 

long"" 
?"" 
UpdatedById"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public$$ 

long$$ 
?$$ 
DeletedById$$ 
{$$ 
get$$ "
;$$" #
set$$$ '
;$$' (
}$$) *
public&& 

bool&& 
?&& 
IsActive&& 
{&& 
get&& 
;&&  
set&&! $
;&&$ %
}&&& '
public(( 

bool(( 
?(( 
	IsDeleted(( 
{(( 
get((  
;((  !
set((" %
;((% &
}((' (
public** 

DateTime** 
?** 
	LastLogin** 
{**  
get**! $
;**$ %
set**& )
;**) *
}**+ ,
public,, 

string,, 
?,, 
IsVerifEmail,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
public.. 

string.. 
?.. 
IsVerifNoTelp..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
}// Ä!
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterUnit.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblMasterUnit "
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

long

 
?

 
ParentId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 

int 
Type 
{ 
get 
; 
set 
; 
}  !
public 

string 
? 
KodeWilayah 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Code 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
FullCode 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
	ShortName 
{ 
get "
;" #
set$ '
;' (
}) *
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

string 
? 
Address 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Email 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
Telepon 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
StatusOutlet 
{  !
get" %
;% &
set' *
;* +
}, -
public   

string   
?   
Latitude   
{   
get   !
;  ! "
set  # &
;  & '
}  ( )
public"" 

string"" 
?"" 
	Longitude"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
public$$ 

bool$$ 
?$$ 
IsActive$$ 
{$$ 
get$$ 
;$$  
set$$! $
;$$$ %
}$$& '
public&& 

DateTime&& 
?&& 
CreatedTime&&  
{&&! "
get&&# &
;&&& '
set&&( +
;&&+ ,
}&&- .
public(( 

DateTime(( 
?(( 
UpdatedTime((  
{((! "
get((# &
;((& '
set((( +
;((+ ,
}((- .
public** 

int** 
?** 
CreatedById** 
{** 
get** !
;**! "
set**# &
;**& '
}**( )
public,, 

int,, 
?,, 
UpdatedById,, 
{,, 
get,, !
;,,! "
set,,# &
;,,& '
},,( )
public.. 

DateTime.. 
?.. 
DeletedTime..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
public00 

int00 
?00 
DeletedById00 
{00 
get00 !
;00! "
set00# &
;00& '
}00( )
public22 

bool22 
?22 
IsDelete22 
{22 
get22 
;22  
set22! $
;22$ %
}22& '
public44 

int44 
?44 
ParentLevel44 
{44 
get44 !
;44! "
set44# &
;44& '
}44( )
}55 ®
PD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterSystemParameter.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class $
TblMasterSystemParameter -
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Key

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 

string 
? 
Value 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
UpdatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
DeletedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
? 
	IsDeleted 
{ 
get  
;  !
set" %
;% &
}' (
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
} í
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterRole.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblMasterRole "
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Name

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

string 
? 
Kode 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
UpdatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
DeletedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
public 

bool 
? 
	IsDeleted 
{ 
get  
;  !
set" %
;% &
}' (
} ª
GD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblMasterLookup.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblMasterLookup $
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Name

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

int 
? 
Value 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Type 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
UpdatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

DateTime 
? 
DeletedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

long 
? 
CreatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
UpdatedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

long 
? 
DeletedById 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
? 
	IsDeleted 
{ 
get  
;  !
set" %
;% &
}' (
public   

bool   
?   
IsActive   
{   
get   
;    
set  ! $
;  $ %
}  & '
}!! π
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblLogErrorPrint.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblLogErrorPrint %
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
?

 
IdFile

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 

string 
? 
ErrorMessage 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
} ¶
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblLogActivity.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblLogActivity #
{ 
public 

long 
Id 
{ 
get 
; 
set 
; 
}  
public

 

string

 
?

 
Username

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

string 
? 
Url 
{ 
get 
; 
set !
;! "
}# $
public 

DateTime 
? 

ActionTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

string 
? 
Browser 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Ip 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
Os 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 

ClientInfo 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
? 

Keterangan 
{ 
get  #
;# $
set% (
;( )
}* +
public 

long 
? 
UserId 
{ 
get 
; 
set "
;" #
}$ %
} ´
AD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblGetOtp.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
	TblGetOtp 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
Username

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 

string 
? 
KodeOtp 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 
ExpiredTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
} í
LD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblFileUploadNopTemp.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class  
TblFileUploadNopTemp )
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
IdFileFromApi

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 

int 
? 
IdNop 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
FileName 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
FileSize 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
FilePath 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
FileExt 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 

UploadTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
? 

UploadById 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
? 
RandomString 
{  !
get" %
;% &
set' *
;* +
}, -
} €
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblFileUploadNop.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblFileUploadNop %
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
IdFileFromApi

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 

int 
? 
IdNop 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
FileName 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
FileSize 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
FilePath 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
FileExt 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 

UploadTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
? 

UploadById 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
} í
LD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblFileUploadNodTemp.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class  
TblFileUploadNodTemp )
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
IdFileFromApi

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 

int 
? 
IdNod 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
FileName 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
FileSize 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
FilePath 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
FileExt 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 

UploadTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
? 

UploadById 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
? 
RandomString 
{  !
get" %
;% &
set' *
;* +
}, -
} €
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblFileUploadNod.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblFileUploadNod %
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
IdFileFromApi

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 

int 
? 
IdNod 
{ 
get 
; 
set  
;  !
}" #
public 

string 
? 
FileName 
{ 
get !
;! "
set# &
;& '
}( )
public 

int 
? 
FileSize 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
FilePath 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
FileExt 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 
? 

UploadTime 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
? 

UploadById 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 
IsActive 
{ 
get 
; 
set  #
;# $
}% &
public 

int 
? 
	IsDeleted 
{ 
get 
;  
set! $
;$ %
}& '
} Ω
JD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\TblDownloadBigFile.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public 
partial 
class 
TblDownloadBigFile '
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
?

 
Path

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

string 
? 
FileName 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
? 
FileExt 
{ 
get  
;  !
set" %
;% &
}' (
public 

int 
? 
StatusDownload 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
? 
CreatedTime  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
? 
CreatedById 
{ 
get !
;! "
set# &
;& '
}( )
} ®±
QD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\MasterRoleController.cs
	namespace		 	
DashboardDevaBNI		
 
.		 
Controllers		 &
{

 
public 

class  
MasterRoleController %
:& '

Controller( 2
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public  
MasterRoleController #
(# $
IConfiguration$ 2
config3 9
,9 :%
DbDashboardDevaBniContext; T
contextU \
,\ ] 
IHttpContextAccessor^ r
accessors {
){ |
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
	GetConfig1 :
.: ;

AppSetting; E
[E F
$strF n
]n o
+p q
$strr y
,y z
new{ ~
{	 Ä
a
Å Ç
=
É Ñ
true
Ö â
}
ä ã
)
ã å
;
å ç
} 
var 
location 
= 
new 
Uri "
(" #
$"# %
{% &
Request& -
.- .
Scheme. 4
}4 5
$str5 8
{8 9
Request9 @
.@ A
HostA E
}E F
{F G
RequestG N
.N O
PathO S
}S T
"T U
)U V
;V W
string   
Path   
=   
location   "
.  " #
AbsolutePath  # /
;  / 0
if!! 
(!! 
!!! 
accessSecurity!! 
.!!  
IsGetAccess!!  +
(!!+ ,
$str!!, 0
+!!1 2
Path!!3 7
)!!7 8
)!!8 9
{"" 
return## 
RedirectToAction## '
(##' (
$str##( 3
,##3 4
	GetConfig##5 >
.##> ?

AppSetting##? I
[##I J
$str##J r
]##r s
+##t u
$str##v }
)##} ~
;##~ 
}$$ 
ViewBag&& 
.&& 
CurrentPath&& 
=&&  !
Path&&" &
;&&& '
ViewBag'' 
.'' 

Pengumuman'' 
=''  
_context''! )
.'') *%
TblMasterSystemParameters''* C
.''C D
Where''D I
(''I J
x''J K
=>''L N
x''O P
.''P Q
Key''Q T
==''U W
$str''X d
)''d e
.''e f
Select''f l
(''l m
x''m n
=>''o q
x''r s
.''s t
Value''t y
)''y z
.''z {
FirstOrDefault	''{ â
(
''â ä
)
''ä ã
;
''ã å
ViewBag(( 
.(( 
Speed(( 
=(( 
int(( 
.((  
Parse((  %
(((% &
_context((& .
.((. /%
TblMasterSystemParameters((/ H
.((H I
Where((I N
(((N O
x((O P
=>((Q S
x((T U
.((U V
Key((V Y
==((Z \
$str((] d
)((d e
.((e f
Select((f l
(((l m
x((m n
=>((o q
x((r s
.((s t
Value((t y
)((y z
.((z {
FirstOrDefault	(({ â
(
((â ä
)
((ä ã
)
((ã å
;
((å ç
return)) 
View)) 
()) 
))) 
;)) 
}** 	
[-- 	
HttpPost--	 
]-- 
public.. 
IActionResult.. 
LoadData.. %
(..% &
)..& '
{// 	
if00 
(00 
!00 
lastSession00 
.00 
Update00 #
(00# $
)00$ %
)00% &
{11 
return22 
RedirectToAction22 '
(22' (
$str22( /
,22/ 0
	GetConfig221 :
.22: ;

AppSetting22; E
[22E F
$str22F n
]22n o
+22p q
$str22r y
,22y z
new22{ ~
{	22 Ä
a
22Å Ç
=
22É Ñ
true
22Ö â
}
22ä ã
)
22ã å
;
22å ç
}33 
var44 
location44 
=44 
new44 
Uri44 "
(44" #
$"44# %
{44% &
Request44& -
.44- .
Scheme44. 4
}444 5
$str445 8
{448 9
Request449 @
.44@ A
Host44A E
}44E F
{44F G
Request44G N
.44N O
Path44O S
}44S T
"44T U
)44U V
;44V W
string55 
Path55 
=55 
location55 "
.55" #
AbsolutePath55# /
.55/ 0
Replace550 7
(557 8
this558 <
.55< =
ControllerContext55= N
.55N O
	RouteData55O X
.55X Y
Values55Y _
[55_ `
$str55` h
]55h i
.55i j
ToString55j r
(55r s
)55s t
,55t u
$str55v }
)55} ~
;55~ 
if66 
(66 
!66 
accessSecurity66 
.66  
IsGetAccess66  +
(66+ ,
$str66, 0
+661 2
Path663 7
)667 8
)668 9
{77 
return88 
RedirectToAction88 '
(88' (
$str88( 3
,883 4
$str885 <
)88< =
;88= >
}99 
try;; 
{<< 
var== 
dict== 
=== 
Request== "
.==" #
Form==# '
.==' (
ToDictionary==( 4
(==4 5
x==5 6
=>==7 9
x==: ;
.==; <
Key==< ?
,==? @
x==A B
=>==C E
x==F G
.==G H
Value==H M
.==M N
ToString==N V
(==V W
)==W X
)==X Y
;==Y Z
var?? 
draw?? 
=?? 
dict?? 
[??  
$str??  &
]??& '
;??' (
varBB 
startBB 
=BB 
dictBB  
[BB  !
$strBB! (
]BB( )
;BB) *
varCC 
lengthCC 
=CC 
dictCC !
[CC! "
$strCC" *
]CC* +
;CC+ ,
varGG 

pageNumberGG 
=GG  
(GG! "
intGG" %
.GG% &
ParseGG& +
(GG+ ,
startGG, 1
)GG1 2
/GG3 4
intGG5 8
.GG8 9
ParseGG9 >
(GG> ?
lengthGG? E
)GGE F
)GGF G
+GGH I
$numGGJ K
;GGK L
varJJ 

sortColumnJJ 
=JJ  
dictJJ! %
[JJ% &
$strJJ& 0
+JJ1 2
dictJJ3 7
[JJ7 8
$strJJ8 J
]JJJ K
+JJL M
$strJJN W
]JJW X
;JJX Y
varKK 
sortColumnDirKK !
=KK" #
dictKK$ (
[KK( )
$strKK) 8
]KK8 9
;KK9 :
varLL 
NameSearchParamLL #
=LL$ %
dictLL& *
[LL* +
$strLL+ F
]LLF G
;LLG H
varMM !
NoRekeningSearchParamMM )
=MM* +
dictMM, 0
[MM0 1
$strMM1 L
]MML M
;MMM N
intQQ 
pageSizeQQ 
=QQ 
lengthQQ %
!=QQ& (
nullQQ) -
?QQ. /
ConvertQQ0 7
.QQ7 8
ToInt32QQ8 ?
(QQ? @
lengthQQ@ F
)QQF G
:QQH I
$numQQJ K
;QQK L
intRR 
skipRR 
=RR 
startRR  
!=RR! #
nullRR$ (
?RR) *
ConvertRR+ 2
.RR2 3
ToInt32RR3 :
(RR: ;
startRR; @
)RR@ A
:RRB C
$numRRD E
;RRE F
intSS 
recordsTotalSS  
=SS! "
$numSS# $
;SS$ %
ListTT 
<TT  
MasterRole_ViewModelTT )
>TT) *
listTT+ /
=TT0 1
newTT2 5
ListTT6 :
<TT: ; 
MasterRole_ViewModelTT; O
>TTO P
(TTP Q
)TTQ R
;TTR S
listVV 
=VV #
StoredProcedureExecutorVV .
.VV. /
ExecuteSPListVV/ <
<VV< = 
MasterRole_ViewModelVV= Q
>VVQ R
(VVR S
_contextVVS [
,VV[ \
$strVV] v
,VVv w
newVVx {
SqlParameter	VV| à
[
VVà â
]
VVâ ä
{
VVä ã
newWW 
SqlParameterWW (
(WW( )
$strWW) 0
,WW0 1
NameSearchParamWW2 A
)WWA B
,WWB C
newXX 
SqlParameterXX (
(XX( )
$strXX) 0
,XX0 1!
NoRekeningSearchParamXX2 G
)XXG H
,XXH I
newYY 
SqlParameterYY (
(YY( )
$strYY) 6
,YY6 7

sortColumnYY8 B
)YYB C
,YYC D
newZZ 
SqlParameterZZ (
(ZZ( )
$strZZ) 9
,ZZ9 :
sortColumnDirZZ; H
)ZZH I
,ZZI J
new[[ 
SqlParameter[[ (
([[( )
$str[[) 6
,[[6 7

pageNumber[[8 B
)[[B C
,[[C D
new\\ 
SqlParameter\\ (
(\\( )
$str\\) 4
,\\4 5
pageSize\\6 >
)\\> ?
}\\? @
)\\@ A
;\\A B
recordsTotal^^ 
=^^ #
StoredProcedureExecutor^^ 6
.^^6 7
ExecuteScalarInt^^7 G
(^^G H
_context^^H P
,^^P Q
$str^^R l
,^^l m
new^^n q
SqlParameter^^r ~
[^^~ 
]	^^ Ä
{
^^Ä Å
new__ 
SqlParameter__ (
(__( )
$str__) 0
,__0 1
NameSearchParam__2 A
)__A B
,__B C
new`` 
SqlParameter`` (
(``( )
$str``) 0
,``0 1!
NoRekeningSearchParam``2 G
)``G H
,``H I
}aa 
)aa 
;aa 
ifcc 
(cc 
listcc 
==cc 
nullcc  
)cc  !
{dd 
listee 
=ee 
newee 
Listee #
<ee# $ 
MasterRole_ViewModelee$ 8
>ee8 9
(ee9 :
)ee: ;
;ee; <
recordsTotalff  
=ff! "
$numff# $
;ff$ %
}gg 
returnii 
Jsonii 
(ii 
newii 
{ii  !
drawii" &
=ii' (
drawii) -
,ii- .
recordsFilteredii/ >
=ii? @
recordsTotaliiA M
,iiM N
recordsTotaliiO [
=ii\ ]
recordsTotalii^ j
,iij k
dataiil p
=iiq r
listiis w
}iix y
)iiy z
;iiz {
}jj 
catchkk 
(kk 
	Exceptionkk 
Exkk 
)kk  
{ll 
throwmm 
;mm 
}nn 
}oo 	
publicss 
ActionResultss 
Createss "
(ss" #
)ss# $
{tt 	
ifuu 
(uu 
!uu 
lastSessionuu 
.uu 
Updateuu #
(uu# $
)uu$ %
)uu% &
{vv 
returnww 
RedirectToActionww '
(ww' (
$strww( /
,ww/ 0
	GetConfigww1 :
.ww: ;

AppSettingww; E
[wwE F
$strwwF n
]wwn o
+wwp q
$strwwr y
,wwy z
newww{ ~
{	ww Ä
a
wwÅ Ç
=
wwÉ Ñ
true
wwÖ â
}
wwä ã
)
wwã å
;
wwå ç
}xx 
varyy 
locationyy 
=yy 
newyy 
Uriyy "
(yy" #
$"yy# %
{yy% &
Requestyy& -
.yy- .
Schemeyy. 4
}yy4 5
$stryy5 8
{yy8 9
Requestyy9 @
.yy@ A
HostyyA E
}yyE F
{yyF G
RequestyyG N
.yyN O
PathyyO S
}yyS T
"yyT U
)yyU V
;yyV W
stringzz 
Pathzz 
=zz 
locationzz "
.zz" #
AbsolutePathzz# /
.zz/ 0
Replacezz0 7
(zz7 8
thiszz8 <
.zz< =
ControllerContextzz= N
.zzN O
	RouteDatazzO X
.zzX Y
ValueszzY _
[zz_ `
$strzz` h
]zzh i
.zzi j
ToStringzzj r
(zzr s
)zzs t
,zzt u
$strzzv }
)zz} ~
;zz~ 
if{{ 
({{ 
!{{ 
accessSecurity{{ 
.{{  
IsGetAccess{{  +
({{+ ,
$str{{, 0
+{{1 2
Path{{3 7
){{7 8
){{8 9
{|| 
return}} 
RedirectToAction}} '
(}}' (
$str}}( 3
,}}3 4
$str}}5 <
)}}< =
;}}= >
}~~ 
return 
PartialView 
( 
$str (
)( )
;) *
}
ÄÄ 	
[
ÉÉ 	&
ValidateAntiForgeryToken
ÉÉ	 !
]
ÉÉ! "
[
ÑÑ 	
HttpPost
ÑÑ	 
]
ÑÑ 
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
ActionResult
ÖÖ &
>
ÖÖ& '
SubmitCreate
ÖÖ( 4
(
ÖÖ4 5
TblMasterRole
ÖÖ5 B
model
ÖÖC H
)
ÖÖH I
{
ÜÜ 	
if
áá 
(
áá 
!
áá 
lastSession
áá 
.
áá 
Update
áá #
(
áá# $
)
áá$ %
)
áá% &
{
àà 
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( /
,
ââ/ 0
	GetConfig
ââ1 :
.
ââ: ;

AppSetting
ââ; E
[
ââE F
$str
ââF n
]
âân o
+
ââp q
$str
ââr y
,
âây z
new
ââ{ ~
{ââ Ä
aââÅ Ç
=ââÉ Ñ
trueââÖ â
}ââä ã
)ââã å
;ââå ç
}
ää 
var
ãã 
location
ãã 
=
ãã 
new
ãã 
Uri
ãã "
(
ãã" #
$"
ãã# %
{
ãã% &
Request
ãã& -
.
ãã- .
Scheme
ãã. 4
}
ãã4 5
$str
ãã5 8
{
ãã8 9
Request
ãã9 @
.
ãã@ A
Host
ããA E
}
ããE F
{
ããF G
Request
ããG N
.
ããN O
Path
ããO S
}
ããS T
"
ããT U
)
ããU V
;
ããV W
string
åå 
Path
åå 
=
åå 
location
åå "
.
åå" #
AbsolutePath
åå# /
.
åå/ 0
Replace
åå0 7
(
åå7 8
this
åå8 <
.
åå< =
ControllerContext
åå= N
.
ååN O
	RouteData
ååO X
.
ååX Y
Values
ååY _
[
åå_ `
$str
åå` h
]
ååh i
.
ååi j
ToString
ååj r
(
åår s
)
åås t
,
ååt u
$str
ååv }
)
åå} ~
;
åå~ 
if
çç 
(
çç 
!
çç 
accessSecurity
çç 
.
çç  
IsGetAccess
çç  +
(
çç+ ,
$str
çç, 0
+
çç1 2
Path
çç3 7
)
çç7 8
)
çç8 9
{
éé 
return
èè 
RedirectToAction
èè '
(
èè' (
$str
èè( 3
,
èè3 4
$str
èè5 <
)
èè< =
;
èè= >
}
êê 
try
íí 
{
ìì 
var
îî 
regex
îî 
=
îî 
await
îî !
RegexRequest
îî" .
.
îî. /
RegexValidation
îî/ >
(
îî> ?
model
îî? D
)
îîD E
;
îîE F
if
ïï 
(
ïï 
!
ïï 
regex
ïï 
)
ïï 
{
ññ 
return
óó 
Content
óó "
(
óó" #
$str
óó# 1
)
óó1 2
;
óó2 3
}
òò 
TblMasterRole
ôô 
dataKode
ôô &
=
ôô' (
_context
ôô) 1
.
ôô1 2
TblMasterRoles
ôô2 @
.
ôô@ A
Where
ôôA F
(
ôôF G
m
ôôG H
=>
ôôI K
m
ôôL M
.
ôôM N
Kode
ôôN R
==
ôôS U
model
ôôV [
.
ôô[ \
Kode
ôô\ `
&&
ôôa c
m
ôôd e
.
ôôe f
	IsDeleted
ôôf o
!=
ôôp r
true
ôôs w
)
ôôw x
.
ôôx y
FirstOrDefaultôôy á
(ôôá à
)ôôà â
;ôôâ ä
if
öö 
(
öö 
dataKode
öö 
!=
öö 
null
öö  $
)
öö$ %
{
õõ 
return
úú 
Content
úú "
(
úú" #
$str
úú# ?
+
úú@ A
dataKode
úúB J
.
úúJ K
Name
úúK O
)
úúO P
;
úúP Q
}
ùù 
using
üü 
(
üü 
TransactionScope
üü '
trx
üü( +
=
üü, -
new
üü. 1
TransactionScope
üü2 B
(
üüB C
)
üüC D
)
üüD E
{
†† 
model
°° 
.
°° 
	IsDeleted
°° #
=
°°$ %
false
°°& +
;
°°+ ,
model
¢¢ 
.
¢¢ 
CreatedById
¢¢ %
=
¢¢& '
int
¢¢( +
.
¢¢+ ,
Parse
¢¢, 1
(
¢¢1 2
HttpContext
¢¢2 =
.
¢¢= >
Session
¢¢> E
.
¢¢E F
	GetString
¢¢F O
(
¢¢O P
SessionConstan
¢¢P ^
.
¢¢^ _
Session_UserId
¢¢_ m
)
¢¢m n
)
¢¢n o
;
¢¢o p
model
££ 
.
££ 
CreatedTime
££ %
=
££& '
DateTime
££( 0
.
££0 1
Now
££1 4
;
££4 5
_context
§§ 
.
§§ 
TblMasterRoles
§§ +
.
§§+ ,
Add
§§, /
(
§§/ 0
model
§§0 5
)
§§5 6
;
§§6 7
_context
•• 
.
•• 
SaveChanges
•• (
(
••( )
)
••) *
;
••* +
trx
ßß 
.
ßß 
Complete
ßß  
(
ßß  !
)
ßß! "
;
ßß" #
}
®® 
return
™™ 
Content
™™ 
(
™™ 
$str
™™ !
)
™™! "
;
™™" #
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
Ex
≠≠ 
)
≠≠  
{
ÆÆ 
return
ØØ 
Content
ØØ 
(
ØØ 
	GetConfig
ØØ (
.
ØØ( )

AppSetting
ØØ) 3
[
ØØ3 4
$str
ØØ4 M
]
ØØM N
)
ØØN O
;
ØØO P
}
∞∞ 
}
±± 	
public
µµ 
ActionResult
µµ 
Edit
µµ  
(
µµ  !
int
µµ! $
id
µµ% '
)
µµ' (
{
∂∂ 	
if
∑∑ 
(
∑∑ 
!
∑∑ 
lastSession
∑∑ 
.
∑∑ 
Update
∑∑ #
(
∑∑# $
)
∑∑$ %
)
∑∑% &
{
∏∏ 
return
ππ 
RedirectToAction
ππ '
(
ππ' (
$str
ππ( /
,
ππ/ 0
	GetConfig
ππ1 :
.
ππ: ;

AppSetting
ππ; E
[
ππE F
$str
ππF n
]
ππn o
+
ππp q
$str
ππr y
,
ππy z
new
ππ{ ~
{ππ Ä
aππÅ Ç
=ππÉ Ñ
trueππÖ â
}ππä ã
)ππã å
;ππå ç
}
∫∫ 
var
ªª 
location
ªª 
=
ªª 
new
ªª 
Uri
ªª "
(
ªª" #
$"
ªª# %
{
ªª% &
Request
ªª& -
.
ªª- .
Scheme
ªª. 4
}
ªª4 5
$str
ªª5 8
{
ªª8 9
Request
ªª9 @
.
ªª@ A
Host
ªªA E
}
ªªE F
{
ªªF G
Request
ªªG N
.
ªªN O
Path
ªªO S
}
ªªS T
"
ªªT U
)
ªªU V
;
ªªV W
string
ºº 
Path
ºº 
=
ºº 
location
ºº "
.
ºº" #
AbsolutePath
ºº# /
.
ºº/ 0
Replace
ºº0 7
(
ºº7 8
this
ºº8 <
.
ºº< =
ControllerContext
ºº= N
.
ººN O
	RouteData
ººO X
.
ººX Y
Values
ººY _
[
ºº_ `
$str
ºº` h
]
ººh i
.
ººi j
ToString
ººj r
(
ººr s
)
ººs t
,
ººt u
$str
ººv }
)
ºº} ~
;
ºº~ 
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 
accessSecurity
ΩΩ 
.
ΩΩ  
IsGetAccess
ΩΩ  +
(
ΩΩ+ ,
$str
ΩΩ, 0
+
ΩΩ1 2
Path
ΩΩ3 7
)
ΩΩ7 8
)
ΩΩ8 9
{
ææ 
return
øø 
RedirectToAction
øø '
(
øø' (
$str
øø( 3
,
øø3 4
$str
øø5 <
)
øø< =
;
øø= >
}
¿¿ 
TblMasterRole
¬¬ 
data
¬¬ 
=
¬¬  
_context
¬¬! )
.
¬¬) *
TblMasterRoles
¬¬* 8
.
¬¬8 9
Where
¬¬9 >
(
¬¬> ?
m
¬¬? @
=>
¬¬A C
m
¬¬D E
.
¬¬E F
Id
¬¬F H
==
¬¬I K
id
¬¬L N
)
¬¬N O
.
¬¬O P
FirstOrDefault
¬¬P ^
(
¬¬^ _
)
¬¬_ `
;
¬¬` a
if
√√ 
(
√√ 
data
√√ 
==
√√ 
null
√√ 
)
√√ 
{
ƒƒ 
data
≈≈ 
=
≈≈ 
new
≈≈ 
TblMasterRole
≈≈ (
(
≈≈( )
)
≈≈) *
;
≈≈* +
}
∆∆ 
return
»» 
PartialView
»» 
(
»» 
$str
»» &
,
»»& '
data
»»( ,
)
»», -
;
»»- .
}
…… 	
[
ÀÀ 	&
ValidateAntiForgeryToken
ÀÀ	 !
]
ÀÀ! "
[
ÃÃ 	
HttpPost
ÃÃ	 
]
ÃÃ 
public
ÕÕ 
async
ÕÕ 
Task
ÕÕ 
<
ÕÕ 
ActionResult
ÕÕ &
>
ÕÕ& '

SubmitEdit
ÕÕ( 2
(
ÕÕ2 3
TblMasterRole
ÕÕ3 @
model
ÕÕA F
)
ÕÕF G
{
ŒŒ 	
if
œœ 
(
œœ 
!
œœ 
lastSession
œœ 
.
œœ 
Update
œœ #
(
œœ# $
)
œœ$ %
)
œœ% &
{
–– 
return
—— 
RedirectToAction
—— '
(
——' (
$str
——( /
,
——/ 0
	GetConfig
——1 :
.
——: ;

AppSetting
——; E
[
——E F
$str
——F n
]
——n o
+
——p q
$str
——r y
,
——y z
new
——{ ~
{—— Ä
a——Å Ç
=——É Ñ
true——Ö â
}——ä ã
)——ã å
;——å ç
}
““ 
var
”” 
location
”” 
=
”” 
new
”” 
Uri
”” "
(
””" #
$"
””# %
{
””% &
Request
””& -
.
””- .
Scheme
””. 4
}
””4 5
$str
””5 8
{
””8 9
Request
””9 @
.
””@ A
Host
””A E
}
””E F
{
””F G
Request
””G N
.
””N O
Path
””O S
}
””S T
"
””T U
)
””U V
;
””V W
string
‘‘ 
Path
‘‘ 
=
‘‘ 
location
‘‘ "
.
‘‘" #
AbsolutePath
‘‘# /
.
‘‘/ 0
Replace
‘‘0 7
(
‘‘7 8
this
‘‘8 <
.
‘‘< =
ControllerContext
‘‘= N
.
‘‘N O
	RouteData
‘‘O X
.
‘‘X Y
Values
‘‘Y _
[
‘‘_ `
$str
‘‘` h
]
‘‘h i
.
‘‘i j
ToString
‘‘j r
(
‘‘r s
)
‘‘s t
,
‘‘t u
$str
‘‘v }
)
‘‘} ~
;
‘‘~ 
if
’’ 
(
’’ 
!
’’ 
accessSecurity
’’ 
.
’’  
IsGetAccess
’’  +
(
’’+ ,
$str
’’, 0
+
’’1 2
Path
’’3 7
)
’’7 8
)
’’8 9
{
÷÷ 
return
◊◊ 
RedirectToAction
◊◊ '
(
◊◊' (
$str
◊◊( 3
,
◊◊3 4
$str
◊◊5 <
)
◊◊< =
;
◊◊= >
}
ÿÿ 
try
⁄⁄ 
{
€€ 
var
‹‹ 
regex
‹‹ 
=
‹‹ 
await
‹‹ !
RegexRequest
‹‹" .
.
‹‹. /
RegexValidation
‹‹/ >
(
‹‹> ?
model
‹‹? D
)
‹‹D E
;
‹‹E F
if
›› 
(
›› 
!
›› 
regex
›› 
)
›› 
{
ﬁﬁ 
return
ﬂﬂ 
Content
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# 1
)
ﬂﬂ1 2
;
ﬂﬂ2 3
}
‡‡ 
using
‚‚ 
(
‚‚ 
TransactionScope
‚‚ '
trx
‚‚( +
=
‚‚, -
new
‚‚. 1
TransactionScope
‚‚2 B
(
‚‚B C
)
‚‚C D
)
‚‚D E
{
„„ 
TblMasterRole
‰‰ !
data
‰‰" &
=
‰‰' (
_context
‰‰) 1
.
‰‰1 2
TblMasterRoles
‰‰2 @
.
‰‰@ A
Where
‰‰A F
(
‰‰F G
m
‰‰G H
=>
‰‰I K
m
‰‰L M
.
‰‰M N
Id
‰‰N P
==
‰‰Q S
model
‰‰T Y
.
‰‰Y Z
Id
‰‰Z \
)
‰‰\ ]
.
‰‰] ^
FirstOrDefault
‰‰^ l
(
‰‰l m
)
‰‰m n
;
‰‰n o
if
ÂÂ 
(
ÂÂ 
data
ÂÂ 
.
ÂÂ 
Kode
ÂÂ !
!=
ÂÂ" $
model
ÂÂ% *
.
ÂÂ* +
Kode
ÂÂ+ /
)
ÂÂ/ 0
{
ÊÊ 
TblMasterRole
ÁÁ %
dataKode
ÁÁ& .
=
ÁÁ/ 0
_context
ÁÁ1 9
.
ÁÁ9 :
TblMasterRoles
ÁÁ: H
.
ÁÁH I
Where
ÁÁI N
(
ÁÁN O
m
ÁÁO P
=>
ÁÁQ S
m
ÁÁT U
.
ÁÁU V
Kode
ÁÁV Z
==
ÁÁ[ ]
model
ÁÁ^ c
.
ÁÁc d
Kode
ÁÁd h
&&
ÁÁi k
m
ÁÁl m
.
ÁÁm n
	IsDeleted
ÁÁn w
!=
ÁÁx z
true
ÁÁ{ 
)ÁÁ Ä
.ÁÁÄ Å
FirstOrDefaultÁÁÅ è
(ÁÁè ê
)ÁÁê ë
;ÁÁë í
if
ËË 
(
ËË 
dataKode
ËË $
!=
ËË% '
null
ËË( ,
)
ËË, -
{
ÈÈ 
return
ÍÍ "
Content
ÍÍ# *
(
ÍÍ* +
$str
ÍÍ+ G
+
ÍÍH I
dataKode
ÍÍJ R
.
ÍÍR S
Name
ÍÍS W
)
ÍÍW X
;
ÍÍX Y
}
ÎÎ 
}
ÏÏ 
data
ÌÌ 
.
ÌÌ 
Name
ÌÌ 
=
ÌÌ 
model
ÌÌ  %
.
ÌÌ% &
Name
ÌÌ& *
;
ÌÌ* +
data
ÓÓ 
.
ÓÓ 
Kode
ÓÓ 
=
ÓÓ 
model
ÓÓ  %
.
ÓÓ% &
Kode
ÓÓ& *
;
ÓÓ* +
data
ÔÔ 
.
ÔÔ 
Description
ÔÔ $
=
ÔÔ% &
model
ÔÔ' ,
.
ÔÔ, -
Description
ÔÔ- 8
;
ÔÔ8 9
data
 
.
 
IsActive
 !
=
" #
model
$ )
.
) *
IsActive
* 2
;
2 3
data
ÒÒ 
.
ÒÒ 
UpdatedById
ÒÒ $
=
ÒÒ% &
int
ÒÒ' *
.
ÒÒ* +
Parse
ÒÒ+ 0
(
ÒÒ0 1
HttpContext
ÒÒ1 <
.
ÒÒ< =
Session
ÒÒ= D
.
ÒÒD E
	GetString
ÒÒE N
(
ÒÒN O
SessionConstan
ÒÒO ]
.
ÒÒ] ^
Session_UserId
ÒÒ^ l
)
ÒÒl m
)
ÒÒm n
;
ÒÒn o
data
ÚÚ 
.
ÚÚ 
UpdatedTime
ÚÚ $
=
ÚÚ% &
DateTime
ÚÚ' /
.
ÚÚ/ 0
Now
ÚÚ0 3
;
ÚÚ3 4
_context
ÛÛ 
.
ÛÛ 
Entry
ÛÛ "
(
ÛÛ" #
data
ÛÛ# '
)
ÛÛ' (
.
ÛÛ( )
State
ÛÛ) .
=
ÛÛ/ 0
EntityState
ÛÛ1 <
.
ÛÛ< =
Modified
ÛÛ= E
;
ÛÛE F
_context
ÙÙ 
.
ÙÙ 
SaveChanges
ÙÙ (
(
ÙÙ( )
)
ÙÙ) *
;
ÙÙ* +
trx
ˆˆ 
.
ˆˆ 
Complete
ˆˆ  
(
ˆˆ  !
)
ˆˆ! "
;
ˆˆ" #
}
¯¯ 
return
˘˘ 
Content
˘˘ 
(
˘˘ 
$str
˘˘ !
)
˘˘! "
;
˘˘" #
}
˚˚ 
catch
¸¸ 
{
˝˝ 
return
˛˛ 
Content
˛˛ 
(
˛˛ 
	GetConfig
˛˛ (
.
˛˛( )

AppSetting
˛˛) 3
[
˛˛3 4
$str
˛˛4 M
]
˛˛M N
)
˛˛N O
;
˛˛O P
}
ˇˇ 
}
ÄÄ 	
public
ÑÑ 
ActionResult
ÑÑ 
View
ÑÑ  
(
ÑÑ  !
int
ÑÑ! $
id
ÑÑ% '
)
ÑÑ' (
{
ÖÖ 	
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
lastSession
ÜÜ 
.
ÜÜ 
Update
ÜÜ #
(
ÜÜ# $
)
ÜÜ$ %
)
ÜÜ% &
{
áá 
return
àà 
RedirectToAction
àà '
(
àà' (
$str
àà( /
,
àà/ 0
	GetConfig
àà1 :
.
àà: ;

AppSetting
àà; E
[
ààE F
$str
ààF n
]
ààn o
+
ààp q
$str
ààr y
,
àày z
new
àà{ ~
{àà Ä
aààÅ Ç
=ààÉ Ñ
trueààÖ â
}ààä ã
)ààã å
;ààå ç
}
ââ 
var
ää 
location
ää 
=
ää 
new
ää 
Uri
ää "
(
ää" #
$"
ää# %
{
ää% &
Request
ää& -
.
ää- .
Scheme
ää. 4
}
ää4 5
$str
ää5 8
{
ää8 9
Request
ää9 @
.
ää@ A
Host
ääA E
}
ääE F
{
ääF G
Request
ääG N
.
ääN O
Path
ääO S
}
ääS T
"
ääT U
)
ääU V
;
ääV W
string
ãã 
Path
ãã 
=
ãã 
location
ãã "
.
ãã" #
AbsolutePath
ãã# /
.
ãã/ 0
Replace
ãã0 7
(
ãã7 8
this
ãã8 <
.
ãã< =
ControllerContext
ãã= N
.
ããN O
	RouteData
ããO X
.
ããX Y
Values
ããY _
[
ãã_ `
$str
ãã` h
]
ããh i
.
ããi j
ToString
ããj r
(
ããr s
)
ããs t
,
ããt u
$str
ããv }
)
ãã} ~
;
ãã~ 
if
åå 
(
åå 
!
åå 
accessSecurity
åå 
.
åå  
IsGetAccess
åå  +
(
åå+ ,
$str
åå, 0
+
åå1 2
Path
åå3 7
)
åå7 8
)
åå8 9
{
çç 
return
éé 
RedirectToAction
éé '
(
éé' (
$str
éé( 3
,
éé3 4
$str
éé5 <
)
éé< =
;
éé= >
}
èè 
TblMasterRole
ëë 
data
ëë 
=
ëë  
_context
ëë! )
.
ëë) *
TblMasterRoles
ëë* 8
.
ëë8 9
Where
ëë9 >
(
ëë> ?
m
ëë? @
=>
ëëA C
m
ëëD E
.
ëëE F
Id
ëëF H
==
ëëI K
id
ëëL N
)
ëëN O
.
ëëO P
FirstOrDefault
ëëP ^
(
ëë^ _
)
ëë_ `
;
ëë` a
if
íí 
(
íí 
data
íí 
==
íí 
null
íí 
)
íí 
{
ìì 
data
îî 
=
îî 
new
îî 
TblMasterRole
îî (
(
îî( )
)
îî) *
;
îî* +
}
ïï 
return
óó 
PartialView
óó 
(
óó 
$str
óó &
,
óó& '
data
óó( ,
)
óó, -
;
óó- .
}
òò 	
public
ùù 
ActionResult
ùù 
Delete
ùù "
(
ùù" #
string
ùù# )
Ids
ùù* -
)
ùù- .
{
ûû 	
if
üü 
(
üü 
!
üü 
lastSession
üü 
.
üü 
Update
üü #
(
üü# $
)
üü$ %
)
üü% &
{
†† 
return
°° 
RedirectToAction
°° '
(
°°' (
$str
°°( /
,
°°/ 0
	GetConfig
°°1 :
.
°°: ;

AppSetting
°°; E
[
°°E F
$str
°°F n
]
°°n o
+
°°p q
$str
°°r y
,
°°y z
new
°°{ ~
{°° Ä
a°°Å Ç
=°°É Ñ
true°°Ö â
}°°ä ã
)°°ã å
;°°å ç
}
¢¢ 
var
££ 
location
££ 
=
££ 
new
££ 
Uri
££ "
(
££" #
$"
££# %
{
££% &
Request
££& -
.
££- .
Scheme
££. 4
}
££4 5
$str
££5 8
{
££8 9
Request
££9 @
.
££@ A
Host
££A E
}
££E F
{
££F G
Request
££G N
.
££N O
Path
££O S
}
££S T
"
££T U
)
££U V
;
££V W
string
§§ 
Path
§§ 
=
§§ 
location
§§ "
.
§§" #
AbsolutePath
§§# /
.
§§/ 0
Replace
§§0 7
(
§§7 8
this
§§8 <
.
§§< =
ControllerContext
§§= N
.
§§N O
	RouteData
§§O X
.
§§X Y
Values
§§Y _
[
§§_ `
$str
§§` h
]
§§h i
.
§§i j
ToString
§§j r
(
§§r s
)
§§s t
,
§§t u
$str
§§v }
)
§§} ~
;
§§~ 
if
•• 
(
•• 
!
•• 
accessSecurity
•• 
.
••  
IsGetAccess
••  +
(
••+ ,
$str
••, 0
+
••1 2
Path
••3 7
)
••7 8
)
••8 9
{
¶¶ 
return
ßß 
RedirectToAction
ßß '
(
ßß' (
$str
ßß( 3
,
ßß3 4
$str
ßß5 <
)
ßß< =
;
ßß= >
}
®® 
try
™™ 
{
´´ 
long
¨¨ 
[
¨¨ 
]
¨¨ 
confirmedDeleteId
¨¨ (
=
¨¨) *
Ids
¨¨+ .
.
¨¨. /
Split
¨¨/ 4
(
¨¨4 5
$char
¨¨5 8
)
¨¨8 9
.
¨¨9 :
Select
¨¨: @
(
¨¨@ A
long
¨¨A E
.
¨¨E F
Parse
¨¨F K
)
¨¨K L
.
¨¨L M
ToArray
¨¨M T
(
¨¨T U
)
¨¨U V
;
¨¨V W
List
ÆÆ 
<
ÆÆ 
TblMasterRole
ÆÆ "
>
ÆÆ" #

Transaksis
ÆÆ$ .
=
ÆÆ/ 0
_context
ÆÆ1 9
.
ÆÆ9 :
TblMasterRoles
ÆÆ: H
.
ÆÆH I
Where
ÆÆI N
(
ÆÆN O
x
ÆÆO P
=>
ÆÆQ S
confirmedDeleteId
ÆÆT e
.
ÆÆe f
Contains
ÆÆf n
(
ÆÆn o
x
ÆÆo p
.
ÆÆp q
Id
ÆÆq s
)
ÆÆs t
)
ÆÆt u
.
ÆÆu v
ToList
ÆÆv |
(
ÆÆ| }
)
ÆÆ} ~
;
ÆÆ~ 
for
ØØ 
(
ØØ 
int
ØØ 
i
ØØ 
=
ØØ 
$num
ØØ 
;
ØØ 
i
ØØ  !
<
ØØ" #
confirmedDeleteId
ØØ$ 5
.
ØØ5 6
Length
ØØ6 <
;
ØØ< =
i
ØØ> ?
++
ØØ? A
)
ØØA B
{
∞∞ 
TblMasterRole
±± !
data
±±" &
=
±±' (
_context
±±) 1
.
±±1 2
TblMasterRoles
±±2 @
.
±±@ A
Find
±±A E
(
±±E F

Transaksis
±±F P
[
±±P Q
i
±±Q R
]
±±R S
.
±±S T
Id
±±T V
)
±±V W
;
±±W X
data
≤≤ 
.
≤≤ 
	IsDeleted
≤≤ "
=
≤≤# $
true
≤≤% )
;
≤≤) *
data
≥≥ 
.
≥≥ 
DeletedById
≥≥ $
=
≥≥% &
int
≥≥' *
.
≥≥* +
Parse
≥≥+ 0
(
≥≥0 1
HttpContext
≥≥1 <
.
≥≥< =
Session
≥≥= D
.
≥≥D E
	GetString
≥≥E N
(
≥≥N O
SessionConstan
≥≥O ]
.
≥≥] ^
Session_UserId
≥≥^ l
)
≥≥l m
)
≥≥m n
;
≥≥n o
;
≥≥p q
data
¥¥ 
.
¥¥ 
DeletedTime
¥¥ $
=
¥¥% &
DateTime
¥¥' /
.
¥¥/ 0
Now
¥¥0 3
;
¥¥3 4
_context
µµ 
.
µµ 
Entry
µµ "
(
µµ" #
data
µµ# '
)
µµ' (
.
µµ( )
State
µµ) .
=
µµ/ 0
EntityState
µµ1 <
.
µµ< =
Modified
µµ= E
;
µµE F
_context
∂∂ 
.
∂∂ 
SaveChanges
∂∂ (
(
∂∂( )
)
∂∂) *
;
∂∂* +
}
∑∑ 
return
∏∏ 
Content
∏∏ 
(
∏∏ 
$str
∏∏ !
)
∏∏! "
;
∏∏" #
}
ππ 
catch
∫∫ 
{
ªª 
return
ºº 
Content
ºº 
(
ºº 
$str
ºº &
)
ºº& '
;
ºº' (
}
ΩΩ 
}
ææ 	
}
¿¿ 
}¡¡ ∂¶
QD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\MasterMenuController.cs
	namespace

 	
DashboardDevaBNI


 
.

 
Controllers

 &
{ 
public 

class  
MasterMenuController %
:& '

Controller( 2
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public  
MasterMenuController #
(# $
IConfiguration$ 2
config3 9
,9 :%
DbDashboardDevaBniContext; T
contextU \
,\ ] 
IHttpContextAccessor^ r
accessors {
){ |
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
	GetConfig1 :
.: ;

AppSetting; E
[E F
$strF n
]n o
+p q
$strr y
,y z
new{ ~
{	 Ä
a
Å Ç
=
É Ñ
true
Ö â
}
ä ã
)
ã å
;
å ç
} 
var   
location   
=   
new   
Uri   "
(  " #
$"  # %
{  % &
Request  & -
.  - .
Scheme  . 4
}  4 5
$str  5 8
{  8 9
Request  9 @
.  @ A
Host  A E
}  E F
{  F G
Request  G N
.  N O
Path  O S
}  S T
"  T U
)  U V
;  V W
string!! 
Path!! 
=!! 
location!! "
.!!" #
AbsolutePath!!# /
;!!/ 0
if"" 
("" 
!"" 
accessSecurity"" 
.""  
IsGetAccess""  +
(""+ ,
$str"", 0
+""1 2
Path""3 7
)""7 8
)""8 9
{## 
return$$ 
RedirectToAction$$ '
($$' (
$str$$( 3
,$$3 4
	GetConfig$$5 >
.$$> ?

AppSetting$$? I
[$$I J
$str$$J r
]$$r s
+$$t u
$str$$v }
)$$} ~
;$$~ 
}%% 
ViewBag'' 
.'' 
CurrentPath'' 
=''  !
Path''" &
;''& '
ViewBag(( 
.(( 

Pengumuman(( 
=((  
_context((! )
.(() *%
TblMasterSystemParameters((* C
.((C D
Where((D I
(((I J
x((J K
=>((L N
x((O P
.((P Q
Key((Q T
==((U W
$str((X d
)((d e
.((e f
Select((f l
(((l m
x((m n
=>((o q
x((r s
.((s t
Value((t y
)((y z
.((z {
FirstOrDefault	(({ â
(
((â ä
)
((ä ã
;
((ã å
ViewBag)) 
.)) 
Speed)) 
=)) 
int)) 
.))  
Parse))  %
())% &
_context))& .
.)). /%
TblMasterSystemParameters))/ H
.))H I
Where))I N
())N O
x))O P
=>))Q S
x))T U
.))U V
Key))V Y
==))Z \
$str))] d
)))d e
.))e f
Select))f l
())l m
x))m n
=>))o q
x))r s
.))s t
Value))t y
)))y z
.))z {
FirstOrDefault	)){ â
(
))â ä
)
))ä ã
)
))ã å
;
))å ç
return** 
View** 
(** 
)** 
;** 
}++ 	
[.. 	
HttpPost..	 
].. 
public// 
IActionResult// 
LoadData// %
(//% &
)//& '
{00 	
if11 
(11 
!11 
lastSession11 
.11 
Update11 #
(11# $
)11$ %
)11% &
{22 
return33 
RedirectToAction33 '
(33' (
$str33( /
,33/ 0
	GetConfig331 :
.33: ;

AppSetting33; E
[33E F
$str33F n
]33n o
+33p q
$str33r y
,33y z
new33{ ~
{	33 Ä
a
33Å Ç
=
33É Ñ
true
33Ö â
}
33ä ã
)
33ã å
;
33å ç
}44 
var55 
location55 
=55 
new55 
Uri55 "
(55" #
$"55# %
{55% &
Request55& -
.55- .
Scheme55. 4
}554 5
$str555 8
{558 9
Request559 @
.55@ A
Host55A E
}55E F
{55F G
Request55G N
.55N O
Path55O S
}55S T
"55T U
)55U V
;55V W
string66 
Path66 
=66 
location66 "
.66" #
AbsolutePath66# /
.66/ 0
Replace660 7
(667 8
this668 <
.66< =
ControllerContext66= N
.66N O
	RouteData66O X
.66X Y
Values66Y _
[66_ `
$str66` h
]66h i
.66i j
ToString66j r
(66r s
)66s t
,66t u
$str66v }
)66} ~
;66~ 
if77 
(77 
!77 
accessSecurity77 
.77  
IsGetAccess77  +
(77+ ,
$str77, 0
+771 2
Path773 7
)777 8
)778 9
{88 
return99 
RedirectToAction99 '
(99' (
$str99( 3
,993 4
$str995 <
)99< =
;99= >
}:: 
try<< 
{== 
var>> 
dict>> 
=>> 
Request>> "
.>>" #
Form>># '
.>>' (
ToDictionary>>( 4
(>>4 5
x>>5 6
=>>>7 9
x>>: ;
.>>; <
Key>>< ?
,>>? @
x>>A B
=>>>C E
x>>F G
.>>G H
Value>>H M
.>>M N
ToString>>N V
(>>V W
)>>W X
)>>X Y
;>>Y Z
var@@ 
draw@@ 
=@@ 
dict@@ 
[@@  
$str@@  &
]@@& '
;@@' (
varCC 
startCC 
=CC 
dictCC  
[CC  !
$strCC! (
]CC( )
;CC) *
varDD 
lengthDD 
=DD 
dictDD !
[DD! "
$strDD" *
]DD* +
;DD+ ,
varHH 

pageNumberHH 
=HH  
(HH! "
intHH" %
.HH% &
ParseHH& +
(HH+ ,
startHH, 1
)HH1 2
/HH3 4
intHH5 8
.HH8 9
ParseHH9 >
(HH> ?
lengthHH? E
)HHE F
)HHF G
+HHH I
$numHHJ K
;HHK L
varKK 

sortColumnKK 
=KK  
dictKK! %
[KK% &
$strKK& 0
+KK1 2
dictKK3 7
[KK7 8
$strKK8 J
]KKJ K
+KKL M
$strKKN W
]KKW X
;KKX Y
varLL 
sortColumnDirLL !
=LL" #
dictLL$ (
[LL( )
$strLL) 8
]LL8 9
;LL9 :
varMM 
NamaSearchParamMM #
=MM$ %
dictMM& *
[MM* +
$strMM+ F
]MMF G
;MMG H
intPP 
pageSizePP 
=PP 
lengthPP %
!=PP& (
nullPP) -
?PP. /
ConvertPP0 7
.PP7 8
ToInt32PP8 ?
(PP? @
lengthPP@ F
)PPF G
:PPH I
$numPPJ K
;PPK L
intQQ 
skipQQ 
=QQ 
startQQ  
!=QQ! #
nullQQ$ (
?QQ) *
ConvertQQ+ 2
.QQ2 3
ToInt32QQ3 :
(QQ: ;
startQQ; @
)QQ@ A
:QQB C
$numQQD E
;QQE F
intRR 
recordsTotalRR  
=RR! "
$numRR# $
;RR$ %
ListSS 
<SS  
MasterMenu_ViewModelSS )
>SS) *
listSS+ /
=SS0 1
newSS2 5
ListSS6 :
<SS: ; 
MasterMenu_ViewModelSS; O
>SSO P
(SSP Q
)SSQ R
;SSR S
listUU 
=UU #
StoredProcedureExecutorUU .
.UU. /
ExecuteSPListUU/ <
<UU< = 
MasterMenu_ViewModelUU= Q
>UUQ R
(UUR S
_contextUUS [
,UU[ \
$strUU] |
,UU| }
new	UU~ Å
SqlParameter
UUÇ é
[
UUé è
]
UUè ê
{
UUê ë
newVV 
SqlParameterVV (
(VV( )
$strVV) 0
,VV0 1
NamaSearchParamVV2 A
)VVA B
,VVB C
newWW 
SqlParameterWW (
(WW( )
$strWW) 0
,WW0 1
$strWW2 4
)WW4 5
,WW5 6
newXX 
SqlParameterXX (
(XX( )
$strXX) 6
,XX6 7

sortColumnXX8 B
)XXB C
,XXC D
newYY 
SqlParameterYY (
(YY( )
$strYY) 9
,YY9 :
sortColumnDirYY; H
)YYH I
,YYI J
newZZ 
SqlParameterZZ (
(ZZ( )
$strZZ) 6
,ZZ6 7

pageNumberZZ8 B
)ZZB C
,ZZC D
new[[ 
SqlParameter[[ $
([[$ %
$str[[% 0
,[[0 1
pageSize[[2 :
)[[: ;
}[[; <
)[[< =
;[[= >
recordsTotal]] 
=]] #
StoredProcedureExecutor]] 6
.]]6 7
ExecuteScalarInt]]7 G
(]]G H
_context]]H P
,]]P Q
$str]]R r
,]]r s
new]]t w
SqlParameter	]]x Ñ
[
]]Ñ Ö
]
]]Ö Ü
{
]]Ü á
new^^ 
SqlParameter^^ (
(^^( )
$str^^) 0
,^^0 1
NamaSearchParam^^2 A
)^^A B
,^^B C
new__ 
SqlParameter__ (
(__( )
$str__) 0
,__0 1
$str__2 4
)__4 5
}`` 
)`` 
;`` 
ifbb 
(bb 
listbb 
==bb 
nullbb  
)bb  !
{cc 
listdd 
=dd 
newdd 
Listdd #
<dd# $ 
MasterMenu_ViewModeldd$ 8
>dd8 9
(dd9 :
)dd: ;
;dd; <
recordsTotalee  
=ee! "
$numee# $
;ee$ %
}ff 
returnhh 
Jsonhh 
(hh 
newhh 
{hh  !
drawhh" &
=hh' (
drawhh) -
,hh- .
recordsFilteredhh/ >
=hh? @
recordsTotalhhA M
,hhM N
recordsTotalhhO [
=hh\ ]
recordsTotalhh^ j
,hhj k
datahhl p
=hhq r
listhhs w
}hhx y
)hhy z
;hhz {
}ii 
catchjj 
(jj 
	Exceptionjj 
Exjj 
)jj  
{kk 
throwll 
;ll 
}mm 
}nn 	
publicrr 
ActionResultrr 
Createrr "
(rr" #
)rr# $
{ss 	
iftt 
(tt 
!tt 
lastSessiontt 
.tt 
Updatett #
(tt# $
)tt$ %
)tt% &
{uu 
returnvv 
RedirectToActionvv '
(vv' (
$strvv( /
,vv/ 0
	GetConfigvv1 :
.vv: ;

AppSettingvv; E
[vvE F
$strvvF n
]vvn o
+vvp q
$strvvr y
,vvy z
newvv{ ~
{	vv Ä
a
vvÅ Ç
=
vvÉ Ñ
true
vvÖ â
}
vvä ã
)
vvã å
;
vvå ç
}ww 
varxx 
locationxx 
=xx 
newxx 
Urixx "
(xx" #
$"xx# %
{xx% &
Requestxx& -
.xx- .
Schemexx. 4
}xx4 5
$strxx5 8
{xx8 9
Requestxx9 @
.xx@ A
HostxxA E
}xxE F
{xxF G
RequestxxG N
.xxN O
PathxxO S
}xxS T
"xxT U
)xxU V
;xxV W
stringyy 
Pathyy 
=yy 
locationyy "
.yy" #
AbsolutePathyy# /
.yy/ 0
Replaceyy0 7
(yy7 8
thisyy8 <
.yy< =
ControllerContextyy= N
.yyN O
	RouteDatayyO X
.yyX Y
ValuesyyY _
[yy_ `
$stryy` h
]yyh i
.yyi j
ToStringyyj r
(yyr s
)yys t
,yyt u
$stryyv }
)yy} ~
;yy~ 
ifzz 
(zz 
!zz 
accessSecurityzz 
.zz  
IsGetAccesszz  +
(zz+ ,
$strzz, 0
+zz1 2
Pathzz3 7
)zz7 8
)zz8 9
{{{ 
return|| 
RedirectToAction|| '
(||' (
$str||( 3
,||3 4
$str||5 <
)||< =
;||= >
}}} 
ViewBag 
. 
ParentId 
= 
new "

SelectList# -
(- .
$str. 0
,0 1
$str2 4
)4 5
;5 6
ViewBag
ÄÄ 
.
ÄÄ 
TipeId
ÄÄ 
=
ÄÄ 
new
ÄÄ  

SelectList
ÄÄ! +
(
ÄÄ+ ,
$str
ÄÄ, .
,
ÄÄ. /
$str
ÄÄ0 2
)
ÄÄ2 3
;
ÄÄ3 4
ViewBag
ÅÅ 
.
ÅÅ 
RolePegawai
ÅÅ 
=
ÅÅ  !
new
ÅÅ" %

SelectList
ÅÅ& 0
(
ÅÅ0 1
$str
ÅÅ1 3
,
ÅÅ3 4
$str
ÅÅ5 7
)
ÅÅ7 8
;
ÅÅ8 9
ViewBag
ÇÇ 
.
ÇÇ 
RolePegawai
ÇÇ 
=
ÇÇ  !
new
ÇÇ" %

SelectList
ÇÇ& 0
(
ÇÇ0 1
Utility
ÇÇ1 8
.
ÇÇ8 9"
SelectDataMasterRole
ÇÇ9 M
(
ÇÇM N
_context
ÇÇN V
)
ÇÇV W
,
ÇÇW X
$str
ÇÇY ]
,
ÇÇ] ^
$str
ÇÇ_ e
)
ÇÇe f
;
ÇÇf g
return
ÖÖ 
PartialView
ÖÖ 
(
ÖÖ 
$str
ÖÖ (
)
ÖÖ( )
;
ÖÖ) *
}
ÜÜ 	
[
àà 	&
ValidateAntiForgeryToken
àà	 !
]
àà! "
[
ââ 	
HttpPost
ââ	 
]
ââ 
public
ää 
async
ää 
Task
ää 
<
ää 
ActionResult
ää &
>
ää& '
SubmitCreate
ää( 4
(
ää4 5"
MasterMenu_ViewModel
ää5 I
model
ääJ O
,
ääO P
string
ääQ W
Roles
ääX ]
)
ää] ^
{
ãã 	
if
åå 
(
åå 
!
åå 
lastSession
åå 
.
åå 
Update
åå #
(
åå# $
)
åå$ %
)
åå% &
{
çç 
return
éé 
RedirectToAction
éé '
(
éé' (
$str
éé( /
,
éé/ 0
	GetConfig
éé1 :
.
éé: ;

AppSetting
éé; E
[
ééE F
$str
ééF n
]
één o
+
éép q
$str
éér y
,
ééy z
new
éé{ ~
{éé Ä
aééÅ Ç
=ééÉ Ñ
trueééÖ â
}ééä ã
)ééã å
;ééå ç
}
èè 
var
êê 
location
êê 
=
êê 
new
êê 
Uri
êê "
(
êê" #
$"
êê# %
{
êê% &
Request
êê& -
.
êê- .
Scheme
êê. 4
}
êê4 5
$str
êê5 8
{
êê8 9
Request
êê9 @
.
êê@ A
Host
êêA E
}
êêE F
{
êêF G
Request
êêG N
.
êêN O
Path
êêO S
}
êêS T
"
êêT U
)
êêU V
;
êêV W
string
ëë 
Path
ëë 
=
ëë 
location
ëë "
.
ëë" #
AbsolutePath
ëë# /
.
ëë/ 0
Replace
ëë0 7
(
ëë7 8
this
ëë8 <
.
ëë< =
ControllerContext
ëë= N
.
ëëN O
	RouteData
ëëO X
.
ëëX Y
Values
ëëY _
[
ëë_ `
$str
ëë` h
]
ëëh i
.
ëëi j
ToString
ëëj r
(
ëër s
)
ëës t
,
ëët u
$str
ëëv }
)
ëë} ~
;
ëë~ 
if
íí 
(
íí 
!
íí 
accessSecurity
íí 
.
íí  
IsGetAccess
íí  +
(
íí+ ,
$str
íí, 0
+
íí1 2
Path
íí3 7
)
íí7 8
)
íí8 9
{
ìì 
return
îî 
RedirectToAction
îî '
(
îî' (
$str
îî( 3
,
îî3 4
$str
îî5 <
)
îî< =
;
îî= >
}
ïï 
try
óó 
{
òò 
if
ôô 
(
ôô 
Roles
ôô 
==
ôô 
null
ôô !
)
ôô! "
{
öö 
return
õõ 
Content
õõ "
(
õõ" #
	GetConfig
õõ# ,
.
õõ, -

AppSetting
õõ- 7
[
õõ7 8
$str
õõ8 j
]
õõj k
)
õõk l
;
õõl m
}
úú 
var
ûû 
regex
ûû 
=
ûû 
await
ûû !
RegexRequest
ûû" .
.
ûû. /
RegexValidation
ûû/ >
(
ûû> ?
model
ûû? D
)
ûûD E
;
ûûE F
if
üü 
(
üü 
!
üü 
regex
üü 
)
üü 
{
†† 
return
°° 
Content
°° "
(
°°" #
$str
°°# 1
)
°°1 2
;
°°2 3
}
¢¢ 
using
•• 
(
•• 
TransactionScope
•• '
trx
••( +
=
••, -
new
••. 1
TransactionScope
••2 B
(
••B C
)
••C D
)
••D E
{
¶¶ 
TblNavigation
ßß !
data
ßß" &
=
ßß' (
new
ßß) ,
TblNavigation
ßß- :
(
ßß: ;
)
ßß; <
;
ßß< =
data
®® 
.
®® 
Name
®® 
=
®® 
model
®®  %
.
®®% &
Nama
®®& *
;
®®* +
data
©© 
.
©© 
Type
©© 
=
©© 
model
©©  %
.
©©% &
TipeId
©©& ,
;
©©, -
data
™™ 
.
™™  
ParentNavigationId
™™ +
=
™™, -
model
™™. 3
.
™™3 4
ParentId
™™4 <
;
™™< =
data
´´ 
.
´´ 
OrderBy
´´  
=
´´! "
model
´´# (
.
´´( )
OrderBy
´´) 0
;
´´0 1
data
¨¨ 
.
¨¨ 
Route
¨¨ 
=
¨¨  
model
¨¨! &
.
¨¨& '
Route
¨¨' ,
;
¨¨, -
data
≠≠ 
.
≠≠ 
Icon
≠≠ 
=
≠≠ 
model
≠≠  %
.
≠≠% &
Icon
≠≠& *
;
≠≠* +
data
ÆÆ 
.
ÆÆ 
IsActive
ÆÆ !
=
ÆÆ" #
model
ÆÆ$ )
.
ÆÆ) *
IsActive
ÆÆ* 2
;
ÆÆ2 3
data
ØØ 
.
ØØ 
	IsDeleted
ØØ "
=
ØØ# $
false
ØØ% *
;
ØØ* +
data
∞∞ 
.
∞∞ 
CreatedById
∞∞ $
=
∞∞% &
int
∞∞' *
.
∞∞* +
Parse
∞∞+ 0
(
∞∞0 1
HttpContext
∞∞1 <
.
∞∞< =
Session
∞∞= D
.
∞∞D E
	GetString
∞∞E N
(
∞∞N O
SessionConstan
∞∞O ]
.
∞∞] ^
Session_UserId
∞∞^ l
)
∞∞l m
)
∞∞m n
;
∞∞n o
data
±± 
.
±± 
CreatedTime
±± $
=
±±% &
DateTime
±±' /
.
±±/ 0
Now
±±0 3
;
±±3 4
_context
≤≤ 
.
≤≤ 
TblNavigations
≤≤ +
.
≤≤+ ,
Add
≤≤, /
(
≤≤/ 0
data
≤≤0 4
)
≤≤4 5
;
≤≤5 6
_context
≥≥ 
.
≥≥ 
SaveChanges
≥≥ (
(
≥≥( )
)
≥≥) *
;
≥≥* +
string
µµ 
[
µµ 
]
µµ 

ArrayRoles
µµ '
=
µµ( )
Roles
µµ* /
.
µµ/ 0
Split
µµ0 5
(
µµ5 6
$char
µµ6 9
)
µµ9 :
;
µµ: ;
foreach
∂∂ 
(
∂∂ 
var
∂∂  
item
∂∂! %
in
∂∂& (

ArrayRoles
∂∂) 3
)
∂∂3 4
{
∑∑ %
TblNavigationAssignment
∏∏ /

dataAssign
∏∏0 :
=
∏∏; <
new
∏∏= @%
TblNavigationAssignment
∏∏A X
(
∏∏X Y
)
∏∏Y Z
;
∏∏Z [

dataAssign
ππ "
.
ππ" #
NavigationId
ππ# /
=
ππ0 1
data
ππ2 6
.
ππ6 7
Id
ππ7 9
;
ππ9 :

dataAssign
∫∫ "
.
∫∫" #
RoleId
∫∫# )
=
∫∫* +
int
∫∫, /
.
∫∫/ 0
Parse
∫∫0 5
(
∫∫5 6
item
∫∫6 :
)
∫∫: ;
;
∫∫; <

dataAssign
ªª "
.
ªª" #
CreatedById
ªª# .
=
ªª/ 0
int
ªª1 4
.
ªª4 5
Parse
ªª5 :
(
ªª: ;
HttpContext
ªª; F
.
ªªF G
Session
ªªG N
.
ªªN O
	GetString
ªªO X
(
ªªX Y
SessionConstan
ªªY g
.
ªªg h
Session_UserId
ªªh v
)
ªªv w
)
ªªw x
;
ªªx y

dataAssign
ºº "
.
ºº" #
CreatedTime
ºº# .
=
ºº/ 0
DateTime
ºº1 9
.
ºº9 :
Now
ºº: =
;
ºº= >

dataAssign
ΩΩ "
.
ΩΩ" #
IsActive
ΩΩ# +
=
ΩΩ, -
true
ΩΩ. 2
;
ΩΩ2 3

dataAssign
ææ "
.
ææ" #
	IsDeleted
ææ# ,
=
ææ- .
false
ææ/ 4
;
ææ4 5
_context
øø  
.
øø  !&
TblNavigationAssignments
øø! 9
.
øø9 :
Add
øø: =
(
øø= >

dataAssign
øø> H
)
øøH I
;
øøI J
_context
¿¿  
.
¿¿  !
SaveChanges
¿¿! ,
(
¿¿, -
)
¿¿- .
;
¿¿. /
}
¡¡ 
trx
√√ 
.
√√ 
Complete
√√  
(
√√  !
)
√√! "
;
√√" #
}
ƒƒ 
return
∆∆ 
Content
∆∆ 
(
∆∆ 
$str
∆∆ !
)
∆∆! "
;
∆∆" #
}
«« 
catch
»» 
(
»» 
	Exception
»» 
Ex
»» 
)
»»  
{
…… 
return
   
Content
   
(
   
	GetConfig
   (
.
  ( )

AppSetting
  ) 3
[
  3 4
$str
  4 M
]
  M N
)
  N O
;
  O P
}
ÀÀ 
}
ÃÃ 	
public
—— 
ActionResult
—— 
Edit
——  
(
——  !
int
——! $
id
——% '
)
——' (
{
““ 	
if
”” 
(
”” 
!
”” 
lastSession
”” 
.
”” 
Update
”” #
(
””# $
)
””$ %
)
””% &
{
‘‘ 
return
’’ 
RedirectToAction
’’ '
(
’’' (
$str
’’( /
,
’’/ 0
	GetConfig
’’1 :
.
’’: ;

AppSetting
’’; E
[
’’E F
$str
’’F n
]
’’n o
+
’’p q
$str
’’r y
,
’’y z
new
’’{ ~
{’’ Ä
a’’Å Ç
=’’É Ñ
true’’Ö â
}’’ä ã
)’’ã å
;’’å ç
}
÷÷ 
var
◊◊ 
location
◊◊ 
=
◊◊ 
new
◊◊ 
Uri
◊◊ "
(
◊◊" #
$"
◊◊# %
{
◊◊% &
Request
◊◊& -
.
◊◊- .
Scheme
◊◊. 4
}
◊◊4 5
$str
◊◊5 8
{
◊◊8 9
Request
◊◊9 @
.
◊◊@ A
Host
◊◊A E
}
◊◊E F
{
◊◊F G
Request
◊◊G N
.
◊◊N O
Path
◊◊O S
}
◊◊S T
"
◊◊T U
)
◊◊U V
;
◊◊V W
string
ÿÿ 
Path
ÿÿ 
=
ÿÿ 
location
ÿÿ "
.
ÿÿ" #
AbsolutePath
ÿÿ# /
.
ÿÿ/ 0
Replace
ÿÿ0 7
(
ÿÿ7 8
this
ÿÿ8 <
.
ÿÿ< =
ControllerContext
ÿÿ= N
.
ÿÿN O
	RouteData
ÿÿO X
.
ÿÿX Y
Values
ÿÿY _
[
ÿÿ_ `
$str
ÿÿ` h
]
ÿÿh i
.
ÿÿi j
ToString
ÿÿj r
(
ÿÿr s
)
ÿÿs t
,
ÿÿt u
$str
ÿÿv }
)
ÿÿ} ~
;
ÿÿ~ 
if
ŸŸ 
(
ŸŸ 
!
ŸŸ 
accessSecurity
ŸŸ 
.
ŸŸ  
IsGetAccess
ŸŸ  +
(
ŸŸ+ ,
$str
ŸŸ, 0
+
ŸŸ1 2
Path
ŸŸ3 7
)
ŸŸ7 8
)
ŸŸ8 9
{
⁄⁄ 
return
€€ 
RedirectToAction
€€ '
(
€€' (
$str
€€( 3
,
€€3 4
$str
€€5 <
)
€€< =
;
€€= >
}
‹‹ "
MasterMenu_ViewModel
ﬁﬁ  
data
ﬁﬁ! %
=
ﬁﬁ& '
new
ﬁﬁ( +"
MasterMenu_ViewModel
ﬁﬁ, @
(
ﬁﬁ@ A
)
ﬁﬁA B
;
ﬁﬁB C
data
ﬂﬂ 
=
ﬂﬂ %
StoredProcedureExecutor
ﬂﬂ *
.
ﬂﬂ* +
ExecuteSPSingle
ﬂﬂ+ :
<
ﬂﬂ: ;"
MasterMenu_ViewModel
ﬂﬂ; O
>
ﬂﬂO P
(
ﬂﬂP Q
_context
ﬂﬂQ Y
,
ﬂﬂY Z
$str
ﬂﬂ[ z
,
ﬂﬂz {
new
ﬂﬂ| 
SqlParameterﬂﬂÄ å
[ﬂﬂå ç
]ﬂﬂç é
{ﬂﬂé è
new
‡‡ 
SqlParameter
‡‡ (
(
‡‡( )
$str
‡‡) .
,
‡‡. /
id
‡‡0 2
)
‡‡2 3
}
·· 
)
·· 
;
·· 
if
„„ 
(
„„ 
data
„„ 
!=
„„ 
null
„„ 
)
„„ 
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
data
ÂÂ 
.
ÂÂ 
ParentId
ÂÂ !
!=
ÂÂ" $
null
ÂÂ% )
)
ÂÂ) *
{
ÊÊ 
ViewBag
ÁÁ 
.
ÁÁ 
ParentId
ÁÁ $
=
ÁÁ% &
new
ÁÁ' *

SelectList
ÁÁ+ 5
(
ÁÁ5 6
Utility
ÁÁ6 =
.
ÁÁ= >"
SelectDataParentMenu
ÁÁ> R
(
ÁÁR S
data
ÁÁS W
.
ÁÁW X
ParentId
ÁÁX `
,
ÁÁ` a
_context
ÁÁb j
)
ÁÁj k
,
ÁÁk l
$str
ÁÁm q
,
ÁÁq r
$str
ÁÁs y
,
ÁÁy z
data
ÁÁ{ 
.ÁÁ Ä
ParentIdÁÁÄ à
)ÁÁà â
;ÁÁâ ä
}
ËË 
else
ÈÈ 
{
ÍÍ 
ViewBag
ÎÎ 
.
ÎÎ 
ParentId
ÎÎ $
=
ÎÎ% &
new
ÎÎ' *

SelectList
ÎÎ+ 5
(
ÎÎ5 6
$str
ÎÎ6 8
,
ÎÎ8 9
$str
ÎÎ: <
)
ÎÎ< =
;
ÎÎ= >
}
ÏÏ 
if
ÓÓ 
(
ÓÓ 
data
ÓÓ 
.
ÓÓ 
TipeId
ÓÓ 
!=
ÓÓ  "
null
ÓÓ# '
)
ÓÓ' (
{
ÔÔ 
ViewBag
 
.
 
TipeId
 "
=
# $
new
% (

SelectList
) 3
(
3 4
Utility
4 ;
.
; <"
SelectDataLookupById
< P
(
P Q
data
Q U
.
U V
TipeId
V \
,
\ ]
$str
^ h
,
h i
_context
j r
)
r s
,
s t
$str
u y
,
y z
$str{ Å
,Å Ç
dataÉ á
.á à
TipeIdà é
)é è
;è ê
}
ÒÒ 
else
ÚÚ 
{
ÛÛ 
ViewBag
ÙÙ 
.
ÙÙ 
TipeId
ÙÙ "
=
ÙÙ# $
new
ÙÙ% (

SelectList
ÙÙ) 3
(
ÙÙ3 4
$str
ÙÙ4 6
,
ÙÙ6 7
$str
ÙÙ8 :
)
ÙÙ: ;
;
ÙÙ; <
}
ıı 
ViewBag
˜˜ 
.
˜˜ 
RolePegawai
˜˜ #
=
˜˜$ %
new
˜˜& )

SelectList
˜˜* 4
(
˜˜4 5
$str
˜˜5 7
,
˜˜7 8
$str
˜˜9 ;
)
˜˜; <
;
˜˜< =
var
¯¯ 
dataAssignment
¯¯ "
=
¯¯# $
_context
¯¯% -
.
¯¯- .&
TblNavigationAssignments
¯¯. F
.
¯¯F G
Where
¯¯G L
(
¯¯L M
m
¯¯M N
=>
¯¯O Q
m
¯¯R S
.
¯¯S T
NavigationId
¯¯T `
==
¯¯a c
data
¯¯d h
.
¯¯h i
Id
¯¯i k
)
¯¯k l
.
¯¯l m
Select
¯¯m s
(
¯¯s t
m
¯¯t u
=>
¯¯v x
m
¯¯y z
.
¯¯z {
RoleId¯¯{ Å
)¯¯Å Ç
.¯¯Ç É
ToList¯¯É â
(¯¯â ä
)¯¯ä ã
;¯¯ã å
ViewBag
˘˘ 
.
˘˘ "
NavigationAssignment
˘˘ ,
=
˘˘- .
String
˘˘/ 5
.
˘˘5 6
Join
˘˘6 :
(
˘˘: ;
$str
˘˘; >
,
˘˘> ?
dataAssignment
˘˘@ N
.
˘˘N O
ToArray
˘˘O V
(
˘˘V W
)
˘˘W X
)
˘˘X Y
;
˘˘Y Z
}
˙˙ 
return
¸¸ 
PartialView
¸¸ 
(
¸¸ 
$str
¸¸ &
,
¸¸& '
data
¸¸( ,
)
¸¸, -
;
¸¸- .
}
˝˝ 	
[
ˇˇ 	&
ValidateAntiForgeryToken
ˇˇ	 !
]
ˇˇ! "
[
ÄÄ 	
HttpPost
ÄÄ	 
]
ÄÄ 
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
<
ÅÅ 
ActionResult
ÅÅ &
>
ÅÅ& '

SubmitEdit
ÅÅ( 2
(
ÅÅ2 3"
MasterMenu_ViewModel
ÅÅ3 G
model
ÅÅH M
,
ÅÅM N
string
ÅÅO U
Roles
ÅÅV [
)
ÅÅ[ \
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
lastSession
ÉÉ 
.
ÉÉ 
Update
ÉÉ #
(
ÉÉ# $
)
ÉÉ$ %
)
ÉÉ% &
{
ÑÑ 
return
ÖÖ 
RedirectToAction
ÖÖ '
(
ÖÖ' (
$str
ÖÖ( /
,
ÖÖ/ 0
	GetConfig
ÖÖ1 :
.
ÖÖ: ;

AppSetting
ÖÖ; E
[
ÖÖE F
$str
ÖÖF n
]
ÖÖn o
+
ÖÖp q
$str
ÖÖr y
,
ÖÖy z
new
ÖÖ{ ~
{ÖÖ Ä
aÖÖÅ Ç
=ÖÖÉ Ñ
trueÖÖÖ â
}ÖÖä ã
)ÖÖã å
;ÖÖå ç
}
ÜÜ 
var
áá 
location
áá 
=
áá 
new
áá 
Uri
áá "
(
áá" #
$"
áá# %
{
áá% &
Request
áá& -
.
áá- .
Scheme
áá. 4
}
áá4 5
$str
áá5 8
{
áá8 9
Request
áá9 @
.
áá@ A
Host
ááA E
}
ááE F
{
ááF G
Request
ááG N
.
ááN O
Path
ááO S
}
ááS T
"
ááT U
)
ááU V
;
ááV W
string
àà 
Path
àà 
=
àà 
location
àà "
.
àà" #
AbsolutePath
àà# /
.
àà/ 0
Replace
àà0 7
(
àà7 8
this
àà8 <
.
àà< =
ControllerContext
àà= N
.
ààN O
	RouteData
ààO X
.
ààX Y
Values
ààY _
[
àà_ `
$str
àà` h
]
ààh i
.
àài j
ToString
ààj r
(
ààr s
)
ààs t
,
ààt u
$str
ààv }
)
àà} ~
;
àà~ 
if
ââ 
(
ââ 
!
ââ 
accessSecurity
ââ 
.
ââ  
IsGetAccess
ââ  +
(
ââ+ ,
$str
ââ, 0
+
ââ1 2
Path
ââ3 7
)
ââ7 8
)
ââ8 9
{
ää 
return
ãã 
RedirectToAction
ãã '
(
ãã' (
$str
ãã( 3
,
ãã3 4
$str
ãã5 <
)
ãã< =
;
ãã= >
}
åå 
try
éé 
{
èè 
var
êê 
regex
êê 
=
êê 
await
êê !
RegexRequest
êê" .
.
êê. /
RegexValidation
êê/ >
(
êê> ?
model
êê? D
)
êêD E
;
êêE F
if
ëë 
(
ëë 
!
ëë 
regex
ëë 
)
ëë 
{
íí 
return
ìì 
Content
ìì "
(
ìì" #
$str
ìì# 1
)
ìì1 2
;
ìì2 3
}
îî 
using
ññ 
(
ññ 
TransactionScope
ññ '
trx
ññ( +
=
ññ, -
new
ññ. 1
TransactionScope
ññ2 B
(
ññB C
)
ññC D
)
ññD E
{
óó 
TblNavigation
òò !
data
òò" &
=
òò' (
_context
òò) 1
.
òò1 2
TblNavigations
òò2 @
.
òò@ A
Where
òòA F
(
òòF G
m
òòG H
=>
òòI K
m
òòL M
.
òòM N
Id
òòN P
==
òòQ S
model
òòT Y
.
òòY Z
Id
òòZ \
)
òò\ ]
.
òò] ^
FirstOrDefault
òò^ l
(
òòl m
)
òòm n
;
òòn o
data
ôô 
.
ôô 
Type
ôô 
=
ôô 
model
ôô  %
.
ôô% &
TipeId
ôô& ,
;
ôô, -
data
öö 
.
öö  
ParentNavigationId
öö +
=
öö, -
model
öö. 3
.
öö3 4
ParentId
öö4 <
;
öö< =
data
õõ 
.
õõ 
Name
õõ 
=
õõ 
model
õõ  %
.
õõ% &
Nama
õõ& *
;
õõ* +
data
úú 
.
úú 
Route
úú 
=
úú  
model
úú! &
.
úú& '
Route
úú' ,
;
úú, -
data
ùù 
.
ùù 
Icon
ùù 
=
ùù 
model
ùù  %
.
ùù% &
Icon
ùù& *
;
ùù* +
data
ûû 
.
ûû 
OrderBy
ûû  
=
ûû! "
model
ûû# (
.
ûû( )
OrderBy
ûû) 0
;
ûû0 1
data
üü 
.
üü 
IsActive
üü !
=
üü" #
model
üü$ )
.
üü) *
IsActive
üü* 2
;
üü2 3
data
†† 
.
†† 
UpdatedById
†† $
=
††% &
int
††' *
.
††* +
Parse
††+ 0
(
††0 1
HttpContext
††1 <
.
††< =
Session
††= D
.
††D E
	GetString
††E N
(
††N O
SessionConstan
††O ]
.
††] ^
Session_UserId
††^ l
)
††l m
)
††m n
;
††n o
data
°° 
.
°° 
UpdatedTime
°° $
=
°°% &
DateTime
°°' /
.
°°/ 0
Now
°°0 3
;
°°3 4
_context
¢¢ 
.
¢¢ 
Entry
¢¢ "
(
¢¢" #
data
¢¢# '
)
¢¢' (
.
¢¢( )
State
¢¢) .
=
¢¢/ 0
EntityState
¢¢1 <
.
¢¢< =
Modified
¢¢= E
;
¢¢E F
_context
££ 
.
££ 
SaveChanges
££ (
(
££( )
)
££) *
;
££* +
var
¶¶ 

AssignMenu
¶¶ "
=
¶¶# $
_context
¶¶% -
.
¶¶- .&
TblNavigationAssignments
¶¶. F
.
¶¶F G
Where
¶¶G L
(
¶¶L M
m
¶¶M N
=>
¶¶O Q
m
¶¶R S
.
¶¶S T
NavigationId
¶¶T `
==
¶¶a c
data
¶¶d h
.
¶¶h i
Id
¶¶i k
)
¶¶k l
.
¶¶l m
Select
¶¶m s
(
¶¶s t
m
¶¶t u
=>
¶¶v x
m
¶¶y z
.
¶¶z {
RoleId¶¶{ Å
.¶¶Å Ç
ToString¶¶Ç ä
(¶¶ä ã
)¶¶ã å
)¶¶å ç
.¶¶ç é
ToList¶¶é î
(¶¶î ï
)¶¶ï ñ
;¶¶ñ ó
string
ßß 
[
ßß 
]
ßß 
ArrayAssignMenu
ßß ,
=
ßß- .

AssignMenu
ßß/ 9
.
ßß9 :
ToArray
ßß: A
(
ßßA B
)
ßßB C
;
ßßC D
string
®® 
[
®® 
]
®® 

ArrayRoles
®® '
=
®®( )
Roles
®®* /
.
®®/ 0
Split
®®0 5
(
®®5 6
$char
®®6 9
)
®®9 :
;
®®: ;
var
™™ 

TambahData
™™ "
=
™™# $

ArrayRoles
™™% /
.
™™/ 0
Except
™™0 6
(
™™6 7
ArrayAssignMenu
™™7 F
)
™™F G
;
™™G H
var
´´ 

DeleteData
´´ "
=
´´# $
ArrayAssignMenu
´´% 4
.
´´4 5
Except
´´5 ;
(
´´; <

ArrayRoles
´´< F
)
´´F G
;
´´G H
if
≠≠ 
(
≠≠ 

DeleteData
≠≠ "
!=
≠≠# %
null
≠≠& *
)
≠≠* +
{
ÆÆ 
foreach
ØØ 
(
ØØ  !
var
ØØ! $
item
ØØ% )
in
ØØ* ,

DeleteData
ØØ- 7
)
ØØ7 8
{
∞∞ 
int
±± 
IdRole
±±  &
=
±±' (
int
±±) ,
.
±±, -
Parse
±±- 2
(
±±2 3
item
±±3 7
)
±±7 8
;
±±8 9%
TblNavigationAssignment
≤≤ 3
dataNA
≤≤4 :
=
≤≤; <
_context
≤≤= E
.
≤≤E F&
TblNavigationAssignments
≤≤F ^
.
≤≤^ _
Where
≤≤_ d
(
≤≤d e
m
≤≤e f
=>
≤≤g i
m
≤≤j k
.
≤≤k l
NavigationId
≤≤l x
==
≤≤y {
data≤≤| Ä
.≤≤Ä Å
Id≤≤Å É
&&≤≤Ñ Ü
m≤≤á à
.≤≤à â
RoleId≤≤â è
==≤≤ê í
IdRole≤≤ì ô
)≤≤ô ö
.≤≤ö õ
FirstOrDefault≤≤õ ©
(≤≤© ™
)≤≤™ ´
;≤≤´ ¨
_context
≥≥ $
.
≥≥$ %&
TblNavigationAssignments
≥≥% =
.
≥≥= >
Remove
≥≥> D
(
≥≥D E
dataNA
≥≥E K
)
≥≥K L
;
≥≥L M
}
¥¥ 
}
µµ 
if
∏∏ 
(
∏∏ 

TambahData
∏∏ "
!=
∏∏# %
null
∏∏& *
)
∏∏* +
{
ππ 
foreach
∫∫ 
(
∫∫  !
var
∫∫! $
item
∫∫% )
in
∫∫* ,

TambahData
∫∫- 7
)
∫∫7 8
{
ªª %
TblNavigationAssignment
ºº 3
dataAssigment
ºº4 A
=
ººB C
new
ººD G%
TblNavigationAssignment
ººH _
(
ºº_ `
)
ºº` a
;
ººa b
dataAssigment
ΩΩ )
.
ΩΩ) *
NavigationId
ΩΩ* 6
=
ΩΩ7 8
model
ΩΩ9 >
.
ΩΩ> ?
Id
ΩΩ? A
;
ΩΩA B
dataAssigment
ææ )
.
ææ) *
RoleId
ææ* 0
=
ææ1 2
int
ææ3 6
.
ææ6 7
Parse
ææ7 <
(
ææ< =
item
ææ= A
)
ææA B
;
ææB C
dataAssigment
øø )
.
øø) *
CreatedById
øø* 5
=
øø6 7
int
øø8 ;
.
øø; <
Parse
øø< A
(
øøA B
HttpContext
øøB M
.
øøM N
Session
øøN U
.
øøU V
	GetString
øøV _
(
øø_ `
SessionConstan
øø` n
.
øøn o
Session_UserId
øøo }
)
øø} ~
)
øø~ 
;øø Ä
dataAssigment
¿¿ )
.
¿¿) *
CreatedTime
¿¿* 5
=
¿¿6 7
DateTime
¿¿8 @
.
¿¿@ A
Now
¿¿A D
;
¿¿D E
dataAssigment
¡¡ )
.
¡¡) *
IsActive
¡¡* 2
=
¡¡3 4
true
¡¡5 9
;
¡¡9 :
_context
¬¬ $
.
¬¬$ %&
TblNavigationAssignments
¬¬% =
.
¬¬= >
Add
¬¬> A
(
¬¬A B
dataAssigment
¬¬B O
)
¬¬O P
;
¬¬P Q
}
√√ 
}
ƒƒ 
_context
∆∆ 
.
∆∆ 
SaveChanges
∆∆ (
(
∆∆( )
)
∆∆) *
;
∆∆* +
trx
«« 
.
«« 
Complete
««  
(
««  !
)
««! "
;
««" #
}
»» 
return
ÀÀ 
Content
ÀÀ 
(
ÀÀ 
$str
ÀÀ !
)
ÀÀ! "
;
ÀÀ" #
}
ÃÃ 
catch
ÕÕ 
{
ŒŒ 
return
œœ 
Content
œœ 
(
œœ 
	GetConfig
œœ (
.
œœ( )

AppSetting
œœ) 3
[
œœ3 4
$str
œœ4 M
]
œœM N
)
œœN O
;
œœO P
}
–– 
}
—— 	
public
’’ 
ActionResult
’’ 
View
’’  
(
’’  !
int
’’! $
id
’’% '
)
’’' (
{
÷÷ 	
if
◊◊ 
(
◊◊ 
!
◊◊ 
lastSession
◊◊ 
.
◊◊ 
Update
◊◊ #
(
◊◊# $
)
◊◊$ %
)
◊◊% &
{
ÿÿ 
return
ŸŸ 
RedirectToAction
ŸŸ '
(
ŸŸ' (
$str
ŸŸ( /
,
ŸŸ/ 0
	GetConfig
ŸŸ1 :
.
ŸŸ: ;

AppSetting
ŸŸ; E
[
ŸŸE F
$str
ŸŸF n
]
ŸŸn o
+
ŸŸp q
$str
ŸŸr y
,
ŸŸy z
new
ŸŸ{ ~
{ŸŸ Ä
aŸŸÅ Ç
=ŸŸÉ Ñ
trueŸŸÖ â
}ŸŸä ã
)ŸŸã å
;ŸŸå ç
}
⁄⁄ 
var
€€ 
location
€€ 
=
€€ 
new
€€ 
Uri
€€ "
(
€€" #
$"
€€# %
{
€€% &
Request
€€& -
.
€€- .
Scheme
€€. 4
}
€€4 5
$str
€€5 8
{
€€8 9
Request
€€9 @
.
€€@ A
Host
€€A E
}
€€E F
{
€€F G
Request
€€G N
.
€€N O
Path
€€O S
}
€€S T
"
€€T U
)
€€U V
;
€€V W
string
‹‹ 
Path
‹‹ 
=
‹‹ 
location
‹‹ "
.
‹‹" #
AbsolutePath
‹‹# /
.
‹‹/ 0
Replace
‹‹0 7
(
‹‹7 8
this
‹‹8 <
.
‹‹< =
ControllerContext
‹‹= N
.
‹‹N O
	RouteData
‹‹O X
.
‹‹X Y
Values
‹‹Y _
[
‹‹_ `
$str
‹‹` h
]
‹‹h i
.
‹‹i j
ToString
‹‹j r
(
‹‹r s
)
‹‹s t
,
‹‹t u
$str
‹‹v }
)
‹‹} ~
;
‹‹~ 
if
›› 
(
›› 
!
›› 
accessSecurity
›› 
.
››  
IsGetAccess
››  +
(
››+ ,
$str
››, 0
+
››1 2
Path
››3 7
)
››7 8
)
››8 9
{
ﬁﬁ 
return
ﬂﬂ 
RedirectToAction
ﬂﬂ '
(
ﬂﬂ' (
$str
ﬂﬂ( 3
,
ﬂﬂ3 4
$str
ﬂﬂ5 <
)
ﬂﬂ< =
;
ﬂﬂ= >
}
‡‡ "
MasterMenu_ViewModel
‚‚  
data
‚‚! %
=
‚‚& '
new
‚‚( +"
MasterMenu_ViewModel
‚‚, @
(
‚‚@ A
)
‚‚A B
;
‚‚B C
data
„„ 
=
„„ %
StoredProcedureExecutor
„„ *
.
„„* +
ExecuteSPSingle
„„+ :
<
„„: ;"
MasterMenu_ViewModel
„„; O
>
„„O P
(
„„P Q
_context
„„Q Y
,
„„Y Z
$str
„„[ z
,
„„z {
new
„„| 
SqlParameter„„Ä å
[„„å ç
]„„ç é
{„„é è
new
‰‰ 
SqlParameter
‰‰ (
(
‰‰( )
$str
‰‰) .
,
‰‰. /
id
‰‰0 2
)
‰‰2 3
}
ÂÂ 
)
ÂÂ 
;
ÂÂ 
if
ÁÁ 
(
ÁÁ 
data
ÁÁ 
!=
ÁÁ 
null
ÁÁ 
)
ÁÁ 
{
ËË 
if
ÈÈ 
(
ÈÈ 
data
ÈÈ 
.
ÈÈ 
ParentId
ÈÈ !
!=
ÈÈ" $
null
ÈÈ% )
)
ÈÈ) *
{
ÍÍ 
ViewBag
ÎÎ 
.
ÎÎ 
ParentId
ÎÎ $
=
ÎÎ% &
new
ÎÎ' *

SelectList
ÎÎ+ 5
(
ÎÎ5 6
Utility
ÎÎ6 =
.
ÎÎ= >"
SelectDataParentMenu
ÎÎ> R
(
ÎÎR S
data
ÎÎS W
.
ÎÎW X
ParentId
ÎÎX `
,
ÎÎ` a
_context
ÎÎb j
)
ÎÎj k
,
ÎÎk l
$str
ÎÎm q
,
ÎÎq r
$str
ÎÎs y
,
ÎÎy z
data
ÎÎ{ 
.ÎÎ Ä
ParentIdÎÎÄ à
)ÎÎà â
;ÎÎâ ä
}
ÏÏ 
else
ÌÌ 
{
ÓÓ 
ViewBag
ÔÔ 
.
ÔÔ 
ParentId
ÔÔ $
=
ÔÔ% &
new
ÔÔ' *

SelectList
ÔÔ+ 5
(
ÔÔ5 6
$str
ÔÔ6 8
,
ÔÔ8 9
$str
ÔÔ: <
)
ÔÔ< =
;
ÔÔ= >
}
 
if
ÚÚ 
(
ÚÚ 
data
ÚÚ 
.
ÚÚ 
TipeId
ÚÚ 
!=
ÚÚ  "
null
ÚÚ# '
)
ÚÚ' (
{
ÛÛ 
ViewBag
ÙÙ 
.
ÙÙ 
TipeId
ÙÙ "
=
ÙÙ# $
new
ÙÙ% (

SelectList
ÙÙ) 3
(
ÙÙ3 4
Utility
ÙÙ4 ;
.
ÙÙ; <"
SelectDataLookupById
ÙÙ< P
(
ÙÙP Q
data
ÙÙQ U
.
ÙÙU V
TipeId
ÙÙV \
,
ÙÙ\ ]
$str
ÙÙ^ h
,
ÙÙh i
_context
ÙÙj r
)
ÙÙr s
,
ÙÙs t
$str
ÙÙu y
,
ÙÙy z
$strÙÙ{ Å
,ÙÙÅ Ç
dataÙÙÉ á
.ÙÙá à
TipeIdÙÙà é
)ÙÙé è
;ÙÙè ê
}
ıı 
else
ˆˆ 
{
˜˜ 
ViewBag
¯¯ 
.
¯¯ 
TipeId
¯¯ "
=
¯¯# $
new
¯¯% (

SelectList
¯¯) 3
(
¯¯3 4
$str
¯¯4 6
,
¯¯6 7
$str
¯¯8 :
)
¯¯: ;
;
¯¯; <
}
˘˘ 
ViewBag
˚˚ 
.
˚˚ 
RolePegawai
˚˚ #
=
˚˚$ %
new
˚˚& )

SelectList
˚˚* 4
(
˚˚4 5
$str
˚˚5 7
,
˚˚7 8
$str
˚˚9 ;
)
˚˚; <
;
˚˚< =
var
¸¸ 
dataAssignment
¸¸ "
=
¸¸# $
_context
¸¸% -
.
¸¸- .&
TblNavigationAssignments
¸¸. F
.
¸¸F G
Where
¸¸G L
(
¸¸L M
m
¸¸M N
=>
¸¸O Q
m
¸¸R S
.
¸¸S T
NavigationId
¸¸T `
==
¸¸a c
data
¸¸d h
.
¸¸h i
Id
¸¸i k
)
¸¸k l
.
¸¸l m
Select
¸¸m s
(
¸¸s t
m
¸¸t u
=>
¸¸v x
m
¸¸y z
.
¸¸z {
RoleId¸¸{ Å
)¸¸Å Ç
.¸¸Ç É
ToList¸¸É â
(¸¸â ä
)¸¸ä ã
;¸¸ã å
ViewBag
˝˝ 
.
˝˝ "
NavigationAssignment
˝˝ ,
=
˝˝- .
String
˝˝/ 5
.
˝˝5 6
Join
˝˝6 :
(
˝˝: ;
$str
˝˝; >
,
˝˝> ?
dataAssignment
˝˝@ N
.
˝˝N O
ToArray
˝˝O V
(
˝˝V W
)
˝˝W X
)
˝˝X Y
;
˝˝Y Z
}
˛˛ 
return
ÄÄ 
PartialView
ÄÄ 
(
ÄÄ 
$str
ÄÄ &
,
ÄÄ& '
data
ÄÄ( ,
)
ÄÄ, -
;
ÄÄ- .
}
ÅÅ 	
public
ÜÜ 
ActionResult
ÜÜ 
Delete
ÜÜ "
(
ÜÜ" #
string
ÜÜ# )
Ids
ÜÜ* -
)
ÜÜ- .
{
áá 	
if
àà 
(
àà 
!
àà 
lastSession
àà 
.
àà 
Update
àà #
(
àà# $
)
àà$ %
)
àà% &
{
ââ 
return
ää 
RedirectToAction
ää '
(
ää' (
$str
ää( /
,
ää/ 0
	GetConfig
ää1 :
.
ää: ;

AppSetting
ää; E
[
ääE F
$str
ääF n
]
ään o
+
ääp q
$str
äär y
,
ääy z
new
ää{ ~
{ää Ä
aääÅ Ç
=ääÉ Ñ
trueääÖ â
}äää ã
)ääã å
;ääå ç
}
ãã 
var
åå 
location
åå 
=
åå 
new
åå 
Uri
åå "
(
åå" #
$"
åå# %
{
åå% &
Request
åå& -
.
åå- .
Scheme
åå. 4
}
åå4 5
$str
åå5 8
{
åå8 9
Request
åå9 @
.
åå@ A
Host
ååA E
}
ååE F
{
ååF G
Request
ååG N
.
ååN O
Path
ååO S
}
ååS T
"
ååT U
)
ååU V
;
ååV W
string
çç 
Path
çç 
=
çç 
location
çç "
.
çç" #
AbsolutePath
çç# /
.
çç/ 0
Replace
çç0 7
(
çç7 8
this
çç8 <
.
çç< =
ControllerContext
çç= N
.
ççN O
	RouteData
ççO X
.
ççX Y
Values
ççY _
[
çç_ `
$str
çç` h
]
ççh i
.
ççi j
ToString
ççj r
(
ççr s
)
ççs t
,
ççt u
$str
ççv }
)
çç} ~
;
çç~ 
if
éé 
(
éé 
!
éé 
accessSecurity
éé 
.
éé  
IsGetAccess
éé  +
(
éé+ ,
$str
éé, 0
+
éé1 2
Path
éé3 7
)
éé7 8
)
éé8 9
{
èè 
return
êê 
RedirectToAction
êê '
(
êê' (
$str
êê( 3
,
êê3 4
$str
êê5 <
)
êê< =
;
êê= >
}
ëë 
try
ìì 
{
îî 
long
ïï 
[
ïï 
]
ïï 
confirmedDeleteId
ïï (
=
ïï) *
Ids
ïï+ .
.
ïï. /
Split
ïï/ 4
(
ïï4 5
$char
ïï5 8
)
ïï8 9
.
ïï9 :
Select
ïï: @
(
ïï@ A
long
ïïA E
.
ïïE F
Parse
ïïF K
)
ïïK L
.
ïïL M
ToArray
ïïM T
(
ïïT U
)
ïïU V
;
ïïV W
List
óó 
<
óó 
TblNavigation
óó "
>
óó" #

Transaksis
óó$ .
=
óó/ 0
_context
óó1 9
.
óó9 :
TblNavigations
óó: H
.
óóH I
Where
óóI N
(
óóN O
x
óóO P
=>
óóQ S
confirmedDeleteId
óóT e
.
óóe f
Contains
óóf n
(
óón o
x
óóo p
.
óóp q
Id
óóq s
)
óós t
)
óót u
.
óóu v
ToList
óóv |
(
óó| }
)
óó} ~
;
óó~ 
for
òò 
(
òò 
int
òò 
i
òò 
=
òò 
$num
òò 
;
òò 
i
òò  !
<
òò" #
confirmedDeleteId
òò$ 5
.
òò5 6
Length
òò6 <
;
òò< =
i
òò> ?
++
òò? A
)
òòA B
{
ôô 
TblNavigation
öö !
data
öö" &
=
öö' (
_context
öö) 1
.
öö1 2
TblNavigations
öö2 @
.
öö@ A
Find
ööA E
(
ööE F

Transaksis
ööF P
[
ööP Q
i
ööQ R
]
ööR S
.
ööS T
Id
ööT V
)
ööV W
;
ööW X
data
õõ 
.
õõ 
	IsDeleted
õõ "
=
õõ# $
true
õõ% )
;
õõ) *
data
úú 
.
úú 
DeletedById
úú $
=
úú% &
int
úú' *
.
úú* +
Parse
úú+ 0
(
úú0 1
HttpContext
úú1 <
.
úú< =
Session
úú= D
.
úúD E
	GetString
úúE N
(
úúN O
SessionConstan
úúO ]
.
úú] ^
Session_UserId
úú^ l
)
úúl m
)
úúm n
;
úún o
data
ùù 
.
ùù 
DeletedTime
ùù $
=
ùù% &
System
ùù' -
.
ùù- .
DateTime
ùù. 6
.
ùù6 7
Now
ùù7 :
;
ùù: ;
_context
ûû 
.
ûû 
Entry
ûû "
(
ûû" #
data
ûû# '
)
ûû' (
.
ûû( )
State
ûû) .
=
ûû/ 0
EntityState
ûû1 <
.
ûû< =
Modified
ûû= E
;
ûûE F
_context
üü 
.
üü 
SaveChanges
üü (
(
üü( )
)
üü) *
;
üü* +
}
†† 
return
°° 
Content
°° 
(
°° 
$str
°° !
)
°°! "
;
°°" #
}
¢¢ 
catch
££ 
{
§§ 
return
•• 
Content
•• 
(
•• 
$str
•• &
)
••& '
;
••' (
}
¶¶ 
}
ßß 	
}
©© 
}™™ ¯§
ND:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\UtilityController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public 

class 
UtilityController "
:# $

Controller% /
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7 
IHttpContextAccessor 
	_accessor &
;& '
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
public 
UtilityController  
(  !
IConfiguration! /
config0 6
,6 7%
DbDashboardDevaBniContext8 Q
contextR Y
,Y Z 
IHttpContextAccessor[ o
accessorp x
)x y
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
	_accessor 
= 
accessor  
;  !
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
} 	
public 

JsonResult 
GetAllLookup &
(& '
string' -
q. /
,/ 0
string1 7
type8 <
,< =
string> D
pageE I
,I J
intK N

rowPerPageO Y
)Y Z
{ 	&
ListDataDropdownServerSide   &
source  ' -
=  . /
new  0 3&
ListDataDropdownServerSide  4 N
(  N O
)  O P
;  P Q
source$$ 
.$$ 
items$$ 
=$$ 
new$$ 
List$$ #
<$$# $"
DataDropdownServerSide$$$ :
>$$: ;
($$; <
)$$< =
;$$= >
source&& 
.&& 
items&& 
=&& #
StoredProcedureExecutor&& 2
.&&2 3
ExecuteSPList&&3 @
<&&@ A"
DataDropdownServerSide&&A W
>&&W X
(&&X Y
_context&&Y a
,&&a b
$str&&c y
,&&y z
new&&{ ~
SqlParameter	&& ã
[
&&ã å
]
&&å ç
{
&&ç é
new'' 
SqlParameter'' (
(''( )
$str'') 5
,''5 6
q''7 8
)''8 9
,''9 :
new(( 
SqlParameter(( (
(((( )
$str(() 0
,((0 1
type((2 6
)((6 7
})) 
))) 
;)) 
source++ 
.++ 
total_count++ 
=++  #
StoredProcedureExecutor++! 8
.++8 9
ExecuteScalarInt++9 I
(++I J
_context++J R
,++R S
$str++T p
,++p q
new++r u
SqlParameter	++v Ç
[
++Ç É
]
++É Ñ
{
++Ñ Ö
new,, 
SqlParameter,, (
(,,( )
$str,,) 5
,,,5 6
q,,7 8
),,8 9
,,,9 :
new-- 
SqlParameter-- (
(--( )
$str--) 0
,--0 1
type--2 6
)--6 7
,--7 8
}.. 
).. 
;.. 
return11 
Json11 
(11 
source11 
)11 
;11  
}22 	
public33 

JsonResult33 
GetAllDataRole33 (
(33( )
string33) /
search330 6
,336 7
int338 ;
page33< @
,33@ A
int33B E
rowrowPerPage33F S
)33S T
{44 	
List55 
<55 
DropDownRole55 
>55 
dropDownRole55 +
=55, -
new55. 1
List552 6
<556 7
DropDownRole557 C
>55C D
(55D E
)55E F
;55F G
dropDownRole66 
=66 #
StoredProcedureExecutor66 2
.662 3 
ExecuteSPListNoParam663 G
<66G H
DropDownRole66H T
>66T U
(66U V
_context66V ^
,66^ _
$str66` x
)66x y
;66y z
var88 
RoleKode88 
=88 
int88 
.88 
Parse88 $
(88$ %
HttpContext88% 0
.880 1
Session881 8
.888 9
	GetString889 B
(88B C
SessionConstan88C Q
.88Q R
Session_RoleKode88R b
)88b c
)88c d
;88d e
if:: 
(:: 
RoleKode:: 
==:: 
$num:: 
):: 
{;; 
return<< 
Json<< 
(<< 
dropDownRole<< (
)<<( )
;<<) *
}== 
else>> 
{?? 
return@@ 
Json@@ 
(@@ 
dropDownRole@@ (
.@@( )
Where@@) .
(@@. /
m@@/ 0
=>@@1 3
m@@4 5
.@@5 6
id@@6 8
!=@@9 ;
$num@@< =
)@@= >
)@@> ?
;@@? @
}AA 
}BB 	
publicCC 

JsonResultCC  
GetAllDataParentMenuCC .
(CC. /
stringCC/ 5
searchCC6 <
,CC< =
intCC> A
pageCCB F
,CCF G
intCCH K

rowPerPageCCL V
)CCV W
{DD 	
DropDownParentListEE 
sourceEE %
=EE& '
newEE( +
DropDownParentListEE, >
(EE> ?
)EE? @
;EE@ A
sourceFF 
.FF 
itemsFF 
=FF 
newFF 
ListFF #
<FF# $
DropDownParentFF$ 2
>FF2 3
(FF3 4
)FF4 5
;FF5 6
sourceHH 
.HH 
itemsHH 
=HH #
StoredProcedureExecutorHH 2
.HH2 3
ExecuteSPListHH3 @
<HH@ A
DropDownParentHHA O
>HHO P
(HHP Q
_contextHHQ Y
,HHY Z
$strHH[ u
,HHu v
newHHw z
SqlParameter	HH{ á
[
HHá à
]
HHà â
{II 
newJJ 
SqlParameterJJ  
(JJ  !
$strJJ! -
,JJ- .
searchJJ/ 5
)JJ5 6
,JJ6 7
newKK 
SqlParameterKK  
(KK  !
$strKK! .
,KK. /
pageKK0 4
)KK4 5
,KK5 6
newLL 
SqlParameterLL  
(LL  !
$strLL! ,
,LL, -

rowPerPageLL. 8
)LL8 9
}MM 
)MM 
;MM 
sourceOO 
.OO 
total_countOO 
=OO  #
StoredProcedureExecutorOO! 8
.OO8 9
ExecuteScalarIntOO9 I
(OOI J
_contextOOJ R
,OOR S
$strOOT t
,OOt u
newOOv y
SqlParameter	OOz Ü
[
OOÜ á
]
OOá à
{PP 
newQQ 
SqlParameterQQ  
(QQ  !
$strQQ! -
,QQ- .
searchQQ/ 5
)QQ5 6
}RR 
)RR 
;RR 
returnTT 
JsonTT 
(TT 
sourceTT 
)TT 
;TT  
}UU 	
publicVV 

JsonResultVV $
GetDropdownRolesByMenuIdVV 2
(VV2 3
stringVV3 9
RolesVV: ?
)VV? @
{WW 	
lastSessionXX 
.XX 
UpdateXX 
(XX 
)XX  
;XX  !
ListYY 
<YY "
DataDropdownServerSideYY '
>YY' (
dataYY) -
=YY. /
newYY0 3
ListYY4 8
<YY8 9"
DataDropdownServerSideYY9 O
>YYO P
(YYP Q
)YYQ R
;YYR S
data[[ 
=[[ #
StoredProcedureExecutor[[ *
.[[* +
ExecuteSPList[[+ 8
<[[8 9"
DataDropdownServerSide[[9 O
>[[O P
([[P Q
_context[[Q Y
,[[Y Z
$str	[[[ Ä
,
[[Ä Å
new
[[Ç Ö
SqlParameter
[[Ü í
[
[[í ì
]
[[ì î
{
[[î ï
new\\ 
SqlParameter\\ (
(\\( )
$str\\) .
,\\. /
Roles\\0 5
)\\5 6
}\\6 7
)\\7 8
;\\8 9
return^^ 
Json^^ 
(^^ 
data^^ 
)^^ 
;^^ 
}__ 	
publiccc 

JsonResultcc )
GetAllDataDropdownCreditorRefcc 7
(cc7 8
stringcc8 >
qcc? @
,cc@ A
stringccB H
pageccI M
,ccM N
intccO R

rowPerPageccS ]
)cc] ^
{dd 	*
ListDataDropdownServerSideDevaff *
sourceff+ 1
=ff2 3
newff4 7*
ListDataDropdownServerSideDevaff8 V
(ffV W
)ffW X
;ffX Y
varhh 
Rowshh 
=hh 

rowPerPagehh !
>hh" #
$numhh$ &
?hh' (
$numhh) +
:hh+ ,

rowPerPagehh- 7
;hh7 8
varii 
Searchii 
=ii 
qii 
==ii 
nullii "
?ii# $
$strii% '
:ii( )
qii* +
;ii+ ,
tryjj 
{kk 
varll 
urlll 
=ll 
	GetConfigll #
.ll# $

AppSettingll$ .
[ll. /
$strll/ @
]ll@ A
+llB C
	GetConfigllD M
.llM N

AppSettingllN X
[llX Y
$strllY n
]lln o
+llp q
$strllr x
+lly z
Rowsll{ 
+
llÄ Å
$str
llÇ ä
+
llã å
int
llç ê
.
llê ë
Parse
llë ñ
(
llñ ó
page
lló õ
)
llõ ú
+
llù û
$str
llü ‰
+
llÂ Ê
Search
llÁ Ì
+
llÓ Ô
$str
ll Ù
;
llÙ ı
(mm 
boolmm 
	resultApimm 
,mm  
stringmm! '
resultmm( .
)mm. /
=mm0 1
RequestToAPImm2 >
.mm> ?
GetJsonStringWebApimm? R
(mmR S
urlmmS V
,mmV W
nullmmX \
)mm\ ]
;mm] ^
ifnn 
(nn 
	resultApinn 
&&nn  
!nn! "
stringnn" (
.nn( )
IsNullOrEmptynn) 6
(nn6 7
resultnn7 =
)nn= >
)nn> ?
{oo 
varpp 
jsonParseReturnpp '
=pp( )
JsonConvertpp* 5
.pp5 6
DeserializeObjectpp6 G
<ppG H
ResultStatusDataIntppH [
<pp[ \&
DataDropdownServerSideDevapp\ v
>ppv w
>ppw x
(ppx y
resultppy 
)	pp Ä
;
ppÄ Å
sourcerr 
.rr 
itemsrr  
=rr! "
jsonParseReturnrr# 2
.rr2 3
Valuerr3 8
;rr8 9
foreachss 
(ss 
varss  
itemss! %
inss& (
jsonParseReturnss) 8
.ss8 9
Valuess9 >
)ss> ?
{ss@ A
itemtt 
.tt 
idtt 
=tt  !
itemtt" &
.tt& '
CreditorReftt' 2
;tt2 3
itemuu 
.uu 
textuu !
=uu" #
itemuu$ (
.uu( )
CreditorRefuu) 4
;uu4 5
}vv 
sourceww 
.ww 
total_countww &
=ww' (
jsonParseReturnww) 8
.ww8 9

ODataCountww9 C
;wwC D
}xx 
}yy 
catchzz 
(zz 
	Exceptionzz 
Exzz 
)zz  
{{{ 
throw|| 
;|| 
}}} 
return 
Json 
( 
source 
) 
;  
}
ÄÄ 	
public
ÅÅ 

JsonResult
ÅÅ %
GetAllDataDropdownRekId
ÅÅ 1
(
ÅÅ1 2
string
ÅÅ2 8
q
ÅÅ9 :
,
ÅÅ: ;
string
ÅÅ< B
page
ÅÅC G
,
ÅÅG H
int
ÅÅI L

rowPerPage
ÅÅM W
)
ÅÅW X
{
ÇÇ 	,
ListDataDropdownServerSideDeva
ÑÑ *
source
ÑÑ+ 1
=
ÑÑ2 3
new
ÑÑ4 7,
ListDataDropdownServerSideDeva
ÑÑ8 V
(
ÑÑV W
)
ÑÑW X
;
ÑÑX Y
var
ÜÜ 
Rows
ÜÜ 
=
ÜÜ 

rowPerPage
ÜÜ !
>
ÜÜ" #
$num
ÜÜ$ &
?
ÜÜ' (
$num
ÜÜ) +
:
ÜÜ, -

rowPerPage
ÜÜ. 8
;
ÜÜ8 9
var
áá 
Search
áá 
=
áá 
q
áá 
==
áá 
null
áá "
?
áá# $
$str
áá% '
:
áá( )
q
áá* +
;
áá+ ,
try
àà 
{
ââ 
var
ää 
url
ää 
=
ää 
	GetConfig
ää #
.
ää# $

AppSetting
ää$ .
[
ää. /
$str
ää/ @
]
ää@ A
+
ääB C
	GetConfig
ääD M
.
ääM N

AppSetting
ääN X
[
ääX Y
$str
ääY h
]
ääh i
+
ääj k
$str
ääl r
+
ääs t
Rows
ääu y
+
ääz {
$strää| Ñ
+ääÖ Ü
intääá ä
.äää ã
Parseääã ê
(ääê ë
pageääë ï
)ääï ñ
+ääó ò
$strääô –
+ää— “
Searchää” Ÿ
+ää⁄ €
$strää‹ ‡
;ää‡ ·
(
ãã 
bool
ãã 
	resultApi
ãã 
,
ãã  
string
ãã! '
result
ãã( .
)
ãã. /
=
ãã0 1
RequestToAPI
ãã2 >
.
ãã> ?!
GetJsonStringWebApi
ãã? R
(
ããR S
url
ããS V
,
ããV W
null
ããX \
)
ãã\ ]
;
ãã] ^
if
åå 
(
åå 
	resultApi
åå 
&&
åå  
!
åå! "
string
åå" (
.
åå( )
IsNullOrEmpty
åå) 6
(
åå6 7
result
åå7 =
)
åå= >
)
åå> ?
{
çç 
var
éé 
jsonParseReturn
éé '
=
éé( )
JsonConvert
éé* 5
.
éé5 6
DeserializeObject
éé6 G
<
ééG H!
ResultStatusDataInt
ééH [
<
éé[ \(
DataDropdownServerSideDeva
éé\ v
>
éév w
>
ééw x
(
ééx y
result
ééy 
)éé Ä
;ééÄ Å
source
êê 
.
êê 
items
êê  
=
êê! "
jsonParseReturn
êê# 2
.
êê2 3
Value
êê3 8
;
êê8 9
foreach
ëë 
(
ëë 
var
ëë  
item
ëë! %
in
ëë& (
jsonParseReturn
ëë) 8
.
ëë8 9
Value
ëë9 >
)
ëë> ?
{
íí 
item
ìì 
.
ìì 
id
ìì 
=
ìì  !
item
ìì" &
.
ìì& '
RekId
ìì' ,
.
ìì, -
ToString
ìì- 5
(
ìì5 6
)
ìì6 7
;
ìì7 8
item
îî 
.
îî 
text
îî !
=
îî" #
item
îî$ (
.
îî( )
acc
îî) ,
;
îî, -
}
ïï 
source
ññ 
.
ññ 
total_count
ññ &
=
ññ' (
jsonParseReturn
ññ) 8
.
ññ8 9

ODataCount
ññ9 C
;
ññC D
}
óó 
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
Ex
ôô 
)
ôô  
{
öö 
throw
õõ 
;
õõ 
}
úú 
return
ûû 
Json
ûû 
(
ûû 
source
ûû 
)
ûû 
;
ûû  
}
üü 	
public
†† 

JsonResult
†† &
GetDataDetailCreditorRef
†† 2
(
††2 3
string
††3 9
CreditorRef
††: E
,
††E F
string
††G M
DueDate
††N U
)
††U V
{
°° 	
DateTime
¢¢ 
dateTime
¢¢ 
=
¢¢ 
DateTime
¢¢  (
.
¢¢( )

ParseExact
¢¢) 3
(
¢¢3 4
DueDate
¢¢4 ;
,
¢¢; <
$str
¢¢= I
,
¢¢I J
null
¢¢K O
)
¢¢O P
;
¢¢P Q
DateTimeOffset
££ 
dateTimeOffset
££ )
=
££* +
new
££, /
DateTimeOffset
££0 >
(
££> ?
dateTime
££? G
,
££G H
TimeSpan
££I Q
.
££Q R
Zero
££R V
)
££V W
;
££W X
string
§§ 
FinalDueDate
§§ 
=
§§  !
dateTimeOffset
§§" 0
.
§§0 1
ToString
§§1 9
(
§§9 :
$str
§§: P
)
§§P Q
;
§§Q R*
CreditorRefDetail_ViewModels
ßß (
source
ßß) /
=
ßß0 1
new
ßß2 5*
CreditorRefDetail_ViewModels
ßß6 R
(
ßßR S
)
ßßS T
;
ßßT U
try
©© 
{
™™ 
var
´´ 
url
´´ 
=
´´ 
	GetConfig
´´ #
.
´´# $

AppSetting
´´$ .
[
´´. /
$str
´´/ @
]
´´@ A
+
´´B C
	GetConfig
´´D M
.
´´M N

AppSetting
´´N X
[
´´X Y
$str
´´Y t
]
´´t u
+
´´v w
$str
´´x ~
+´´ Ä
$num´´Å É
+´´Ñ Ö
$str´´Ü é
+´´è ê
$num´´ë í
+´´ì î
$str´´ï œ
+´´– —
CreditorRef´´“ ›
+´´ﬁ ﬂ
$str´´‡ Ù
+´´ı ˆ
FinalDueDate´´˜ É
;´´É Ñ
(
¨¨ 
bool
¨¨ 
	resultApi
¨¨ 
,
¨¨  
string
¨¨! '
result
¨¨( .
)
¨¨. /
=
¨¨0 1
RequestToAPI
¨¨2 >
.
¨¨> ?!
GetJsonStringWebApi
¨¨? R
(
¨¨R S
url
¨¨S V
,
¨¨V W
null
¨¨X \
)
¨¨\ ]
;
¨¨] ^
if
≠≠ 
(
≠≠ 
	resultApi
≠≠ 
&&
≠≠  
!
≠≠! "
string
≠≠" (
.
≠≠( )
IsNullOrEmpty
≠≠) 6
(
≠≠6 7
result
≠≠7 =
)
≠≠= >
)
≠≠> ?
{
ÆÆ 
var
ØØ 
jsonParseReturn
ØØ '
=
ØØ( )
JsonConvert
ØØ* 5
.
ØØ5 6
DeserializeObject
ØØ6 G
<
ØØG H!
ResultStatusDataInt
ØØH [
<
ØØ[ \*
CreditorRefDetail_ViewModels
ØØ\ x
>
ØØx y
>
ØØy z
(
ØØz {
resultØØ{ Å
)ØØÅ Ç
;ØØÇ É
if
∞∞ 
(
∞∞ 
jsonParseReturn
∞∞ '
.
∞∞' (
Value
∞∞( -
.
∞∞- .
Count
∞∞. 3
(
∞∞3 4
)
∞∞4 5
!=
∞∞6 8
$num
∞∞9 :
)
∞∞: ;
{
±± 
source
≤≤ 
.
≤≤ 
Outstanding
≤≤ *
=
≤≤+ ,
jsonParseReturn
≤≤- <
.
≤≤< =
Value
≤≤= B
[
≤≤B C
$num
≤≤C D
]
≤≤D E
.
≤≤E F
Outstanding
≤≤F Q
;
≤≤Q R
source
≥≥ 
.
≥≥ 
	Principal
≥≥ (
=
≥≥) *
jsonParseReturn
≥≥+ :
.
≥≥: ;
Value
≥≥; @
[
≥≥@ A
$num
≥≥A B
]
≥≥B C
.
≥≥C D
	Principal
≥≥D M
;
≥≥M N
source
¥¥ 
.
¥¥ 
Interest
¥¥ '
=
¥¥( )
jsonParseReturn
¥¥* 9
.
¥¥9 :
Value
¥¥: ?
[
¥¥? @
$num
¥¥@ A
]
¥¥A B
.
¥¥B C
Interest
¥¥C K
;
¥¥K L
source
µµ 
.
µµ 
Fee
µµ "
=
µµ# $
jsonParseReturn
µµ% 4
.
µµ4 5
Value
µµ5 :
[
µµ: ;
$num
µµ; <
]
µµ< =
.
µµ= >
Fee
µµ> A
;
µµA B
}
∂∂ 
else
∑∑ 
{
∑∑ 
source
∏∏ 
.
∏∏ 
Outstanding
∏∏ *
=
∏∏+ ,
$num
∏∏- .
;
∏∏. /
source
ππ 
.
ππ 
	Principal
ππ (
=
ππ) *
$num
ππ+ ,
;
ππ, -
source
∫∫ 
.
∫∫ 
Interest
∫∫ '
=
∫∫( )
$num
∫∫* +
;
∫∫+ ,
source
ªª 
.
ªª 
Fee
ªª "
=
ªª# $
$num
ªª% &
;
ªª& '
}
ºº 
}
ΩΩ 
return
øø 
Json
øø 
(
øø 
source
øø "
)
øø" #
;
øø# $
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
Ex
¬¬ 
)
¬¬  
{
√√ 
throw
ƒƒ 
;
ƒƒ 
}
≈≈ 
}
∆∆ 	
}
»» 
}…… ¨◊
ND:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\ProfileController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public 

class 
ProfileController "
:# $

Controller% /
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 

IConverter #

_converter$ .
;. /
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public 
ProfileController  
(  !
IConfiguration! /
config0 6
,6 7%
DbDashboardDevaBniContext8 Q
contextR Y
,Y Z 
IHttpContextAccessor[ o
accessorp x
)x y
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return   
RedirectToAction   '
(  ' (
$str  ( /
,  / 0
$str  1 8
,  8 9
new  : =
{  > ?
a  @ A
=  B C
true  D H
}  I J
)  J K
;  K L
}!! 
var"" 
location"" 
="" 
new"" 
Uri"" "
(""" #
$"""# %
{""% &
Request""& -
.""- .
Scheme"". 4
}""4 5
$str""5 8
{""8 9
Request""9 @
.""@ A
Host""A E
}""E F
{""F G
Request""G N
.""N O
Path""O S
}""S T
"""T U
)""U V
;""V W
string## 
Path## 
=## 
location## "
.##" #
AbsolutePath### /
;##/ 0
ViewBag%% 
.%% 
CurrentPath%% 
=%%  !
Path%%" &
;%%& '
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
public(( 
IActionResult(( 
DataProfile(( (
(((( )
)(() *
{)) 	
if** 
(** 
!** 
lastSession** 
.** 
Update** #
(**# $
)**$ %
)**% &
{++ 
return,, 
RedirectToAction,, '
(,,' (
$str,,( /
,,,/ 0
$str,,1 8
,,,8 9
new,,: =
{,,> ?
a,,@ A
=,,B C
true,,D H
},,I J
),,J K
;,,K L
}-- 
var// 

resultData// 
=// 
new//  "
ResultStatusDataString//! 7
<//7 8
Profile_ViewModels//8 J
>//J K
(//K L
)//L M
;//M N
try11 
{22 
var33 
UserId33 
=33 
HttpContext33 (
.33( )
Session33) 0
.330 1
	GetString331 :
(33: ;
SessionConstan33; I
.33I J
Session_UserId33J X
)33X Y
;33Y Z
TblMasterUser44 
tblMasterUser44 +
=44, -
_context44. 6
.446 7
TblMasterUsers447 E
.44E F
Where44F K
(44K L
m44L M
=>44N P
m44Q R
.44R S
Id44S U
==44V X
int44Y \
.44\ ]
Parse44] b
(44b c
UserId44c i
)44i j
)44j k
.44k l
FirstOrDefault44l z
(44z {
)44{ |
;44| }
Profile_ViewModels55 "
data55# '
=55( )
new55* -
Profile_ViewModels55. @
(55@ A
)55A B
;55B C
data66 
.66 
Username66 
=66 
tblMasterUser66  -
.66- .
Username66. 6
;666 7
data77 
.77 
RoleName77 
=77 
_context77  (
.77( )
TblMasterRoles77) 7
.777 8
Where778 =
(77= >
m77> ?
=>77@ B
m77C D
.77D E
Id77E G
==77H J
tblMasterUser77K X
.77X Y
RoleId77Y _
)77_ `
.77` a
Select77a g
(77g h
m77h i
=>77i k
m77k l
.77l m
Name77m q
)77q r
.77r s
FirstOrDefault	77s Å
(
77Å Ç
)
77Ç É
;
77É Ñ
data88 
.88 
Name88 
=88 
tblMasterUser88 )
.88) *
Fullname88* 2
;882 3
data99 
.99 
Email99 
=99 
tblMasterUser99 *
.99* +
Email99+ 0
;990 1
data:: 
.:: 
NoHp:: 
=:: 
tblMasterUser:: )
.::) *
NoTelp::* 0
;::0 1
data;; 
.;; 
IsVerifEmail;; !
=;;" #
tblMasterUser;;$ 1
.;;1 2
IsVerifEmail;;2 >
==;;? A
$str;;B H
?;;I J
true;;K O
:;;P Q
false;;R W
;;;W X
data<< 
.<< 
IsVerifNoTelp<< "
=<<# $
tblMasterUser<<% 2
.<<2 3
IsVerifNoTelp<<3 @
==<<A C
$str<<D J
?<<K L
true<<M Q
:<<R S
false<<T Y
;<<Y Z

resultData>> 
.>> 

StatusCode>> %
=>>& '
$str>>( +
;>>+ ,

resultData?? 
.?? 
Message?? "
=??# $
$str??% -
;??- .

resultData@@ 
.@@ 
Data@@ 
=@@  !
data@@" &
;@@& '
returnBB 
JsonBB 
(BB 

resultDataBB &
)BB& '
;BB' (
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{EE 

resultDataFF 
.FF 

StatusCodeFF %
=FF& '
$strFF( +
;FF+ ,

resultDataGG 
.GG 
MessageGG "
=GG# $
	GetConfigGG% .
.GG. /

AppSettingGG/ 9
[GG9 :
$strGG: U
]GGU V
;GGV W
returnII 
JsonII 
(II 

resultDataII &
)II& '
;II' (
}JJ 
}KK 	
publicLL 
ResultStatusLL 
ValidateOtpLL '
(LL' (
stringLL( .
otpLL/ 2
,LL2 3
intLL4 7
typeLL8 <
)LL< =
{MM 	
varNN 

resultDataNN 
=NN 
newNN  
ResultStatusNN! -
(NN- .
)NN. /
;NN/ 0
varPP 
UsernamePP 
=PP 
HttpContextPP &
.PP& '
SessionPP' .
.PP. /
	GetStringPP/ 8
(PP8 9
SessionConstanPP9 G
.PPG H$
Session_Username_PegawaiPPH `
)PP` a
;PPa b
varQQ 
NoHPQQ 
=QQ 
HttpContextQQ "
.QQ" #
SessionQQ# *
.QQ* +
	GetStringQQ+ 4
(QQ4 5
SessionConstanQQ5 C
.QQC D
Session_NoHPQQD P
)QQP Q
;QQQ R
varRR 
EmailRR 
=RR 
HttpContextRR #
.RR# $
SessionRR$ +
.RR+ ,
	GetStringRR, 5
(RR5 6
SessionConstanRR6 D
.RRD E
Session_EmailRRE R
)RRR S
;RRS T
varSS 
RoleIdSS 
=SS 
HttpContextSS $
.SS$ %
SessionSS% ,
.SS, -
	GetStringSS- 6
(SS6 7
SessionConstanSS7 E
.SSE F
Session_RoleKodeSSF V
)SSV W
;SSW X
tryUU 
{VV 
	TblGetOtpWW 
dataOtpWW !
=WW" #
_contextWW$ ,
.WW, -

TblGetOtpsWW- 7
.WW7 8
WhereWW8 =
(WW= >
mWW> ?
=>WW@ B
mWWC D
.WWD E
UsernameWWE M
==WWN P
UsernameWWQ Y
)WWY Z
.WWZ [
FirstOrDefaultWW[ i
(WWi j
)WWj k
;WWk l
ifYY 
(YY 
dataOtpYY 
.YY 
ExpiredTimeYY '
<=YY( *
DateTimeYY+ 3
.YY3 4
NowYY4 7
)YY7 8
{ZZ 

resultData[[ 
.[[ 

StatusCode[[ )
=[[* +
$str[[, /
;[[/ 0

resultData\\ 
.\\ 
Message\\ &
=\\' (
$str\\) <
;\\< =

resultData]] 
.]] 
ValueGeneratorOtp]] 0
=]]1 2
type]]3 7
==]]8 :
$num]]; <
?]]= >
CensorEmail]]? J
(]]J K
Email]]K P
)]]P Q
:]]R S
CensorNumber]]T `
(]]` a
NoHP]]a e
)]]e f
;]]f g
return^^ 

resultData^^ %
;^^% &
}__ 
else`` 
if`` 
(`` 
dataOtp``  
.``  !
KodeOtp``! (
==``) +
otp``, /
)``/ 0
{aa 
ifbb 
(bb 
typebb 
==bb 
$numbb  !
)bb! "
{cc 
HttpContextdd #
.dd# $
Sessiondd$ +
.dd+ ,
	SetStringdd, 5
(dd5 6
SessionConstandd6 D
.ddD E 
Session_IsVerifEmailddE Y
,ddY Z
$strdd[ a
)dda b
;ddb c
TblMasterUseree %
TblMasterUseree& 3
=ee4 5
_contextee6 >
.ee> ?
TblMasterUsersee? M
.eeM N
WhereeeN S
(eeS T
meeT U
=>eeV X
meeY Z
.eeZ [
Usernameee[ c
==eed f
Usernameeeg o
)eeo p
.eep q
FirstOrDefaulteeq 
(	ee Ä
)
eeÄ Å
;
eeÅ Ç
TblMasterUserff %
.ff% &
IsVerifEmailff& 2
=ff3 4
$strff5 ;
;ff; <
_contextgg  
.gg  !
Entrygg! &
(gg& '
TblMasterUsergg' 4
)gg4 5
.gg5 6
Stategg6 ;
=gg< =
EntityStategg> I
.ggI J
ModifiedggJ R
;ggR S
_contexthh  
.hh  !
SaveChangeshh! ,
(hh, -
)hh- .
;hh. /
}ii 
elsejj 
{jj 
HttpContextkk #
.kk# $
Sessionkk$ +
.kk+ ,
	SetStringkk, 5
(kk5 6
SessionConstankk6 D
.kkD E!
Session_IsVerifNoTelpkkE Z
,kkZ [
$strkk\ b
)kkb c
;kkc d
TblMasterUserll %
TblMasterUserll& 3
=ll4 5
_contextll6 >
.ll> ?
TblMasterUsersll? M
.llM N
WherellN S
(llS T
mllT U
=>llV X
mllY Z
.llZ [
Usernamell[ c
==lld f
Usernamellg o
)llo p
.llp q
FirstOrDefaultllq 
(	ll Ä
)
llÄ Å
;
llÅ Ç
TblMasterUsermm %
.mm% &
IsVerifNoTelpmm& 3
=mm4 5
$strmm6 <
;mm< =
_contextnn  
.nn  !
Entrynn! &
(nn& '
TblMasterUsernn' 4
)nn4 5
.nn5 6
Statenn6 ;
=nn< =
EntityStatenn> I
.nnI J
ModifiednnJ R
;nnR S
_contextoo  
.oo  !
SaveChangesoo! ,
(oo, -
)oo- .
;oo. /
}pp 

resultDataqq 
.qq 

StatusCodeqq )
=qq* +
$strqq, /
;qq/ 0

resultDatarr 
.rr 
Messagerr &
=rr' (
$strrr) 3
;rr3 4

resultDatass 
.ss 
ValueGeneratorOtpss 0
=ss1 2
typess3 7
==ss8 :
$numss; <
?ss= >
CensorEmailss? J
(ssJ K
EmailssK P
)ssP Q
:ssR S
CensorNumberssT `
(ss` a
NoHPssa e
)sse f
;ssf g
returntt 

resultDatatt %
;tt% &
}uu 
elsevv 
{ww 

resultDataxx 
.xx 

StatusCodexx )
=xx* +
$strxx, /
;xx/ 0

resultDatayy 
.yy 
Messageyy &
=yy' (
$stryy) C
;yyC D

resultDatazz 
.zz 
ValueGeneratorOtpzz 0
=zz1 2
typezz3 7
==zz8 :
$numzz; <
?zz= >
CensorEmailzz? J
(zzJ K
EmailzzK P
)zzP Q
:zzR S
CensorNumberzzT `
(zz` a
NoHPzza e
)zze f
;zzf g
return{{ 

resultData{{ %
;{{% &
}|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 

resultData
ÄÄ 
.
ÄÄ 

StatusCode
ÄÄ %
=
ÄÄ& '
$str
ÄÄ( +
;
ÄÄ+ ,

resultData
ÅÅ 
.
ÅÅ 
Message
ÅÅ "
=
ÅÅ# $
	GetConfig
ÅÅ% .
.
ÅÅ. /

AppSetting
ÅÅ/ 9
[
ÅÅ9 :
$str
ÅÅ: U
]
ÅÅU V
;
ÅÅV W

resultData
ÇÇ 
.
ÇÇ 
ValueGeneratorOtp
ÇÇ ,
=
ÇÇ- .
type
ÇÇ/ 3
==
ÇÇ4 6
$num
ÇÇ7 8
?
ÇÇ9 :
CensorEmail
ÇÇ; F
(
ÇÇF G
Email
ÇÇG L
)
ÇÇL M
:
ÇÇN O
CensorNumber
ÇÇP \
(
ÇÇ\ ]
NoHP
ÇÇ] a
)
ÇÇa b
;
ÇÇb c
return
ÉÉ 

resultData
ÉÉ !
;
ÉÉ! "
}
ÑÑ 
}
ÖÖ 	
public
ÜÜ 
ResultStatus
ÜÜ 
ValidatePassword
ÜÜ ,
(
ÜÜ, -
string
ÜÜ- 3
password
ÜÜ4 <
)
ÜÜ< =
{
áá 	
var
àà 

resultData
àà 
=
àà 
new
àà  
ResultStatus
àà! -
(
àà- .
)
àà. /
;
àà/ 0
var
ââ 
UserId
ââ 
=
ââ 
HttpContext
ââ $
.
ââ$ %
Session
ââ% ,
.
ââ, -
	GetString
ââ- 6
(
ââ6 7
SessionConstan
ââ7 E
.
ââE F
Session_UserId
ââF T
)
ââT U
;
ââU V
try
ää 
{
ãã 
TblMasterUser
åå 
tblMasterUser
åå +
=
åå, -
_context
åå. 6
.
åå6 7
TblMasterUsers
åå7 E
.
ååE F
Where
ååF K
(
ååK L
m
ååL M
=>
ååN P
m
ååQ R
.
ååR S
Id
ååS U
==
ååV X
int
ååY \
.
åå\ ]
Parse
åå] b
(
ååb c
UserId
ååc i
)
ååi j
)
ååj k
.
ååk l
FirstOrDefault
åål z
(
ååz {
)
åå{ |
;
åå| }
var
çç 
ismatch
çç 
=
çç 
BCrypt
çç $
.
çç$ %
Net
çç% (
.
çç( )
BCrypt
çç) /
.
çç/ 0
Verify
çç0 6
(
çç6 7
password
çç7 ?
,
çç? @
tblMasterUser
ççA N
.
ççN O
Password
ççO W
)
ççW X
;
ççX Y
if
èè 
(
èè 
ismatch
èè 
)
èè 
{
êê 

resultData
ëë 
.
ëë 

StatusCode
ëë )
=
ëë* +
$str
ëë, /
;
ëë/ 0

resultData
íí 
.
íí 
Message
íí &
=
íí' (
$str
íí) 1
;
íí1 2
return
ìì 

resultData
ìì %
;
ìì% &
}
îî 
else
ïï 
{
ïï 

resultData
ññ 
.
ññ 

StatusCode
ññ )
=
ññ* +
$str
ññ, /
;
ññ/ 0

resultData
óó 
.
óó 
Message
óó &
=
óó' (
$str
óó) I
;
óóI J
return
òò 

resultData
òò %
;
òò% &
}
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
úú 

resultData
ùù 
.
ùù 

StatusCode
ùù %
=
ùù& '
$str
ùù( +
;
ùù+ ,

resultData
ûû 
.
ûû 
Message
ûû "
=
ûû# $
	GetConfig
ûû% .
.
ûû. /

AppSetting
ûû/ 9
[
ûû9 :
$str
ûû: U
]
ûûU V
;
ûûV W
return
üü 

resultData
üü !
;
üü! "
}
†† 
}
°° 	
public
¢¢ 
ResultStatus
¢¢ 
UpdateProfile
¢¢ )
(
¢¢) *
string
¢¢* 0
value
¢¢1 6
,
¢¢6 7
int
¢¢8 ;

changeWhat
¢¢< F
,
¢¢F G
int
¢¢H K
typeOtp
¢¢L S
)
¢¢S T
{
££ 	
var
§§ 

resultData
§§ 
=
§§ 
new
§§  
ResultStatus
§§! -
(
§§- .
)
§§. /
;
§§/ 0
var
•• 
UserId
•• 
=
•• 
HttpContext
•• $
.
••$ %
Session
••% ,
.
••, -
	GetString
••- 6
(
••6 7
SessionConstan
••7 E
.
••E F
Session_UserId
••F T
)
••T U
;
••U V
try
ßß 
{
®® 
TblMasterUser
©© 
tblMasterUser
©© +
=
©©, -
_context
©©. 6
.
©©6 7
TblMasterUsers
©©7 E
.
©©E F
Where
©©F K
(
©©K L
m
©©L M
=>
©©N P
m
©©Q R
.
©©R S
Id
©©S U
==
©©V X
int
©©Y \
.
©©\ ]
Parse
©©] b
(
©©b c
UserId
©©c i
)
©©i j
)
©©j k
.
©©k l
FirstOrDefault
©©l z
(
©©z {
)
©©{ |
;
©©| }
var
´´ 
model
´´ 
=
´´ 
new
´´ 
{
´´  !
email
´´" '
=
´´( )
$str
´´* ,
,
´´, -
noHP
´´. 2
=
´´3 4
$str
´´5 7
,
´´7 8
password
´´9 A
=
´´B C
$str
´´D F
,
´´F G
otpType
´´H O
=
´´P Q
$num
´´R S
}
´´T U
;
´´U V
if
¨¨ 
(
¨¨ 

changeWhat
¨¨ 
==
¨¨ !
$num
¨¨" #
)
¨¨# $
{
≠≠ 
tblMasterUser
ÆÆ !
.
ÆÆ! "
Email
ÆÆ" '
=
ÆÆ( )
value
ÆÆ* /
;
ÆÆ/ 0
tblMasterUser
ØØ !
.
ØØ! "
UpdatedById
ØØ" -
=
ØØ. /
int
ØØ0 3
.
ØØ3 4
Parse
ØØ4 9
(
ØØ9 :
UserId
ØØ: @
)
ØØ@ A
;
ØØA B
tblMasterUser
∞∞ !
.
∞∞! "
UpdatedTime
∞∞" -
=
∞∞. /
DateTime
∞∞0 8
.
∞∞8 9
Now
∞∞9 <
;
∞∞< =
_context
±± 
.
±± 
Entry
±± "
(
±±" #
tblMasterUser
±±# 0
)
±±0 1
.
±±1 2
State
±±2 7
=
±±8 9
EntityState
±±: E
.
±±E F
Modified
±±F N
;
±±N O
_context
≤≤ 
.
≤≤ 
SaveChanges
≤≤ (
(
≤≤( )
)
≤≤) *
;
≤≤* +
HttpContext
≥≥ 
.
≥≥  
Session
≥≥  '
.
≥≥' (
	SetString
≥≥( 1
(
≥≥1 2
SessionConstan
≥≥2 @
.
≥≥@ A
Session_Email
≥≥A N
,
≥≥N O
value
≥≥P U
)
≥≥U V
;
≥≥V W
}
¥¥ 
else
µµ 
if
µµ 
(
µµ 

changeWhat
µµ #
==
µµ$ &
$num
µµ' (
)
µµ( )
{
∂∂ 
tblMasterUser
∑∑ !
.
∑∑! "
NoTelp
∑∑" (
=
∑∑) *
value
∑∑+ 0
;
∑∑0 1
tblMasterUser
∏∏ !
.
∏∏! "
UpdatedById
∏∏" -
=
∏∏. /
int
∏∏0 3
.
∏∏3 4
Parse
∏∏4 9
(
∏∏9 :
UserId
∏∏: @
)
∏∏@ A
;
∏∏A B
tblMasterUser
ππ !
.
ππ! "
UpdatedTime
ππ" -
=
ππ. /
DateTime
ππ0 8
.
ππ8 9
Now
ππ9 <
;
ππ< =
_context
∫∫ 
.
∫∫ 
Entry
∫∫ "
(
∫∫" #
tblMasterUser
∫∫# 0
)
∫∫0 1
.
∫∫1 2
State
∫∫2 7
=
∫∫8 9
EntityState
∫∫: E
.
∫∫E F
Modified
∫∫F N
;
∫∫N O
_context
ªª 
.
ªª 
SaveChanges
ªª (
(
ªª( )
)
ªª) *
;
ªª* +
HttpContext
ºº 
.
ºº  
Session
ºº  '
.
ºº' (
	SetString
ºº( 1
(
ºº1 2
SessionConstan
ºº2 @
.
ºº@ A
Session_NoHP
ººA M
,
ººM N
value
ººO T
)
ººT U
;
ººU V
}
ΩΩ 
else
ææ 
if
ææ 
(
ææ 

changeWhat
ææ #
==
ææ$ &
$num
ææ' (
)
ææ( )
{
øø 
if
¿¿ 
(
¿¿ 
!
¿¿ 
RegexRequest
¿¿ %
.
¿¿% &
ValidatePassword
¿¿& 6
(
¿¿6 7
value
¿¿7 <
)
¿¿< =
)
¿¿= >
{
¡¡ 

resultData
¬¬ "
.
¬¬" #

StatusCode
¬¬# -
=
¬¬. /
$str
¬¬0 3
;
¬¬3 4

resultData
√√ "
.
√√" #
Message
√√# *
=
√√+ ,
$str
√√- E
;
√√E F
return
ƒƒ 

resultData
ƒƒ )
;
ƒƒ) *
}
≈≈ 
tblMasterUser
∆∆ !
.
∆∆! "
Password
∆∆" *
=
∆∆+ ,
BCrypt
∆∆- 3
.
∆∆3 4
Net
∆∆4 7
.
∆∆7 8
BCrypt
∆∆8 >
.
∆∆> ?
HashPassword
∆∆? K
(
∆∆K L
value
∆∆L Q
)
∆∆Q R
;
∆∆R S
tblMasterUser
«« !
.
««! "
UpdatedById
««" -
=
««. /
int
««0 3
.
««3 4
Parse
««4 9
(
««9 :
UserId
««: @
)
««@ A
;
««A B
tblMasterUser
»» !
.
»»! "
UpdatedTime
»»" -
=
»». /
DateTime
»»0 8
.
»»8 9
Now
»»9 <
;
»»< =
_context
…… 
.
…… 
Entry
…… "
(
……" #
tblMasterUser
……# 0
)
……0 1
.
……1 2
State
……2 7
=
……8 9
EntityState
……: E
.
……E F
Modified
……F N
;
……N O
_context
   
.
   
SaveChanges
   (
(
  ( )
)
  ) *
;
  * +
}
ÀÀ 

resultData
ÕÕ 
.
ÕÕ 

StatusCode
ÕÕ %
=
ÕÕ& '
$str
ÕÕ( +
;
ÕÕ+ ,

resultData
ŒŒ 
.
ŒŒ 
Message
ŒŒ "
=
ŒŒ# $
$str
ŒŒ% -
;
ŒŒ- .
return
œœ 

resultData
œœ !
;
œœ! "
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
““ 

resultData
”” 
.
”” 

StatusCode
”” %
=
””& '
$str
””( +
;
””+ ,

resultData
‘‘ 
.
‘‘ 
Message
‘‘ "
=
‘‘# $
	GetConfig
‘‘% .
.
‘‘. /

AppSetting
‘‘/ 9
[
‘‘9 :
$str
‘‘: U
]
‘‘U V
;
‘‘V W
return
’’ 

resultData
’’ !
;
’’! "
}
÷÷ 
}
◊◊ 	
static
ÿÿ 
string
ÿÿ 
CensorEmail
ÿÿ !
(
ÿÿ! "
string
ÿÿ" (
email
ÿÿ) .
)
ÿÿ. /
{
ŸŸ 	
string
€€ 
[
€€ 
]
€€ 
parts
€€ 
=
€€ 
email
€€ "
.
€€" #
Split
€€# (
(
€€( )
$char
€€) ,
)
€€, -
;
€€- .
string
ﬁﬁ 
censoredUsername
ﬁﬁ #
=
ﬁﬁ$ %
parts
ﬁﬁ& +
[
ﬁﬁ+ ,
$num
ﬁﬁ, -
]
ﬁﬁ- .
[
ﬁﬁ. /
$num
ﬁﬁ/ 0
]
ﬁﬁ0 1
+
ﬁﬁ2 3
new
ﬁﬁ4 7
string
ﬁﬁ8 >
(
ﬁﬁ> ?
$char
ﬁﬁ? B
,
ﬁﬁB C
parts
ﬁﬁD I
[
ﬁﬁI J
$num
ﬁﬁJ K
]
ﬁﬁK L
.
ﬁﬁL M
Length
ﬁﬁM S
)
ﬁﬁS T
;
ﬁﬁT U
string
·· 
censoredDomain
·· !
=
··" #
parts
··$ )
[
··) *
$num
··* +
]
··+ ,
[
··, -
$num
··- .
]
··. /
+
··0 1
new
··2 5
string
··6 <
(
··< =
$char
··= @
,
··@ A
parts
··B G
[
··G H
$num
··H I
]
··I J
.
··J K
Length
··K Q
)
··Q R
;
··R S
return
‰‰ 
$"
‰‰ 
{
‰‰ 
censoredUsername
‰‰ &
}
‰‰& '
$str
‰‰' (
{
‰‰( )
censoredDomain
‰‰) 7
}
‰‰7 8
"
‰‰8 9
;
‰‰9 :
}
ÂÂ 	
static
ÊÊ 
string
ÊÊ 
CensorNumber
ÊÊ "
(
ÊÊ" #
string
ÊÊ# )
number
ÊÊ* 0
)
ÊÊ0 1
{
ÁÁ 	
int
ÈÈ 
length
ÈÈ 
=
ÈÈ 
number
ÈÈ 
.
ÈÈ  
Length
ÈÈ  &
;
ÈÈ& '
string
ÏÏ 
censoredPart
ÏÏ 
=
ÏÏ  !
new
ÏÏ" %
string
ÏÏ& ,
(
ÏÏ, -
$char
ÏÏ- 0
,
ÏÏ0 1
length
ÏÏ2 8
-
ÏÏ9 :
$num
ÏÏ; <
)
ÏÏ< =
+
ÏÏ> ?
$str
ÏÏ@ C
+
ÏÏD E
new
ÏÏF I
string
ÏÏJ P
(
ÏÏP Q
$char
ÏÏQ T
,
ÏÏT U
$num
ÏÏV W
)
ÏÏW X
+
ÏÏY Z
$str
ÏÏ[ ^
+
ÏÏ_ `
number
ÏÏa g
.
ÏÏg h
	Substring
ÏÏh q
(
ÏÏq r
length
ÏÏr x
-
ÏÏy z
$num
ÏÏ{ |
)
ÏÏ| }
;
ÏÏ} ~
return
ÓÓ 
censoredPart
ÓÓ 
;
ÓÓ  
}
ÔÔ 	
}
 
}ÒÒ ⁄∆
VD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\NoticeOfPaymentController.cs
	namespace&& 	
DashboardDevaBNI&&
 
.&& 
Controllers&& &
{'' 
public(( 

class(( %
NoticeOfPaymentController(( *
:((+ ,

Controller((- 7
{)) 
private** 
readonly** %
DbDashboardDevaBniContext** 2
_context**3 ;
;**; <
private++ 
readonly++ 
IConfiguration++ '
_configuration++( 6
;++6 7
private,, 
readonly,, 

IConverter,, #

_converter,,$ .
;,,. /
private-- 
readonly-- 
LastSessionLog-- '
lastSession--( 3
;--3 4
private.. 
readonly.. 
AccessSecurity.. '
accessSecurity..( 6
;..6 7
public// %
NoticeOfPaymentController// (
(//( )
IConfiguration//) 7
config//8 >
,//> ?%
DbDashboardDevaBniContext//@ Y
context//Z a
,//a b 
IHttpContextAccessor//c w
accessor	//x Ä
)
//Ä Å
{00 	
_context11 
=11 
context11 
;11 
_configuration22 
=22 
config22 #
;22# $
lastSession33 
=33 
new33 
LastSessionLog33 ,
(33, -
accessor33- 5
,335 6
context337 >
,33> ?
config33@ F
)33F G
;33G H
accessSecurity44 
=44 
new44  
AccessSecurity44! /
(44/ 0
accessor440 8
,448 9
context44: A
,44A B
config44C I
)44I J
;44J K
}55 	
public77 
IActionResult77 
Index77 "
(77" #
)77# $
{88 	
if99 
(99 
!99 
lastSession99 
.99 
Update99 #
(99# $
)99$ %
)99% &
{:: 
return;; 
RedirectToAction;; '
(;;' (
$str;;( /
,;;/ 0
	GetConfig;;1 :
.;;: ;

AppSetting;;; E
[;;E F
$str;;F n
];;n o
+;;p q
$str;;r y
,;;y z
new;;{ ~
{	;; Ä
a
;;Å Ç
=
;;É Ñ
true
;;Ö â
}
;;ä ã
)
;;ã å
;
;;å ç
}<< 
var== 
location== 
=== 
new== 
Uri== "
(==" #
$"==# %
{==% &
Request==& -
.==- .
Scheme==. 4
}==4 5
$str==5 8
{==8 9
Request==9 @
.==@ A
Host==A E
}==E F
{==F G
Request==G N
.==N O
Path==O S
}==S T
"==T U
)==U V
;==V W
string>> 
Path>> 
=>> 
location>> "
.>>" #
AbsolutePath>># /
;>>/ 0
if?? 
(?? 
!?? 
accessSecurity?? 
.??  
IsGetAccess??  +
(??+ ,
$str??, 0
+??1 2
Path??3 7
)??7 8
)??8 9
{@@ 
returnAA 
RedirectToActionAA '
(AA' (
$strAA( 3
,AA3 4
	GetConfigAA5 >
.AA> ?

AppSettingAA? I
[AAI J
$strAAJ r
]AAr s
+AAt u
$strAAv }
)AA} ~
;AA~ 
}BB 
ViewBagDD 
.DD 
CurrentPathDD 
=DD  !
PathDD" &
;DD& '
ViewBagEE 
.EE 

PengumumanEE 
=EE  
_contextEE! )
.EE) *%
TblMasterSystemParametersEE* C
.EEC D
WhereEED I
(EEI J
xEEJ K
=>EEL N
xEEO P
.EEP Q
KeyEEQ T
==EEU W
$strEEX d
)EEd e
.EEe f
SelectEEf l
(EEl m
xEEm n
=>EEo q
xEEr s
.EEs t
ValueEEt y
)EEy z
.EEz {
FirstOrDefault	EE{ â
(
EEâ ä
)
EEä ã
;
EEã å
ViewBagFF 
.FF 
SpeedFF 
=FF 
intFF 
.FF  
ParseFF  %
(FF% &
_contextFF& .
.FF. /%
TblMasterSystemParametersFF/ H
.FFH I
WhereFFI N
(FFN O
xFFO P
=>FFQ S
xFFT U
.FFU V
KeyFFV Y
==FFZ \
$strFF] d
)FFd e
.FFe f
SelectFFf l
(FFl m
xFFm n
=>FFo q
xFFr s
.FFs t
ValueFFt y
)FFy z
.FFz {
FirstOrDefault	FF{ â
(
FFâ ä
)
FFä ã
)
FFã å
;
FFå ç
returnGG 
ViewGG 
(GG 
)GG 
;GG 
}HH 	
[KK 	
HttpPostKK	 
]KK 
publicLL 
IActionResultLL 
LoadDataLL %
(LL% &
)LL& '
{MM 	
ifNN 
(NN 
!NN 
lastSessionNN 
.NN 
UpdateNN #
(NN# $
)NN$ %
)NN% &
{OO 
returnPP 
RedirectToActionPP '
(PP' (
$strPP( /
,PP/ 0
	GetConfigPP1 :
.PP: ;

AppSettingPP; E
[PPE F
$strPPF n
]PPn o
+PPp q
$strPPr y
,PPy z
newPP{ ~
{	PP Ä
a
PPÅ Ç
=
PPÉ Ñ
true
PPÖ â
}
PPä ã
)
PPã å
;
PPå ç
}QQ 
varRR 
locationRR 
=RR 
newRR 
UriRR "
(RR" #
$"RR# %
{RR% &
RequestRR& -
.RR- .
SchemeRR. 4
}RR4 5
$strRR5 8
{RR8 9
RequestRR9 @
.RR@ A
HostRRA E
}RRE F
{RRF G
RequestRRG N
.RRN O
PathRRO S
}RRS T
"RRT U
)RRU V
;RRV W
stringSS 
PathSS 
=SS 
locationSS "
.SS" #
AbsolutePathSS# /
.SS/ 0
ReplaceSS0 7
(SS7 8
thisSS8 <
.SS< =
ControllerContextSS= N
.SSN O
	RouteDataSSO X
.SSX Y
ValuesSSY _
[SS_ `
$strSS` h
]SSh i
.SSi j
ToStringSSj r
(SSr s
)SSs t
,SSt u
$strSSv }
)SS} ~
;SS~ 
ifTT 
(TT 
!TT 
accessSecurityTT 
.TT  
IsGetAccessTT  +
(TT+ ,
$strTT, 0
+TT1 2
PathTT3 7
)TT7 8
)TT8 9
{UU 
returnVV 
RedirectToActionVV '
(VV' (
$strVV( 3
,VV3 4
$strVV5 <
)VV< =
;VV= >
}WW 
tryYY 
{ZZ 
var[[ 
dict[[ 
=[[ 
Request[[ "
.[[" #
Form[[# '
.[[' (
ToDictionary[[( 4
([[4 5
x[[5 6
=>[[7 9
x[[: ;
.[[; <
Key[[< ?
,[[? @
x[[A B
=>[[C E
x[[F G
.[[G H
Value[[H M
.[[M N
ToString[[N V
([[V W
)[[W X
)[[X Y
;[[Y Z
var]] 
draw]] 
=]] 
dict]] 
[]]  
$str]]  &
]]]& '
;]]' (
var`` 
start`` 
=`` 
dict``  
[``  !
$str``! (
]``( )
;``) *
varaa 
lengthaa 
=aa 
dictaa !
[aa! "
$straa" *
]aa* +
;aa+ ,
varee 

pageNumberee 
=ee  
(ee! "
intee" %
.ee% &
Parseee& +
(ee+ ,
startee, 1
)ee1 2
/ee3 4
intee5 8
.ee8 9
Parseee9 >
(ee> ?
lengthee? E
)eeE F
)eeF G
+eeH I
$numeeJ K
;eeK L
varhh 

sortColumnhh 
=hh  
dicthh! %
[hh% &
$strhh& 0
+hh1 2
dicthh3 7
[hh7 8
$strhh8 J
]hhJ K
+hhL M
$strhhN W
]hhW X
;hhX Y
varii 
sortColumnDirii !
=ii" #
dictii$ (
[ii( )
$strii) 8
]ii8 9
;ii9 :
varjj 
NopNoSearchParamjj $
=jj% &
dictjj' +
[jj+ ,
$strjj, G
]jjG H
;jjH I
varkk 
DueDatekk 
=kk 
dictkk "
[kk" #
$strkk# >
]kk> ?
;kk? @
intoo 
pageSizeoo 
=oo 
lengthoo %
!=oo& (
nulloo) -
?oo. /
Convertoo0 7
.oo7 8
ToInt32oo8 ?
(oo? @
lengthoo@ F
)ooF G
:ooH I
$numooJ K
;ooK L
intpp 
skippp 
=pp 
startpp  
!=pp! #
nullpp$ (
?pp) *
Convertpp+ 2
.pp2 3
ToInt32pp3 :
(pp: ;
startpp; @
)pp@ A
:ppB C
$numppD E
;ppE F
intqq 
recordsTotalqq  
=qq! "
$numqq# $
;qq$ %
CultureInfoss 
culturess #
=ss$ %
newss& )
CultureInfoss* 5
(ss5 6
$strss6 =
)ss= >
;ss> ?
vartt 
	dateArraytt 
=tt 
newtt  #
stringtt$ *
[tt* +
]tt+ ,
{tt- .
}tt/ 0
;tt0 1
ifvv 
(vv 
!vv 
stringvv 
.vv 
IsNullOrEmptyvv )
(vv) *
DueDatevv* 1
)vv1 2
)vv2 3
{ww 
	dateArrayxx 
=xx 
DueDatexx  '
.xx' (
Splitxx( -
(xx- .
$strxx. 4
)xx4 5
;xx5 6
}yy 
List{{ 
<{{ %
NoticeOfPayment_ViewModel{{ .
>{{. /
list{{0 4
={{5 6
new{{7 :
List{{; ?
<{{? @%
NoticeOfPayment_ViewModel{{@ Y
>{{Y Z
({{Z [
){{[ \
;{{\ ]
list|| 
=|| #
StoredProcedureExecutor|| .
.||. /
ExecuteSPList||/ <
<||< =%
NoticeOfPayment_ViewModel||= V
>||V W
(||W X
_context||X `
,||` a
$str	||b Ä
,
||Ä Å
new
||Ç Ö
SqlParameter
||Ü í
[
||í ì
]
||ì î
{
||î ï
new}} 
SqlParameter}} (
(}}( )
$str}}) 1
,}}1 2
NopNoSearchParam}}3 C
)}}C D
,}}D E
new~~ 
SqlParameter~~ (
(~~( )
$str~~) 7
,~~7 8
	dateArray~~9 B
.~~B C
Count~~C H
(~~H I
)~~I J
==~~K M
$num~~N O
?~~P Q
$str~~R T
:~~U V
DateTime~~W _
.~~_ `
Parse~~` e
(~~e f
	dateArray~~f o
[~~o p
$num~~p q
]~~q r
,~~r s
culture~~t {
)~~{ |
)~~| }
,~~} ~
new 
SqlParameter (
(( )
$str) 5
,5 6
	dateArray7 @
.@ A
CountA F
(F G
)G H
==I K
$numL M
?N O
$strP R
:S T
DateTimeU ]
.] ^
Parse^ c
(c d
	dateArrayd m
[m n
$numn o
]o p
,p q
culturer y
)y z
)z {
,{ |
new
ÄÄ 
SqlParameter
ÄÄ (
(
ÄÄ( )
$str
ÄÄ) 6
,
ÄÄ6 7

sortColumn
ÄÄ8 B
)
ÄÄB C
,
ÄÄC D
new
ÅÅ 
SqlParameter
ÅÅ (
(
ÅÅ( )
$str
ÅÅ) 9
,
ÅÅ9 :
sortColumnDir
ÅÅ; H
)
ÅÅH I
,
ÅÅI J
new
ÇÇ 
SqlParameter
ÇÇ (
(
ÇÇ( )
$str
ÇÇ) 6
,
ÇÇ6 7

pageNumber
ÇÇ8 B
)
ÇÇB C
,
ÇÇC D
new
ÉÉ 
SqlParameter
ÉÉ (
(
ÉÉ( )
$str
ÉÉ) 4
,
ÉÉ4 5
pageSize
ÉÉ6 >
)
ÉÉ> ?
}
ÉÉ? @
)
ÉÉ@ A
;
ÉÉA B
recordsTotal
ÖÖ 
=
ÖÖ %
StoredProcedureExecutor
ÖÖ 6
.
ÖÖ6 7
ExecuteScalarInt
ÖÖ7 G
(
ÖÖG H
_context
ÖÖH P
,
ÖÖP Q
$str
ÖÖR q
,
ÖÖq r
new
ÖÖs v
SqlParameterÖÖw É
[ÖÖÉ Ñ
]ÖÖÑ Ö
{ÖÖÖ Ü
new
ÜÜ 
SqlParameter
ÜÜ (
(
ÜÜ( )
$str
ÜÜ) 1
,
ÜÜ1 2
NopNoSearchParam
ÜÜ3 C
)
ÜÜC D
,
ÜÜD E
new
áá 
SqlParameter
áá (
(
áá( )
$str
áá) 7
,
áá7 8
	dateArray
áá9 B
.
ááB C
Count
ááC H
(
ááH I
)
ááI J
==
ááK M
$num
ááN O
?
ááP Q
$str
ááR T
:
ááU V
DateTime
ááW _
.
áá_ `
Parse
áá` e
(
ááe f
	dateArray
ááf o
[
ááo p
$num
ááp q
]
ááq r
,
áár s
culture
áát {
)
áá{ |
)
áá| }
,
áá} ~
new
àà 
SqlParameter
àà (
(
àà( )
$str
àà) 5
,
àà5 6
	dateArray
àà7 @
.
àà@ A
Count
ààA F
(
ààF G
)
ààG H
==
ààI K
$num
ààL M
?
ààN O
$str
ààP R
:
ààS T
DateTime
ààU ]
.
àà] ^
Parse
àà^ c
(
ààc d
	dateArray
ààd m
[
ààm n
$num
ààn o
]
àào p
,
ààp q
culture
ààr y
)
àày z
)
ààz {
,
àà{ |
}
ââ 
)
ââ 
;
ââ 
if
ãã 
(
ãã 
list
ãã 
==
ãã 
null
ãã  
)
ãã  !
{
åå 
list
çç 
=
çç 
new
çç 
List
çç #
<
çç# $'
NoticeOfPayment_ViewModel
çç$ =
>
çç= >
(
çç> ?
)
çç? @
;
çç@ A
recordsTotal
éé  
=
éé! "
$num
éé# $
;
éé$ %
}
èè 
return
ëë 
Json
ëë 
(
ëë 
new
ëë 
{
ëë  !
draw
ëë" &
=
ëë' (
draw
ëë) -
,
ëë- .
recordsFiltered
ëë/ >
=
ëë? @
recordsTotal
ëëA M
,
ëëM N
recordsTotal
ëëO [
=
ëë\ ]
recordsTotal
ëë^ j
,
ëëj k
data
ëël p
=
ëëq r
list
ëës w
}
ëëx y
)
ëëy z
;
ëëz {
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì 
Ex
ìì 
)
ìì  
{
îî 
throw
ïï 
;
ïï 
}
ññ 
}
óó 	
[
öö 	
HttpPost
öö	 
]
öö 
public
õõ 
IActionResult
õõ #
LoadDataDetailNopTemp
õõ 2
(
õõ2 3
string
õõ3 9
randomstring
õõ: F
)
õõF G
{
úú 	
if
ùù 
(
ùù 
!
ùù 
lastSession
ùù 
.
ùù 
Update
ùù #
(
ùù# $
)
ùù$ %
)
ùù% &
{
ûû 
return
üü 
RedirectToAction
üü '
(
üü' (
$str
üü( /
,
üü/ 0
	GetConfig
üü1 :
.
üü: ;

AppSetting
üü; E
[
üüE F
$str
üüF n
]
üün o
+
üüp q
$str
üür y
,
üüy z
new
üü{ ~
{üü Ä
aüüÅ Ç
=üüÉ Ñ
trueüüÖ â
}üüä ã
)üüã å
;üüå ç
}
†† 
var
°° 
location
°° 
=
°° 
new
°° 
Uri
°° "
(
°°" #
$"
°°# %
{
°°% &
Request
°°& -
.
°°- .
Scheme
°°. 4
}
°°4 5
$str
°°5 8
{
°°8 9
Request
°°9 @
.
°°@ A
Host
°°A E
}
°°E F
{
°°F G
Request
°°G N
.
°°N O
Path
°°O S
}
°°S T
"
°°T U
)
°°U V
;
°°V W
string
¢¢ 
Path
¢¢ 
=
¢¢ 
location
¢¢ "
.
¢¢" #
AbsolutePath
¢¢# /
.
¢¢/ 0
Replace
¢¢0 7
(
¢¢7 8
this
¢¢8 <
.
¢¢< =
ControllerContext
¢¢= N
.
¢¢N O
	RouteData
¢¢O X
.
¢¢X Y
Values
¢¢Y _
[
¢¢_ `
$str
¢¢` h
]
¢¢h i
.
¢¢i j
ToString
¢¢j r
(
¢¢r s
)
¢¢s t
,
¢¢t u
$str
¢¢v }
)
¢¢} ~
;
¢¢~ 
if
££ 
(
££ 
!
££ 
accessSecurity
££ 
.
££  
IsGetAccess
££  +
(
££+ ,
$str
££, 0
+
££1 2
Path
££3 7
)
££7 8
)
££8 9
{
§§ 
return
•• 
RedirectToAction
•• '
(
••' (
$str
••( 3
,
••3 4
$str
••5 <
)
••< =
;
••= >
}
¶¶ 
try
®® 
{
©© 
var
™™ 
dict
™™ 
=
™™ 
Request
™™ "
.
™™" #
Form
™™# '
.
™™' (
ToDictionary
™™( 4
(
™™4 5
x
™™5 6
=>
™™7 9
x
™™: ;
.
™™; <
Key
™™< ?
,
™™? @
x
™™A B
=>
™™C E
x
™™F G
.
™™G H
Value
™™H M
.
™™M N
ToString
™™N V
(
™™V W
)
™™W X
)
™™X Y
;
™™Y Z
var
¨¨ 
draw
¨¨ 
=
¨¨ 
dict
¨¨ 
[
¨¨  
$str
¨¨  &
]
¨¨& '
;
¨¨' (
var
ØØ 
start
ØØ 
=
ØØ 
dict
ØØ  
[
ØØ  !
$str
ØØ! (
]
ØØ( )
;
ØØ) *
var
∞∞ 
length
∞∞ 
=
∞∞ 
dict
∞∞ !
[
∞∞! "
$str
∞∞" *
]
∞∞* +
;
∞∞+ ,
var
¥¥ 

pageNumber
¥¥ 
=
¥¥  
(
¥¥! "
int
¥¥" %
.
¥¥% &
Parse
¥¥& +
(
¥¥+ ,
start
¥¥, 1
)
¥¥1 2
/
¥¥3 4
int
¥¥5 8
.
¥¥8 9
Parse
¥¥9 >
(
¥¥> ?
length
¥¥? E
)
¥¥E F
)
¥¥F G
+
¥¥H I
$num
¥¥J K
;
¥¥K L
var
∑∑ 

sortColumn
∑∑ 
=
∑∑  
dict
∑∑! %
[
∑∑% &
$str
∑∑& 0
+
∑∑1 2
dict
∑∑3 7
[
∑∑7 8
$str
∑∑8 J
]
∑∑J K
+
∑∑L M
$str
∑∑N W
]
∑∑W X
;
∑∑X Y
var
∏∏ 
sortColumnDir
∏∏ !
=
∏∏" #
dict
∏∏$ (
[
∏∏( )
$str
∏∏) 8
]
∏∏8 9
;
∏∏9 :
int
ªª 
pageSize
ªª 
=
ªª 
length
ªª %
!=
ªª& (
null
ªª) -
?
ªª. /
Convert
ªª0 7
.
ªª7 8
ToInt32
ªª8 ?
(
ªª? @
length
ªª@ F
)
ªªF G
:
ªªH I
$num
ªªJ K
;
ªªK L
int
ºº 
skip
ºº 
=
ºº 
start
ºº  
!=
ºº! #
null
ºº$ (
?
ºº) *
Convert
ºº+ 2
.
ºº2 3
ToInt32
ºº3 :
(
ºº: ;
start
ºº; @
)
ºº@ A
:
ººB C
$num
ººD E
;
ººE F
int
ΩΩ 
recordsTotal
ΩΩ  
=
ΩΩ! "
$num
ΩΩ# $
;
ΩΩ$ %
List
øø 
<
øø '
NoticeOfPayment_ViewModel
øø .
>
øø. /
list
øø0 4
=
øø5 6
new
øø7 :
List
øø; ?
<
øø? @'
NoticeOfPayment_ViewModel
øø@ Y
>
øøY Z
(
øøZ [
)
øø[ \
;
øø\ ]
list
¡¡ 
=
¡¡ %
StoredProcedureExecutor
¡¡ .
.
¡¡. /
ExecuteSPList
¡¡/ <
<
¡¡< ='
NoticeOfPayment_ViewModel
¡¡= V
>
¡¡V W
(
¡¡W X
_context
¡¡X `
,
¡¡` a
$str¡¡b ä
,¡¡ä ã
new¡¡å è
SqlParameter¡¡ê ú
[¡¡ú ù
]¡¡ù û
{¡¡û ü
new
¬¬ 
SqlParameter
¬¬ (
(
¬¬( )
$str
¬¬) 8
,
¬¬8 9
randomstring
¬¬: F
)
¬¬F G
,
¬¬G H
new
√√ 
SqlParameter
√√ (
(
√√( )
$str
√√) 6
,
√√6 7

sortColumn
√√8 B
)
√√B C
,
√√C D
new
ƒƒ 
SqlParameter
ƒƒ (
(
ƒƒ( )
$str
ƒƒ) 9
,
ƒƒ9 :
sortColumnDir
ƒƒ; H
)
ƒƒH I
,
ƒƒI J
new
≈≈ 
SqlParameter
≈≈ (
(
≈≈( )
$str
≈≈) 6
,
≈≈6 7

pageNumber
≈≈8 B
)
≈≈B C
,
≈≈C D
new
∆∆ 
SqlParameter
∆∆ (
(
∆∆( )
$str
∆∆) 4
,
∆∆4 5
pageSize
∆∆6 >
)
∆∆> ?
}
∆∆? @
)
∆∆@ A
;
∆∆A B
recordsTotal
»» 
=
»» %
StoredProcedureExecutor
»» 6
.
»»6 7
ExecuteScalarInt
»»7 G
(
»»G H
_context
»»H P
,
»»P Q
$str
»»R {
,
»»{ |
new»»} Ä
SqlParameter»»Å ç
[»»ç é
]»»é è
{»»è ê
new
…… 
SqlParameter
…… (
(
……( )
$str
……) 8
,
……8 9
randomstring
……: F
)
……F G
,
……G H
}
   
)
   
;
   
if
ÃÃ 
(
ÃÃ 
list
ÃÃ 
==
ÃÃ 
null
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
list
ŒŒ 
=
ŒŒ 
new
ŒŒ 
List
ŒŒ #
<
ŒŒ# $'
NoticeOfPayment_ViewModel
ŒŒ$ =
>
ŒŒ= >
(
ŒŒ> ?
)
ŒŒ? @
;
ŒŒ@ A
recordsTotal
œœ  
=
œœ! "
$num
œœ# $
;
œœ$ %
}
–– 
return
““ 
Json
““ 
(
““ 
new
““ 
{
““  !
draw
““" &
=
““' (
draw
““) -
,
““- .
recordsFiltered
““/ >
=
““? @
recordsTotal
““A M
,
““M N
recordsTotal
““O [
=
““\ ]
recordsTotal
““^ j
,
““j k
data
““l p
=
““q r
list
““s w
}
““x y
)
““y z
;
““z {
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
Ex
‘‘ 
)
‘‘  
{
’’ 
throw
÷÷ 
;
÷÷ 
}
◊◊ 
}
ÿÿ 	
public
⁄⁄ 
IActionResult
⁄⁄ 
LoadDataDetailNop
⁄⁄ .
(
⁄⁄. /
string
⁄⁄/ 5
NopId
⁄⁄6 ;
)
⁄⁄; <
{
€€ 	
if
‹‹ 
(
‹‹ 
!
‹‹ 
lastSession
‹‹ 
.
‹‹ 
Update
‹‹ #
(
‹‹# $
)
‹‹$ %
)
‹‹% &
{
›› 
return
ﬁﬁ 
RedirectToAction
ﬁﬁ '
(
ﬁﬁ' (
$str
ﬁﬁ( /
,
ﬁﬁ/ 0
	GetConfig
ﬁﬁ1 :
.
ﬁﬁ: ;

AppSetting
ﬁﬁ; E
[
ﬁﬁE F
$str
ﬁﬁF n
]
ﬁﬁn o
+
ﬁﬁp q
$str
ﬁﬁr y
,
ﬁﬁy z
new
ﬁﬁ{ ~
{ﬁﬁ Ä
aﬁﬁÅ Ç
=ﬁﬁÉ Ñ
trueﬁﬁÖ â
}ﬁﬁä ã
)ﬁﬁã å
;ﬁﬁå ç
}
ﬂﬂ 
var
‡‡ 
location
‡‡ 
=
‡‡ 
new
‡‡ 
Uri
‡‡ "
(
‡‡" #
$"
‡‡# %
{
‡‡% &
Request
‡‡& -
.
‡‡- .
Scheme
‡‡. 4
}
‡‡4 5
$str
‡‡5 8
{
‡‡8 9
Request
‡‡9 @
.
‡‡@ A
Host
‡‡A E
}
‡‡E F
{
‡‡F G
Request
‡‡G N
.
‡‡N O
Path
‡‡O S
}
‡‡S T
"
‡‡T U
)
‡‡U V
;
‡‡V W
string
·· 
Path
·· 
=
·· 
location
·· "
.
··" #
AbsolutePath
··# /
.
··/ 0
Replace
··0 7
(
··7 8
this
··8 <
.
··< =
ControllerContext
··= N
.
··N O
	RouteData
··O X
.
··X Y
Values
··Y _
[
··_ `
$str
··` h
]
··h i
.
··i j
ToString
··j r
(
··r s
)
··s t
,
··t u
$str
··v }
)
··} ~
;
··~ 
if
‚‚ 
(
‚‚ 
!
‚‚ 
accessSecurity
‚‚ 
.
‚‚  
IsGetAccess
‚‚  +
(
‚‚+ ,
$str
‚‚, 0
+
‚‚1 2
Path
‚‚3 7
)
‚‚7 8
)
‚‚8 9
{
„„ 
return
‰‰ 
RedirectToAction
‰‰ '
(
‰‰' (
$str
‰‰( 3
,
‰‰3 4
$str
‰‰5 <
)
‰‰< =
;
‰‰= >
}
ÂÂ 
try
ÁÁ 
{
ËË 
var
ÈÈ 
dict
ÈÈ 
=
ÈÈ 
Request
ÈÈ "
.
ÈÈ" #
Form
ÈÈ# '
.
ÈÈ' (
ToDictionary
ÈÈ( 4
(
ÈÈ4 5
x
ÈÈ5 6
=>
ÈÈ7 9
x
ÈÈ: ;
.
ÈÈ; <
Key
ÈÈ< ?
,
ÈÈ? @
x
ÈÈA B
=>
ÈÈC E
x
ÈÈF G
.
ÈÈG H
Value
ÈÈH M
.
ÈÈM N
ToString
ÈÈN V
(
ÈÈV W
)
ÈÈW X
)
ÈÈX Y
;
ÈÈY Z
var
ÎÎ 
draw
ÎÎ 
=
ÎÎ 
dict
ÎÎ 
[
ÎÎ  
$str
ÎÎ  &
]
ÎÎ& '
;
ÎÎ' (
var
ÓÓ 
start
ÓÓ 
=
ÓÓ 
dict
ÓÓ  
[
ÓÓ  !
$str
ÓÓ! (
]
ÓÓ( )
;
ÓÓ) *
var
ÔÔ 
length
ÔÔ 
=
ÔÔ 
dict
ÔÔ !
[
ÔÔ! "
$str
ÔÔ" *
]
ÔÔ* +
;
ÔÔ+ ,
var
ÛÛ 

pageNumber
ÛÛ 
=
ÛÛ  
(
ÛÛ! "
int
ÛÛ" %
.
ÛÛ% &
Parse
ÛÛ& +
(
ÛÛ+ ,
start
ÛÛ, 1
)
ÛÛ1 2
/
ÛÛ3 4
int
ÛÛ5 8
.
ÛÛ8 9
Parse
ÛÛ9 >
(
ÛÛ> ?
length
ÛÛ? E
)
ÛÛE F
)
ÛÛF G
+
ÛÛH I
$num
ÛÛJ K
;
ÛÛK L
var
ˆˆ 

sortColumn
ˆˆ 
=
ˆˆ  
dict
ˆˆ! %
[
ˆˆ% &
$str
ˆˆ& 0
+
ˆˆ1 2
dict
ˆˆ3 7
[
ˆˆ7 8
$str
ˆˆ8 J
]
ˆˆJ K
+
ˆˆL M
$str
ˆˆN W
]
ˆˆW X
;
ˆˆX Y
var
˜˜ 
sortColumnDir
˜˜ !
=
˜˜" #
dict
˜˜$ (
[
˜˜( )
$str
˜˜) 8
]
˜˜8 9
;
˜˜9 :
int
˙˙ 
pageSize
˙˙ 
=
˙˙ 
length
˙˙ %
!=
˙˙& (
null
˙˙) -
?
˙˙. /
Convert
˙˙0 7
.
˙˙7 8
ToInt32
˙˙8 ?
(
˙˙? @
length
˙˙@ F
)
˙˙F G
:
˙˙H I
$num
˙˙J K
;
˙˙K L
int
˚˚ 
skip
˚˚ 
=
˚˚ 
start
˚˚  
!=
˚˚! #
null
˚˚$ (
?
˚˚) *
Convert
˚˚+ 2
.
˚˚2 3
ToInt32
˚˚3 :
(
˚˚: ;
start
˚˚; @
)
˚˚@ A
:
˚˚B C
$num
˚˚D E
;
˚˚E F
int
¸¸ 
recordsTotal
¸¸  
=
¸¸! "
$num
¸¸# $
;
¸¸$ %
List
˛˛ 
<
˛˛ '
NoticeOfPayment_ViewModel
˛˛ .
>
˛˛. /
list
˛˛0 4
=
˛˛5 6
new
˛˛7 :
List
˛˛; ?
<
˛˛? @'
NoticeOfPayment_ViewModel
˛˛@ Y
>
˛˛Y Z
(
˛˛Z [
)
˛˛[ \
;
˛˛\ ]
list
ÄÄ 
=
ÄÄ %
StoredProcedureExecutor
ÄÄ .
.
ÄÄ. /
ExecuteSPList
ÄÄ/ <
<
ÄÄ< ='
NoticeOfPayment_ViewModel
ÄÄ= V
>
ÄÄV W
(
ÄÄW X
_context
ÄÄX `
,
ÄÄ` a
$strÄÄb Ü
,ÄÄÜ á
newÄÄà ã
SqlParameterÄÄå ò
[ÄÄò ô
]ÄÄô ö
{ÄÄö õ
new
ÅÅ 
SqlParameter
ÅÅ (
(
ÅÅ( )
$str
ÅÅ) 1
,
ÅÅ1 2
NopId
ÅÅ3 8
)
ÅÅ8 9
,
ÅÅ9 :
new
ÇÇ 
SqlParameter
ÇÇ (
(
ÇÇ( )
$str
ÇÇ) 6
,
ÇÇ6 7

sortColumn
ÇÇ8 B
)
ÇÇB C
,
ÇÇC D
new
ÉÉ 
SqlParameter
ÉÉ (
(
ÉÉ( )
$str
ÉÉ) 9
,
ÉÉ9 :
sortColumnDir
ÉÉ; H
)
ÉÉH I
,
ÉÉI J
new
ÑÑ 
SqlParameter
ÑÑ (
(
ÑÑ( )
$str
ÑÑ) 6
,
ÑÑ6 7

pageNumber
ÑÑ8 B
)
ÑÑB C
,
ÑÑC D
new
ÖÖ 
SqlParameter
ÖÖ (
(
ÖÖ( )
$str
ÖÖ) 4
,
ÖÖ4 5
pageSize
ÖÖ6 >
)
ÖÖ> ?
}
ÖÖ? @
)
ÖÖ@ A
;
ÖÖA B
recordsTotal
áá 
=
áá %
StoredProcedureExecutor
áá 6
.
áá6 7
ExecuteScalarInt
áá7 G
(
ááG H
_context
ááH P
,
ááP Q
$str
ááR w
,
ááw x
new
ááy |
SqlParameteráá} â
[ááâ ä
]ááä ã
{ááã å
new
àà 
SqlParameter
àà (
(
àà( )
$str
àà) 1
,
àà1 2
NopId
àà3 8
)
àà8 9
,
àà9 :
}
ââ 
)
ââ 
;
ââ 
if
ãã 
(
ãã 
list
ãã 
==
ãã 
null
ãã  
)
ãã  !
{
åå 
list
çç 
=
çç 
new
çç 
List
çç #
<
çç# $'
NoticeOfPayment_ViewModel
çç$ =
>
çç= >
(
çç> ?
)
çç? @
;
çç@ A
recordsTotal
éé  
=
éé! "
$num
éé# $
;
éé$ %
}
èè 
return
ëë 
Json
ëë 
(
ëë 
new
ëë 
{
ëë  !
draw
ëë" &
=
ëë' (
draw
ëë) -
,
ëë- .
recordsFiltered
ëë/ >
=
ëë? @
recordsTotal
ëëA M
,
ëëM N
recordsTotal
ëëO [
=
ëë\ ]
recordsTotal
ëë^ j
,
ëëj k
data
ëël p
=
ëëq r
list
ëës w
}
ëëx y
)
ëëy z
;
ëëz {
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì 
Ex
ìì 
)
ìì  
{
îî 
throw
ïï 
;
ïï 
}
ññ 
}
òò 	
public
ÓÓ 
IActionResult
ÓÓ "
LoadDataDetailNopNew
ÓÓ 1
(
ÓÓ1 2
string
ÓÓ2 8
DueDate
ÓÓ9 @
)
ÓÓ@ A
{
ÔÔ 	
if
 
(
 
!
 
lastSession
 
.
 
Update
 #
(
# $
)
$ %
)
% &
{
ÒÒ 
return
ÚÚ 
RedirectToAction
ÚÚ '
(
ÚÚ' (
$str
ÚÚ( /
,
ÚÚ/ 0
	GetConfig
ÚÚ1 :
.
ÚÚ: ;

AppSetting
ÚÚ; E
[
ÚÚE F
$str
ÚÚF n
]
ÚÚn o
+
ÚÚp q
$str
ÚÚr y
,
ÚÚy z
new
ÚÚ{ ~
{ÚÚ Ä
aÚÚÅ Ç
=ÚÚÉ Ñ
trueÚÚÖ â
}ÚÚä ã
)ÚÚã å
;ÚÚå ç
}
ÛÛ 
var
ÙÙ 
location
ÙÙ 
=
ÙÙ 
new
ÙÙ 
Uri
ÙÙ "
(
ÙÙ" #
$"
ÙÙ# %
{
ÙÙ% &
Request
ÙÙ& -
.
ÙÙ- .
Scheme
ÙÙ. 4
}
ÙÙ4 5
$str
ÙÙ5 8
{
ÙÙ8 9
Request
ÙÙ9 @
.
ÙÙ@ A
Host
ÙÙA E
}
ÙÙE F
{
ÙÙF G
Request
ÙÙG N
.
ÙÙN O
Path
ÙÙO S
}
ÙÙS T
"
ÙÙT U
)
ÙÙU V
;
ÙÙV W
string
ıı 
Path
ıı 
=
ıı 
location
ıı "
.
ıı" #
AbsolutePath
ıı# /
.
ıı/ 0
Replace
ıı0 7
(
ıı7 8
this
ıı8 <
.
ıı< =
ControllerContext
ıı= N
.
ııN O
	RouteData
ııO X
.
ııX Y
Values
ııY _
[
ıı_ `
$str
ıı` h
]
ııh i
.
ııi j
ToString
ııj r
(
ıır s
)
ııs t
,
ııt u
$str
ııv }
)
ıı} ~
;
ıı~ 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
accessSecurity
ˆˆ 
.
ˆˆ  
IsGetAccess
ˆˆ  +
(
ˆˆ+ ,
$str
ˆˆ, 0
+
ˆˆ1 2
Path
ˆˆ3 7
)
ˆˆ7 8
)
ˆˆ8 9
{
˜˜ 
return
¯¯ 
RedirectToAction
¯¯ '
(
¯¯' (
$str
¯¯( 3
,
¯¯3 4
$str
¯¯5 <
)
¯¯< =
;
¯¯= >
}
˘˘ 
try
˚˚ 
{
¸¸ 
int
˝˝ 
recordsTotal
˝˝  
=
˝˝! "
$num
˝˝# $
;
˝˝$ %
List
˛˛ 
<
˛˛ '
NoticeOfPayment_ViewModel
˛˛ .
>
˛˛. /
list
˛˛0 4
=
˛˛5 6
new
˛˛7 :
List
˛˛; ?
<
˛˛? @'
NoticeOfPayment_ViewModel
˛˛@ Y
>
˛˛Y Z
(
˛˛Z [
)
˛˛[ \
;
˛˛\ ]
if
ÄÄ 
(
ÄÄ 
DueDate
ÄÄ 
==
ÄÄ 
$str
ÄÄ !
)
ÄÄ! "
{
ÅÅ 
list
ÇÇ 
=
ÇÇ 
null
ÇÇ 
;
ÇÇ  
recordsTotal
ÉÉ  
=
ÉÉ! "
$num
ÉÉ# $
;
ÉÉ$ %
return
ÖÖ 
Json
ÖÖ 
(
ÖÖ  
new
ÖÖ  #
{
ÖÖ$ %
data
ÖÖ& *
=
ÖÖ+ ,
list
ÖÖ- 1
}
ÖÖ2 3
)
ÖÖ3 4
;
ÖÖ4 5
}
ÜÜ 
DateTime
àà 
dateTime
àà !
=
àà" #
DateTime
àà$ ,
.
àà, -

ParseExact
àà- 7
(
àà7 8
DueDate
àà8 ?
,
àà? @
$str
ààA M
,
ààM N
null
ààO S
)
ààS T
;
ààT U
DateTimeOffset
ââ 
dateTimeOffset
ââ -
=
ââ. /
new
ââ0 3
DateTimeOffset
ââ4 B
(
ââB C
dateTime
ââC K
,
ââK L
TimeSpan
ââM U
.
ââU V
Zero
ââV Z
)
ââZ [
;
ââ[ \
string
ää 
FinalDueDate
ää #
=
ää$ %
dateTimeOffset
ää& 4
.
ää4 5
ToString
ää5 =
(
ää= >
$str
ää> T
)
ääT U
;
ääU V
int
åå 
skip
åå 
=
åå 
$num
åå 
;
åå 
int
çç 
	batchSize
çç 
=
çç 
$num
çç  "
;
çç" #
bool
éé 
keepFetching
éé !
=
éé" #
true
éé$ (
;
éé( )
long
èè 
id
èè 
=
èè 
$num
èè 
;
èè 
while
ëë 
(
ëë 
keepFetching
ëë #
)
ëë# $
{
íí 
var
ìì 
url
ìì 
=
ìì 
	GetConfig
ìì '
.
ìì' (

AppSetting
ìì( 2
[
ìì2 3
$str
ìì3 D
]
ììD E
+
îî 
	GetConfig
îî  )
.
îî) *

AppSetting
îî* 4
[
îî4 5
$str
îî5 P
]
îîP Q
+
ïï 
$str
ïï  &
+
ïï' (
	batchSize
ïï) 2
+
ññ 
$str
ññ  (
+
ññ) *
skip
ññ+ /
+
óó 
$str
óó  X
+
òò 
FinalDueDate
òò  ,
;
òò, -
(
öö 
bool
öö 
	resultApi
öö #
,
öö# $
string
öö% +
result
öö, 2
)
öö2 3
=
öö4 5
RequestToAPI
öö6 B
.
ööB C!
GetJsonStringWebApi
ööC V
(
ööV W
url
ööW Z
,
ööZ [
null
öö\ `
)
öö` a
;
ööa b
if
úú 
(
úú 
	resultApi
úú !
&&
úú" $
!
úú% &
string
úú& ,
.
úú, -
IsNullOrEmpty
úú- :
(
úú: ;
result
úú; A
)
úúA B
)
úúB C
{
ùù 
var
ûû 
jsonParseReturn
ûû +
=
ûû, -
JsonConvert
ûû. 9
.
ûû9 :
DeserializeObject
ûû: K
<
ûûK L!
ResultStatusDataInt
ûûL _
<
ûû_ `'
NoticeOfPayment_ViewModel
ûû` y
>
ûûy z
>
ûûz {
(
ûû{ |
resultûû| Ç
)ûûÇ É
;ûûÉ Ñ
if
†† 
(
†† 
jsonParseReturn
†† +
.
††+ ,
Value
††, 1
.
††1 2
Count
††2 7
(
††7 8
)
††8 9
!=
††: <
$num
††= >
)
††> ?
{
°° 
foreach
¢¢ #
(
¢¢$ %
var
¢¢% (
item
¢¢) -
in
¢¢. 0
jsonParseReturn
¢¢1 @
.
¢¢@ A
Value
¢¢A F
)
¢¢F G
{
££ '
NoticeOfPayment_ViewModel
§§  9
	nopDetail
§§: C
=
§§D E
new
§§F I'
NoticeOfPayment_ViewModel
§§J c
{
••  !
Id
¶¶$ &
=
¶¶' (
id
¶¶) +
,
¶¶+ ,
CreditorRef
ßß$ /
=
ßß0 1
item
ßß2 6
.
ßß6 7
CreditorRef
ßß7 B
,
ßßB C
Outstanding
®®$ /
=
®®0 1
item
®®2 6
.
®®6 7
Outstanding
®®7 B
,
®®B C
	Principal
©©$ -
=
©©. /
item
©©0 4
.
©©4 5
	Principal
©©5 >
,
©©> ?
Interest
™™$ ,
=
™™- .
item
™™/ 3
.
™™3 4
Interest
™™4 <
,
™™< =
Fee
´´$ '
=
´´( )
item
´´* .
.
´´. /
Fee
´´/ 2
,
´´2 3
}
¨¨  !
;
¨¨! "
list
≠≠  $
.
≠≠$ %
Add
≠≠% (
(
≠≠( )
	nopDetail
≠≠) 2
)
≠≠2 3
;
≠≠3 4
id
ÆÆ  "
++
ÆÆ" $
;
ÆÆ$ %
}
ØØ 
}
∞∞ 
if
≤≤ 
(
≤≤ 
jsonParseReturn
≤≤ +
.
≤≤+ ,
Value
≤≤, 1
.
≤≤1 2
Count
≤≤2 7
(
≤≤7 8
)
≤≤8 9
<
≤≤: ;
	batchSize
≤≤< E
)
≤≤E F
{
≥≥ 
keepFetching
¥¥ (
=
¥¥) *
false
¥¥+ 0
;
¥¥0 1
}
µµ 
else
∂∂ 
{
∑∑ 
skip
∏∏  
+=
∏∏! #
	batchSize
∏∏$ -
;
∏∏- .
}
ππ 
}
∫∫ 
else
ªª 
{
ºº 
keepFetching
ΩΩ $
=
ΩΩ% &
false
ΩΩ' ,
;
ΩΩ, -
}
ææ 
}
øø 
return
¡¡ 
Json
¡¡ 
(
¡¡ 
new
¡¡ 
{
¡¡  !
data
¡¡" &
=
¡¡' (
list
¡¡) -
}
¡¡. /
)
¡¡/ 0
;
¡¡0 1
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
Ex
√√ 
)
√√  
{
ƒƒ 
throw
≈≈ 
;
≈≈ 
}
∆∆ 
}
«« 	
public
»» 
IActionResult
»» &
LoadOnlyDataDetailNopNew
»» 5
(
»»5 6
int
»»6 9
id
»»: <
)
»»< =
{
…… 	
if
   
(
   
!
   
lastSession
   
.
   
Update
   #
(
  # $
)
  $ %
)
  % &
{
ÀÀ 
return
ÃÃ 
RedirectToAction
ÃÃ '
(
ÃÃ' (
$str
ÃÃ( /
,
ÃÃ/ 0
	GetConfig
ÃÃ1 :
.
ÃÃ: ;

AppSetting
ÃÃ; E
[
ÃÃE F
$str
ÃÃF n
]
ÃÃn o
+
ÃÃp q
$str
ÃÃr y
,
ÃÃy z
new
ÃÃ{ ~
{ÃÃ Ä
aÃÃÅ Ç
=ÃÃÉ Ñ
trueÃÃÖ â
}ÃÃä ã
)ÃÃã å
;ÃÃå ç
}
ÕÕ 
var
ŒŒ 
location
ŒŒ 
=
ŒŒ 
new
ŒŒ 
Uri
ŒŒ "
(
ŒŒ" #
$"
ŒŒ# %
{
ŒŒ% &
Request
ŒŒ& -
.
ŒŒ- .
Scheme
ŒŒ. 4
}
ŒŒ4 5
$str
ŒŒ5 8
{
ŒŒ8 9
Request
ŒŒ9 @
.
ŒŒ@ A
Host
ŒŒA E
}
ŒŒE F
{
ŒŒF G
Request
ŒŒG N
.
ŒŒN O
Path
ŒŒO S
}
ŒŒS T
"
ŒŒT U
)
ŒŒU V
;
ŒŒV W
string
œœ 
Path
œœ 
=
œœ 
location
œœ "
.
œœ" #
AbsolutePath
œœ# /
.
œœ/ 0
Replace
œœ0 7
(
œœ7 8
this
œœ8 <
.
œœ< =
ControllerContext
œœ= N
.
œœN O
	RouteData
œœO X
.
œœX Y
Values
œœY _
[
œœ_ `
$str
œœ` h
]
œœh i
.
œœi j
ToString
œœj r
(
œœr s
)
œœs t
,
œœt u
$str
œœv }
)
œœ} ~
;
œœ~ 
if
–– 
(
–– 
!
–– 
accessSecurity
–– 
.
––  
IsGetAccess
––  +
(
––+ ,
$str
––, 0
+
––1 2
Path
––3 7
)
––7 8
)
––8 9
{
—— 
return
““ 
RedirectToAction
““ '
(
““' (
$str
““( 3
,
““3 4
$str
““5 <
)
““< =
;
““= >
}
”” 
try
’’ 
{
÷÷ 
List
◊◊ 
<
◊◊ '
NoticeOfPayment_ViewModel
◊◊ .
>
◊◊. /
listData
◊◊0 8
=
◊◊9 :
new
◊◊; >
List
◊◊? C
<
◊◊C D'
NoticeOfPayment_ViewModel
◊◊D ]
>
◊◊] ^
(
◊◊^ _
)
◊◊_ `
;
◊◊` a
List
ÿÿ 
<
ÿÿ &
TblNoticeOfPaymentDetail
ÿÿ -
>
ÿÿ- .
list
ÿÿ/ 3
=
ÿÿ4 5
_context
ÿÿ6 >
.
ÿÿ> ?'
TblNoticeOfPaymentDetails
ÿÿ? X
.
ÿÿX Y
Where
ÿÿY ^
(
ÿÿ^ _
m
ÿÿ_ `
=>
ÿÿ` b
m
ÿÿb c
.
ÿÿc d
NopId
ÿÿd i
==
ÿÿj l
id
ÿÿm o
&&
ÿÿp r
m
ÿÿs t
.
ÿÿt u
	IsDeleted
ÿÿu ~
==ÿÿ Å
$numÿÿÇ É
)ÿÿÉ Ñ
.ÿÿÑ Ö
ToListÿÿÖ ã
(ÿÿã å
)ÿÿå ç
;ÿÿç é
foreach
⁄⁄ 
(
⁄⁄ 
var
⁄⁄ 
item
⁄⁄ !
in
⁄⁄" $
list
⁄⁄% )
)
⁄⁄) *
{
⁄⁄+ ,'
NoticeOfPayment_ViewModel
€€ -
temp
€€. 2
=
€€3 4
new
€€5 8'
NoticeOfPayment_ViewModel
€€9 R
(
€€R S
)
€€S T
;
€€T U
temp
‹‹ 
.
‹‹ 
IdDetailFromGet
‹‹ (
=
‹‹) *
item
‹‹+ /
.
‹‹/ 0
Id
‹‹0 2
;
‹‹2 3
temp
›› 
.
››  
IdNopDetailFromApi
›› +
=
››, -
item
››. 2
.
››2 3 
IdNopDetailFromApi
››3 E
;
››E F
temp
ﬁﬁ 
.
ﬁﬁ 
CreditorRef
ﬁﬁ $
=
ﬁﬁ% &
item
ﬁﬁ' +
.
ﬁﬁ+ ,
CreditorRef
ﬁﬁ, 7
;
ﬁﬁ7 8
temp
ﬂﬂ 
.
ﬂﬂ 
Outstanding
ﬂﬂ $
=
ﬂﬂ% &
item
ﬂﬂ' +
.
ﬂﬂ+ ,
Outstanding
ﬂﬂ, 7
;
ﬂﬂ7 8
temp
‡‡ 
.
‡‡ 
	Principal
‡‡ "
=
‡‡# $
item
‡‡% )
.
‡‡) *
	Principal
‡‡* 3
;
‡‡3 4
temp
·· 
.
·· 
Interest
·· !
=
··" #
item
··$ (
.
··( )
Interest
··) 1
;
··1 2
temp
‚‚ 
.
‚‚ 
Fee
‚‚ 
=
‚‚ 
item
‚‚ #
.
‚‚# $
Fee
‚‚$ '
;
‚‚' (
listData
„„ 
.
„„ 
Add
„„  
(
„„  !
temp
„„! %
)
„„% &
;
„„& '
}
‰‰ 
return
ÊÊ 
Json
ÊÊ 
(
ÊÊ 
new
ÊÊ 
{
ÊÊ  !
data
ÊÊ" &
=
ÊÊ' (
listData
ÊÊ) 1
}
ÊÊ2 3
)
ÊÊ3 4
;
ÊÊ4 5
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
Ex
ËË 
)
ËË  
{
ÈÈ 
throw
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
[
ÌÌ 	
HttpPost
ÌÌ	 
]
ÌÌ 
public
ÓÓ 
IActionResult
ÓÓ !
LoadDataFileNopTemp
ÓÓ 0
(
ÓÓ0 1
string
ÓÓ1 7
randomstring
ÓÓ8 D
)
ÓÓD E
{
ÔÔ 	
if
 
(
 
!
 
lastSession
 
.
 
Update
 #
(
# $
)
$ %
)
% &
{
ÒÒ 
return
ÚÚ 
RedirectToAction
ÚÚ '
(
ÚÚ' (
$str
ÚÚ( /
,
ÚÚ/ 0
	GetConfig
ÚÚ1 :
.
ÚÚ: ;

AppSetting
ÚÚ; E
[
ÚÚE F
$str
ÚÚF n
]
ÚÚn o
+
ÚÚp q
$str
ÚÚr y
,
ÚÚy z
new
ÚÚ{ ~
{ÚÚ Ä
aÚÚÅ Ç
=ÚÚÉ Ñ
trueÚÚÖ â
}ÚÚä ã
)ÚÚã å
;ÚÚå ç
}
ÛÛ 
var
ÙÙ 
location
ÙÙ 
=
ÙÙ 
new
ÙÙ 
Uri
ÙÙ "
(
ÙÙ" #
$"
ÙÙ# %
{
ÙÙ% &
Request
ÙÙ& -
.
ÙÙ- .
Scheme
ÙÙ. 4
}
ÙÙ4 5
$str
ÙÙ5 8
{
ÙÙ8 9
Request
ÙÙ9 @
.
ÙÙ@ A
Host
ÙÙA E
}
ÙÙE F
{
ÙÙF G
Request
ÙÙG N
.
ÙÙN O
Path
ÙÙO S
}
ÙÙS T
"
ÙÙT U
)
ÙÙU V
;
ÙÙV W
string
ıı 
Path
ıı 
=
ıı 
location
ıı "
.
ıı" #
AbsolutePath
ıı# /
.
ıı/ 0
Replace
ıı0 7
(
ıı7 8
this
ıı8 <
.
ıı< =
ControllerContext
ıı= N
.
ııN O
	RouteData
ııO X
.
ııX Y
Values
ııY _
[
ıı_ `
$str
ıı` h
]
ııh i
.
ııi j
ToString
ııj r
(
ıır s
)
ııs t
,
ııt u
$str
ııv }
)
ıı} ~
;
ıı~ 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
accessSecurity
ˆˆ 
.
ˆˆ  
IsGetAccess
ˆˆ  +
(
ˆˆ+ ,
$str
ˆˆ, 0
+
ˆˆ1 2
Path
ˆˆ3 7
)
ˆˆ7 8
)
ˆˆ8 9
{
˜˜ 
return
¯¯ 
RedirectToAction
¯¯ '
(
¯¯' (
$str
¯¯( 3
,
¯¯3 4
$str
¯¯5 <
)
¯¯< =
;
¯¯= >
}
˘˘ 
try
˚˚ 
{
¸¸ 
var
˝˝ 
dict
˝˝ 
=
˝˝ 
Request
˝˝ "
.
˝˝" #
Form
˝˝# '
.
˝˝' (
ToDictionary
˝˝( 4
(
˝˝4 5
x
˝˝5 6
=>
˝˝7 9
x
˝˝: ;
.
˝˝; <
Key
˝˝< ?
,
˝˝? @
x
˝˝A B
=>
˝˝C E
x
˝˝F G
.
˝˝G H
Value
˝˝H M
.
˝˝M N
ToString
˝˝N V
(
˝˝V W
)
˝˝W X
)
˝˝X Y
;
˝˝Y Z
var
ˇˇ 
draw
ˇˇ 
=
ˇˇ 
dict
ˇˇ 
[
ˇˇ  
$str
ˇˇ  &
]
ˇˇ& '
;
ˇˇ' (
var
ÇÇ 
start
ÇÇ 
=
ÇÇ 
dict
ÇÇ  
[
ÇÇ  !
$str
ÇÇ! (
]
ÇÇ( )
;
ÇÇ) *
var
ÉÉ 
length
ÉÉ 
=
ÉÉ 
dict
ÉÉ !
[
ÉÉ! "
$str
ÉÉ" *
]
ÉÉ* +
;
ÉÉ+ ,
var
áá 

pageNumber
áá 
=
áá  
(
áá! "
int
áá" %
.
áá% &
Parse
áá& +
(
áá+ ,
start
áá, 1
)
áá1 2
/
áá3 4
int
áá5 8
.
áá8 9
Parse
áá9 >
(
áá> ?
length
áá? E
)
ááE F
)
ááF G
+
ááH I
$num
ááJ K
;
ááK L
var
ää 

sortColumn
ää 
=
ää  
dict
ää! %
[
ää% &
$str
ää& 0
+
ää1 2
dict
ää3 7
[
ää7 8
$str
ää8 J
]
ääJ K
+
ääL M
$str
ääN W
]
ääW X
;
ääX Y
var
ãã 
sortColumnDir
ãã !
=
ãã" #
dict
ãã$ (
[
ãã( )
$str
ãã) 8
]
ãã8 9
;
ãã9 :
int
éé 
pageSize
éé 
=
éé 
length
éé %
!=
éé& (
null
éé) -
?
éé. /
Convert
éé0 7
.
éé7 8
ToInt32
éé8 ?
(
éé? @
length
éé@ F
)
ééF G
:
ééH I
$num
ééJ K
;
ééK L
int
èè 
skip
èè 
=
èè 
start
èè  
!=
èè! #
null
èè$ (
?
èè) *
Convert
èè+ 2
.
èè2 3
ToInt32
èè3 :
(
èè: ;
start
èè; @
)
èè@ A
:
èèB C
$num
èèD E
;
èèE F
int
êê 
recordsTotal
êê  
=
êê! "
$num
êê# $
;
êê$ %
List
íí 
<
íí +
NoticeOfPaymentFile_ViewModel
íí 2
>
íí2 3
list
íí4 8
=
íí9 :
new
íí; >
List
íí? C
<
ííC D+
NoticeOfPaymentFile_ViewModel
ííD a
>
íía b
(
ííb c
)
ííc d
;
ííd e
list
îî 
=
îî %
StoredProcedureExecutor
îî .
.
îî. /
ExecuteSPList
îî/ <
<
îî< =+
NoticeOfPaymentFile_ViewModel
îî= Z
>
îîZ [
(
îî[ \
_context
îî\ d
,
îîd e
$strîîf å
,îîå ç
newîîé ë
SqlParameterîîí û
[îîû ü
]îîü †
{îî† °
new
ïï 
SqlParameter
ïï (
(
ïï( )
$str
ïï) 8
,
ïï8 9
randomstring
ïï: F
)
ïïF G
,
ïïG H
new
ññ 
SqlParameter
ññ (
(
ññ( )
$str
ññ) 6
,
ññ6 7

sortColumn
ññ8 B
)
ññB C
,
ññC D
new
óó 
SqlParameter
óó (
(
óó( )
$str
óó) 9
,
óó9 :
sortColumnDir
óó; H
)
óóH I
,
óóI J
new
òò 
SqlParameter
òò (
(
òò( )
$str
òò) 6
,
òò6 7

pageNumber
òò8 B
)
òòB C
,
òòC D
new
ôô 
SqlParameter
ôô (
(
ôô( )
$str
ôô) 4
,
ôô4 5
pageSize
ôô6 >
)
ôô> ?
}
ôô? @
)
ôô@ A
;
ôôA B
recordsTotal
õõ 
=
õõ %
StoredProcedureExecutor
õõ 6
.
õõ6 7
ExecuteScalarInt
õõ7 G
(
õõG H
_context
õõH P
,
õõP Q
$str
õõR y
,
õõy z
new
õõ{ ~
SqlParameterõõ ã
[õõã å
]õõå ç
{õõç é
new
úú 
SqlParameter
úú (
(
úú( )
$str
úú) 8
,
úú8 9
randomstring
úú: F
)
úúF G
,
úúG H
}
ùù 
)
ùù 
;
ùù 
if
üü 
(
üü 
list
üü 
==
üü 
null
üü  
)
üü  !
{
†† 
list
°° 
=
°° 
new
°° 
List
°° #
<
°°# $+
NoticeOfPaymentFile_ViewModel
°°$ A
>
°°A B
(
°°B C
)
°°C D
;
°°D E
recordsTotal
¢¢  
=
¢¢! "
$num
¢¢# $
;
¢¢$ %
}
££ 
return
•• 
Json
•• 
(
•• 
new
•• 
{
••  !
draw
••" &
=
••' (
draw
••) -
,
••- .
recordsFiltered
••/ >
=
••? @
recordsTotal
••A M
,
••M N
recordsTotal
••O [
=
••\ ]
recordsTotal
••^ j
,
••j k
data
••l p
=
••q r
list
••s w
}
••x y
)
••y z
;
••z {
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
Ex
ßß 
)
ßß  
{
®® 
throw
©© 
;
©© 
}
™™ 
}
´´ 	
[
¨¨ 	
HttpPost
¨¨	 
]
¨¨ 
public
≠≠ 
IActionResult
≠≠ 
LoadDataFileNop
≠≠ ,
(
≠≠, -
string
≠≠- 3
NopId
≠≠4 9
)
≠≠9 :
{
ÆÆ 	
if
ØØ 
(
ØØ 
!
ØØ 
lastSession
ØØ 
.
ØØ 
Update
ØØ #
(
ØØ# $
)
ØØ$ %
)
ØØ% &
{
∞∞ 
return
±± 
RedirectToAction
±± '
(
±±' (
$str
±±( /
,
±±/ 0
	GetConfig
±±1 :
.
±±: ;

AppSetting
±±; E
[
±±E F
$str
±±F n
]
±±n o
+
±±p q
$str
±±r y
,
±±y z
new
±±{ ~
{±± Ä
a±±Å Ç
=±±É Ñ
true±±Ö â
}±±ä ã
)±±ã å
;±±å ç
}
≤≤ 
var
≥≥ 
location
≥≥ 
=
≥≥ 
new
≥≥ 
Uri
≥≥ "
(
≥≥" #
$"
≥≥# %
{
≥≥% &
Request
≥≥& -
.
≥≥- .
Scheme
≥≥. 4
}
≥≥4 5
$str
≥≥5 8
{
≥≥8 9
Request
≥≥9 @
.
≥≥@ A
Host
≥≥A E
}
≥≥E F
{
≥≥F G
Request
≥≥G N
.
≥≥N O
Path
≥≥O S
}
≥≥S T
"
≥≥T U
)
≥≥U V
;
≥≥V W
string
¥¥ 
Path
¥¥ 
=
¥¥ 
location
¥¥ "
.
¥¥" #
AbsolutePath
¥¥# /
.
¥¥/ 0
Replace
¥¥0 7
(
¥¥7 8
this
¥¥8 <
.
¥¥< =
ControllerContext
¥¥= N
.
¥¥N O
	RouteData
¥¥O X
.
¥¥X Y
Values
¥¥Y _
[
¥¥_ `
$str
¥¥` h
]
¥¥h i
.
¥¥i j
ToString
¥¥j r
(
¥¥r s
)
¥¥s t
,
¥¥t u
$str
¥¥v }
)
¥¥} ~
;
¥¥~ 
if
µµ 
(
µµ 
!
µµ 
accessSecurity
µµ 
.
µµ  
IsGetAccess
µµ  +
(
µµ+ ,
$str
µµ, 0
+
µµ1 2
Path
µµ3 7
)
µµ7 8
)
µµ8 9
{
∂∂ 
return
∑∑ 
RedirectToAction
∑∑ '
(
∑∑' (
$str
∑∑( 3
,
∑∑3 4
$str
∑∑5 <
)
∑∑< =
;
∑∑= >
}
∏∏ 
try
∫∫ 
{
ªª 
var
ºº 
dict
ºº 
=
ºº 
Request
ºº "
.
ºº" #
Form
ºº# '
.
ºº' (
ToDictionary
ºº( 4
(
ºº4 5
x
ºº5 6
=>
ºº7 9
x
ºº: ;
.
ºº; <
Key
ºº< ?
,
ºº? @
x
ººA B
=>
ººC E
x
ººF G
.
ººG H
Value
ººH M
.
ººM N
ToString
ººN V
(
ººV W
)
ººW X
)
ººX Y
;
ººY Z
var
ææ 
draw
ææ 
=
ææ 
dict
ææ 
[
ææ  
$str
ææ  &
]
ææ& '
;
ææ' (
var
¡¡ 
start
¡¡ 
=
¡¡ 
dict
¡¡  
[
¡¡  !
$str
¡¡! (
]
¡¡( )
;
¡¡) *
var
¬¬ 
length
¬¬ 
=
¬¬ 
dict
¬¬ !
[
¬¬! "
$str
¬¬" *
]
¬¬* +
;
¬¬+ ,
var
∆∆ 

pageNumber
∆∆ 
=
∆∆  
(
∆∆! "
int
∆∆" %
.
∆∆% &
Parse
∆∆& +
(
∆∆+ ,
start
∆∆, 1
)
∆∆1 2
/
∆∆3 4
int
∆∆5 8
.
∆∆8 9
Parse
∆∆9 >
(
∆∆> ?
length
∆∆? E
)
∆∆E F
)
∆∆F G
+
∆∆H I
$num
∆∆J K
;
∆∆K L
var
…… 

sortColumn
…… 
=
……  
dict
……! %
[
……% &
$str
……& 0
+
……1 2
dict
……3 7
[
……7 8
$str
……8 J
]
……J K
+
……L M
$str
……N W
]
……W X
;
……X Y
var
   
sortColumnDir
   !
=
  " #
dict
  $ (
[
  ( )
$str
  ) 8
]
  8 9
;
  9 :
int
ÕÕ 
pageSize
ÕÕ 
=
ÕÕ 
length
ÕÕ %
!=
ÕÕ& (
null
ÕÕ) -
?
ÕÕ. /
Convert
ÕÕ0 7
.
ÕÕ7 8
ToInt32
ÕÕ8 ?
(
ÕÕ? @
length
ÕÕ@ F
)
ÕÕF G
:
ÕÕH I
$num
ÕÕJ K
;
ÕÕK L
int
ŒŒ 
skip
ŒŒ 
=
ŒŒ 
start
ŒŒ  
!=
ŒŒ! #
null
ŒŒ$ (
?
ŒŒ) *
Convert
ŒŒ+ 2
.
ŒŒ2 3
ToInt32
ŒŒ3 :
(
ŒŒ: ;
start
ŒŒ; @
)
ŒŒ@ A
:
ŒŒB C
$num
ŒŒD E
;
ŒŒE F
int
œœ 
recordsTotal
œœ  
=
œœ! "
$num
œœ# $
;
œœ$ %
List
—— 
<
—— +
NoticeOfPaymentFile_ViewModel
—— 2
>
——2 3
list
——4 8
=
——9 :
new
——; >
List
——? C
<
——C D+
NoticeOfPaymentFile_ViewModel
——D a
>
——a b
(
——b c
)
——c d
;
——d e
list
”” 
=
”” %
StoredProcedureExecutor
”” .
.
””. /
ExecuteSPList
””/ <
<
””< =+
NoticeOfPaymentFile_ViewModel
””= Z
>
””Z [
(
””[ \
_context
””\ d
,
””d e
$str””f à
,””à â
new””ä ç
SqlParameter””é ö
[””ö õ
]””õ ú
{””ú ù
new
‘‘ 
SqlParameter
‘‘ (
(
‘‘( )
$str
‘‘) 1
,
‘‘1 2
NopId
‘‘3 8
)
‘‘8 9
,
‘‘9 :
new
’’ 
SqlParameter
’’ (
(
’’( )
$str
’’) 6
,
’’6 7

sortColumn
’’8 B
)
’’B C
,
’’C D
new
÷÷ 
SqlParameter
÷÷ (
(
÷÷( )
$str
÷÷) 9
,
÷÷9 :
sortColumnDir
÷÷; H
)
÷÷H I
,
÷÷I J
new
◊◊ 
SqlParameter
◊◊ (
(
◊◊( )
$str
◊◊) 6
,
◊◊6 7

pageNumber
◊◊8 B
)
◊◊B C
,
◊◊C D
new
ÿÿ 
SqlParameter
ÿÿ (
(
ÿÿ( )
$str
ÿÿ) 4
,
ÿÿ4 5
pageSize
ÿÿ6 >
)
ÿÿ> ?
}
ÿÿ? @
)
ÿÿ@ A
;
ÿÿA B
recordsTotal
⁄⁄ 
=
⁄⁄ %
StoredProcedureExecutor
⁄⁄ 6
.
⁄⁄6 7
ExecuteScalarInt
⁄⁄7 G
(
⁄⁄G H
_context
⁄⁄H P
,
⁄⁄P Q
$str
⁄⁄R u
,
⁄⁄u v
new
⁄⁄w z
SqlParameter⁄⁄{ á
[⁄⁄á à
]⁄⁄à â
{⁄⁄â ä
new
€€ 
SqlParameter
€€ (
(
€€( )
$str
€€) 1
,
€€1 2
NopId
€€3 8
)
€€8 9
,
€€9 :
}
‹‹ 
)
‹‹ 
;
‹‹ 
if
ﬁﬁ 
(
ﬁﬁ 
list
ﬁﬁ 
==
ﬁﬁ 
null
ﬁﬁ  
)
ﬁﬁ  !
{
ﬂﬂ 
list
‡‡ 
=
‡‡ 
new
‡‡ 
List
‡‡ #
<
‡‡# $+
NoticeOfPaymentFile_ViewModel
‡‡$ A
>
‡‡A B
(
‡‡B C
)
‡‡C D
;
‡‡D E
recordsTotal
··  
=
··! "
$num
··# $
;
··$ %
}
‚‚ 
return
‰‰ 
Json
‰‰ 
(
‰‰ 
new
‰‰ 
{
‰‰  !
draw
‰‰" &
=
‰‰' (
draw
‰‰) -
,
‰‰- .
recordsFiltered
‰‰/ >
=
‰‰? @
recordsTotal
‰‰A M
,
‰‰M N
recordsTotal
‰‰O [
=
‰‰\ ]
recordsTotal
‰‰^ j
,
‰‰j k
data
‰‰l p
=
‰‰q r
list
‰‰s w
}
‰‰x y
)
‰‰y z
;
‰‰z {
}
ÂÂ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
Ex
ÊÊ 
)
ÊÊ  
{
ÁÁ 
throw
ËË 
;
ËË 
}
ÈÈ 
}
ÍÍ 	
public
ÓÓ 

JsonResult
ÓÓ &
GetDataDetailCreditorRef
ÓÓ 2
(
ÓÓ2 3
string
ÓÓ3 9
DueDate
ÓÓ: A
)
ÓÓA B
{
ÔÔ 	
DateTime
 
dateTime
 
=
 
DateTime
  (
.
( )

ParseExact
) 3
(
3 4
DueDate
4 ;
,
; <
$str
= I
,
I J
null
K O
)
O P
;
P Q
DateTimeOffset
ÒÒ 
dateTimeOffset
ÒÒ )
=
ÒÒ* +
new
ÒÒ, /
DateTimeOffset
ÒÒ0 >
(
ÒÒ> ?
dateTime
ÒÒ? G
,
ÒÒG H
TimeSpan
ÒÒI Q
.
ÒÒQ R
Zero
ÒÒR V
)
ÒÒV W
;
ÒÒW X
string
ÚÚ 
FinalDueDate
ÚÚ 
=
ÚÚ  !
dateTimeOffset
ÚÚ" 0
.
ÚÚ0 1
ToString
ÚÚ1 9
(
ÚÚ9 :
$str
ÚÚ: P
)
ÚÚP Q
;
ÚÚQ R*
CreditorRefDetail_ViewModels
ıı (
source
ıı) /
=
ıı0 1
new
ıı2 5*
CreditorRefDetail_ViewModels
ıı6 R
(
ııR S
)
ııS T
;
ııT U
try
˜˜ 
{
¯¯ 
var
˘˘ 
url
˘˘ 
=
˘˘ 
	GetConfig
˘˘ #
.
˘˘# $

AppSetting
˘˘$ .
[
˘˘. /
$str
˘˘/ @
]
˘˘@ A
+
˘˘B C
	GetConfig
˘˘D M
.
˘˘M N

AppSetting
˘˘N X
[
˘˘X Y
$str
˘˘Y t
]
˘˘t u
+
˘˘v w
$str
˘˘x ~
+˘˘ Ä
$num˘˘Å É
+˘˘Ñ Ö
$str˘˘Ü é
+˘˘è ê
$num˘˘ë í
+˘˘ì î
$str˘˘ï √
+˘˘ƒ ≈
FinalDueDate˘˘∆ “
;˘˘“ ”
(
˙˙ 
bool
˙˙ 
	resultApi
˙˙ 
,
˙˙  
string
˙˙! '
result
˙˙( .
)
˙˙. /
=
˙˙0 1
RequestToAPI
˙˙2 >
.
˙˙> ?!
GetJsonStringWebApi
˙˙? R
(
˙˙R S
url
˙˙S V
,
˙˙V W
null
˙˙X \
)
˙˙\ ]
;
˙˙] ^
if
˚˚ 
(
˚˚ 
	resultApi
˚˚ 
&&
˚˚  
!
˚˚! "
string
˚˚" (
.
˚˚( )
IsNullOrEmpty
˚˚) 6
(
˚˚6 7
result
˚˚7 =
)
˚˚= >
)
˚˚> ?
{
¸¸ 
var
˝˝ 
jsonParseReturn
˝˝ '
=
˝˝( )
JsonConvert
˝˝* 5
.
˝˝5 6
DeserializeObject
˝˝6 G
<
˝˝G H!
ResultStatusDataInt
˝˝H [
<
˝˝[ \*
CreditorRefDetail_ViewModels
˝˝\ x
>
˝˝x y
>
˝˝y z
(
˝˝z {
result˝˝{ Å
)˝˝Å Ç
;˝˝Ç É
if
˛˛ 
(
˛˛ 
jsonParseReturn
˛˛ '
.
˛˛' (
Value
˛˛( -
.
˛˛- .
Count
˛˛. 3
(
˛˛3 4
)
˛˛4 5
!=
˛˛6 8
$num
˛˛9 :
)
˛˛: ;
{
ˇˇ 
source
ÄÄ 
.
ÄÄ 
Outstanding
ÄÄ *
=
ÄÄ+ ,
jsonParseReturn
ÄÄ- <
.
ÄÄ< =
Value
ÄÄ= B
[
ÄÄB C
$num
ÄÄC D
]
ÄÄD E
.
ÄÄE F
Outstanding
ÄÄF Q
;
ÄÄQ R
source
ÅÅ 
.
ÅÅ 
	Principal
ÅÅ (
=
ÅÅ) *
jsonParseReturn
ÅÅ+ :
.
ÅÅ: ;
Value
ÅÅ; @
[
ÅÅ@ A
$num
ÅÅA B
]
ÅÅB C
.
ÅÅC D
	Principal
ÅÅD M
;
ÅÅM N
source
ÇÇ 
.
ÇÇ 
Interest
ÇÇ '
=
ÇÇ( )
jsonParseReturn
ÇÇ* 9
.
ÇÇ9 :
Value
ÇÇ: ?
[
ÇÇ? @
$num
ÇÇ@ A
]
ÇÇA B
.
ÇÇB C
Interest
ÇÇC K
;
ÇÇK L
source
ÉÉ 
.
ÉÉ 
Fee
ÉÉ "
=
ÉÉ# $
jsonParseReturn
ÉÉ% 4
.
ÉÉ4 5
Value
ÉÉ5 :
[
ÉÉ: ;
$num
ÉÉ; <
]
ÉÉ< =
.
ÉÉ= >
Fee
ÉÉ> A
;
ÉÉA B
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 
source
áá 
.
áá 
Outstanding
áá *
=
áá+ ,
$num
áá- .
;
áá. /
source
àà 
.
àà 
	Principal
àà (
=
àà) *
$num
àà+ ,
;
àà, -
source
ââ 
.
ââ 
Interest
ââ '
=
ââ( )
$num
ââ* +
;
ââ+ ,
source
ää 
.
ää 
Fee
ää "
=
ää# $
$num
ää% &
;
ää& '
}
ãã 
}
åå 
return
éé 
Json
éé 
(
éé 
source
éé "
)
éé" #
;
éé# $
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
Ex
ëë 
)
ëë  
{
íí 
throw
ìì 
;
ìì 
}
îî 
}
ïï 	
public
ôô 
ActionResult
ôô 
Create
ôô "
(
ôô" #
)
ôô# $
{
öö 	
if
õõ 
(
õõ 
!
õõ 
lastSession
õõ 
.
õõ 
Update
õõ #
(
õõ# $
)
õõ$ %
)
õõ% &
{
úú 
return
ùù 
RedirectToAction
ùù '
(
ùù' (
$str
ùù( /
,
ùù/ 0
	GetConfig
ùù1 :
.
ùù: ;

AppSetting
ùù; E
[
ùùE F
$str
ùùF n
]
ùùn o
+
ùùp q
$str
ùùr y
,
ùùy z
new
ùù{ ~
{ùù Ä
aùùÅ Ç
=ùùÉ Ñ
trueùùÖ â
}ùùä ã
)ùùã å
;ùùå ç
}
ûû 
var
üü 
location
üü 
=
üü 
new
üü 
Uri
üü "
(
üü" #
$"
üü# %
{
üü% &
Request
üü& -
.
üü- .
Scheme
üü. 4
}
üü4 5
$str
üü5 8
{
üü8 9
Request
üü9 @
.
üü@ A
Host
üüA E
}
üüE F
{
üüF G
Request
üüG N
.
üüN O
Path
üüO S
}
üüS T
"
üüT U
)
üüU V
;
üüV W
string
†† 
Path
†† 
=
†† 
location
†† "
.
††" #
AbsolutePath
††# /
.
††/ 0
Replace
††0 7
(
††7 8
this
††8 <
.
††< =
ControllerContext
††= N
.
††N O
	RouteData
††O X
.
††X Y
Values
††Y _
[
††_ `
$str
††` h
]
††h i
.
††i j
ToString
††j r
(
††r s
)
††s t
,
††t u
$str
††v }
)
††} ~
;
††~ 
if
¢¢ 
(
¢¢ 
!
¢¢ 
accessSecurity
¢¢ 
.
¢¢  
IsGetAccess
¢¢  +
(
¢¢+ ,
$str
¢¢, 0
+
¢¢1 2
Path
¢¢3 7
)
¢¢7 8
)
¢¢8 9
{
££ 
return
§§ 
RedirectToAction
§§ '
(
§§' (
$str
§§( 3
,
§§3 4
$str
§§5 <
)
§§< =
;
§§= >
}
•• 
ViewBag
¶¶ 
.
¶¶ 
RekId
¶¶ 
=
¶¶ 
new
¶¶ 

SelectList
¶¶  *
(
¶¶* +
$str
¶¶+ -
,
¶¶- .
$str
¶¶/ 1
)
¶¶1 2
;
¶¶2 3
ViewBag
ßß 
.
ßß 
Cur
ßß 
=
ßß 
new
ßß 

SelectList
ßß (
(
ßß( )
$str
ßß) +
,
ßß+ ,
$str
ßß- /
)
ßß/ 0
;
ßß0 1
return
®® 
PartialView
®® 
(
®® 
$str
®® (
)
®®( )
;
®®) *
}
™™ 	
public
´´ 
ActionResult
´´ 

CreateBulk
´´ &
(
´´& '
)
´´' (
{
¨¨ 	
if
≠≠ 
(
≠≠ 
!
≠≠ 
lastSession
≠≠ 
.
≠≠ 
Update
≠≠ #
(
≠≠# $
)
≠≠$ %
)
≠≠% &
{
ÆÆ 
return
ØØ 
RedirectToAction
ØØ '
(
ØØ' (
$str
ØØ( /
,
ØØ/ 0
	GetConfig
ØØ1 :
.
ØØ: ;

AppSetting
ØØ; E
[
ØØE F
$str
ØØF n
]
ØØn o
+
ØØp q
$str
ØØr y
,
ØØy z
new
ØØ{ ~
{ØØ Ä
aØØÅ Ç
=ØØÉ Ñ
trueØØÖ â
}ØØä ã
)ØØã å
;ØØå ç
}
∞∞ 
var
±± 
location
±± 
=
±± 
new
±± 
Uri
±± "
(
±±" #
$"
±±# %
{
±±% &
Request
±±& -
.
±±- .
Scheme
±±. 4
}
±±4 5
$str
±±5 8
{
±±8 9
Request
±±9 @
.
±±@ A
Host
±±A E
}
±±E F
{
±±F G
Request
±±G N
.
±±N O
Path
±±O S
}
±±S T
"
±±T U
)
±±U V
;
±±V W
string
≤≤ 
Path
≤≤ 
=
≤≤ 
location
≤≤ "
.
≤≤" #
AbsolutePath
≤≤# /
.
≤≤/ 0
Replace
≤≤0 7
(
≤≤7 8
this
≤≤8 <
.
≤≤< =
ControllerContext
≤≤= N
.
≤≤N O
	RouteData
≤≤O X
.
≤≤X Y
Values
≤≤Y _
[
≤≤_ `
$str
≤≤` h
]
≤≤h i
.
≤≤i j
ToString
≤≤j r
(
≤≤r s
)
≤≤s t
,
≤≤t u
$str
≤≤v }
)
≤≤} ~
;
≤≤~ 
if
≥≥ 
(
≥≥ 
!
≥≥ 
accessSecurity
≥≥ 
.
≥≥  
IsGetAccess
≥≥  +
(
≥≥+ ,
$str
≥≥, 0
+
≥≥1 2
Path
≥≥3 7
)
≥≥7 8
)
≥≥8 9
{
¥¥ 
return
µµ 
RedirectToAction
µµ '
(
µµ' (
$str
µµ( 3
,
µµ3 4
$str
µµ5 <
)
µµ< =
;
µµ= >
}
∂∂ 
return
∑∑ 
PartialView
∑∑ 
(
∑∑ 
$str
∑∑ ,
)
∑∑, -
;
∑∑- .
}
∏∏ 	
public
ππ 
ActionResult
ππ 
CreateDetailNop
ππ +
(
ππ+ ,
)
ππ, -
{
∫∫ 	
if
ªª 
(
ªª 
!
ªª 
lastSession
ªª 
.
ªª 
Update
ªª #
(
ªª# $
)
ªª$ %
)
ªª% &
{
ºº 
return
ΩΩ 
RedirectToAction
ΩΩ '
(
ΩΩ' (
$str
ΩΩ( /
,
ΩΩ/ 0
	GetConfig
ΩΩ1 :
.
ΩΩ: ;

AppSetting
ΩΩ; E
[
ΩΩE F
$str
ΩΩF n
]
ΩΩn o
+
ΩΩp q
$str
ΩΩr y
,
ΩΩy z
new
ΩΩ{ ~
{ΩΩ Ä
aΩΩÅ Ç
=ΩΩÉ Ñ
trueΩΩÖ â
}ΩΩä ã
)ΩΩã å
;ΩΩå ç
}
ææ 
var
¿¿ 
location
¿¿ 
=
¿¿ 
new
¿¿ 
Uri
¿¿ "
(
¿¿" #
$"
¿¿# %
{
¿¿% &
Request
¿¿& -
.
¿¿- .
Scheme
¿¿. 4
}
¿¿4 5
$str
¿¿5 8
{
¿¿8 9
Request
¿¿9 @
.
¿¿@ A
Host
¿¿A E
}
¿¿E F
{
¿¿F G
Request
¿¿G N
.
¿¿N O
Path
¿¿O S
}
¿¿S T
"
¿¿T U
)
¿¿U V
;
¿¿V W
string
¡¡ 
Path
¡¡ 
=
¡¡ 
location
¡¡ "
.
¡¡" #
AbsolutePath
¡¡# /
.
¡¡/ 0
Replace
¡¡0 7
(
¡¡7 8
this
¡¡8 <
.
¡¡< =
ControllerContext
¡¡= N
.
¡¡N O
	RouteData
¡¡O X
.
¡¡X Y
Values
¡¡Y _
[
¡¡_ `
$str
¡¡` h
]
¡¡h i
.
¡¡i j
ToString
¡¡j r
(
¡¡r s
)
¡¡s t
,
¡¡t u
$str
¡¡v }
)
¡¡} ~
;
¡¡~ 
if
√√ 
(
√√ 
!
√√ 
accessSecurity
√√ 
.
√√  
IsGetAccess
√√  +
(
√√+ ,
$str
√√, 0
+
√√1 2
Path
√√3 7
)
√√7 8
)
√√8 9
{
ƒƒ 
return
≈≈ 
RedirectToAction
≈≈ '
(
≈≈' (
$str
≈≈( 3
,
≈≈3 4
$str
≈≈5 <
)
≈≈< =
;
≈≈= >
}
∆∆ 
ViewBag
»» 
.
»» 
CreditorRef
»» 
=
»»  !
new
»»" %

SelectList
»»& 0
(
»»0 1
$str
»»1 3
,
»»3 4
$str
»»5 7
)
»»7 8
;
»»8 9
return
…… 
PartialView
…… 
(
…… 
$str
…… 1
)
……1 2
;
……2 3
}
   	
public
ÀÀ 
ActionResult
ÀÀ 
CreateFileNop
ÀÀ )
(
ÀÀ) *
)
ÀÀ* +
{
ÃÃ 	
if
ÕÕ 
(
ÕÕ 
!
ÕÕ 
lastSession
ÕÕ 
.
ÕÕ 
Update
ÕÕ #
(
ÕÕ# $
)
ÕÕ$ %
)
ÕÕ% &
{
ŒŒ 
return
œœ 
RedirectToAction
œœ '
(
œœ' (
$str
œœ( /
,
œœ/ 0
	GetConfig
œœ1 :
.
œœ: ;

AppSetting
œœ; E
[
œœE F
$str
œœF n
]
œœn o
+
œœp q
$str
œœr y
,
œœy z
new
œœ{ ~
{œœ Ä
aœœÅ Ç
=œœÉ Ñ
trueœœÖ â
}œœä ã
)œœã å
;œœå ç
}
–– 
var
““ 
location
““ 
=
““ 
new
““ 
Uri
““ "
(
““" #
$"
““# %
{
““% &
Request
““& -
.
““- .
Scheme
““. 4
}
““4 5
$str
““5 8
{
““8 9
Request
““9 @
.
““@ A
Host
““A E
}
““E F
{
““F G
Request
““G N
.
““N O
Path
““O S
}
““S T
"
““T U
)
““U V
;
““V W
string
”” 
Path
”” 
=
”” 
location
”” "
.
””" #
AbsolutePath
””# /
.
””/ 0
Replace
””0 7
(
””7 8
this
””8 <
.
””< =
ControllerContext
””= N
.
””N O
	RouteData
””O X
.
””X Y
Values
””Y _
[
””_ `
$str
””` h
]
””h i
.
””i j
ToString
””j r
(
””r s
)
””s t
,
””t u
$str
””v }
)
””} ~
;
””~ 
if
’’ 
(
’’ 
!
’’ 
accessSecurity
’’ 
.
’’  
IsGetAccess
’’  +
(
’’+ ,
$str
’’, 0
+
’’1 2
Path
’’3 7
)
’’7 8
)
’’8 9
{
÷÷ 
return
◊◊ 
RedirectToAction
◊◊ '
(
◊◊' (
$str
◊◊( 3
,
◊◊3 4
$str
◊◊5 <
)
◊◊< =
;
◊◊= >
}
ÿÿ 
return
⁄⁄ 
PartialView
⁄⁄ 
(
⁄⁄ 
$str
⁄⁄ /
)
⁄⁄/ 0
;
⁄⁄0 1
}
€€ 	
[
›› 	&
ValidateAntiForgeryToken
››	 !
]
››! "
[
ﬁﬁ 	
HttpPost
ﬁﬁ	 
]
ﬁﬁ 
public
ﬂﬂ 
async
ﬂﬂ 
Task
ﬂﬂ 
<
ﬂﬂ 
ActionResult
ﬂﬂ &
>
ﬂﬂ& '
SubmitCreate
ﬂﬂ( 4
(
ﬂﬂ4 5"
TblNoticeOfPaymentVM
ﬂﬂ5 I
data
ﬂﬂJ N
,
ﬂﬂN O
string
ﬂﬂP V
listDetailNop
ﬂﬂW d
,
ﬂﬂd e
string
ﬂﬂf l
randomString
ﬂﬂm y
)
ﬂﬂy z
{
‡‡ 	
if
·· 
(
·· 
!
·· 
lastSession
·· 
.
·· 
Update
·· #
(
··# $
)
··$ %
)
··% &
{
‚‚ 
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( /
,
„„/ 0
	GetConfig
„„1 :
.
„„: ;

AppSetting
„„; E
[
„„E F
$str
„„F n
]
„„n o
+
„„p q
$str
„„r y
,
„„y z
new
„„{ ~
{„„ Ä
a„„Å Ç
=„„É Ñ
true„„Ö â
}„„ä ã
)„„ã å
;„„å ç
}
‰‰ 
var
ÂÂ 
location
ÂÂ 
=
ÂÂ 
new
ÂÂ 
Uri
ÂÂ "
(
ÂÂ" #
$"
ÂÂ# %
{
ÂÂ% &
Request
ÂÂ& -
.
ÂÂ- .
Scheme
ÂÂ. 4
}
ÂÂ4 5
$str
ÂÂ5 8
{
ÂÂ8 9
Request
ÂÂ9 @
.
ÂÂ@ A
Host
ÂÂA E
}
ÂÂE F
{
ÂÂF G
Request
ÂÂG N
.
ÂÂN O
Path
ÂÂO S
}
ÂÂS T
"
ÂÂT U
)
ÂÂU V
;
ÂÂV W
string
ÊÊ 
Path
ÊÊ 
=
ÊÊ 
location
ÊÊ "
.
ÊÊ" #
AbsolutePath
ÊÊ# /
.
ÊÊ/ 0
Replace
ÊÊ0 7
(
ÊÊ7 8
this
ÊÊ8 <
.
ÊÊ< =
ControllerContext
ÊÊ= N
.
ÊÊN O
	RouteData
ÊÊO X
.
ÊÊX Y
Values
ÊÊY _
[
ÊÊ_ `
$str
ÊÊ` h
]
ÊÊh i
.
ÊÊi j
ToString
ÊÊj r
(
ÊÊr s
)
ÊÊs t
,
ÊÊt u
$str
ÊÊv }
)
ÊÊ} ~
;
ÊÊ~ 
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
accessSecurity
ÁÁ 
.
ÁÁ  
IsGetAccess
ÁÁ  +
(
ÁÁ+ ,
$str
ÁÁ, 0
+
ÁÁ1 2
Path
ÁÁ3 7
)
ÁÁ7 8
)
ÁÁ8 9
{
ËË 
return
ÈÈ 
RedirectToAction
ÈÈ '
(
ÈÈ' (
$str
ÈÈ( 3
,
ÈÈ3 4
$str
ÈÈ5 <
)
ÈÈ< =
;
ÈÈ= >
}
ÍÍ 
try
ÏÏ 
{
ÌÌ 
var
ÓÓ 
regex
ÓÓ 
=
ÓÓ 
await
ÓÓ !
RegexRequest
ÓÓ" .
.
ÓÓ. /
RegexValidation
ÓÓ/ >
(
ÓÓ> ?
data
ÓÓ? C
)
ÓÓC D
;
ÓÓD E
if
ÔÔ 
(
ÔÔ 
!
ÔÔ 
regex
ÔÔ 
)
ÔÔ 
{
 
return
ÒÒ 
Content
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 1
)
ÒÒ1 2
;
ÒÒ2 3
}
ÚÚ  
TblNoticeOfPayment
ÛÛ "
	dataNopNo
ÛÛ# ,
=
ÛÛ- .
_context
ÛÛ/ 7
.
ÛÛ7 8!
TblNoticeOfPayments
ÛÛ8 K
.
ÛÛK L
Where
ÛÛL Q
(
ÛÛQ R
m
ÛÛR S
=>
ÛÛT V
m
ÛÛW X
.
ÛÛX Y
NopNo
ÛÛY ^
==
ÛÛ_ a
data
ÛÛb f
.
ÛÛf g
NopNo
ÛÛg l
&&
ÛÛm o
m
ÛÛp q
.
ÛÛq r
	IsDeleted
ÛÛr {
!=
ÛÛ| ~
$numÛÛ Ä
)ÛÛÄ Å
.ÛÛÅ Ç
FirstOrDefaultÛÛÇ ê
(ÛÛê ë
)ÛÛë í
;ÛÛí ì
if
ÙÙ 
(
ÙÙ 
	dataNopNo
ÙÙ 
!=
ÙÙ  
null
ÙÙ! %
)
ÙÙ% &
{
ıı 
return
ˆˆ 
Content
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# @
+
ˆˆA B
	dataNopNo
ˆˆC L
.
ˆˆL M
Cur
ˆˆM P
)
ˆˆP Q
;
ˆˆQ R
}
˜˜ 
using
˘˘ 
(
˘˘ 
TransactionScope
˘˘ '
trx
˘˘( +
=
˘˘, -
new
˘˘. 1
TransactionScope
˘˘2 B
(
˘˘B C
)
˘˘C D
)
˘˘D E
{
˙˙  
TblNoticeOfPayment
˚˚ &
model
˚˚' ,
=
˚˚- .
new
˚˚/ 2 
TblNoticeOfPayment
˚˚3 E
(
˚˚E F
)
˚˚F G
;
˚˚G H
model
¸¸ 
.
¸¸ 
NopNo
¸¸ 
=
¸¸  !
data
¸¸" &
.
¸¸& '
NopNo
¸¸' ,
;
¸¸, -
model
˝˝ 
.
˝˝ 
DueDate
˝˝ !
=
˝˝" #
data
˝˝$ (
.
˝˝( )
DueDate
˝˝) 0
;
˝˝0 1
model
˛˛ 
.
˛˛ 
InterestDays
˛˛ &
=
˛˛' (
data
˛˛) -
.
˛˛- .
InterestDays
˛˛. :
==
˛˛; =
null
˛˛> B
||
˛˛C E
data
˛˛F J
.
˛˛J K
InterestDays
˛˛K W
==
˛˛X Z
$str
˛˛[ ]
?
˛˛^ _
null
˛˛` d
:
˛˛e f
decimal
˛˛h o
.
˛˛o p
Parse
˛˛p u
(
˛˛u v
data
˛˛v z
.
˛˛z {
InterestDays˛˛{ á
.˛˛á à
Replace˛˛à è
(˛˛è ê
$str˛˛ê ì
,˛˛ì î
$str˛˛ï ó
)˛˛ó ò
)˛˛ò ô
;˛˛ô ö
model
ˇˇ 
.
ˇˇ 
InterestRate
ˇˇ &
=
ˇˇ' (
data
ˇˇ) -
.
ˇˇ- .
InterestRate
ˇˇ. :
==
ˇˇ; =
null
ˇˇ> B
||
ˇˇC E
data
ˇˇF J
.
ˇˇJ K
InterestRate
ˇˇK W
==
ˇˇX Z
$str
ˇˇ[ ]
?
ˇˇ^ _
null
ˇˇ` d
:
ˇˇe f
decimal
ˇˇh o
.
ˇˇo p
Parse
ˇˇp u
(
ˇˇu v
data
ˇˇv z
.
ˇˇz {
InterestRateˇˇ{ á
.ˇˇá à
Replaceˇˇà è
(ˇˇè ê
$strˇˇê ì
,ˇˇì î
$strˇˇï ó
)ˇˇó ò
)ˇˇò ô
;ˇˇô ö
model
ÄÄ 
.
ÄÄ 
RekId
ÄÄ 
=
ÄÄ  !
data
ÄÄ" &
.
ÄÄ& '
RekId
ÄÄ' ,
;
ÄÄ, -
model
ÅÅ 
.
ÅÅ 

RekNameAcc
ÅÅ $
=
ÅÅ% &
data
ÅÅ' +
.
ÅÅ+ ,

RekNameAcc
ÅÅ, 6
;
ÅÅ6 7
model
ÇÇ 
.
ÇÇ 
Cur
ÇÇ 
=
ÇÇ 
_context
ÇÇ  (
.
ÇÇ( )
TblMasterLookups
ÇÇ) 9
.
ÇÇ9 :
Where
ÇÇ: ?
(
ÇÇ? @
m
ÇÇ@ A
=>
ÇÇB D
m
ÇÇE F
.
ÇÇF G
Value
ÇÇG L
==
ÇÇM O
int
ÇÇP S
.
ÇÇS T
Parse
ÇÇT Y
(
ÇÇY Z
data
ÇÇZ ^
.
ÇÇ^ _
Cur
ÇÇ_ b
)
ÇÇb c
&&
ÇÇd f
m
ÇÇg h
.
ÇÇh i
Type
ÇÇi m
==
ÇÇn p
$str
ÇÇq {
)
ÇÇ{ |
.
ÇÇ| }
SelectÇÇ} É
(ÇÇÉ Ñ
mÇÇÑ Ö
=>ÇÇÜ à
mÇÇâ ä
.ÇÇä ã
NameÇÇã è
)ÇÇè ê
.ÇÇê ë
FirstOrDefaultÇÇë ü
(ÇÇü †
)ÇÇ† °
;ÇÇ° ¢
model
ÉÉ 
.
ÉÉ 
	AccountNo
ÉÉ #
=
ÉÉ$ %
data
ÉÉ& *
.
ÉÉ* +
	AccountNo
ÉÉ+ 4
;
ÉÉ4 5
model
ÑÑ 
.
ÑÑ 
AccountName
ÑÑ %
=
ÑÑ& '
data
ÑÑ( ,
.
ÑÑ, -
AccountName
ÑÑ- 8
;
ÑÑ8 9
model
ÖÖ 
.
ÖÖ 
Status
ÖÖ  
=
ÖÖ! "
$str
ÖÖ# ,
;
ÖÖ, -
model
ÜÜ 
.
ÜÜ 
CreatedById
ÜÜ %
=
ÜÜ& '
int
ÜÜ( +
.
ÜÜ+ ,
Parse
ÜÜ, 1
(
ÜÜ1 2
HttpContext
ÜÜ2 =
.
ÜÜ= >
Session
ÜÜ> E
.
ÜÜE F
	GetString
ÜÜF O
(
ÜÜO P
SessionConstan
ÜÜP ^
.
ÜÜ^ _
Session_UserId
ÜÜ_ m
)
ÜÜm n
)
ÜÜn o
;
ÜÜo p
model
áá 
.
áá 
CreatedTime
áá %
=
áá& '
DateTime
áá( 0
.
áá0 1
Now
áá1 4
;
áá4 5
model
àà 
.
àà 
	IsDeleted
àà #
=
àà$ %
$num
àà& '
;
àà' (
model
ââ 
.
ââ 
IsActive
ââ "
=
ââ# $
$num
ââ% &
;
ââ& '
_context
ää 
.
ää !
TblNoticeOfPayments
ää 0
.
ää0 1
Add
ää1 4
(
ää4 5
model
ää5 :
)
ää: ;
;
ää; <
_context
ãã 
.
ãã 
SaveChanges
ãã (
(
ãã( )
)
ãã) *
;
ãã* +
List
éé 
<
éé &
TblNoticeOfPaymentDetail
éé 1
>
éé1 2
nopDetailList
éé3 @
=
ééA B
JsonConvert
ééC N
.
ééN O
DeserializeObject
ééO `
<
éé` a
List
ééa e
<
éée f&
TblNoticeOfPaymentDetail
ééf ~
>
éé~ 
>éé Ä
(ééÄ Å
listDetailNopééÅ é
)ééé è
;ééè ê
if
èè 
(
èè 
nopDetailList
èè %
!=
èè& (
null
èè) -
)
èè- .
{
êê 
foreach
ëë 
(
ëë  !
var
ëë! $
item
ëë% )
in
ëë* ,
nopDetailList
ëë- :
)
ëë: ;
{
íí &
TblNoticeOfPaymentDetail
ìì 4
	nopDetail
ìì5 >
=
ìì? @
new
ììA D&
TblNoticeOfPaymentDetail
ììE ]
(
ìì] ^
)
ìì^ _
;
ìì_ `
	nopDetail
îî %
.
îî% &
NopId
îî& +
=
îî, -
model
îî. 3
.
îî3 4
Id
îî4 6
;
îî6 7
	nopDetail
ïï %
.
ïï% &
CreditorRef
ïï& 1
=
ïï2 3
item
ïï4 8
.
ïï8 9
CreditorRef
ïï9 D
;
ïïD E
	nopDetail
ññ %
.
ññ% &
Outstanding
ññ& 1
=
ññ2 3
item
ññ4 8
.
ññ8 9
Outstanding
ññ9 D
;
ññD E
	nopDetail
óó %
.
óó% &
	Principal
óó& /
=
óó0 1
item
óó2 6
.
óó6 7
	Principal
óó7 @
;
óó@ A
	nopDetail
òò %
.
òò% &
Interest
òò& .
=
òò/ 0
item
òò1 5
.
òò5 6
Interest
òò6 >
;
òò> ?
	nopDetail
ôô %
.
ôô% &
Fee
ôô& )
=
ôô* +
item
ôô, 0
.
ôô0 1
Fee
ôô1 4
;
ôô4 5
	nopDetail
öö %
.
öö% &
CreatedTime
öö& 1
=
öö2 3
DateTime
öö4 <
.
öö< =
Now
öö= @
;
öö@ A
	nopDetail
õõ %
.
õõ% &
CreatedById
õõ& 1
=
õõ2 3
int
õõ4 7
.
õõ7 8
Parse
õõ8 =
(
õõ= >
HttpContext
õõ> I
.
õõI J
Session
õõJ Q
.
õõQ R
	GetString
õõR [
(
õõ[ \
SessionConstan
õõ\ j
.
õõj k
Session_UserId
õõk y
)
õõy z
)
õõz {
;
õõ{ |
	nopDetail
úú %
.
úú% &
IsActive
úú& .
=
úú/ 0
$num
úú1 2
;
úú2 3
	nopDetail
ùù %
.
ùù% &
	IsDeleted
ùù& /
=
ùù0 1
$num
ùù2 3
;
ùù3 4
_context
ûû $
.
ûû$ %'
TblNoticeOfPaymentDetails
ûû% >
.
ûû> ?
Add
ûû? B
(
ûûB C
	nopDetail
ûûC L
)
ûûL M
;
ûûM N
}
üü 
_context
††  
.
††  !
SaveChanges
††! ,
(
††, -
)
††- .
;
††. /
}
°° 
List
££ 
<
££ "
TblFileUploadNopTemp
££ -
>
££- .
nopFileList
££/ :
=
££; <
_context
££= E
.
££E F#
TblFileUploadNopTemps
££F [
.
££[ \
Where
££\ a
(
££a b
m
££b c
=>
££d f
m
££g h
.
££h i
RandomString
££i u
==
££v x
randomString££y Ö
&&££Ü à
m££â ä
.££ä ã
IsActive££ã ì
==££î ñ
$num££ó ò
&&££ô õ
m££ú ù
.££ù û
	IsDeleted££û ß
==££® ™
$num££´ ¨
)££¨ ≠
.££≠ Æ
ToList££Æ ¥
(££¥ µ
)££µ ∂
;££∂ ∑
if
§§ 
(
§§ 
nopFileList
§§ #
!=
§§$ &
null
§§' +
)
§§+ ,
{
•• 
foreach
¶¶ 
(
¶¶  !
var
¶¶! $
item
¶¶% )
in
¶¶* ,
nopFileList
¶¶- 8
)
¶¶8 9
{
ßß 
TblFileUploadNop
®® ,
nopFile
®®- 4
=
®®5 6
new
®®7 :
TblFileUploadNop
®®; K
(
®®K L
)
®®L M
;
®®M N
nopFile
©© #
.
©©# $
IdNop
©©$ )
=
©©* +
(
©©, -
int
©©- 0
?
©©0 1
)
©©1 2
model
©©2 7
.
©©7 8
Id
©©8 :
;
©©: ;
nopFile
™™ #
.
™™# $
FileName
™™$ ,
=
™™- .
item
™™/ 3
.
™™3 4
FileName
™™4 <
;
™™< =
nopFile
´´ #
.
´´# $
FileSize
´´$ ,
=
´´- .
item
´´/ 3
.
´´3 4
FileSize
´´4 <
;
´´< =
nopFile
¨¨ #
.
¨¨# $
FilePath
¨¨$ ,
=
¨¨- .
item
¨¨/ 3
.
¨¨3 4
FilePath
¨¨4 <
;
¨¨< =
nopFile
≠≠ #
.
≠≠# $
FileExt
≠≠$ +
=
≠≠, -
item
≠≠. 2
.
≠≠2 3
FileExt
≠≠3 :
;
≠≠: ;
nopFile
ÆÆ #
.
ÆÆ# $

UploadTime
ÆÆ$ .
=
ÆÆ/ 0
DateTime
ÆÆ1 9
.
ÆÆ9 :
Now
ÆÆ: =
;
ÆÆ= >
nopFile
ØØ #
.
ØØ# $

UploadById
ØØ$ .
=
ØØ/ 0
int
ØØ1 4
.
ØØ4 5
Parse
ØØ5 :
(
ØØ: ;
HttpContext
ØØ; F
.
ØØF G
Session
ØØG N
.
ØØN O
	GetString
ØØO X
(
ØØX Y
SessionConstan
ØØY g
.
ØØg h
Session_UserId
ØØh v
)
ØØv w
)
ØØw x
;
ØØx y
nopFile
∞∞ #
.
∞∞# $
IsActive
∞∞$ ,
=
∞∞- .
$num
∞∞/ 0
;
∞∞0 1
nopFile
±± #
.
±±# $
	IsDeleted
±±$ -
=
±±. /
$num
±±0 1
;
±±1 2
_context
≤≤ $
.
≤≤$ %
TblFileUploadNops
≤≤% 6
.
≤≤6 7
Add
≤≤7 :
(
≤≤: ;
nopFile
≤≤; B
)
≤≤B C
;
≤≤C D
}
≥≥ 
_context
¥¥  
.
¥¥  !
SaveChanges
¥¥! ,
(
¥¥, -
)
¥¥- .
;
¥¥. /
}
µµ 
trx
èè 
.
èè 
Complete
èè  
(
èè  !
)
èè! "
;
èè" #
}
íí 
return
îî 
Content
îî 
(
îî 
$str
îî !
)
îî! "
;
îî" #
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ 
Ex
ññ 
)
ññ  
{
óó 
return
òò 
Content
òò 
(
òò 
	GetConfig
òò (
.
òò( )

AppSetting
òò) 3
[
òò3 4
$str
òò4 M
]
òòM N
)
òòN O
;
òòO P
}
ôô 
}
öö 	
public
õõ 
ActionResult
õõ '
SubmitCreateDetailNopTemp
õõ 5
(
õõ5 6(
TblNoticeOfPaymentDetailVM
õõ6 P
data
õõQ U
,
õõU V
string
õõW ]
uniq
õõ^ b
)
õõb c
{
úú 	
if
ùù 
(
ùù 
!
ùù 
lastSession
ùù 
.
ùù 
Update
ùù #
(
ùù# $
)
ùù$ %
)
ùù% &
{
ûû 
return
üü 
RedirectToAction
üü '
(
üü' (
$str
üü( /
,
üü/ 0
	GetConfig
üü1 :
.
üü: ;

AppSetting
üü; E
[
üüE F
$str
üüF n
]
üün o
+
üüp q
$str
üür y
,
üüy z
new
üü{ ~
{üü Ä
aüüÅ Ç
=üüÉ Ñ
trueüüÖ â
}üüä ã
)üüã å
;üüå ç
}
†† 
var
¢¢ 
location
¢¢ 
=
¢¢ 
new
¢¢ 
Uri
¢¢ "
(
¢¢" #
$"
¢¢# %
{
¢¢% &
Request
¢¢& -
.
¢¢- .
Scheme
¢¢. 4
}
¢¢4 5
$str
¢¢5 8
{
¢¢8 9
Request
¢¢9 @
.
¢¢@ A
Host
¢¢A E
}
¢¢E F
{
¢¢F G
Request
¢¢G N
.
¢¢N O
Path
¢¢O S
}
¢¢S T
"
¢¢T U
)
¢¢U V
;
¢¢V W
string
££ 
Path
££ 
=
££ 
location
££ "
.
££" #
AbsolutePath
££# /
.
££/ 0
Replace
££0 7
(
££7 8
this
££8 <
.
££< =
ControllerContext
££= N
.
££N O
	RouteData
££O X
.
££X Y
Values
££Y _
[
££_ `
$str
££` h
]
££h i
.
££i j
ToString
££j r
(
££r s
)
££s t
,
££t u
$str
££v }
)
££} ~
;
££~ 
if
•• 
(
•• 
!
•• 
accessSecurity
•• 
.
••  
IsGetAccess
••  +
(
••+ ,
$str
••, 0
+
••1 2
Path
••3 7
)
••7 8
)
••8 9
{
¶¶ 
return
ßß 
RedirectToAction
ßß '
(
ßß' (
$str
ßß( 3
,
ßß3 4
$str
ßß5 <
)
ßß< =
;
ßß= >
}
®® 
try
™™ 
{
´´ 
using
≤≤ 
(
≤≤ 
TransactionScope
≤≤ '
trx
≤≤( +
=
≤≤, -
new
≤≤. 1
TransactionScope
≤≤2 B
(
≤≤B C
)
≤≤C D
)
≤≤D E
{
≥≥ *
TblNoticeOfPaymentDetailTemp
¥¥ 0
model
¥¥1 6
=
¥¥7 8
new
¥¥9 <*
TblNoticeOfPaymentDetailTemp
¥¥= Y
(
¥¥Y Z
)
¥¥Z [
;
¥¥[ \
model
µµ 
.
µµ 
CreditorRef
µµ %
=
µµ& '
data
µµ( ,
.
µµ, -
CreditorRef
µµ- 8
;
µµ8 9
model
∂∂ 
.
∂∂ 
Outstanding
∂∂ %
=
∂∂& '
decimal
∂∂( /
.
∂∂/ 0
Parse
∂∂0 5
(
∂∂5 6
data
∂∂6 :
.
∂∂: ;
Outstanding
∂∂; F
.
∂∂F G
Replace
∂∂G N
(
∂∂N O
$str
∂∂O R
,
∂∂R S
$str
∂∂T V
)
∂∂V W
)
∂∂W X
;
∂∂X Y
model
∑∑ 
.
∑∑ 
	Principal
∑∑ #
=
∑∑$ %
decimal
∑∑& -
.
∑∑- .
Parse
∑∑. 3
(
∑∑3 4
data
∑∑4 8
.
∑∑8 9
	Principal
∑∑9 B
.
∑∑B C
Replace
∑∑C J
(
∑∑J K
$str
∑∑K N
,
∑∑N O
$str
∑∑P R
)
∑∑R S
)
∑∑S T
;
∑∑T U
model
∏∏ 
.
∏∏ 
Interest
∏∏ "
=
∏∏# $
decimal
∏∏% ,
.
∏∏, -
Parse
∏∏- 2
(
∏∏2 3
data
∏∏3 7
.
∏∏7 8
Interest
∏∏8 @
.
∏∏@ A
Replace
∏∏A H
(
∏∏H I
$str
∏∏I L
,
∏∏L M
$str
∏∏N P
)
∏∏P Q
)
∏∏Q R
;
∏∏R S
model
ππ 
.
ππ 
Fee
ππ 
=
ππ 
decimal
ππ  '
.
ππ' (
Parse
ππ( -
(
ππ- .
data
ππ. 2
.
ππ2 3
Fee
ππ3 6
.
ππ6 7
Replace
ππ7 >
(
ππ> ?
$str
ππ? B
,
ππB C
$str
ππD F
)
ππF G
)
ππG H
;
ππH I
model
∫∫ 
.
∫∫ 
IsActive
∫∫ "
=
∫∫# $
$num
∫∫% &
;
∫∫& '
model
ªª 
.
ªª 
	IsDeleted
ªª #
=
ªª$ %
$num
ªª& '
;
ªª' (
model
ºº 
.
ºº 
RandomString
ºº &
=
ºº' (
uniq
ºº) -
;
ºº- .
_context
ææ 
.
ææ +
TblNoticeOfPaymentDetailTemps
ææ :
.
ææ: ;
Add
ææ; >
(
ææ> ?
model
ææ? D
)
ææD E
;
ææE F
_context
øø 
.
øø 
SaveChanges
øø (
(
øø( )
)
øø) *
;
øø* +
trx
¬¬ 
.
¬¬ 
Complete
¬¬  
(
¬¬  !
)
¬¬! "
;
¬¬" #
}
√√ 
return
≈≈ 
Content
≈≈ 
(
≈≈ 
$str
≈≈ !
)
≈≈! "
;
≈≈" #
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   
return
ÀÀ 
Content
ÀÀ 
(
ÀÀ 
	GetConfig
ÀÀ (
.
ÀÀ( )

AppSetting
ÀÀ) 3
[
ÀÀ3 4
$str
ÀÀ4 O
]
ÀÀO P
)
ÀÀP Q
;
ÀÀQ R
}
ÃÃ 
}
ÕÕ 	
public
ŒŒ 
ActionResult
ŒŒ #
SubmitCreateDetailNop
ŒŒ 1
(
ŒŒ1 2(
TblNoticeOfPaymentDetailVM
ŒŒ2 L
data
ŒŒM Q
,
ŒŒQ R
string
ŒŒS Y
uniq
ŒŒZ ^
)
ŒŒ^ _
{
œœ 	
if
–– 
(
–– 
!
–– 
lastSession
–– 
.
–– 
Update
–– #
(
––# $
)
––$ %
)
––% &
{
—— 
return
““ 
RedirectToAction
““ '
(
““' (
$str
““( /
,
““/ 0
	GetConfig
““1 :
.
““: ;

AppSetting
““; E
[
““E F
$str
““F n
]
““n o
+
““p q
$str
““r y
,
““y z
new
““{ ~
{““ Ä
a““Å Ç
=““É Ñ
true““Ö â
}““ä ã
)““ã å
;““å ç
}
”” 
var
’’ 
location
’’ 
=
’’ 
new
’’ 
Uri
’’ "
(
’’" #
$"
’’# %
{
’’% &
Request
’’& -
.
’’- .
Scheme
’’. 4
}
’’4 5
$str
’’5 8
{
’’8 9
Request
’’9 @
.
’’@ A
Host
’’A E
}
’’E F
{
’’F G
Request
’’G N
.
’’N O
Path
’’O S
}
’’S T
"
’’T U
)
’’U V
;
’’V W
string
÷÷ 
Path
÷÷ 
=
÷÷ 
location
÷÷ "
.
÷÷" #
AbsolutePath
÷÷# /
.
÷÷/ 0
Replace
÷÷0 7
(
÷÷7 8
this
÷÷8 <
.
÷÷< =
ControllerContext
÷÷= N
.
÷÷N O
	RouteData
÷÷O X
.
÷÷X Y
Values
÷÷Y _
[
÷÷_ `
$str
÷÷` h
]
÷÷h i
.
÷÷i j
ToString
÷÷j r
(
÷÷r s
)
÷÷s t
,
÷÷t u
$str
÷÷v }
)
÷÷} ~
;
÷÷~ 
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
accessSecurity
ÿÿ 
.
ÿÿ  
IsGetAccess
ÿÿ  +
(
ÿÿ+ ,
$str
ÿÿ, 0
+
ÿÿ1 2
Path
ÿÿ3 7
)
ÿÿ7 8
)
ÿÿ8 9
{
ŸŸ 
return
⁄⁄ 
RedirectToAction
⁄⁄ '
(
⁄⁄' (
$str
⁄⁄( 3
,
⁄⁄3 4
$str
⁄⁄5 <
)
⁄⁄< =
;
⁄⁄= >
}
€€ 
try
›› 
{
ﬁﬁ 
using
ÂÂ 
(
ÂÂ 
TransactionScope
ÂÂ '
trx
ÂÂ( +
=
ÂÂ, -
new
ÂÂ. 1
TransactionScope
ÂÂ2 B
(
ÂÂB C
)
ÂÂC D
)
ÂÂD E
{
ÊÊ &
TblNoticeOfPaymentDetail
ÁÁ ,
model
ÁÁ- 2
=
ÁÁ3 4
new
ÁÁ5 8&
TblNoticeOfPaymentDetail
ÁÁ9 Q
(
ÁÁQ R
)
ÁÁR S
;
ÁÁS T
model
ËË 
.
ËË 
NopId
ËË 
=
ËË  !
int
ËË" %
.
ËË% &
Parse
ËË& +
(
ËË+ ,
uniq
ËË, 0
)
ËË0 1
;
ËË1 2
model
ÈÈ 
.
ÈÈ 
CreditorRef
ÈÈ %
=
ÈÈ& '
data
ÈÈ( ,
.
ÈÈ, -
CreditorRef
ÈÈ- 8
;
ÈÈ8 9
model
ÍÍ 
.
ÍÍ 
Outstanding
ÍÍ %
=
ÍÍ& '
decimal
ÍÍ( /
.
ÍÍ/ 0
Parse
ÍÍ0 5
(
ÍÍ5 6
data
ÍÍ6 :
.
ÍÍ: ;
Outstanding
ÍÍ; F
.
ÍÍF G
Replace
ÍÍG N
(
ÍÍN O
$str
ÍÍO R
,
ÍÍR S
$str
ÍÍT V
)
ÍÍV W
)
ÍÍW X
;
ÍÍX Y
model
ÎÎ 
.
ÎÎ 
	Principal
ÎÎ #
=
ÎÎ$ %
decimal
ÎÎ& -
.
ÎÎ- .
Parse
ÎÎ. 3
(
ÎÎ3 4
data
ÎÎ4 8
.
ÎÎ8 9
	Principal
ÎÎ9 B
.
ÎÎB C
Replace
ÎÎC J
(
ÎÎJ K
$str
ÎÎK N
,
ÎÎN O
$str
ÎÎP R
)
ÎÎR S
)
ÎÎS T
;
ÎÎT U
model
ÏÏ 
.
ÏÏ 
Interest
ÏÏ "
=
ÏÏ# $
decimal
ÏÏ% ,
.
ÏÏ, -
Parse
ÏÏ- 2
(
ÏÏ2 3
data
ÏÏ3 7
.
ÏÏ7 8
Interest
ÏÏ8 @
.
ÏÏ@ A
Replace
ÏÏA H
(
ÏÏH I
$str
ÏÏI L
,
ÏÏL M
$str
ÏÏN P
)
ÏÏP Q
)
ÏÏQ R
;
ÏÏR S
model
ÌÌ 
.
ÌÌ 
Fee
ÌÌ 
=
ÌÌ 
decimal
ÌÌ  '
.
ÌÌ' (
Parse
ÌÌ( -
(
ÌÌ- .
data
ÌÌ. 2
.
ÌÌ2 3
Fee
ÌÌ3 6
.
ÌÌ6 7
Replace
ÌÌ7 >
(
ÌÌ> ?
$str
ÌÌ? B
,
ÌÌB C
$str
ÌÌD F
)
ÌÌF G
)
ÌÌG H
;
ÌÌH I
model
ÓÓ 
.
ÓÓ 
CreatedById
ÓÓ %
=
ÓÓ& '
int
ÓÓ( +
.
ÓÓ+ ,
Parse
ÓÓ, 1
(
ÓÓ1 2
HttpContext
ÓÓ2 =
.
ÓÓ= >
Session
ÓÓ> E
.
ÓÓE F
	GetString
ÓÓF O
(
ÓÓO P
SessionConstan
ÓÓP ^
.
ÓÓ^ _
Session_UserId
ÓÓ_ m
)
ÓÓm n
)
ÓÓn o
;
ÓÓo p
model
ÔÔ 
.
ÔÔ 
IsActive
ÔÔ "
=
ÔÔ# $
$num
ÔÔ% &
;
ÔÔ& '
model
 
.
 
	IsDeleted
 #
=
$ %
$num
& '
;
' (
_context
ÒÒ 
.
ÒÒ '
TblNoticeOfPaymentDetails
ÒÒ 6
.
ÒÒ6 7
Add
ÒÒ7 :
(
ÒÒ: ;
model
ÒÒ; @
)
ÒÒ@ A
;
ÒÒA B
_context
ÚÚ 
.
ÚÚ 
SaveChanges
ÚÚ (
(
ÚÚ( )
)
ÚÚ) *
;
ÚÚ* +
trx
ÛÛ 
.
ÛÛ 
Complete
ÛÛ  
(
ÛÛ  !
)
ÛÛ! "
;
ÛÛ" #
}
ÙÙ 
return
ˆˆ 
Content
ˆˆ 
(
ˆˆ 
$str
ˆˆ !
)
ˆˆ! "
;
ˆˆ" #
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
ex
˘˘ 
)
˘˘  
{
˙˙ 
return
˚˚ 
Content
˚˚ 
(
˚˚ 
	GetConfig
˚˚ (
.
˚˚( )

AppSetting
˚˚) 3
[
˚˚3 4
$str
˚˚4 O
]
˚˚O P
)
˚˚P Q
;
˚˚Q R
}
¸¸ 
}
˝˝ 	
public
˛˛ 
async
˛˛ 
Task
˛˛ 
<
˛˛ 
ActionResult
˛˛ &
>
˛˛& '
SubmitExcelCreate
˛˛( 9
(
˛˛9 :'
NoticeOfPayment_ViewModel
˛˛: S
model
˛˛T Y
)
˛˛Y Z
{
ˇˇ 	
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
lastSession
ÄÄ 
.
ÄÄ 
Update
ÄÄ #
(
ÄÄ# $
)
ÄÄ$ %
)
ÄÄ% &
{
ÅÅ 
return
ÇÇ 
RedirectToAction
ÇÇ '
(
ÇÇ' (
$str
ÇÇ( /
,
ÇÇ/ 0
	GetConfig
ÇÇ1 :
.
ÇÇ: ;

AppSetting
ÇÇ; E
[
ÇÇE F
$str
ÇÇF n
]
ÇÇn o
+
ÇÇp q
$str
ÇÇr y
,
ÇÇy z
new
ÇÇ{ ~
{ÇÇ Ä
aÇÇÅ Ç
=ÇÇÉ Ñ
trueÇÇÖ â
}ÇÇä ã
)ÇÇã å
;ÇÇå ç
}
ÉÉ 
var
ÑÑ 
location
ÑÑ 
=
ÑÑ 
new
ÑÑ 
Uri
ÑÑ "
(
ÑÑ" #
$"
ÑÑ# %
{
ÑÑ% &
Request
ÑÑ& -
.
ÑÑ- .
Scheme
ÑÑ. 4
}
ÑÑ4 5
$str
ÑÑ5 8
{
ÑÑ8 9
Request
ÑÑ9 @
.
ÑÑ@ A
Host
ÑÑA E
}
ÑÑE F
{
ÑÑF G
Request
ÑÑG N
.
ÑÑN O
Path
ÑÑO S
}
ÑÑS T
"
ÑÑT U
)
ÑÑU V
;
ÑÑV W
string
ÖÖ 
Patha
ÖÖ 
=
ÖÖ 
location
ÖÖ #
.
ÖÖ# $
AbsolutePath
ÖÖ$ 0
.
ÖÖ0 1
Replace
ÖÖ1 8
(
ÖÖ8 9
this
ÖÖ9 =
.
ÖÖ= >
ControllerContext
ÖÖ> O
.
ÖÖO P
	RouteData
ÖÖP Y
.
ÖÖY Z
Values
ÖÖZ `
[
ÖÖ` a
$str
ÖÖa i
]
ÖÖi j
.
ÖÖj k
ToString
ÖÖk s
(
ÖÖs t
)
ÖÖt u
,
ÖÖu v
$str
ÖÖw ~
)
ÖÖ~ 
;ÖÖ Ä
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
accessSecurity
ÜÜ 
.
ÜÜ  
IsGetAccess
ÜÜ  +
(
ÜÜ+ ,
$str
ÜÜ, 0
+
ÜÜ1 2
Patha
ÜÜ3 8
)
ÜÜ8 9
)
ÜÜ9 :
{
áá 
return
àà 
RedirectToAction
àà '
(
àà' (
$str
àà( 3
,
àà3 4
$str
àà5 <
)
àà< =
;
àà= >
}
ââ 
try
ãã 
{
åå 
var
çç 
regex
çç 
=
çç 
await
çç !
RegexRequest
çç" .
.
çç. /
RegexValidation
çç/ >
(
çç> ?
model
çç? D
)
ççD E
;
ççE F
if
éé 
(
éé 
!
éé 
regex
éé 
)
éé 
{
èè 
return
êê 
Content
êê "
(
êê" #
$str
êê# 1
)
êê1 2
;
êê2 3
}
ëë 
var
ìì 
	increment
ìì 
=
ìì 
$num
ìì  !
;
ìì! "
using
îî 
(
îî 
var
îî 
trx
îî 
=
îî  
new
îî! $
TransactionScope
îî% 5
(
îî5 6$
TransactionScopeOption
îî6 L
.
îîL M
Required
îîM U
,
îîU V
new
îîW Z 
TransactionOptions
îî[ m
{
ïï 
Timeout
ññ 
=
ññ 
new
ññ !
TimeSpan
ññ" *
(
ññ* +
$num
ññ+ ,
,
ññ, -
$num
ññ. /
,
ññ/ 0
$num
ññ1 2
)
ññ2 3
}
óó 
,
óó -
TransactionScopeAsyncFlowOption
óó 2
.
óó2 3
Enabled
óó3 :
)
óó: ;
)
óó; <
{
òò 
if
öö 
(
öö 
model
öö 
.
öö 
File
öö "
==
öö# %
null
öö& *
)
öö* +
{
õõ 
return
úú 
Content
úú &
(
úú& '
$str
úú' F
)
úúF G
;
úúG H
}
ùù 
else
ûû 
{
üü &
TblMasterSystemParameter
†† 0!
ConfigAppsLocalPath
††1 D
=
††E F
_context
††G O
.
††O P'
TblMasterSystemParameters
††P i
.
††i j
Where
††j o
(
††o p
m
††p q
=>
††r t
m
††u v
.
††v w
Key
††w z
==
††{ }
$str††~ ç
)††ç é
.††é è
FirstOrDefault††è ù
(††ù û
)††û ü
;††ü †
List
¢¢ 
<
¢¢ *
TblNoticeOfPaymentDetailTemp
¢¢ 9
>
¢¢9 :
list
¢¢; ?
=
¢¢@ A
_context
¢¢B J
.
¢¢J K+
TblNoticeOfPaymentDetailTemps
¢¢K h
.
¢¢h i
Where
¢¢i n
(
¢¢n o
m
¢¢o p
=>
¢¢q s
m
¢¢t u
.
¢¢u v
RandomString¢¢v Ç
==¢¢É Ö
model¢¢Ü ã
.¢¢ã å
RandomString¢¢å ò
)¢¢ò ô
.¢¢ô ö
ToList¢¢ö †
(¢¢† °
)¢¢° ¢
;¢¢¢ £
if
££ 
(
££ 
list
££  
.
££  !
Count
££! &
(
££& '
)
££' (
!=
££) +
$num
££, -
)
££- .
{
§§ 
return
•• "
Content
••# *
(
••* +
$str
••+ B
)
••B C
;
••C D
}
¶¶ 
var
®® 

RowErrorKe
®® &
=
®®' (
$num
®®) *
;
®®* +
string
´´ #
AllowedFileUploadType
´´ 4
=
´´5 6
$str
´´7 I
;
´´I J
decimal
¨¨ 
SizeFileNon
¨¨  +
=
¨¨, -
model
¨¨. 3
.
¨¨3 4
File
¨¨4 8
.
¨¨8 9
Length
¨¨9 ?
/
¨¨@ A
$num
¨¨B I
;
¨¨I J
string
≠≠ 
ExtNon
≠≠ %
=
≠≠& '
Path
≠≠( ,
.
≠≠, -
GetExtension
≠≠- 9
(
≠≠9 :
model
≠≠: ?
.
≠≠? @
File
≠≠@ D
.
≠≠D E
FileName
≠≠E M
)
≠≠M N
;
≠≠N O
if
∞∞ 
(
∞∞ 
!
∞∞ #
AllowedFileUploadType
∞∞ 2
.
∞∞2 3
Contains
∞∞3 ;
(
∞∞; <
ExtNon
∞∞< B
)
∞∞B C
)
∞∞C D
{
±± 
return
≤≤ "
Content
≤≤# *
(
≤≤* +
$str
≤≤+ C
)
≤≤C D
;
≤≤D E
}
≥≥ 
if
∫∫ 
(
∫∫ 
SizeFileNon
∫∫ '
<=
∫∫( *
$num
∫∫+ -
)
∫∫- .
{
ªª 
string
ºº "
sFileExtensionNon
ºº# 4
=
ºº5 6
Path
ºº7 ;
.
ºº; <
GetExtension
ºº< H
(
ººH I
model
ººI N
.
ººN O
File
ººO S
.
ººS T
FileName
ººT \
)
ºº\ ]
.
ºº] ^
ToLower
ºº^ e
(
ººe f
)
ººf g
;
ººg h
ISheet
ΩΩ "
sheet
ΩΩ# (
;
ΩΩ( )
string
ææ "
fullPathNon
ææ# .
=
ææ/ 0
Path
ææ1 5
.
ææ5 6
Combine
ææ6 =
(
ææ= >
model
ææ> C
.
ææC D
File
ææD H
.
ææH I
FileName
ææI Q
)
ææQ R
;
ææR S
var
øø %
fileNameReplaceSpaceNon
øø  7
=
øø8 9
model
øø: ?
.
øø? @
File
øø@ D
.
øøD E
FileName
øøE M
.
øøM N
Replace
øøN U
(
øøU V
$str
øøV Y
,
øøY Z
$str
øø[ ^
)
øø^ _
;
øø_ `
var
¿¿ 
path
¿¿  $
=
¿¿% &
Path
¿¿' +
.
¿¿+ ,
Combine
¿¿, 3
(
¿¿3 4!
ConfigAppsLocalPath
¿¿4 G
.
¿¿G H
Value
¿¿H M
,
¿¿M N%
fileNameReplaceSpaceNon
¿¿O f
)
¿¿f g
;
¿¿g h
using
¡¡ !
(
¡¡" #
var
¡¡# &
stream
¡¡' -
=
¡¡. /
new
¡¡0 3
MemoryStream
¡¡4 @
(
¡¡@ A
)
¡¡A B
)
¡¡B C
{
¬¬ 
model
√√  %
.
√√% &
File
√√& *
.
√√* +
CopyTo
√√+ 1
(
√√1 2
stream
√√2 8
)
√√8 9
;
√√9 :
stream
ƒƒ  &
.
ƒƒ& '
Position
ƒƒ' /
=
ƒƒ0 1
$num
ƒƒ2 3
;
ƒƒ3 4
if
≈≈  "
(
≈≈# $
sFileExtensionNon
≈≈$ 5
==
≈≈6 8
$str
≈≈9 ?
)
≈≈? @
{
∆∆  !
HSSFWorkbook
««$ 0
hssfwb
««1 7
=
««8 9
new
««: =
HSSFWorkbook
««> J
(
««J K
stream
««K Q
)
««Q R
;
««R S
sheet
»»$ )
=
»»* +
hssfwb
»», 2
.
»»2 3

GetSheetAt
»»3 =
(
»»= >
$num
»»> ?
)
»»? @
;
»»@ A
}
……  !
else
    $
{
ÀÀ  !
XSSFWorkbook
ÃÃ$ 0
hssfwb
ÃÃ1 7
=
ÃÃ8 9
new
ÃÃ: =
XSSFWorkbook
ÃÃ> J
(
ÃÃJ K
stream
ÃÃK Q
)
ÃÃQ R
;
ÃÃR S
sheet
ÕÕ$ )
=
ÕÕ* +
hssfwb
ÕÕ, 2
.
ÕÕ2 3

GetSheetAt
ÕÕ3 =
(
ÕÕ= >
$num
ÕÕ> ?
)
ÕÕ? @
;
ÕÕ@ A
}
ŒŒ  !
}
œœ 
using
““ !
(
““" #
TransactionScope
““# 3
trx2
““4 8
=
““9 :
new
““; >
TransactionScope
““? O
(
““O P$
TransactionScopeOption
““P f
.
““f g
Required
““g o
,
““o p
new
““q t!
TransactionOptions““u á
{
”” 
Timeout
‘‘  '
=
‘‘( )
new
‘‘* -
TimeSpan
‘‘. 6
(
‘‘6 7
$num
‘‘7 8
,
‘‘8 9
$num
‘‘: ;
,
‘‘; <
$num
‘‘= >
)
‘‘> ?
}
’’ 
,
’’ -
TransactionScopeAsyncFlowOption
’’ >
.
’’> ?
Enabled
’’? F
)
’’F G
)
’’G H
{
÷÷ 
for
ÿÿ  #
(
ÿÿ$ %
int
ÿÿ% (
i
ÿÿ) *
=
ÿÿ+ ,
(
ÿÿ- .
sheet
ÿÿ. 3
.
ÿÿ3 4
FirstRowNum
ÿÿ4 ?
+
ÿÿ@ A
$num
ÿÿB C
)
ÿÿC D
;
ÿÿD E
i
ÿÿF G
<=
ÿÿH J
sheet
ÿÿK P
.
ÿÿP Q

LastRowNum
ÿÿQ [
;
ÿÿ[ \
i
ÿÿ] ^
++
ÿÿ^ `
)
ÿÿ` a
{
ŸŸ  !

RowErrorKe
⁄⁄$ .
=
⁄⁄/ 0
i
⁄⁄1 2
;
⁄⁄2 3
IRow
€€$ (
row
€€) ,
=
€€- .
sheet
€€/ 4
.
€€4 5
GetRow
€€5 ;
(
€€; <
i
€€< =
)
€€= >
;
€€> ?
if
‹‹$ &
(
‹‹' (
row
‹‹( +
==
‹‹, .
null
‹‹/ 3
)
‹‹3 4
continue
‹‹5 =
;
‹‹= >
if
››$ &
(
››' (
row
››( +
.
››+ ,
Cells
››, 1
.
››1 2
All
››2 5
(
››5 6
d
››6 7
=>
››8 :
d
››; <
.
››< =
CellType
››= E
==
››F H
CellType
››I Q
.
››Q R
Blank
››R W
)
››W X
)
››X Y
continue
››Z b
;
››b c
var
ﬂﬂ$ '
a
ﬂﬂ( )
=
ﬂﬂ* +
row
ﬂﬂ, /
.
ﬂﬂ/ 0
GetCell
ﬂﬂ0 7
(
ﬂﬂ7 8
$num
ﬂﬂ8 9
)
ﬂﬂ9 :
.
ﬂﬂ: ;
ToString
ﬂﬂ; C
(
ﬂﬂC D
)
ﬂﬂD E
;
ﬂﬂE F
if
‡‡$ &
(
‡‡' (
row
‡‡( +
.
‡‡+ ,
GetCell
‡‡, 3
(
‡‡3 4
$num
‡‡4 5
)
‡‡5 6
.
‡‡6 7
ToString
‡‡7 ?
(
‡‡? @
)
‡‡@ A
!=
‡‡B D
$str
‡‡E G
)
‡‡G H
{
··$ %
CultureInfo
‚‚( 3
culture
‚‚4 ;
=
‚‚< =
new
‚‚> A
CultureInfo
‚‚B M
(
‚‚M N
$str
‚‚N U
)
‚‚U V
;
‚‚V W
var
‰‰( +
NopNotempNop
‰‰, 8
=
‰‰9 :
row
‰‰; >
.
‰‰> ?
GetCell
‰‰? F
(
‰‰F G
$num
‰‰G H
)
‰‰H I
.
‰‰I J
ToString
‰‰J R
(
‰‰R S
)
‰‰S T
==
‰‰U W
$str
‰‰X Z
||
‰‰[ ]
row
‰‰^ a
.
‰‰a b
GetCell
‰‰b i
(
‰‰i j
$num
‰‰j k
)
‰‰k l
.
‰‰l m
ToString
‰‰m u
(
‰‰u v
)
‰‰v w
==
‰‰x z
null
‰‰{ 
?‰‰Ä Å
$str‰‰Ç Ñ
:‰‰Ö Ü
row‰‰á ä
.‰‰ä ã
GetCell‰‰ã í
(‰‰í ì
$num‰‰ì î
)‰‰î ï
.‰‰ï ñ
ToString‰‰ñ û
(‰‰û ü
)‰‰ü †
;‰‰† °
var
ÂÂ( +
NopNotempNopTemp
ÂÂ, <
=
ÂÂ= >
row
ÂÂ? B
.
ÂÂB C
GetCell
ÂÂC J
(
ÂÂJ K
$num
ÂÂK L
)
ÂÂL M
.
ÂÂM N
ToString
ÂÂN V
(
ÂÂV W
)
ÂÂW X
==
ÂÂY [
$str
ÂÂ\ ^
||
ÂÂ_ a
row
ÂÂb e
.
ÂÂe f
GetCell
ÂÂf m
(
ÂÂm n
$num
ÂÂn o
)
ÂÂo p
.
ÂÂp q
ToString
ÂÂq y
(
ÂÂy z
)
ÂÂz {
==
ÂÂ| ~
nullÂÂ É
?ÂÂÑ Ö
$strÂÂÜ à
:ÂÂâ ä
rowÂÂã é
.ÂÂé è
GetCellÂÂè ñ
(ÂÂñ ó
$numÂÂó ò
)ÂÂò ô
.ÂÂô ö
ToStringÂÂö ¢
(ÂÂ¢ £
)ÂÂ£ §
;ÂÂ§ • 
TblNoticeOfPayment
ÁÁ( :
ListTempNop
ÁÁ; F
=
ÁÁG H
_context
ÁÁI Q
.
ÁÁQ R!
TblNoticeOfPayments
ÁÁR e
.
ÁÁe f
Where
ÁÁf k
(
ÁÁk l
m
ÁÁl m
=>
ÁÁn p
m
ÁÁq r
.
ÁÁr s
NopNo
ÁÁs x
==
ÁÁy {
NopNotempNopÁÁ| à
&&ÁÁâ ã
mÁÁå ç
.ÁÁç é
	IsDeletedÁÁé ó
==ÁÁò ö
$numÁÁõ ú
)ÁÁú ù
.ÁÁù û
FirstOrDefaultÁÁû ¨
(ÁÁ¨ ≠
)ÁÁ≠ Æ
;ÁÁÆ Ø&
TblNoticeOfPaymentDetail
ËË( @
ListTempNopDetail
ËËA R
=
ËËS T
_context
ËËU ]
.
ËË] ^'
TblNoticeOfPaymentDetails
ËË^ w
.
ËËw x
Where
ËËx }
(
ËË} ~
m
ËË~ 
=>ËËÄ Ç
mËËÉ Ñ
.ËËÑ Ö
CreditorRefËËÖ ê
==ËËë ì 
NopNotempNopTempËËî §
&&ËË• ß
mËË® ©
.ËË© ™
	IsDeletedËË™ ≥
==ËË¥ ∂
$numËË∑ ∏
)ËË∏ π
.ËËπ ∫
FirstOrDefaultËË∫ »
(ËË» …
)ËË…  
;ËË  À
if
ÍÍ( *
(
ÍÍ+ ,
ListTempNop
ÍÍ, 7
==
ÍÍ8 :
null
ÍÍ; ?
)
ÍÍ? @
{
ÎÎ( ) 
TblNoticeOfPayment
ÏÏ, >
ListTempNew
ÏÏ? J
=
ÏÏK L
new
ÏÏM P 
TblNoticeOfPayment
ÏÏQ c
(
ÏÏc d
)
ÏÏd e
;
ÏÏe f
ListTempNew
ÌÌ, 7
.
ÌÌ7 8
NopNo
ÌÌ8 =
=
ÌÌ> ?
row
ÌÌ@ C
.
ÌÌC D
GetCell
ÌÌD K
(
ÌÌK L
$num
ÌÌL M
)
ÌÌM N
.
ÌÌN O
ToString
ÌÌO W
(
ÌÌW X
)
ÌÌX Y
==
ÌÌZ \
$str
ÌÌ] _
||
ÌÌ` b
row
ÌÌc f
.
ÌÌf g
GetCell
ÌÌg n
(
ÌÌn o
$num
ÌÌo p
)
ÌÌp q
.
ÌÌq r
ToString
ÌÌr z
(
ÌÌz {
)
ÌÌ{ |
==
ÌÌ} 
nullÌÌÄ Ñ
?ÌÌÖ Ü
$strÌÌá â
:ÌÌä ã
rowÌÌå è
.ÌÌè ê
GetCellÌÌê ó
(ÌÌó ò
$numÌÌò ô
)ÌÌô ö
.ÌÌö õ
ToStringÌÌõ £
(ÌÌ£ §
)ÌÌ§ •
;ÌÌ• ¶
ListTempNew
ÓÓ, 7
.
ÓÓ7 8
DueDate
ÓÓ8 ?
=
ÓÓ@ A
DateTime
ÓÓB J
.
ÓÓJ K
Parse
ÓÓK P
(
ÓÓP Q
row
ÓÓQ T
.
ÓÓT U
GetCell
ÓÓU \
(
ÓÓ\ ]
$num
ÓÓ] ^
)
ÓÓ^ _
.
ÓÓ_ `
ToString
ÓÓ` h
(
ÓÓh i
)
ÓÓi j
==
ÓÓk m
$str
ÓÓn p
||
ÓÓq s
row
ÓÓt w
.
ÓÓw x
GetCell
ÓÓx 
(ÓÓ Ä
$numÓÓÄ Å
)ÓÓÅ Ç
.ÓÓÇ É
ToStringÓÓÉ ã
(ÓÓã å
)ÓÓå ç
==ÓÓé ê
nullÓÓë ï
?ÓÓñ ó
$strÓÓò ö
:ÓÓõ ú
rowÓÓù †
.ÓÓ† °
GetCellÓÓ° ®
(ÓÓ® ©
$numÓÓ© ™
)ÓÓ™ ´
.ÓÓ´ ¨
ToStringÓÓ¨ ¥
(ÓÓ¥ µ
)ÓÓµ ∂
,ÓÓ∂ ∑
cultureÓÓ∏ ø
)ÓÓø ¿
;ÓÓ¿ ¡
ListTempNew
ÔÔ, 7
.
ÔÔ7 8
InterestRate
ÔÔ8 D
=
ÔÔE F
decimal
ÔÔG N
.
ÔÔN O
Parse
ÔÔO T
(
ÔÔT U
row
ÔÔU X
.
ÔÔX Y
GetCell
ÔÔY `
(
ÔÔ` a
$num
ÔÔa b
)
ÔÔb c
.
ÔÔc d
ToString
ÔÔd l
(
ÔÔl m
)
ÔÔm n
==
ÔÔo q
$str
ÔÔr t
||
ÔÔu w
row
ÔÔx {
.
ÔÔ{ |
GetCellÔÔ| É
(ÔÔÉ Ñ
$numÔÔÑ Ö
)ÔÔÖ Ü
.ÔÔÜ á
ToStringÔÔá è
(ÔÔè ê
)ÔÔê ë
==ÔÔí î
nullÔÔï ô
?ÔÔö õ
$strÔÔú û
:ÔÔü †
rowÔÔ° §
.ÔÔ§ •
GetCellÔÔ• ¨
(ÔÔ¨ ≠
$numÔÔ≠ Æ
)ÔÔÆ Ø
.ÔÔØ ∞
ToStringÔÔ∞ ∏
(ÔÔ∏ π
)ÔÔπ ∫
)ÔÔ∫ ª
;ÔÔª º
ListTempNew
, 7
.
7 8
InterestDays
8 D
=
E F
decimal
G N
.
N O
Parse
O T
(
T U
row
U X
.
X Y
GetCell
Y `
(
` a
$num
a b
)
b c
.
c d
ToString
d l
(
l m
)
m n
==
o q
$str
r t
||
u w
row
x {
.
{ |
GetCell| É
(É Ñ
$numÑ Ö
)Ö Ü
.Ü á
ToStringá è
(è ê
)ê ë
==í î
nullï ô
?ö õ
$strú û
:ü †
row° §
.§ •
GetCell• ¨
(¨ ≠
$num≠ Æ
)Æ Ø
.Ø ∞
ToString∞ ∏
(∏ π
)π ∫
)∫ ª
;ª º
var
ÒÒ, /
Rek
ÒÒ0 3
=
ÒÒ4 5
row
ÒÒ6 9
.
ÒÒ9 :
GetCell
ÒÒ: A
(
ÒÒA B
$num
ÒÒB C
)
ÒÒC D
.
ÒÒD E
ToString
ÒÒE M
(
ÒÒM N
)
ÒÒN O
==
ÒÒP R
$str
ÒÒS U
||
ÒÒV X
row
ÒÒY \
.
ÒÒ\ ]
GetCell
ÒÒ] d
(
ÒÒd e
$num
ÒÒe f
)
ÒÒf g
.
ÒÒg h
ToString
ÒÒh p
(
ÒÒp q
)
ÒÒq r
==
ÒÒs u
null
ÒÒv z
?
ÒÒ{ |
$str
ÒÒ} 
:ÒÒÄ Å
rowÒÒÇ Ö
.ÒÒÖ Ü
GetCellÒÒÜ ç
(ÒÒç é
$numÒÒé è
)ÒÒè ê
.ÒÒê ë
ToStringÒÒë ô
(ÒÒô ö
)ÒÒö õ
;ÒÒõ ú
var
ÚÚ, /
CheckRek
ÚÚ0 8
=
ÚÚ9 :
SelectDataRekId
ÚÚ; J
(
ÚÚJ K
Rek
ÚÚK N
)
ÚÚN O
;
ÚÚO P
ListTempNew
ÛÛ, 7
.
ÛÛ7 8
RekId
ÛÛ8 =
=
ÛÛ> ?
CheckRek
ÛÛ@ H
.
ÛÛH I
id
ÛÛI K
;
ÛÛK L
ListTempNew
ÙÙ, 7
.
ÙÙ7 8

RekNameAcc
ÙÙ8 B
=
ÙÙC D
CheckRek
ÙÙE M
.
ÙÙM N
text
ÙÙN R
;
ÙÙR S
var
ıı, /
Currency
ıı0 8
=
ıı9 :
row
ıı; >
.
ıı> ?
GetCell
ıı? F
(
ııF G
$num
ııG H
)
ııH I
.
ııI J
ToString
ııJ R
(
ııR S
)
ııS T
==
ııU W
$str
ııX Z
||
ıı[ ]
row
ıı^ a
.
ııa b
GetCell
ııb i
(
ııi j
$num
ııj k
)
ıık l
.
ııl m
ToString
ıım u
(
ııu v
)
ııv w
==
ııx z
null
ıı{ 
?ııÄ Å
$strııÇ Ñ
:ııÖ Ü
rowııá ä
.ııä ã
GetCellııã í
(ııí ì
$numııì î
)ııî ï
.ııï ñ
ToStringııñ û
(ııû ü
)ııü †
;ıı† °
var
ˆˆ, /
CheckCurrency
ˆˆ0 =
=
ˆˆ> ?
_context
ˆˆ@ H
.
ˆˆH I
TblMasterLookups
ˆˆI Y
.
ˆˆY Z
Where
ˆˆZ _
(
ˆˆ_ `
m
ˆˆ` a
=>
ˆˆb d
m
ˆˆe f
.
ˆˆf g
Name
ˆˆg k
==
ˆˆl n
Currency
ˆˆo w
&&
ˆˆx z
m
ˆˆ{ |
.
ˆˆ| }
Typeˆˆ} Å
==ˆˆÇ Ñ
$strˆˆÖ è
)ˆˆè ê
.ˆˆê ë
Selectˆˆë ó
(ˆˆó ò
mˆˆò ô
=>ˆˆö ú
mˆˆù û
.ˆˆû ü
Nameˆˆü £
)ˆˆ£ §
.ˆˆ§ •
FirstOrDefaultˆˆ• ≥
(ˆˆ≥ ¥
)ˆˆ¥ µ
;ˆˆµ ∂
ListTempNew
˜˜, 7
.
˜˜7 8
Cur
˜˜8 ;
=
˜˜< =
CheckCurrency
˜˜> K
;
˜˜K L
ListTempNew
¯¯, 7
.
¯¯7 8
Status
¯¯8 >
=
¯¯? @
$str
¯¯A J
;
¯¯J K
ListTempNew
˘˘, 7
.
˘˘7 8
IsActive
˘˘8 @
=
˘˘A B
$num
˘˘C D
;
˘˘D E
ListTempNew
˙˙, 7
.
˙˙7 8
	IsDeleted
˙˙8 A
=
˙˙B C
$num
˙˙D E
;
˙˙E F
ListTempNew
˚˚, 7
.
˚˚7 8
CreatedById
˚˚8 C
=
˚˚D E
int
˚˚F I
.
˚˚I J
Parse
˚˚J O
(
˚˚O P
HttpContext
˚˚P [
.
˚˚[ \
Session
˚˚\ c
.
˚˚c d
	GetString
˚˚d m
(
˚˚m n
SessionConstan
˚˚n |
.
˚˚| }
Session_UserId˚˚} ã
)˚˚ã å
)˚˚å ç
;˚˚ç é
ListTempNew
¸¸, 7
.
¸¸7 8
CreatedTime
¸¸8 C
=
¸¸D E
DateTime
¸¸F N
.
¸¸N O
Now
¸¸O R
;
¸¸R S
_context
˝˝, 4
.
˝˝4 5!
TblNoticeOfPayments
˝˝5 H
.
˝˝H I
Add
˝˝I L
(
˝˝L M
ListTempNew
˝˝M X
)
˝˝X Y
;
˝˝Y Z
_context
˛˛, 4
.
˛˛4 5
SaveChanges
˛˛5 @
(
˛˛@ A
)
˛˛A B
;
˛˛B C
if
Ä	Ä	, .
(
Ä	Ä	/ 0
ListTempNopDetail
Ä	Ä	0 A
==
Ä	Ä	B D
null
Ä	Ä	E I
)
Ä	Ä	I J
{
Å	Å	, -&
TblNoticeOfPaymentDetail
Ç	Ç	0 H
ListTempNewDetail
Ç	Ç	I Z
=
Ç	Ç	[ \
new
Ç	Ç	] `&
TblNoticeOfPaymentDetail
Ç	Ç	a y
(
Ç	Ç	y z
)
Ç	Ç	z {
;
Ç	Ç	{ |
ListTempNewDetail
É	É	0 A
.
É	É	A B
NopId
É	É	B G
=
É	É	H I
ListTempNew
É	É	J U
.
É	É	U V
Id
É	É	V X
;
É	É	X Y
ListTempNewDetail
Ñ	Ñ	0 A
.
Ñ	Ñ	A B
CreditorRef
Ñ	Ñ	B M
=
Ñ	Ñ	N O
row
Ñ	Ñ	P S
.
Ñ	Ñ	S T
GetCell
Ñ	Ñ	T [
(
Ñ	Ñ	[ \
$num
Ñ	Ñ	\ ]
)
Ñ	Ñ	] ^
.
Ñ	Ñ	^ _
ToString
Ñ	Ñ	_ g
(
Ñ	Ñ	g h
)
Ñ	Ñ	h i
==
Ñ	Ñ	j l
$str
Ñ	Ñ	m o
||
Ñ	Ñ	p r
row
Ñ	Ñ	s v
.
Ñ	Ñ	v w
GetCell
Ñ	Ñ	w ~
(
Ñ	Ñ	~ 
$numÑ	Ñ	 Ä
)Ñ	Ñ	Ä Å
.Ñ	Ñ	Å Ç
ToStringÑ	Ñ	Ç ä
(Ñ	Ñ	ä ã
)Ñ	Ñ	ã å
==Ñ	Ñ	ç è
nullÑ	Ñ	ê î
?Ñ	Ñ	ï ñ
$strÑ	Ñ	ó ô
:Ñ	Ñ	ö õ
rowÑ	Ñ	ú ü
.Ñ	Ñ	ü †
GetCellÑ	Ñ	† ß
(Ñ	Ñ	ß ®
$numÑ	Ñ	® ©
)Ñ	Ñ	© ™
.Ñ	Ñ	™ ´
ToStringÑ	Ñ	´ ≥
(Ñ	Ñ	≥ ¥
)Ñ	Ñ	¥ µ
;Ñ	Ñ	µ ∂
ListTempNewDetail
Ö	Ö	0 A
.
Ö	Ö	A B
Outstanding
Ö	Ö	B M
=
Ö	Ö	N O
decimal
Ö	Ö	P W
.
Ö	Ö	W X
Parse
Ö	Ö	X ]
(
Ö	Ö	] ^
row
Ö	Ö	^ a
.
Ö	Ö	a b
GetCell
Ö	Ö	b i
(
Ö	Ö	i j
$num
Ö	Ö	j k
)
Ö	Ö	k l
.
Ö	Ö	l m
ToString
Ö	Ö	m u
(
Ö	Ö	u v
)
Ö	Ö	v w
==
Ö	Ö	x z
$str
Ö	Ö	{ }
||Ö	Ö	~ Ä
rowÖ	Ö	Å Ñ
.Ö	Ö	Ñ Ö
GetCellÖ	Ö	Ö å
(Ö	Ö	å ç
$numÖ	Ö	ç é
)Ö	Ö	é è
.Ö	Ö	è ê
ToStringÖ	Ö	ê ò
(Ö	Ö	ò ô
)Ö	Ö	ô ö
==Ö	Ö	õ ù
nullÖ	Ö	û ¢
?Ö	Ö	£ §
$strÖ	Ö	• ß
:Ö	Ö	® ©
rowÖ	Ö	™ ≠
.Ö	Ö	≠ Æ
GetCellÖ	Ö	Æ µ
(Ö	Ö	µ ∂
$numÖ	Ö	∂ ∑
)Ö	Ö	∑ ∏
.Ö	Ö	∏ π
ToStringÖ	Ö	π ¡
(Ö	Ö	¡ ¬
)Ö	Ö	¬ √
)Ö	Ö	√ ƒ
;Ö	Ö	ƒ ≈
ListTempNewDetail
Ü	Ü	0 A
.
Ü	Ü	A B
	Principal
Ü	Ü	B K
=
Ü	Ü	L M
decimal
Ü	Ü	N U
.
Ü	Ü	U V
Parse
Ü	Ü	V [
(
Ü	Ü	[ \
row
Ü	Ü	\ _
.
Ü	Ü	_ `
GetCell
Ü	Ü	` g
(
Ü	Ü	g h
$num
Ü	Ü	h i
)
Ü	Ü	i j
.
Ü	Ü	j k
ToString
Ü	Ü	k s
(
Ü	Ü	s t
)
Ü	Ü	t u
==
Ü	Ü	v x
$str
Ü	Ü	y {
||
Ü	Ü	| ~
rowÜ	Ü	 Ç
.Ü	Ü	Ç É
GetCellÜ	Ü	É ä
(Ü	Ü	ä ã
$numÜ	Ü	ã å
)Ü	Ü	å ç
.Ü	Ü	ç é
ToStringÜ	Ü	é ñ
(Ü	Ü	ñ ó
)Ü	Ü	ó ò
==Ü	Ü	ô õ
nullÜ	Ü	ú †
?Ü	Ü	° ¢
$strÜ	Ü	£ •
:Ü	Ü	¶ ß
rowÜ	Ü	® ´
.Ü	Ü	´ ¨
GetCellÜ	Ü	¨ ≥
(Ü	Ü	≥ ¥
$numÜ	Ü	¥ µ
)Ü	Ü	µ ∂
.Ü	Ü	∂ ∑
ToStringÜ	Ü	∑ ø
(Ü	Ü	ø ¿
)Ü	Ü	¿ ¡
)Ü	Ü	¡ ¬
;Ü	Ü	¬ √
ListTempNewDetail
á	á	0 A
.
á	á	A B
Interest
á	á	B J
=
á	á	K L
decimal
á	á	M T
.
á	á	T U
Parse
á	á	U Z
(
á	á	Z [
row
á	á	[ ^
.
á	á	^ _
GetCell
á	á	_ f
(
á	á	f g
$num
á	á	g h
)
á	á	h i
.
á	á	i j
ToString
á	á	j r
(
á	á	r s
)
á	á	s t
==
á	á	u w
$str
á	á	x z
||
á	á	{ }
rowá	á	~ Å
.á	á	Å Ç
GetCellá	á	Ç â
(á	á	â ä
$numá	á	ä ã
)á	á	ã å
.á	á	å ç
ToStringá	á	ç ï
(á	á	ï ñ
)á	á	ñ ó
==á	á	ò ö
nullá	á	õ ü
?á	á	† °
$strá	á	¢ §
:á	á	• ¶
rowá	á	ß ™
.á	á	™ ´
GetCellá	á	´ ≤
(á	á	≤ ≥
$numá	á	≥ ¥
)á	á	¥ µ
.á	á	µ ∂
ToStringá	á	∂ æ
(á	á	æ ø
)á	á	ø ¿
)á	á	¿ ¡
;á	á	¡ ¬
ListTempNewDetail
à	à	0 A
.
à	à	A B
Fee
à	à	B E
=
à	à	F G
decimal
à	à	H O
.
à	à	O P
Parse
à	à	P U
(
à	à	U V
row
à	à	V Y
.
à	à	Y Z
GetCell
à	à	Z a
(
à	à	a b
$num
à	à	b d
)
à	à	d e
.
à	à	e f
ToString
à	à	f n
(
à	à	n o
)
à	à	o p
==
à	à	q s
$str
à	à	t v
||
à	à	w y
row
à	à	z }
.
à	à	} ~
GetCellà	à	~ Ö
(à	à	Ö Ü
$numà	à	Ü à
)à	à	à â
.à	à	â ä
ToStringà	à	ä í
(à	à	í ì
)à	à	ì î
==à	à	ï ó
nullà	à	ò ú
?à	à	ù û
$strà	à	ü °
:à	à	¢ £
rowà	à	§ ß
.à	à	ß ®
GetCellà	à	® Ø
(à	à	Ø ∞
$numà	à	∞ ≤
)à	à	≤ ≥
.à	à	≥ ¥
ToStringà	à	¥ º
(à	à	º Ω
)à	à	Ω æ
)à	à	æ ø
;à	à	ø ¿
ListTempNewDetail
â	â	0 A
.
â	â	A B
IsActive
â	â	B J
=
â	â	K L
$num
â	â	M N
;
â	â	N O
ListTempNewDetail
ä	ä	0 A
.
ä	ä	A B
	IsDeleted
ä	ä	B K
=
ä	ä	L M
$num
ä	ä	N O
;
ä	ä	O P
ListTempNewDetail
ã	ã	0 A
.
ã	ã	A B
CreatedById
ã	ã	B M
=
ã	ã	N O
int
ã	ã	P S
.
ã	ã	S T
Parse
ã	ã	T Y
(
ã	ã	Y Z
HttpContext
ã	ã	Z e
.
ã	ã	e f
Session
ã	ã	f m
.
ã	ã	m n
	GetString
ã	ã	n w
(
ã	ã	w x
SessionConstanã	ã	x Ü
.ã	ã	Ü á
Session_UserIdã	ã	á ï
)ã	ã	ï ñ
)ã	ã	ñ ó
;ã	ã	ó ò
ListTempNewDetail
å	å	0 A
.
å	å	A B
CreatedTime
å	å	B M
=
å	å	N O
DateTime
å	å	P X
.
å	å	X Y
Now
å	å	Y \
;
å	å	\ ]
bool
ç	ç	0 4
CheckCreRef
ç	ç	5 @
=
ç	ç	A B
CheckCreditorRef
ç	ç	C S
(
ç	ç	S T
row
ç	ç	T W
.
ç	ç	W X
GetCell
ç	ç	X _
(
ç	ç	_ `
$num
ç	ç	` a
)
ç	ç	a b
.
ç	ç	b c
ToString
ç	ç	c k
(
ç	ç	k l
)
ç	ç	l m
==
ç	ç	n p
$str
ç	ç	q s
||
ç	ç	t v
row
ç	ç	w z
.
ç	ç	z {
GetCellç	ç	{ Ç
(ç	ç	Ç É
$numç	ç	É Ñ
)ç	ç	Ñ Ö
.ç	ç	Ö Ü
ToStringç	ç	Ü é
(ç	ç	é è
)ç	ç	è ê
==ç	ç	ë ì
nullç	ç	î ò
?ç	ç	ô ö
$strç	ç	õ ù
:ç	ç	û ü
rowç	ç	† £
.ç	ç	£ §
GetCellç	ç	§ ´
(ç	ç	´ ¨
$numç	ç	¨ ≠
)ç	ç	≠ Æ
.ç	ç	Æ Ø
ToStringç	ç	Ø ∑
(ç	ç	∑ ∏
)ç	ç	∏ π
)ç	ç	π ∫
;ç	ç	∫ ª
if
é	é	0 2
(
é	é	3 4
CheckCreRef
é	é	4 ?
)
é	é	? @
{
è	è	0 1
_context
ê	ê	4 <
.
ê	ê	< ='
TblNoticeOfPaymentDetails
ê	ê	= V
.
ê	ê	V W
Add
ê	ê	W Z
(
ê	ê	Z [
ListTempNewDetail
ê	ê	[ l
)
ê	ê	l m
;
ê	ê	m n
}
ë	ë	0 1
}
ì	ì	, -
else
î	î	, 0
{
ï	ï	, -
ListTempNopDetail
ñ	ñ	0 A
.
ñ	ñ	A B
NopId
ñ	ñ	B G
=
ñ	ñ	H I
ListTempNew
ñ	ñ	J U
.
ñ	ñ	U V
Id
ñ	ñ	V X
;
ñ	ñ	X Y
ListTempNopDetail
ó	ó	0 A
.
ó	ó	A B
CreditorRef
ó	ó	B M
=
ó	ó	N O
row
ó	ó	P S
.
ó	ó	S T
GetCell
ó	ó	T [
(
ó	ó	[ \
$num
ó	ó	\ ]
)
ó	ó	] ^
.
ó	ó	^ _
ToString
ó	ó	_ g
(
ó	ó	g h
)
ó	ó	h i
==
ó	ó	j l
$str
ó	ó	m o
||
ó	ó	p r
row
ó	ó	s v
.
ó	ó	v w
GetCell
ó	ó	w ~
(
ó	ó	~ 
$numó	ó	 Ä
)ó	ó	Ä Å
.ó	ó	Å Ç
ToStringó	ó	Ç ä
(ó	ó	ä ã
)ó	ó	ã å
==ó	ó	ç è
nulló	ó	ê î
?ó	ó	ï ñ
$stró	ó	ó ô
:ó	ó	ö õ
rowó	ó	ú ü
.ó	ó	ü †
GetCelló	ó	† ß
(ó	ó	ß ®
$numó	ó	® ©
)ó	ó	© ™
.ó	ó	™ ´
ToStringó	ó	´ ≥
(ó	ó	≥ ¥
)ó	ó	¥ µ
;ó	ó	µ ∂
ListTempNopDetail
ò	ò	0 A
.
ò	ò	A B
Outstanding
ò	ò	B M
=
ò	ò	N O
decimal
ò	ò	P W
.
ò	ò	W X
Parse
ò	ò	X ]
(
ò	ò	] ^
row
ò	ò	^ a
.
ò	ò	a b
GetCell
ò	ò	b i
(
ò	ò	i j
$num
ò	ò	j k
)
ò	ò	k l
.
ò	ò	l m
ToString
ò	ò	m u
(
ò	ò	u v
)
ò	ò	v w
==
ò	ò	x z
$str
ò	ò	{ }
||ò	ò	~ Ä
rowò	ò	Å Ñ
.ò	ò	Ñ Ö
GetCellò	ò	Ö å
(ò	ò	å ç
$numò	ò	ç é
)ò	ò	é è
.ò	ò	è ê
ToStringò	ò	ê ò
(ò	ò	ò ô
)ò	ò	ô ö
==ò	ò	õ ù
nullò	ò	û ¢
?ò	ò	£ §
$strò	ò	• ß
:ò	ò	® ©
rowò	ò	™ ≠
.ò	ò	≠ Æ
GetCellò	ò	Æ µ
(ò	ò	µ ∂
$numò	ò	∂ ∑
)ò	ò	∑ ∏
.ò	ò	∏ π
ToStringò	ò	π ¡
(ò	ò	¡ ¬
)ò	ò	¬ √
)ò	ò	√ ƒ
;ò	ò	ƒ ≈
ListTempNopDetail
ô	ô	0 A
.
ô	ô	A B
	Principal
ô	ô	B K
=
ô	ô	L M
decimal
ô	ô	N U
.
ô	ô	U V
Parse
ô	ô	V [
(
ô	ô	[ \
row
ô	ô	\ _
.
ô	ô	_ `
GetCell
ô	ô	` g
(
ô	ô	g h
$num
ô	ô	h i
)
ô	ô	i j
.
ô	ô	j k
ToString
ô	ô	k s
(
ô	ô	s t
)
ô	ô	t u
==
ô	ô	v x
$str
ô	ô	y {
||
ô	ô	| ~
rowô	ô	 Ç
.ô	ô	Ç É
GetCellô	ô	É ä
(ô	ô	ä ã
$numô	ô	ã å
)ô	ô	å ç
.ô	ô	ç é
ToStringô	ô	é ñ
(ô	ô	ñ ó
)ô	ô	ó ò
==ô	ô	ô õ
nullô	ô	ú †
?ô	ô	° ¢
$strô	ô	£ •
:ô	ô	¶ ß
rowô	ô	® ´
.ô	ô	´ ¨
GetCellô	ô	¨ ≥
(ô	ô	≥ ¥
$numô	ô	¥ µ
)ô	ô	µ ∂
.ô	ô	∂ ∑
ToStringô	ô	∑ ø
(ô	ô	ø ¿
)ô	ô	¿ ¡
)ô	ô	¡ ¬
;ô	ô	¬ √
ListTempNopDetail
ö	ö	0 A
.
ö	ö	A B
Interest
ö	ö	B J
=
ö	ö	K L
decimal
ö	ö	M T
.
ö	ö	T U
Parse
ö	ö	U Z
(
ö	ö	Z [
row
ö	ö	[ ^
.
ö	ö	^ _
GetCell
ö	ö	_ f
(
ö	ö	f g
$num
ö	ö	g h
)
ö	ö	h i
.
ö	ö	i j
ToString
ö	ö	j r
(
ö	ö	r s
)
ö	ö	s t
==
ö	ö	u w
$str
ö	ö	x z
||
ö	ö	{ }
rowö	ö	~ Å
.ö	ö	Å Ç
GetCellö	ö	Ç â
(ö	ö	â ä
$numö	ö	ä ã
)ö	ö	ã å
.ö	ö	å ç
ToStringö	ö	ç ï
(ö	ö	ï ñ
)ö	ö	ñ ó
==ö	ö	ò ö
nullö	ö	õ ü
?ö	ö	† °
$strö	ö	¢ §
:ö	ö	• ¶
rowö	ö	ß ™
.ö	ö	™ ´
GetCellö	ö	´ ≤
(ö	ö	≤ ≥
$numö	ö	≥ ¥
)ö	ö	¥ µ
.ö	ö	µ ∂
ToStringö	ö	∂ æ
(ö	ö	æ ø
)ö	ö	ø ¿
)ö	ö	¿ ¡
;ö	ö	¡ ¬
ListTempNopDetail
õ	õ	0 A
.
õ	õ	A B
Fee
õ	õ	B E
=
õ	õ	F G
decimal
õ	õ	H O
.
õ	õ	O P
Parse
õ	õ	P U
(
õ	õ	U V
row
õ	õ	V Y
.
õ	õ	Y Z
GetCell
õ	õ	Z a
(
õ	õ	a b
$num
õ	õ	b d
)
õ	õ	d e
.
õ	õ	e f
ToString
õ	õ	f n
(
õ	õ	n o
)
õ	õ	o p
==
õ	õ	q s
$str
õ	õ	t v
||
õ	õ	w y
row
õ	õ	z }
.
õ	õ	} ~
GetCellõ	õ	~ Ö
(õ	õ	Ö Ü
$numõ	õ	Ü à
)õ	õ	à â
.õ	õ	â ä
ToStringõ	õ	ä í
(õ	õ	í ì
)õ	õ	ì î
==õ	õ	ï ó
nullõ	õ	ò ú
?õ	õ	ù û
$strõ	õ	ü °
:õ	õ	¢ £
rowõ	õ	§ ß
.õ	õ	ß ®
GetCellõ	õ	® Ø
(õ	õ	Ø ∞
$numõ	õ	∞ ≤
)õ	õ	≤ ≥
.õ	õ	≥ ¥
ToStringõ	õ	¥ º
(õ	õ	º Ω
)õ	õ	Ω æ
)õ	õ	æ ø
;õ	õ	ø ¿
ListTempNopDetail
ú	ú	0 A
.
ú	ú	A B
IsActive
ú	ú	B J
=
ú	ú	K L
$num
ú	ú	M N
;
ú	ú	N O
ListTempNopDetail
ù	ù	0 A
.
ù	ù	A B
	IsDeleted
ù	ù	B K
=
ù	ù	L M
$num
ù	ù	N O
;
ù	ù	O P
ListTempNopDetail
û	û	0 A
.
û	û	A B
CreatedById
û	û	B M
=
û	û	N O
int
û	û	P S
.
û	û	S T
Parse
û	û	T Y
(
û	û	Y Z
HttpContext
û	û	Z e
.
û	û	e f
Session
û	û	f m
.
û	û	m n
	GetString
û	û	n w
(
û	û	w x
SessionConstanû	û	x Ü
.û	û	Ü á
Session_UserIdû	û	á ï
)û	û	ï ñ
)û	û	ñ ó
;û	û	ó ò
ListTempNopDetail
ü	ü	0 A
.
ü	ü	A B
CreatedTime
ü	ü	B M
=
ü	ü	N O
DateTime
ü	ü	P X
.
ü	ü	X Y
Now
ü	ü	Y \
;
ü	ü	\ ]
bool
†	†	0 4
CheckCreRef
†	†	5 @
=
†	†	A B
CheckCreditorRef
†	†	C S
(
†	†	S T
row
†	†	T W
.
†	†	W X
GetCell
†	†	X _
(
†	†	_ `
$num
†	†	` a
)
†	†	a b
.
†	†	b c
ToString
†	†	c k
(
†	†	k l
)
†	†	l m
==
†	†	n p
$str
†	†	q s
||
†	†	t v
row
†	†	w z
.
†	†	z {
GetCell†	†	{ Ç
(†	†	Ç É
$num†	†	É Ñ
)†	†	Ñ Ö
.†	†	Ö Ü
ToString†	†	Ü é
(†	†	é è
)†	†	è ê
==†	†	ë ì
null†	†	î ò
?†	†	ô ö
$str†	†	õ ù
:†	†	û ü
row†	†	† £
.†	†	£ §
GetCell†	†	§ ´
(†	†	´ ¨
$num†	†	¨ ≠
)†	†	≠ Æ
.†	†	Æ Ø
ToString†	†	Ø ∑
(†	†	∑ ∏
)†	†	∏ π
)†	†	π ∫
;†	†	∫ ª
if
°	°	0 2
(
°	°	3 4
CheckCreRef
°	°	4 ?
)
°	°	? @
{
¢	¢	0 1
_context
£	£	4 <
.
£	£	< ='
TblNoticeOfPaymentDetails
£	£	= V
.
£	£	V W
Add
£	£	W Z
(
£	£	Z [
ListTempNopDetail
£	£	[ l
)
£	£	l m
;
£	£	m n
}
§	§	0 1
}
•	•	, -
_context
¶	¶	, 4
.
¶	¶	4 5
SaveChanges
¶	¶	5 @
(
¶	¶	@ A
)
¶	¶	A B
;
¶	¶	B C
}
®	®	( )
else
©	©	( ,
if
©	©	- /
(
©	©	0 1
ListTempNop
©	©	1 <
!=
©	©	= ?
null
©	©	@ D
&&
©	©	E G
ListTempNop
©	©	H S
.
©	©	S T
Status
©	©	T Z
!=
©	©	[ ]
$str
©	©	^ h
)
©	©	h i
{
™	™	( )
ListTempNop
´	´	, 7
.
´	´	7 8
NopNo
´	´	8 =
=
´	´	> ?
row
´	´	@ C
.
´	´	C D
GetCell
´	´	D K
(
´	´	K L
$num
´	´	L M
)
´	´	M N
.
´	´	N O
ToString
´	´	O W
(
´	´	W X
)
´	´	X Y
==
´	´	Z \
$str
´	´	] _
||
´	´	` b
row
´	´	c f
.
´	´	f g
GetCell
´	´	g n
(
´	´	n o
$num
´	´	o p
)
´	´	p q
.
´	´	q r
ToString
´	´	r z
(
´	´	z {
)
´	´	{ |
==
´	´	} 
null´	´	Ä Ñ
?´	´	Ö Ü
$str´	´	á â
:´	´	ä ã
row´	´	å è
.´	´	è ê
GetCell´	´	ê ó
(´	´	ó ò
$num´	´	ò ô
)´	´	ô ö
.´	´	ö õ
ToString´	´	õ £
(´	´	£ §
)´	´	§ •
;´	´	• ¶
ListTempNop
¨	¨	, 7
.
¨	¨	7 8
DueDate
¨	¨	8 ?
=
¨	¨	@ A
DateTime
¨	¨	B J
.
¨	¨	J K
Parse
¨	¨	K P
(
¨	¨	P Q
row
¨	¨	Q T
.
¨	¨	T U
GetCell
¨	¨	U \
(
¨	¨	\ ]
$num
¨	¨	] ^
)
¨	¨	^ _
.
¨	¨	_ `
ToString
¨	¨	` h
(
¨	¨	h i
)
¨	¨	i j
==
¨	¨	k m
$str
¨	¨	n p
||
¨	¨	q s
row
¨	¨	t w
.
¨	¨	w x
GetCell
¨	¨	x 
(¨	¨	 Ä
$num¨	¨	Ä Å
)¨	¨	Å Ç
.¨	¨	Ç É
ToString¨	¨	É ã
(¨	¨	ã å
)¨	¨	å ç
==¨	¨	é ê
null¨	¨	ë ï
?¨	¨	ñ ó
$str¨	¨	ò ö
:¨	¨	õ ú
row¨	¨	ù †
.¨	¨	† °
GetCell¨	¨	° ®
(¨	¨	® ©
$num¨	¨	© ™
)¨	¨	™ ´
.¨	¨	´ ¨
ToString¨	¨	¨ ¥
(¨	¨	¥ µ
)¨	¨	µ ∂
,¨	¨	∂ ∑
culture¨	¨	∏ ø
)¨	¨	ø ¿
;¨	¨	¿ ¡
ListTempNop
≠	≠	, 7
.
≠	≠	7 8
InterestRate
≠	≠	8 D
=
≠	≠	E F
decimal
≠	≠	G N
.
≠	≠	N O
Parse
≠	≠	O T
(
≠	≠	T U
row
≠	≠	U X
.
≠	≠	X Y
GetCell
≠	≠	Y `
(
≠	≠	` a
$num
≠	≠	a b
)
≠	≠	b c
.
≠	≠	c d
ToString
≠	≠	d l
(
≠	≠	l m
)
≠	≠	m n
==
≠	≠	o q
$str
≠	≠	r t
||
≠	≠	u w
row
≠	≠	x {
.
≠	≠	{ |
GetCell≠	≠	| É
(≠	≠	É Ñ
$num≠	≠	Ñ Ö
)≠	≠	Ö Ü
.≠	≠	Ü á
ToString≠	≠	á è
(≠	≠	è ê
)≠	≠	ê ë
==≠	≠	í î
null≠	≠	ï ô
?≠	≠	ö õ
$str≠	≠	ú û
:≠	≠	ü †
row≠	≠	° §
.≠	≠	§ •
GetCell≠	≠	• ¨
(≠	≠	¨ ≠
$num≠	≠	≠ Æ
)≠	≠	Æ Ø
.≠	≠	Ø ∞
ToString≠	≠	∞ ∏
(≠	≠	∏ π
)≠	≠	π ∫
)≠	≠	∫ ª
;≠	≠	ª º
ListTempNop
Æ	Æ	, 7
.
Æ	Æ	7 8
InterestDays
Æ	Æ	8 D
=
Æ	Æ	E F
decimal
Æ	Æ	G N
.
Æ	Æ	N O
Parse
Æ	Æ	O T
(
Æ	Æ	T U
row
Æ	Æ	U X
.
Æ	Æ	X Y
GetCell
Æ	Æ	Y `
(
Æ	Æ	` a
$num
Æ	Æ	a b
)
Æ	Æ	b c
.
Æ	Æ	c d
ToString
Æ	Æ	d l
(
Æ	Æ	l m
)
Æ	Æ	m n
==
Æ	Æ	o q
$str
Æ	Æ	r t
||
Æ	Æ	u w
row
Æ	Æ	x {
.
Æ	Æ	{ |
GetCellÆ	Æ	| É
(Æ	Æ	É Ñ
$numÆ	Æ	Ñ Ö
)Æ	Æ	Ö Ü
.Æ	Æ	Ü á
ToStringÆ	Æ	á è
(Æ	Æ	è ê
)Æ	Æ	ê ë
==Æ	Æ	í î
nullÆ	Æ	ï ô
?Æ	Æ	ö õ
$strÆ	Æ	ú û
:Æ	Æ	ü †
rowÆ	Æ	° §
.Æ	Æ	§ •
GetCellÆ	Æ	• ¨
(Æ	Æ	¨ ≠
$numÆ	Æ	≠ Æ
)Æ	Æ	Æ Ø
.Æ	Æ	Ø ∞
ToStringÆ	Æ	∞ ∏
(Æ	Æ	∏ π
)Æ	Æ	π ∫
)Æ	Æ	∫ ª
;Æ	Æ	ª º
var
Ø	Ø	, /
Rek
Ø	Ø	0 3
=
Ø	Ø	4 5
row
Ø	Ø	6 9
.
Ø	Ø	9 :
GetCell
Ø	Ø	: A
(
Ø	Ø	A B
$num
Ø	Ø	B C
)
Ø	Ø	C D
.
Ø	Ø	D E
ToString
Ø	Ø	E M
(
Ø	Ø	M N
)
Ø	Ø	N O
==
Ø	Ø	P R
$str
Ø	Ø	S U
||
Ø	Ø	V X
row
Ø	Ø	Y \
.
Ø	Ø	\ ]
GetCell
Ø	Ø	] d
(
Ø	Ø	d e
$num
Ø	Ø	e f
)
Ø	Ø	f g
.
Ø	Ø	g h
ToString
Ø	Ø	h p
(
Ø	Ø	p q
)
Ø	Ø	q r
==
Ø	Ø	s u
null
Ø	Ø	v z
?
Ø	Ø	{ |
$str
Ø	Ø	} 
:Ø	Ø	Ä Å
rowØ	Ø	Ç Ö
.Ø	Ø	Ö Ü
GetCellØ	Ø	Ü ç
(Ø	Ø	ç é
$numØ	Ø	é è
)Ø	Ø	è ê
.Ø	Ø	ê ë
ToStringØ	Ø	ë ô
(Ø	Ø	ô ö
)Ø	Ø	ö õ
;Ø	Ø	õ ú
var
∞	∞	, /
CheckRek
∞	∞	0 8
=
∞	∞	9 :
SelectDataRekId
∞	∞	; J
(
∞	∞	J K
Rek
∞	∞	K N
)
∞	∞	N O
;
∞	∞	O P
ListTempNop
±	±	, 7
.
±	±	7 8
RekId
±	±	8 =
=
±	±	> ?
CheckRek
±	±	@ H
.
±	±	H I
id
±	±	I K
;
±	±	K L
ListTempNop
≤	≤	, 7
.
≤	≤	7 8

RekNameAcc
≤	≤	8 B
=
≤	≤	C D
CheckRek
≤	≤	E M
.
≤	≤	M N
text
≤	≤	N R
;
≤	≤	R S
var
≥	≥	, /
Currency
≥	≥	0 8
=
≥	≥	9 :
row
≥	≥	; >
.
≥	≥	> ?
GetCell
≥	≥	? F
(
≥	≥	F G
$num
≥	≥	G H
)
≥	≥	H I
.
≥	≥	I J
ToString
≥	≥	J R
(
≥	≥	R S
)
≥	≥	S T
==
≥	≥	U W
$str
≥	≥	X Z
||
≥	≥	[ ]
row
≥	≥	^ a
.
≥	≥	a b
GetCell
≥	≥	b i
(
≥	≥	i j
$num
≥	≥	j k
)
≥	≥	k l
.
≥	≥	l m
ToString
≥	≥	m u
(
≥	≥	u v
)
≥	≥	v w
==
≥	≥	x z
null
≥	≥	{ 
?≥	≥	Ä Å
$str≥	≥	Ç Ñ
:≥	≥	Ö Ü
row≥	≥	á ä
.≥	≥	ä ã
GetCell≥	≥	ã í
(≥	≥	í ì
$num≥	≥	ì î
)≥	≥	î ï
.≥	≥	ï ñ
ToString≥	≥	ñ û
(≥	≥	û ü
)≥	≥	ü †
;≥	≥	† °
var
¥	¥	, /
CheckCurrency
¥	¥	0 =
=
¥	¥	> ?
_context
¥	¥	@ H
.
¥	¥	H I
TblMasterLookups
¥	¥	I Y
.
¥	¥	Y Z
Where
¥	¥	Z _
(
¥	¥	_ `
m
¥	¥	` a
=>
¥	¥	b d
m
¥	¥	e f
.
¥	¥	f g
Name
¥	¥	g k
==
¥	¥	l n
Currency
¥	¥	o w
&&
¥	¥	x z
m
¥	¥	{ |
.
¥	¥	| }
Type¥	¥	} Å
==¥	¥	Ç Ñ
$str¥	¥	Ö è
)¥	¥	è ê
.¥	¥	ê ë
Select¥	¥	ë ó
(¥	¥	ó ò
m¥	¥	ò ô
=>¥	¥	ö ú
m¥	¥	ù û
.¥	¥	û ü
Name¥	¥	ü £
)¥	¥	£ §
.¥	¥	§ •
FirstOrDefault¥	¥	• ≥
(¥	¥	≥ ¥
)¥	¥	¥ µ
;¥	¥	µ ∂
ListTempNop
µ	µ	, 7
.
µ	µ	7 8
Cur
µ	µ	8 ;
=
µ	µ	< =
CheckCurrency
µ	µ	> K
;
µ	µ	K L
ListTempNop
∂	∂	, 7
.
∂	∂	7 8
IsActive
∂	∂	8 @
=
∂	∂	A B
$num
∂	∂	C D
;
∂	∂	D E
ListTempNop
∑	∑	, 7
.
∑	∑	7 8
	IsDeleted
∑	∑	8 A
=
∑	∑	B C
$num
∑	∑	D E
;
∑	∑	E F
ListTempNop
∏	∏	, 7
.
∏	∏	7 8
CreatedById
∏	∏	8 C
=
∏	∏	D E
int
∏	∏	F I
.
∏	∏	I J
Parse
∏	∏	J O
(
∏	∏	O P
HttpContext
∏	∏	P [
.
∏	∏	[ \
Session
∏	∏	\ c
.
∏	∏	c d
	GetString
∏	∏	d m
(
∏	∏	m n
SessionConstan
∏	∏	n |
.
∏	∏	| }
Session_UserId∏	∏	} ã
)∏	∏	ã å
)∏	∏	å ç
;∏	∏	ç é
ListTempNop
π	π	, 7
.
π	π	7 8
CreatedTime
π	π	8 C
=
π	π	D E
DateTime
π	π	F N
.
π	π	N O
Now
π	π	O R
;
π	π	R S
_context
∫	∫	, 4
.
∫	∫	4 5
Entry
∫	∫	5 :
(
∫	∫	: ;
ListTempNop
∫	∫	; F
)
∫	∫	F G
.
∫	∫	G H
State
∫	∫	H M
=
∫	∫	N O
EntityState
∫	∫	P [
.
∫	∫	[ \
Modified
∫	∫	\ d
;
∫	∫	d e
if
º	º	, .
(
º	º	/ 0
ListTempNopDetail
º	º	0 A
==
º	º	B D
null
º	º	E I
)
º	º	I J
{
Ω	Ω	, -&
TblNoticeOfPaymentDetail
æ	æ	0 H
ListTempNewDetail
æ	æ	I Z
=
æ	æ	[ \
new
æ	æ	] `&
TblNoticeOfPaymentDetail
æ	æ	a y
(
æ	æ	y z
)
æ	æ	z {
;
æ	æ	{ |
ListTempNewDetail
ø	ø	0 A
.
ø	ø	A B
NopId
ø	ø	B G
=
ø	ø	H I
ListTempNop
ø	ø	J U
.
ø	ø	U V
Id
ø	ø	V X
;
ø	ø	X Y
ListTempNewDetail
¿	¿	0 A
.
¿	¿	A B
CreditorRef
¿	¿	B M
=
¿	¿	N O
row
¿	¿	P S
.
¿	¿	S T
GetCell
¿	¿	T [
(
¿	¿	[ \
$num
¿	¿	\ ]
)
¿	¿	] ^
.
¿	¿	^ _
ToString
¿	¿	_ g
(
¿	¿	g h
)
¿	¿	h i
==
¿	¿	j l
$str
¿	¿	m o
||
¿	¿	p r
row
¿	¿	s v
.
¿	¿	v w
GetCell
¿	¿	w ~
(
¿	¿	~ 
$num¿	¿	 Ä
)¿	¿	Ä Å
.¿	¿	Å Ç
ToString¿	¿	Ç ä
(¿	¿	ä ã
)¿	¿	ã å
==¿	¿	ç è
null¿	¿	ê î
?¿	¿	ï ñ
$str¿	¿	ó ô
:¿	¿	ö õ
row¿	¿	ú ü
.¿	¿	ü †
GetCell¿	¿	† ß
(¿	¿	ß ®
$num¿	¿	® ©
)¿	¿	© ™
.¿	¿	™ ´
ToString¿	¿	´ ≥
(¿	¿	≥ ¥
)¿	¿	¥ µ
;¿	¿	µ ∂
ListTempNewDetail
¡	¡	0 A
.
¡	¡	A B
Outstanding
¡	¡	B M
=
¡	¡	N O
decimal
¡	¡	P W
.
¡	¡	W X
Parse
¡	¡	X ]
(
¡	¡	] ^
row
¡	¡	^ a
.
¡	¡	a b
GetCell
¡	¡	b i
(
¡	¡	i j
$num
¡	¡	j k
)
¡	¡	k l
.
¡	¡	l m
ToString
¡	¡	m u
(
¡	¡	u v
)
¡	¡	v w
==
¡	¡	x z
$str
¡	¡	{ }
||¡	¡	~ Ä
row¡	¡	Å Ñ
.¡	¡	Ñ Ö
GetCell¡	¡	Ö å
(¡	¡	å ç
$num¡	¡	ç é
)¡	¡	é è
.¡	¡	è ê
ToString¡	¡	ê ò
(¡	¡	ò ô
)¡	¡	ô ö
==¡	¡	õ ù
null¡	¡	û ¢
?¡	¡	£ §
$str¡	¡	• ß
:¡	¡	® ©
row¡	¡	™ ≠
.¡	¡	≠ Æ
GetCell¡	¡	Æ µ
(¡	¡	µ ∂
$num¡	¡	∂ ∑
)¡	¡	∑ ∏
.¡	¡	∏ π
ToString¡	¡	π ¡
(¡	¡	¡ ¬
)¡	¡	¬ √
)¡	¡	√ ƒ
;¡	¡	ƒ ≈
ListTempNewDetail
¬	¬	0 A
.
¬	¬	A B
	Principal
¬	¬	B K
=
¬	¬	L M
decimal
¬	¬	N U
.
¬	¬	U V
Parse
¬	¬	V [
(
¬	¬	[ \
row
¬	¬	\ _
.
¬	¬	_ `
GetCell
¬	¬	` g
(
¬	¬	g h
$num
¬	¬	h i
)
¬	¬	i j
.
¬	¬	j k
ToString
¬	¬	k s
(
¬	¬	s t
)
¬	¬	t u
==
¬	¬	v x
$str
¬	¬	y {
||
¬	¬	| ~
row¬	¬	 Ç
.¬	¬	Ç É
GetCell¬	¬	É ä
(¬	¬	ä ã
$num¬	¬	ã å
)¬	¬	å ç
.¬	¬	ç é
ToString¬	¬	é ñ
(¬	¬	ñ ó
)¬	¬	ó ò
==¬	¬	ô õ
null¬	¬	ú †
?¬	¬	° ¢
$str¬	¬	£ •
:¬	¬	¶ ß
row¬	¬	® ´
.¬	¬	´ ¨
GetCell¬	¬	¨ ≥
(¬	¬	≥ ¥
$num¬	¬	¥ µ
)¬	¬	µ ∂
.¬	¬	∂ ∑
ToString¬	¬	∑ ø
(¬	¬	ø ¿
)¬	¬	¿ ¡
)¬	¬	¡ ¬
;¬	¬	¬ √
ListTempNewDetail
√	√	0 A
.
√	√	A B
Interest
√	√	B J
=
√	√	K L
decimal
√	√	M T
.
√	√	T U
Parse
√	√	U Z
(
√	√	Z [
row
√	√	[ ^
.
√	√	^ _
GetCell
√	√	_ f
(
√	√	f g
$num
√	√	g h
)
√	√	h i
.
√	√	i j
ToString
√	√	j r
(
√	√	r s
)
√	√	s t
==
√	√	u w
$str
√	√	x z
||
√	√	{ }
row√	√	~ Å
.√	√	Å Ç
GetCell√	√	Ç â
(√	√	â ä
$num√	√	ä ã
)√	√	ã å
.√	√	å ç
ToString√	√	ç ï
(√	√	ï ñ
)√	√	ñ ó
==√	√	ò ö
null√	√	õ ü
?√	√	† °
$str√	√	¢ §
:√	√	• ¶
row√	√	ß ™
.√	√	™ ´
GetCell√	√	´ ≤
(√	√	≤ ≥
$num√	√	≥ ¥
)√	√	¥ µ
.√	√	µ ∂
ToString√	√	∂ æ
(√	√	æ ø
)√	√	ø ¿
)√	√	¿ ¡
;√	√	¡ ¬
ListTempNewDetail
ƒ	ƒ	0 A
.
ƒ	ƒ	A B
Fee
ƒ	ƒ	B E
=
ƒ	ƒ	F G
decimal
ƒ	ƒ	H O
.
ƒ	ƒ	O P
Parse
ƒ	ƒ	P U
(
ƒ	ƒ	U V
row
ƒ	ƒ	V Y
.
ƒ	ƒ	Y Z
GetCell
ƒ	ƒ	Z a
(
ƒ	ƒ	a b
$num
ƒ	ƒ	b d
)
ƒ	ƒ	d e
.
ƒ	ƒ	e f
ToString
ƒ	ƒ	f n
(
ƒ	ƒ	n o
)
ƒ	ƒ	o p
==
ƒ	ƒ	q s
$str
ƒ	ƒ	t v
||
ƒ	ƒ	w y
row
ƒ	ƒ	z }
.
ƒ	ƒ	} ~
GetCellƒ	ƒ	~ Ö
(ƒ	ƒ	Ö Ü
$numƒ	ƒ	Ü à
)ƒ	ƒ	à â
.ƒ	ƒ	â ä
ToStringƒ	ƒ	ä í
(ƒ	ƒ	í ì
)ƒ	ƒ	ì î
==ƒ	ƒ	ï ó
nullƒ	ƒ	ò ú
?ƒ	ƒ	ù û
$strƒ	ƒ	ü °
:ƒ	ƒ	¢ £
rowƒ	ƒ	§ ß
.ƒ	ƒ	ß ®
GetCellƒ	ƒ	® Ø
(ƒ	ƒ	Ø ∞
$numƒ	ƒ	∞ ≤
)ƒ	ƒ	≤ ≥
.ƒ	ƒ	≥ ¥
ToStringƒ	ƒ	¥ º
(ƒ	ƒ	º Ω
)ƒ	ƒ	Ω æ
)ƒ	ƒ	æ ø
;ƒ	ƒ	ø ¿
ListTempNewDetail
≈	≈	0 A
.
≈	≈	A B
IsActive
≈	≈	B J
=
≈	≈	K L
$num
≈	≈	M N
;
≈	≈	N O
ListTempNewDetail
∆	∆	0 A
.
∆	∆	A B
	IsDeleted
∆	∆	B K
=
∆	∆	L M
$num
∆	∆	N O
;
∆	∆	O P
ListTempNewDetail
«	«	0 A
.
«	«	A B
CreatedById
«	«	B M
=
«	«	N O
int
«	«	P S
.
«	«	S T
Parse
«	«	T Y
(
«	«	Y Z
HttpContext
«	«	Z e
.
«	«	e f
Session
«	«	f m
.
«	«	m n
	GetString
«	«	n w
(
«	«	w x
SessionConstan«	«	x Ü
.«	«	Ü á
Session_UserId«	«	á ï
)«	«	ï ñ
)«	«	ñ ó
;«	«	ó ò
ListTempNewDetail
»	»	0 A
.
»	»	A B
CreatedTime
»	»	B M
=
»	»	N O
DateTime
»	»	P X
.
»	»	X Y
Now
»	»	Y \
;
»	»	\ ]
bool
…	…	0 4
CheckCreRef
…	…	5 @
=
…	…	A B
CheckCreditorRef
…	…	C S
(
…	…	S T
row
…	…	T W
.
…	…	W X
GetCell
…	…	X _
(
…	…	_ `
$num
…	…	` a
)
…	…	a b
.
…	…	b c
ToString
…	…	c k
(
…	…	k l
)
…	…	l m
==
…	…	n p
$str
…	…	q s
||
…	…	t v
row
…	…	w z
.
…	…	z {
GetCell…	…	{ Ç
(…	…	Ç É
$num…	…	É Ñ
)…	…	Ñ Ö
.…	…	Ö Ü
ToString…	…	Ü é
(…	…	é è
)…	…	è ê
==…	…	ë ì
null…	…	î ò
?…	…	ô ö
$str…	…	õ ù
:…	…	û ü
row…	…	† £
.…	…	£ §
GetCell…	…	§ ´
(…	…	´ ¨
$num…	…	¨ ≠
)…	…	≠ Æ
.…	…	Æ Ø
ToString…	…	Ø ∑
(…	…	∑ ∏
)…	…	∏ π
)…	…	π ∫
;…	…	∫ ª
if
 	 	0 2
(
 	 	3 4
CheckCreRef
 	 	4 ?
)
 	 	? @
{
À	À	0 1
_context
Ã	Ã	4 <
.
Ã	Ã	< ='
TblNoticeOfPaymentDetails
Ã	Ã	= V
.
Ã	Ã	V W
Add
Ã	Ã	W Z
(
Ã	Ã	Z [
ListTempNewDetail
Ã	Ã	[ l
)
Ã	Ã	l m
;
Ã	Ã	m n
}
Õ	Õ	0 1
}
Œ	Œ	, -
else
œ	œ	, 0
{
–	–	, -
ListTempNopDetail
—	—	0 A
.
—	—	A B
NopId
—	—	B G
=
—	—	H I
ListTempNop
—	—	J U
.
—	—	U V
Id
—	—	V X
;
—	—	X Y
ListTempNopDetail
“	“	0 A
.
“	“	A B
CreditorRef
“	“	B M
=
“	“	N O
row
“	“	P S
.
“	“	S T
GetCell
“	“	T [
(
“	“	[ \
$num
“	“	\ ]
)
“	“	] ^
.
“	“	^ _
ToString
“	“	_ g
(
“	“	g h
)
“	“	h i
==
“	“	j l
$str
“	“	m o
||
“	“	p r
row
“	“	s v
.
“	“	v w
GetCell
“	“	w ~
(
“	“	~ 
$num“	“	 Ä
)“	“	Ä Å
.“	“	Å Ç
ToString“	“	Ç ä
(“	“	ä ã
)“	“	ã å
==“	“	ç è
null“	“	ê î
?“	“	ï ñ
$str“	“	ó ô
:“	“	ö õ
row“	“	ú ü
.“	“	ü †
GetCell“	“	† ß
(“	“	ß ®
$num“	“	® ©
)“	“	© ™
.“	“	™ ´
ToString“	“	´ ≥
(“	“	≥ ¥
)“	“	¥ µ
;“	“	µ ∂
ListTempNopDetail
”	”	0 A
.
”	”	A B
Outstanding
”	”	B M
=
”	”	N O
decimal
”	”	P W
.
”	”	W X
Parse
”	”	X ]
(
”	”	] ^
row
”	”	^ a
.
”	”	a b
GetCell
”	”	b i
(
”	”	i j
$num
”	”	j k
)
”	”	k l
.
”	”	l m
ToString
”	”	m u
(
”	”	u v
)
”	”	v w
==
”	”	x z
$str
”	”	{ }
||”	”	~ Ä
row”	”	Å Ñ
.”	”	Ñ Ö
GetCell”	”	Ö å
(”	”	å ç
$num”	”	ç é
)”	”	é è
.”	”	è ê
ToString”	”	ê ò
(”	”	ò ô
)”	”	ô ö
==”	”	õ ù
null”	”	û ¢
?”	”	£ §
$str”	”	• ß
:”	”	® ©
row”	”	™ ≠
.”	”	≠ Æ
GetCell”	”	Æ µ
(”	”	µ ∂
$num”	”	∂ ∑
)”	”	∑ ∏
.”	”	∏ π
ToString”	”	π ¡
(”	”	¡ ¬
)”	”	¬ √
)”	”	√ ƒ
;”	”	ƒ ≈
ListTempNopDetail
‘	‘	0 A
.
‘	‘	A B
	Principal
‘	‘	B K
=
‘	‘	L M
decimal
‘	‘	N U
.
‘	‘	U V
Parse
‘	‘	V [
(
‘	‘	[ \
row
‘	‘	\ _
.
‘	‘	_ `
GetCell
‘	‘	` g
(
‘	‘	g h
$num
‘	‘	h i
)
‘	‘	i j
.
‘	‘	j k
ToString
‘	‘	k s
(
‘	‘	s t
)
‘	‘	t u
==
‘	‘	v x
$str
‘	‘	y {
||
‘	‘	| ~
row‘	‘	 Ç
.‘	‘	Ç É
GetCell‘	‘	É ä
(‘	‘	ä ã
$num‘	‘	ã å
)‘	‘	å ç
.‘	‘	ç é
ToString‘	‘	é ñ
(‘	‘	ñ ó
)‘	‘	ó ò
==‘	‘	ô õ
null‘	‘	ú †
?‘	‘	° ¢
$str‘	‘	£ •
:‘	‘	¶ ß
row‘	‘	® ´
.‘	‘	´ ¨
GetCell‘	‘	¨ ≥
(‘	‘	≥ ¥
$num‘	‘	¥ µ
)‘	‘	µ ∂
.‘	‘	∂ ∑
ToString‘	‘	∑ ø
(‘	‘	ø ¿
)‘	‘	¿ ¡
)‘	‘	¡ ¬
;‘	‘	¬ √
ListTempNopDetail
’	’	0 A
.
’	’	A B
Interest
’	’	B J
=
’	’	K L
decimal
’	’	M T
.
’	’	T U
Parse
’	’	U Z
(
’	’	Z [
row
’	’	[ ^
.
’	’	^ _
GetCell
’	’	_ f
(
’	’	f g
$num
’	’	g h
)
’	’	h i
.
’	’	i j
ToString
’	’	j r
(
’	’	r s
)
’	’	s t
==
’	’	u w
$str
’	’	x z
||
’	’	{ }
row’	’	~ Å
.’	’	Å Ç
GetCell’	’	Ç â
(’	’	â ä
$num’	’	ä ã
)’	’	ã å
.’	’	å ç
ToString’	’	ç ï
(’	’	ï ñ
)’	’	ñ ó
==’	’	ò ö
null’	’	õ ü
?’	’	† °
$str’	’	¢ §
:’	’	• ¶
row’	’	ß ™
.’	’	™ ´
GetCell’	’	´ ≤
(’	’	≤ ≥
$num’	’	≥ ¥
)’	’	¥ µ
.’	’	µ ∂
ToString’	’	∂ æ
(’	’	æ ø
)’	’	ø ¿
)’	’	¿ ¡
;’	’	¡ ¬
ListTempNopDetail
÷	÷	0 A
.
÷	÷	A B
Fee
÷	÷	B E
=
÷	÷	F G
decimal
÷	÷	H O
.
÷	÷	O P
Parse
÷	÷	P U
(
÷	÷	U V
row
÷	÷	V Y
.
÷	÷	Y Z
GetCell
÷	÷	Z a
(
÷	÷	a b
$num
÷	÷	b d
)
÷	÷	d e
.
÷	÷	e f
ToString
÷	÷	f n
(
÷	÷	n o
)
÷	÷	o p
==
÷	÷	q s
$str
÷	÷	t v
||
÷	÷	w y
row
÷	÷	z }
.
÷	÷	} ~
GetCell÷	÷	~ Ö
(÷	÷	Ö Ü
$num÷	÷	Ü à
)÷	÷	à â
.÷	÷	â ä
ToString÷	÷	ä í
(÷	÷	í ì
)÷	÷	ì î
==÷	÷	ï ó
null÷	÷	ò ú
?÷	÷	ù û
$str÷	÷	ü °
:÷	÷	¢ £
row÷	÷	§ ß
.÷	÷	ß ®
GetCell÷	÷	® Ø
(÷	÷	Ø ∞
$num÷	÷	∞ ≤
)÷	÷	≤ ≥
.÷	÷	≥ ¥
ToString÷	÷	¥ º
(÷	÷	º Ω
)÷	÷	Ω æ
)÷	÷	æ ø
;÷	÷	ø ¿
ListTempNopDetail
◊	◊	0 A
.
◊	◊	A B
IsActive
◊	◊	B J
=
◊	◊	K L
$num
◊	◊	M N
;
◊	◊	N O
ListTempNopDetail
ÿ	ÿ	0 A
.
ÿ	ÿ	A B
	IsDeleted
ÿ	ÿ	B K
=
ÿ	ÿ	L M
$num
ÿ	ÿ	N O
;
ÿ	ÿ	O P
ListTempNopDetail
Ÿ	Ÿ	0 A
.
Ÿ	Ÿ	A B
CreatedById
Ÿ	Ÿ	B M
=
Ÿ	Ÿ	N O
int
Ÿ	Ÿ	P S
.
Ÿ	Ÿ	S T
Parse
Ÿ	Ÿ	T Y
(
Ÿ	Ÿ	Y Z
HttpContext
Ÿ	Ÿ	Z e
.
Ÿ	Ÿ	e f
Session
Ÿ	Ÿ	f m
.
Ÿ	Ÿ	m n
	GetString
Ÿ	Ÿ	n w
(
Ÿ	Ÿ	w x
SessionConstanŸ	Ÿ	x Ü
.Ÿ	Ÿ	Ü á
Session_UserIdŸ	Ÿ	á ï
)Ÿ	Ÿ	ï ñ
)Ÿ	Ÿ	ñ ó
;Ÿ	Ÿ	ó ò
ListTempNopDetail
⁄	⁄	0 A
.
⁄	⁄	A B
CreatedTime
⁄	⁄	B M
=
⁄	⁄	N O
DateTime
⁄	⁄	P X
.
⁄	⁄	X Y
Now
⁄	⁄	Y \
;
⁄	⁄	\ ]
bool
€	€	0 4
CheckCreRef
€	€	5 @
=
€	€	A B
CheckCreditorRef
€	€	C S
(
€	€	S T
row
€	€	T W
.
€	€	W X
GetCell
€	€	X _
(
€	€	_ `
$num
€	€	` a
)
€	€	a b
.
€	€	b c
ToString
€	€	c k
(
€	€	k l
)
€	€	l m
==
€	€	n p
$str
€	€	q s
||
€	€	t v
row
€	€	w z
.
€	€	z {
GetCell€	€	{ Ç
(€	€	Ç É
$num€	€	É Ñ
)€	€	Ñ Ö
.€	€	Ö Ü
ToString€	€	Ü é
(€	€	é è
)€	€	è ê
==€	€	ë ì
null€	€	î ò
?€	€	ô ö
$str€	€	õ ù
:€	€	û ü
row€	€	† £
.€	€	£ §
GetCell€	€	§ ´
(€	€	´ ¨
$num€	€	¨ ≠
)€	€	≠ Æ
.€	€	Æ Ø
ToString€	€	Ø ∑
(€	€	∑ ∏
)€	€	∏ π
)€	€	π ∫
;€	€	∫ ª
if
‹	‹	0 2
(
‹	‹	3 4
CheckCreRef
‹	‹	4 ?
)
‹	‹	? @
{
›	›	0 1
_context
ﬁ	ﬁ	4 <
.
ﬁ	ﬁ	< ='
TblNoticeOfPaymentDetails
ﬁ	ﬁ	= V
.
ﬁ	ﬁ	V W
Add
ﬁ	ﬁ	W Z
(
ﬁ	ﬁ	Z [
ListTempNopDetail
ﬁ	ﬁ	[ l
)
ﬁ	ﬁ	l m
;
ﬁ	ﬁ	m n
}
ﬂ	ﬂ	0 1
}
‡	‡	, -
_context
‚	‚	, 4
.
‚	‚	4 5
SaveChanges
‚	‚	5 @
(
‚	‚	@ A
)
‚	‚	A B
;
‚	‚	B C
}
„	„	( )
}
‰	‰	$ %
}
Â	Â	  !
trx2
Ê	Ê	  $
.
Ê	Ê	$ %
Complete
Ê	Ê	% -
(
Ê	Ê	- .
)
Ê	Ê	. /
;
Ê	Ê	/ 0
}
Á	Á	 
trx
Ë	Ë	 
.
Ë	Ë	  
Complete
Ë	Ë	  (
(
Ë	Ë	( )
)
Ë	Ë	) *
;
Ë	Ë	* +
return
È	È	 "
Content
È	È	# *
(
È	È	* +
$str
È	È	+ -
)
È	È	- .
;
È	È	. /
}
Í	Í	 
else
Î	Î	 
{
Ï	Ï	 
return
Ì	Ì	 "
Content
Ì	Ì	# *
(
Ì	Ì	* +
$str
Ì	Ì	+ :
)
Ì	Ì	: ;
;
Ì	Ì	; <
}
Ó	Ó	 
}
Ô	Ô	 
}
Ò	Ò	 
}
Ú	Ú	 
catch
Û	Û	 
(
Û	Û	 
	Exception
Û	Û	 
Ex
Û	Û	 
)
Û	Û	  
{
Ù	Ù	 
return
ı	ı	 
Content
ı	ı	 
(
ı	ı	 
	GetConfig
ı	ı	 (
.
ı	ı	( )

AppSetting
ı	ı	) 3
[
ı	ı	3 4
$str
ı	ı	4 M
]
ı	ı	M N
)
ı	ı	N O
;
ı	ı	O P
}
ˆ	ˆ	 
}
˜	˜	 	
[
¯	¯	 	
HttpPost
¯	¯		 
]
¯	¯	 
public
˘	˘	 
ActionResult
˘	˘	 %
SubmitCreateFileNopTemp
˘	˘	 3
(
˘	˘	3 41
#NoticeOfPaymentFileUpload_ViewModel
˘	˘	4 W
data
˘	˘	X \
)
˘	˘	\ ]
{
˙	˙	 	
if
˚	˚	 
(
˚	˚	 
!
˚	˚	 
lastSession
˚	˚	 
.
˚	˚	 
Update
˚	˚	 #
(
˚	˚	# $
)
˚	˚	$ %
)
˚	˚	% &
{
¸	¸	 
return
˝	˝	 
RedirectToAction
˝	˝	 '
(
˝	˝	' (
$str
˝	˝	( /
,
˝	˝	/ 0
$str
˝	˝	1 8
,
˝	˝	8 9
new
˝	˝	: =
{
˝	˝	> ?
a
˝	˝	@ A
=
˝	˝	B C
true
˝	˝	D H
}
˝	˝	I J
)
˝	˝	J K
;
˝	˝	K L
}
˛	˛	 
var
Ä
Ä
 
location
Ä
Ä
 
=
Ä
Ä
 
new
Ä
Ä
 
Uri
Ä
Ä
 "
(
Ä
Ä
" #
$"
Ä
Ä
# %
{
Ä
Ä
% &
Request
Ä
Ä
& -
.
Ä
Ä
- .
Scheme
Ä
Ä
. 4
}
Ä
Ä
4 5
$str
Ä
Ä
5 8
{
Ä
Ä
8 9
Request
Ä
Ä
9 @
.
Ä
Ä
@ A
Host
Ä
Ä
A E
}
Ä
Ä
E F
{
Ä
Ä
F G
Request
Ä
Ä
G N
.
Ä
Ä
N O
Path
Ä
Ä
O S
}
Ä
Ä
S T
"
Ä
Ä
T U
)
Ä
Ä
U V
;
Ä
Ä
V W
string
Å
Å
 
Patha
Å
Å
 
=
Å
Å
 
location
Å
Å
 #
.
Å
Å
# $
AbsolutePath
Å
Å
$ 0
.
Å
Å
0 1
Replace
Å
Å
1 8
(
Å
Å
8 9
this
Å
Å
9 =
.
Å
Å
= >
ControllerContext
Å
Å
> O
.
Å
Å
O P
	RouteData
Å
Å
P Y
.
Å
Å
Y Z
Values
Å
Å
Z `
[
Å
Å
` a
$str
Å
Å
a i
]
Å
Å
i j
.
Å
Å
j k
ToString
Å
Å
k s
(
Å
Å
s t
)
Å
Å
t u
,
Å
Å
u v
$str
Å
Å
w ~
)
Å
Å
~ 
;Å
Å
 Ä
if
É
É
 
(
É
É
 
!
É
É
 
accessSecurity
É
É
 
.
É
É
  
IsGetAccess
É
É
  +
(
É
É
+ ,
$str
É
É
, 0
+
É
É
1 2
Patha
É
É
3 8
)
É
É
8 9
)
É
É
9 :
{
Ñ
Ñ
 
return
Ö
Ö
 
RedirectToAction
Ö
Ö
 '
(
Ö
Ö
' (
$str
Ö
Ö
( 3
,
Ö
Ö
3 4
$str
Ö
Ö
5 <
)
Ö
Ö
< =
;
Ö
Ö
= >
}
Ü
Ü
 
try
à
à
 
{
â
â
 
var
ã
ã
 
FilePath
ã
ã
 
=
ã
ã
 
_context
ã
ã
 '
.
ã
ã
' ('
TblMasterSystemParameters
ã
ã
( A
.
ã
ã
A B
Where
ã
ã
B G
(
ã
ã
G H
m
ã
ã
H I
=>
ã
ã
J L
m
ã
ã
M N
.
ã
ã
N O
Key
ã
ã
O R
==
ã
ã
S U
$str
ã
ã
V e
)
ã
ã
e f
.
ã
ã
f g
Select
ã
ã
g m
(
ã
ã
m n
m
ã
ã
n o
=>
ã
ã
p r
m
ã
ã
s t
.
ã
ã
t u
Value
ã
ã
u z
)
ã
ã
z {
.
ã
ã
{ |
FirstOrDefaultã
ã
| ä
(ã
ã
ä ã
)ã
ã
ã å
;ã
ã
å ç
if
å
å
 
(
å
å
 
data
å
å
 
.
å
å
 
File
å
å
 
==
å
å
  
null
å
å
! %
)
å
å
% &
{
ç
ç
 
return
é
é
 
Content
é
é
 "
(
é
é
" #
$str
é
é
# B
)
é
é
B C
;
é
é
C D
}
è
è
 
string
ë
ë
 
FileNameNoExt
ë
ë
 $
=
ë
ë
% &
Path
ë
ë
' +
.
ë
ë
+ ,)
GetFileNameWithoutExtension
ë
ë
, G
(
ë
ë
G H
data
ë
ë
H L
.
ë
ë
L M
File
ë
ë
M Q
.
ë
ë
Q R
FileName
ë
ë
R Z
)
ë
ë
Z [
;
ë
ë
[ \
string
í
í
 
Ext
í
í
 
=
í
í
 
Path
í
í
 !
.
í
í
! "
GetExtension
í
í
" .
(
í
í
. /
data
í
í
/ 3
.
í
í
3 4
File
í
í
4 8
.
í
í
8 9
FileName
í
í
9 A
)
í
í
A B
;
í
í
B C
string
ì
ì
 
FullName
ì
ì
 
=
ì
ì
  !
FileNameNoExt
ì
ì
" /
+
ì
ì
0 1
$str
ì
ì
2 5
+
ì
ì
6 7
DateTime
ì
ì
8 @
.
ì
ì
@ A
Now
ì
ì
A D
.
ì
ì
D E
ToString
ì
ì
E M
(
ì
ì
M N
$str
ì
ì
N ^
)
ì
ì
^ _
+
ì
ì
` a
Ext
ì
ì
b e
;
ì
ì
e f
string
î
î
 
FullPath
î
î
 
=
î
î
  !
FilePath
î
î
" *
+
î
î
+ ,
FullName
î
î
- 5
;
î
î
5 6
string
ñ
ñ
 
[
ñ
ñ
 
]
ñ
ñ
 
allowedExtensions
ñ
ñ
 *
=
ñ
ñ
+ ,
{
ñ
ñ
- .
$str
ñ
ñ
/ 6
,
ñ
ñ
6 7
$str
ñ
ñ
8 >
,
ñ
ñ
> ?
$str
ñ
ñ
@ F
,
ñ
ñ
F G
$str
ñ
ñ
H O
,
ñ
ñ
O P
$str
ñ
ñ
Q W
}
ñ
ñ
X Y
;
ñ
ñ
Y Z
if
ó
ó
 
(
ó
ó
 
!
ó
ó
 
allowedExtensions
ó
ó
 &
.
ó
ó
& '
Contains
ó
ó
' /
(
ó
ó
/ 0
Ext
ó
ó
0 3
)
ó
ó
3 4
)
ó
ó
4 5
{
ò
ò
 
return
ô
ô
 
Content
ô
ô
 "
(
ô
ô
" #
$str
ô
ô
# ;
)
ô
ô
; <
;
ô
ô
< =
}
ö
ö
 
using
ú
ú
 
(
ú
ú
 
TransactionScope
ú
ú
 '
trx
ú
ú
( +
=
ú
ú
, -
new
ú
ú
. 1
TransactionScope
ú
ú
2 B
(
ú
ú
B C
)
ú
ú
C D
)
ú
ú
D E
{
ù
ù
 
try
û
û
 
{
ü
ü
 "
TblFileUploadNopTemp
†
†
 ,
model
†
†
- 2
=
†
†
3 4
new
†
†
5 8"
TblFileUploadNopTemp
†
†
9 M
(
†
†
M N
)
†
†
N O
;
†
†
O P
model
°
°
 
.
°
°
 
FileName
°
°
 &
=
°
°
' (
FullName
°
°
) 1
;
°
°
1 2
model
¢
¢
 
.
¢
¢
 
FileSize
¢
¢
 &
=
¢
¢
' (
Convert
¢
¢
) 0
.
¢
¢
0 1
ToInt32
¢
¢
1 8
(
¢
¢
8 9
data
¢
¢
9 =
.
¢
¢
= >
File
¢
¢
> B
.
¢
¢
B C
Length
¢
¢
C I
)
¢
¢
I J
;
¢
¢
J K
model
£
£
 
.
£
£
 
FilePath
£
£
 &
=
£
£
' (
FullPath
£
£
) 1
;
£
£
1 2
model
§
§
 
.
§
§
 
FileExt
§
§
 %
=
§
§
& '
Ext
§
§
( +
;
§
§
+ ,
model
•
•
 
.
•
•
 

UploadTime
•
•
 (
=
•
•
) *
DateTime
•
•
+ 3
.
•
•
3 4
Now
•
•
4 7
;
•
•
7 8
model
¶
¶
 
.
¶
¶
 

UploadById
¶
¶
 (
=
¶
¶
) *
int
¶
¶
+ .
.
¶
¶
. /
Parse
¶
¶
/ 4
(
¶
¶
4 5
HttpContext
¶
¶
5 @
.
¶
¶
@ A
Session
¶
¶
A H
.
¶
¶
H I
	GetString
¶
¶
I R
(
¶
¶
R S
SessionConstan
¶
¶
S a
.
¶
¶
a b
Session_UserId
¶
¶
b p
)
¶
¶
p q
)
¶
¶
q r
;
¶
¶
r s
model
ß
ß
 
.
ß
ß
 
IsActive
ß
ß
 &
=
ß
ß
' (
$num
ß
ß
) *
;
ß
ß
* +
model
®
®
 
.
®
®
 
	IsDeleted
®
®
 '
=
®
®
( )
$num
®
®
* +
;
®
®
+ ,
model
©
©
 
.
©
©
 
RandomString
©
©
 *
=
©
©
+ ,
data
©
©
- 1
.
©
©
1 2
uniq
©
©
2 6
;
©
©
6 7
_context
™
™
  
.
™
™
  !#
TblFileUploadNopTemps
™
™
! 6
.
™
™
6 7
Add
™
™
7 :
(
™
™
: ;
model
™
™
; @
)
™
™
@ A
;
™
™
A B
_context
´
´
  
.
´
´
  !
SaveChanges
´
´
! ,
(
´
´
, -
)
´
´
- .
;
´
´
. /
if
Æ
Æ
 
(
Æ
Æ
 
!
Æ
Æ
 
	Directory
Æ
Æ
 &
.
Æ
Æ
& '
Exists
Æ
Æ
' -
(
Æ
Æ
- .
FilePath
Æ
Æ
. 6
)
Æ
Æ
6 7
)
Æ
Æ
7 8
{
Ø
Ø
 
	Directory
∞
∞
 %
.
∞
∞
% &
CreateDirectory
∞
∞
& 5
(
∞
∞
5 6
FilePath
∞
∞
6 >
)
∞
∞
> ?
;
∞
∞
? @
}
±
±
 
using
≥
≥
 
(
≥
≥
 

FileStream
≥
≥
 )

fileStream
≥
≥
* 4
=
≥
≥
5 6
new
≥
≥
7 :

FileStream
≥
≥
; E
(
≥
≥
E F
FullPath
≥
≥
F N
,
≥
≥
N O
FileMode
≥
≥
P X
.
≥
≥
X Y
Create
≥
≥
Y _
)
≥
≥
_ `
)
≥
≥
` a
{
¥
¥
 
data
∂
∂
  
.
∂
∂
  !
File
∂
∂
! %
.
∂
∂
% &
CopyTo
∂
∂
& ,
(
∂
∂
, -

fileStream
∂
∂
- 7
)
∂
∂
7 8
;
∂
∂
8 9
}
∑
∑
 
trx
π
π
 
.
π
π
 
Complete
π
π
 $
(
π
π
$ %
)
π
π
% &
;
π
π
& '
}
∫
∫
 
catch
ª
ª
 
(
ª
ª
 
	Exception
ª
ª
 $
ex
ª
ª
% '
)
ª
ª
' (
{
º
º
 
throw
Ω
Ω
 
;
Ω
Ω
 
}
æ
æ
 
}
ø
ø
 
return
¡
¡
 
Content
¡
¡
 
(
¡
¡
 
$str
¡
¡
 !
)
¡
¡
! "
;
¡
¡
" #
}
¬
¬
 
catch
√
√
 
(
√
√
 
	Exception
√
√
 
ex
√
√
 
)
√
√
  
{
ƒ
ƒ
 
return
≈
≈
 
Content
≈
≈
 
(
≈
≈
 
	GetConfig
≈
≈
 (
.
≈
≈
( )

AppSetting
≈
≈
) 3
[
≈
≈
3 4
$str
≈
≈
4 O
]
≈
≈
O P
)
≈
≈
P Q
;
≈
≈
Q R
}
∆
∆
 
}
«
«
 	
[
»
»
 	
HttpPost
»
»
	 
]
»
»
 
public
…
…
 
ActionResult
…
…
 !
SubmitCreateFileNop
…
…
 /
(
…
…
/ 0'
NoticeOfPayment_ViewModel
…
…
0 I
data
…
…
J N
,
…
…
N O
string
…
…
P V
uniq
…
…
W [
)
…
…
[ \
{
 
 
 	
if
À
À
 
(
À
À
 
!
À
À
 
lastSession
À
À
 
.
À
À
 
Update
À
À
 #
(
À
À
# $
)
À
À
$ %
)
À
À
% &
{
Ã
Ã
 
return
Õ
Õ
 
RedirectToAction
Õ
Õ
 '
(
Õ
Õ
' (
$str
Õ
Õ
( /
,
Õ
Õ
/ 0
	GetConfig
Õ
Õ
1 :
.
Õ
Õ
: ;

AppSetting
Õ
Õ
; E
[
Õ
Õ
E F
$str
Õ
Õ
F n
]
Õ
Õ
n o
+
Õ
Õ
p q
$str
Õ
Õ
r y
,
Õ
Õ
y z
new
Õ
Õ
{ ~
{Õ
Õ
 Ä
aÕ
Õ
Å Ç
=Õ
Õ
É Ñ
trueÕ
Õ
Ö â
}Õ
Õ
ä ã
)Õ
Õ
ã å
;Õ
Õ
å ç
}
Œ
Œ
 
var
–
–
 
location
–
–
 
=
–
–
 
new
–
–
 
Uri
–
–
 "
(
–
–
" #
$"
–
–
# %
{
–
–
% &
Request
–
–
& -
.
–
–
- .
Scheme
–
–
. 4
}
–
–
4 5
$str
–
–
5 8
{
–
–
8 9
Request
–
–
9 @
.
–
–
@ A
Host
–
–
A E
}
–
–
E F
{
–
–
F G
Request
–
–
G N
.
–
–
N O
Path
–
–
O S
}
–
–
S T
"
–
–
T U
)
–
–
U V
;
–
–
V W
string
—
—
 
Patha
—
—
 
=
—
—
 
location
—
—
 #
.
—
—
# $
AbsolutePath
—
—
$ 0
.
—
—
0 1
Replace
—
—
1 8
(
—
—
8 9
this
—
—
9 =
.
—
—
= >
ControllerContext
—
—
> O
.
—
—
O P
	RouteData
—
—
P Y
.
—
—
Y Z
Values
—
—
Z `
[
—
—
` a
$str
—
—
a i
]
—
—
i j
.
—
—
j k
ToString
—
—
k s
(
—
—
s t
)
—
—
t u
,
—
—
u v
$str
—
—
w ~
)
—
—
~ 
;—
—
 Ä
if
”
”
 
(
”
”
 
!
”
”
 
accessSecurity
”
”
 
.
”
”
  
IsGetAccess
”
”
  +
(
”
”
+ ,
$str
”
”
, 0
+
”
”
1 2
Patha
”
”
3 8
)
”
”
8 9
)
”
”
9 :
{
‘
‘
 
return
’
’
 
RedirectToAction
’
’
 '
(
’
’
' (
$str
’
’
( 3
,
’
’
3 4
$str
’
’
5 <
)
’
’
< =
;
’
’
= >
}
÷
÷
 
try
ÿ
ÿ
 
{
Ÿ
Ÿ
  
TblNoticeOfPayment
⁄
⁄
 "

dataAssign
⁄
⁄
# -
=
⁄
⁄
. /
_context
⁄
⁄
0 8
.
⁄
⁄
8 9!
TblNoticeOfPayments
⁄
⁄
9 L
.
⁄
⁄
L M
Where
⁄
⁄
M R
(
⁄
⁄
R S
m
⁄
⁄
S T
=>
⁄
⁄
U W
m
⁄
⁄
X Y
.
⁄
⁄
Y Z
Id
⁄
⁄
Z \
==
⁄
⁄
] _
int
⁄
⁄
` c
.
⁄
⁄
c d
Parse
⁄
⁄
d i
(
⁄
⁄
i j
uniq
⁄
⁄
j n
)
⁄
⁄
n o
&&
⁄
⁄
p r
m
⁄
⁄
s t
.
⁄
⁄
t u
	IsDeleted
⁄
⁄
u ~
==⁄
⁄
 Å
$num⁄
⁄
Ç É
)⁄
⁄
É Ñ
.⁄
⁄
Ñ Ö
FirstOrDefault⁄
⁄
Ö ì
(⁄
⁄
ì î
)⁄
⁄
î ï
;⁄
⁄
ï ñ
if
‹
‹
 
(
‹
‹
 

dataAssign
‹
‹
 
.
‹
‹
 
IdNopFromApi
‹
‹
 +
!=
‹
‹
, .
null
‹
‹
/ 3
)
‹
‹
3 4
{
›
›
 
var
ﬁ
ﬁ
 "
jsonParseReturnCheck
ﬁ
ﬁ
 ,
=
ﬁ
ﬁ
- .
JsonConvert
ﬁ
ﬁ
/ :
.
ﬁ
ﬁ
: ;
DeserializeObject
ﬁ
ﬁ
; L
<
ﬁ
ﬁ
L M!
ResultStatusDataInt
ﬁ
ﬁ
M `
<
ﬁ
ﬁ
` a!
ResultStatusDataNop
ﬁ
ﬁ
a t
>
ﬁ
ﬁ
t u
>
ﬁ
ﬁ
u v
(
ﬁ
ﬁ
v w
$str
ﬁ
ﬁ
w y
)
ﬁ
ﬁ
y z
;
ﬁ
ﬁ
z {
var
ﬂ
ﬂ
 
urlCheck
ﬂ
ﬂ
  
=
ﬂ
ﬂ
! "
	GetConfig
ﬂ
ﬂ
# ,
.
ﬂ
ﬂ
, -

AppSetting
ﬂ
ﬂ
- 7
[
ﬂ
ﬂ
7 8
$str
ﬂ
ﬂ
8 I
]
ﬂ
ﬂ
I J
+
ﬂ
ﬂ
K L
	GetConfig
ﬂ
ﬂ
M V
.
ﬂ
ﬂ
V W

AppSetting
ﬂ
ﬂ
W a
[
ﬂ
ﬂ
a b
$str
ﬂ
ﬂ
b {
]
ﬂ
ﬂ
{ |
+
ﬂ
ﬂ
} ~

dataAssignﬂ
ﬂ
 â
.ﬂ
ﬂ
â ä
IdNopFromApiﬂ
ﬂ
ä ñ
;ﬂ
ﬂ
ñ ó
(
‡
‡
 
bool
‡
‡
 
resultApiCheck
‡
‡
 (
,
‡
‡
( )
string
‡
‡
* 0
resultCheck
‡
‡
1 <
)
‡
‡
< =
=
‡
‡
> ?
RequestToAPI
‡
‡
@ L
.
‡
‡
L M!
GetJsonStringWebApi
‡
‡
M `
(
‡
‡
` a
urlCheck
‡
‡
a i
,
‡
‡
i j
null
‡
‡
k o
)
‡
‡
o p
;
‡
‡
p q
if
·
·
 
(
·
·
 
resultApiCheck
·
·
 &
&&
·
·
' )
!
·
·
* +
string
·
·
+ 1
.
·
·
1 2
IsNullOrEmpty
·
·
2 ?
(
·
·
? @
resultCheck
·
·
@ K
)
·
·
K L
)
·
·
L M
{
‚
‚
 "
jsonParseReturnCheck
„
„
 ,
=
„
„
- .
JsonConvert
„
„
/ :
.
„
„
: ;
DeserializeObject
„
„
; L
<
„
„
L M!
ResultStatusDataInt
„
„
M `
<
„
„
` a!
ResultStatusDataNop
„
„
a t
>
„
„
t u
>
„
„
u v
(
„
„
v w
resultCheck„
„
w Ç
)„
„
Ç É
;„
„
É Ñ
if
‰
‰
 
(
‰
‰
 "
jsonParseReturnCheck
‰
‰
 0
.
‰
‰
0 1

StatusCode
‰
‰
1 ;
==
‰
‰
< >
$num
‰
‰
? B
||
‰
‰
C E"
jsonParseReturnCheck
‰
‰
F Z
.
‰
‰
Z [

StatusCode
‰
‰
[ e
==
‰
‰
f h
$num
‰
‰
i l
)
‰
‰
l m
{
Â
Â
 
if
Ê
Ê
 
(
Ê
Ê
  "
jsonParseReturnCheck
Ê
Ê
  4
.
Ê
Ê
4 5
Data
Ê
Ê
5 9
.
Ê
Ê
9 :
Status
Ê
Ê
: @
==
Ê
Ê
A C
$str
Ê
Ê
D P
)
Ê
Ê
P Q
{
Á
Á
 
var
Ë
Ë
  #
FilePath
Ë
Ë
$ ,
=
Ë
Ë
- .
_context
Ë
Ë
/ 7
.
Ë
Ë
7 8'
TblMasterSystemParameters
Ë
Ë
8 Q
.
Ë
Ë
Q R
Where
Ë
Ë
R W
(
Ë
Ë
W X
m
Ë
Ë
X Y
=>
Ë
Ë
Z \
m
Ë
Ë
] ^
.
Ë
Ë
^ _
Key
Ë
Ë
_ b
==
Ë
Ë
c e
$str
Ë
Ë
f u
)
Ë
Ë
u v
.
Ë
Ë
v w
Select
Ë
Ë
w }
(
Ë
Ë
} ~
m
Ë
Ë
~ 
=>Ë
Ë
Ä Ç
mË
Ë
É Ñ
.Ë
Ë
Ñ Ö
ValueË
Ë
Ö ä
)Ë
Ë
ä ã
.Ë
Ë
ã å
FirstOrDefaultË
Ë
å ö
(Ë
Ë
ö õ
)Ë
Ë
õ ú
;Ë
Ë
ú ù
if
È
È
  "
(
È
È
# $
data
È
È
$ (
.
È
È
( )
File
È
È
) -
==
È
È
. 0
null
È
È
1 5
)
È
È
5 6
{
Í
Í
  !
return
Î
Î
$ *
Content
Î
Î
+ 2
(
Î
Î
2 3
$str
Î
Î
3 R
)
Î
Î
R S
;
Î
Î
S T
}
Ï
Ï
  !
string
Ó
Ó
  &
FileNameNoExt
Ó
Ó
' 4
=
Ó
Ó
5 6
Path
Ó
Ó
7 ;
.
Ó
Ó
; <)
GetFileNameWithoutExtension
Ó
Ó
< W
(
Ó
Ó
W X
data
Ó
Ó
X \
.
Ó
Ó
\ ]
File
Ó
Ó
] a
.
Ó
Ó
a b
FileName
Ó
Ó
b j
)
Ó
Ó
j k
;
Ó
Ó
k l
string
Ô
Ô
  &
Ext
Ô
Ô
' *
=
Ô
Ô
+ ,
Path
Ô
Ô
- 1
.
Ô
Ô
1 2
GetExtension
Ô
Ô
2 >
(
Ô
Ô
> ?
data
Ô
Ô
? C
.
Ô
Ô
C D
File
Ô
Ô
D H
.
Ô
Ô
H I
FileName
Ô
Ô
I Q
)
Ô
Ô
Q R
;
Ô
Ô
R S
string


  &
FullName


' /
=


0 1
FileNameNoExt


2 ?
+


@ A
$str


B E
+


F G
DateTime


H P
.


P Q
Now


Q T
.


T U
ToString


U ]
(


] ^
$str


^ n
)


n o
+


p q
Ext


r u
;


u v
string
Ò
Ò
  &
FullPath
Ò
Ò
' /
=
Ò
Ò
0 1
FilePath
Ò
Ò
2 :
+
Ò
Ò
; <
FullName
Ò
Ò
= E
;
Ò
Ò
E F
string
Û
Û
  &
[
Û
Û
& '
]
Û
Û
' (
allowedExtensions
Û
Û
) :
=
Û
Û
; <
{
Û
Û
= >
$str
Û
Û
? F
,
Û
Û
F G
$str
Û
Û
H N
,
Û
Û
N O
$str
Û
Û
P V
,
Û
Û
V W
$str
Û
Û
X _
,
Û
Û
_ `
$str
Û
Û
a g
}
Û
Û
h i
;
Û
Û
i j
if
Ù
Ù
  "
(
Ù
Ù
# $
!
Ù
Ù
$ %
allowedExtensions
Ù
Ù
% 6
.
Ù
Ù
6 7
Contains
Ù
Ù
7 ?
(
Ù
Ù
? @
Ext
Ù
Ù
@ C
)
Ù
Ù
C D
)
Ù
Ù
D E
{
ı
ı
  !
return
ˆ
ˆ
$ *
Content
ˆ
ˆ
+ 2
(
ˆ
ˆ
2 3
$str
ˆ
ˆ
3 K
)
ˆ
ˆ
K L
;
ˆ
ˆ
L M
}
˜
˜
  !
using
˘
˘
  %
(
˘
˘
& '
TransactionScope
˘
˘
' 7
trx
˘
˘
8 ;
=
˘
˘
< =
new
˘
˘
> A
TransactionScope
˘
˘
B R
(
˘
˘
R S
)
˘
˘
S T
)
˘
˘
T U
{
˙
˙
  !
try
˚
˚
$ '
{
¸
¸
$ %
TblFileUploadNop
˝
˝
( 8
model
˝
˝
9 >
=
˝
˝
? @
new
˝
˝
A D
TblFileUploadNop
˝
˝
E U
(
˝
˝
U V
)
˝
˝
V W
;
˝
˝
W X
model
˛
˛
( -
.
˛
˛
- .
IdNop
˛
˛
. 3
=
˛
˛
4 5
int
˛
˛
6 9
.
˛
˛
9 :
Parse
˛
˛
: ?
(
˛
˛
? @
uniq
˛
˛
@ D
)
˛
˛
D E
;
˛
˛
E F
model
ˇ
ˇ
( -
.
ˇ
ˇ
- .
FileName
ˇ
ˇ
. 6
=
ˇ
ˇ
7 8
FullName
ˇ
ˇ
9 A
;
ˇ
ˇ
A B
model
ÄÄ( -
.
ÄÄ- .
FileSize
ÄÄ. 6
=
ÄÄ7 8
Convert
ÄÄ9 @
.
ÄÄ@ A
ToInt32
ÄÄA H
(
ÄÄH I
data
ÄÄI M
.
ÄÄM N
File
ÄÄN R
.
ÄÄR S
Length
ÄÄS Y
)
ÄÄY Z
;
ÄÄZ [
model
ÅÅ( -
.
ÅÅ- .
FilePath
ÅÅ. 6
=
ÅÅ7 8
FullPath
ÅÅ9 A
;
ÅÅA B
model
ÇÇ( -
.
ÇÇ- .
FileExt
ÇÇ. 5
=
ÇÇ6 7
Ext
ÇÇ8 ;
;
ÇÇ; <
model
ÉÉ( -
.
ÉÉ- .

UploadTime
ÉÉ. 8
=
ÉÉ9 :
DateTime
ÉÉ; C
.
ÉÉC D
Now
ÉÉD G
;
ÉÉG H
model
ÑÑ( -
.
ÑÑ- .

UploadById
ÑÑ. 8
=
ÑÑ9 :
int
ÑÑ; >
.
ÑÑ> ?
Parse
ÑÑ? D
(
ÑÑD E
HttpContext
ÑÑE P
.
ÑÑP Q
Session
ÑÑQ X
.
ÑÑX Y
	GetString
ÑÑY b
(
ÑÑb c
SessionConstan
ÑÑc q
.
ÑÑq r
Session_UserIdÑÑr Ä
)ÑÑÄ Å
)ÑÑÅ Ç
;ÑÑÇ É
model
ÖÖ( -
.
ÖÖ- .
IsActive
ÖÖ. 6
=
ÖÖ7 8
$num
ÖÖ9 :
;
ÖÖ: ;
model
ÜÜ( -
.
ÜÜ- .
	IsDeleted
ÜÜ. 7
=
ÜÜ8 9
$num
ÜÜ: ;
;
ÜÜ; <
_context
áá( 0
.
áá0 1
TblFileUploadNops
áá1 B
.
ááB C
Add
ááC F
(
ááF G
model
ááG L
)
ááL M
;
ááM N
_context
àà( 0
.
àà0 1
SaveChanges
àà1 <
(
àà< =
)
àà= >
;
àà> ?
if
ãã( *
(
ãã+ ,
!
ãã, -
	Directory
ãã- 6
.
ãã6 7
Exists
ãã7 =
(
ãã= >
FilePath
ãã> F
)
ããF G
)
ããG H
{
åå( )
	Directory
çç, 5
.
çç5 6
CreateDirectory
çç6 E
(
ççE F
FilePath
ççF N
)
ççN O
;
ççO P
}
éé( )
using
êê( -
(
êê. /

FileStream
êê/ 9

fileStream
êê: D
=
êêE F
new
êêG J

FileStream
êêK U
(
êêU V
FullPath
êêV ^
,
êê^ _
FileMode
êê` h
.
êêh i
Create
êêi o
)
êêo p
)
êêp q
{
ëë( )
data
ìì, 0
.
ìì0 1
File
ìì1 5
.
ìì5 6
CopyTo
ìì6 <
(
ìì< =

fileStream
ìì= G
)
ììG H
;
ììH I
}
îî( )
trx
ññ( +
.
ññ+ ,
Complete
ññ, 4
(
ññ4 5
)
ññ5 6
;
ññ6 7
}
óó$ %
catch
òò$ )
(
òò* +
	Exception
òò+ 4
ex
òò5 7
)
òò7 8
{
ôô$ %
throw
öö( -
;
öö- .
}
õõ$ %
}
úú  !
}
ùù 
else
ûû  
{
üü 
var
††  #
FilePath
††$ ,
=
††- .
_context
††/ 7
.
††7 8'
TblMasterSystemParameters
††8 Q
.
††Q R
Where
††R W
(
††W X
m
††X Y
=>
††Z \
m
††] ^
.
††^ _
Key
††_ b
==
††c e
$str
††f u
)
††u v
.
††v w
Select
††w }
(
††} ~
m
††~ 
=>††Ä Ç
m††É Ñ
.††Ñ Ö
Value††Ö ä
)††ä ã
.††ã å
FirstOrDefault††å ö
(††ö õ
)††õ ú
;††ú ù
if
°°  "
(
°°# $
data
°°$ (
.
°°( )
File
°°) -
==
°°. 0
null
°°1 5
)
°°5 6
{
¢¢  !
return
££$ *
Content
££+ 2
(
££2 3
$str
££3 R
)
££R S
;
££S T
}
§§  !
string
¶¶  &
FileNameNoExt
¶¶' 4
=
¶¶5 6
Path
¶¶7 ;
.
¶¶; <)
GetFileNameWithoutExtension
¶¶< W
(
¶¶W X
data
¶¶X \
.
¶¶\ ]
File
¶¶] a
.
¶¶a b
FileName
¶¶b j
)
¶¶j k
;
¶¶k l
string
ßß  &
Ext
ßß' *
=
ßß+ ,
Path
ßß- 1
.
ßß1 2
GetExtension
ßß2 >
(
ßß> ?
data
ßß? C
.
ßßC D
File
ßßD H
.
ßßH I
FileName
ßßI Q
)
ßßQ R
;
ßßR S
string
®®  &
FullName
®®' /
=
®®0 1
FileNameNoExt
®®2 ?
+
®®@ A
$str
®®B E
+
®®F G
DateTime
®®H P
.
®®P Q
Now
®®Q T
.
®®T U
ToString
®®U ]
(
®®] ^
$str
®®^ n
)
®®n o
+
®®p q
Ext
®®r u
;
®®u v
string
©©  &
FullPath
©©' /
=
©©0 1
FilePath
©©2 :
+
©©; <
FullName
©©= E
;
©©E F
string
´´  &
[
´´& '
]
´´' (
allowedExtensions
´´) :
=
´´; <
{
´´= >
$str
´´? F
,
´´F G
$str
´´H N
,
´´N O
$str
´´P V
,
´´V W
$str
´´X _
,
´´_ `
$str
´´a g
}
´´h i
;
´´i j
if
¨¨  "
(
¨¨# $
!
¨¨$ %
allowedExtensions
¨¨% 6
.
¨¨6 7
Contains
¨¨7 ?
(
¨¨? @
Ext
¨¨@ C
)
¨¨C D
)
¨¨D E
{
≠≠  !
return
ÆÆ$ *
Content
ÆÆ+ 2
(
ÆÆ2 3
$str
ÆÆ3 K
)
ÆÆK L
;
ÆÆL M
}
ØØ  !
if
±±  "
(
±±# $
!
±±$ %
	Directory
±±% .
.
±±. /
Exists
±±/ 5
(
±±5 6
FilePath
±±6 >
)
±±> ?
)
±±? @
{
≤≤  !
	Directory
≥≥$ -
.
≥≥- .
CreateDirectory
≥≥. =
(
≥≥= >
FilePath
≥≥> F
)
≥≥F G
;
≥≥G H
}
¥¥  !
using
∂∂  %
(
∂∂& '

FileStream
∂∂' 1

fileStream
∂∂2 <
=
∂∂= >
new
∂∂? B

FileStream
∂∂C M
(
∂∂M N
FullPath
∂∂N V
,
∂∂V W
FileMode
∂∂X `
.
∂∂` a
Create
∂∂a g
)
∂∂g h
)
∂∂h i
{
∑∑  !
data
ππ$ (
.
ππ( )
File
ππ) -
.
ππ- .
CopyTo
ππ. 4
(
ππ4 5

fileStream
ππ5 ?
)
ππ? @
;
ππ@ A
}
∫∫  !
byte
ºº  $
[
ºº$ %
]
ºº% &
	fileBytes
ºº' 0
=
ºº1 2
System
ºº3 9
.
ºº9 :
IO
ºº: <
.
ºº< =
File
ºº= A
.
ººA B
ReadAllBytes
ººB N
(
ººN O
FullPath
ººO W
)
ººW X
;
ººX Y
string
øø  &
base64String
øø' 3
=
øø4 5
Convert
øø6 =
.
øø= >
ToBase64String
øø> L
(
øøL M
	fileBytes
øøM V
)
øøV W
;
øøW X
var
¬¬  #)
jsonParseReturnUploadBase64
¬¬$ ?
=
¬¬@ A
JsonConvert
¬¬B M
.
¬¬M N
DeserializeObject
¬¬N _
<
¬¬_ `!
ResultStatusDataInt
¬¬` s
<
¬¬s t"
ResultStatusDataNop¬¬t á
>¬¬á à
>¬¬à â
(¬¬â ä
$str¬¬ä å
)¬¬å ç
;¬¬ç é
var
√√  #
urlUploadBase64
√√$ 3
=
√√4 5
	GetConfig
√√6 ?
.
√√? @

AppSetting
√√@ J
[
√√J K
$str
√√K \
]
√√\ ]
+
√√^ _
	GetConfig
√√` i
.
√√i j

AppSetting
√√j t
[
√√t u
$str√√u è
]√√è ê
+√√ë í

dataAssign√√ì ù
.√√ù û
IdNopFromApi√√û ™
;√√™ ´
(
ƒƒ  !
bool
ƒƒ! %#
resultApiUploadBase64
ƒƒ& ;
,
ƒƒ; <
string
ƒƒ= C 
resultUploadBase64
ƒƒD V
)
ƒƒV W
=
ƒƒX Y
RequestToAPI
ƒƒZ f
.
ƒƒf g!
PostRequestToWebApi
ƒƒg z
(
ƒƒz {
urlUploadBase64ƒƒ{ ä
,ƒƒä ã
newƒƒå è
{
≈≈  !
FileName
∆∆$ ,
=
∆∆- .
FullName
∆∆/ 7
,
∆∆7 8
FileContent
««$ /
=
««0 1
base64String
««2 >
,
««> ?
}
»»  !
,
»»! "
null
»»# '
)
»»' (
;
»»( )
if
……  "
(
……# $#
resultApiUploadBase64
……$ 9
&&
……: <
!
……= >
string
……> D
.
……D E
IsNullOrEmpty
……E R
(
……R S 
resultUploadBase64
……S e
)
……e f
)
……f g
{
    !)
jsonParseReturnUploadBase64
ÀÀ$ ?
=
ÀÀ@ A
JsonConvert
ÀÀB M
.
ÀÀM N
DeserializeObject
ÀÀN _
<
ÀÀ_ `!
ResultStatusDataInt
ÀÀ` s
<
ÀÀs t"
ResultStatusDataNopÀÀt á
>ÀÀá à
>ÀÀà â
(ÀÀâ ä"
resultUploadBase64ÀÀä ú
)ÀÀú ù
;ÀÀù û
if
ÃÃ$ &
(
ÃÃ' ()
jsonParseReturnUploadBase64
ÃÃ( C
.
ÃÃC D

StatusCode
ÃÃD N
==
ÃÃO Q
$num
ÃÃR U
||
ÃÃV X)
jsonParseReturnUploadBase64
ÃÃY t
.
ÃÃt u

StatusCode
ÃÃu 
==ÃÃÄ Ç
$numÃÃÉ Ü
)ÃÃÜ á
{
ÕÕ$ %
using
ŒŒ( -
(
ŒŒ. /
TransactionScope
ŒŒ/ ?
trx
ŒŒ@ C
=
ŒŒD E
new
ŒŒF I
TransactionScope
ŒŒJ Z
(
ŒŒZ [
)
ŒŒ[ \
)
ŒŒ\ ]
{
œœ( )
try
––, /
{
——, -
TblFileUploadNop
““0 @
model
““A F
=
““G H
new
““I L
TblFileUploadNop
““M ]
(
““] ^
)
““^ _
;
““_ `
model
””0 5
.
””5 6
IdNop
””6 ;
=
””< =
int
””> A
.
””A B
Parse
””B G
(
””G H
uniq
””H L
)
””L M
;
””M N
model
‘‘0 5
.
‘‘5 6
IdFileFromApi
‘‘6 C
=
‘‘D E)
jsonParseReturnUploadBase64
‘‘F a
.
‘‘a b
Data
‘‘b f
.
‘‘f g
Key
‘‘g j
;
‘‘j k
model
’’0 5
.
’’5 6
FileName
’’6 >
=
’’? @
FullName
’’A I
;
’’I J
model
÷÷0 5
.
÷÷5 6
FileSize
÷÷6 >
=
÷÷? @
Convert
÷÷A H
.
÷÷H I
ToInt32
÷÷I P
(
÷÷P Q
data
÷÷Q U
.
÷÷U V
File
÷÷V Z
.
÷÷Z [
Length
÷÷[ a
)
÷÷a b
;
÷÷b c
model
◊◊0 5
.
◊◊5 6
FilePath
◊◊6 >
=
◊◊? @
FullPath
◊◊A I
;
◊◊I J
model
ÿÿ0 5
.
ÿÿ5 6
FileExt
ÿÿ6 =
=
ÿÿ> ?
Ext
ÿÿ@ C
;
ÿÿC D
model
ŸŸ0 5
.
ŸŸ5 6

UploadTime
ŸŸ6 @
=
ŸŸA B
DateTime
ŸŸC K
.
ŸŸK L
Now
ŸŸL O
;
ŸŸO P
model
⁄⁄0 5
.
⁄⁄5 6

UploadById
⁄⁄6 @
=
⁄⁄A B
int
⁄⁄C F
.
⁄⁄F G
Parse
⁄⁄G L
(
⁄⁄L M
HttpContext
⁄⁄M X
.
⁄⁄X Y
Session
⁄⁄Y `
.
⁄⁄` a
	GetString
⁄⁄a j
(
⁄⁄j k
SessionConstan
⁄⁄k y
.
⁄⁄y z
Session_UserId⁄⁄z à
)⁄⁄à â
)⁄⁄â ä
;⁄⁄ä ã
model
€€0 5
.
€€5 6
IsActive
€€6 >
=
€€? @
$num
€€A B
;
€€B C
model
‹‹0 5
.
‹‹5 6
	IsDeleted
‹‹6 ?
=
‹‹@ A
$num
‹‹B C
;
‹‹C D
_context
››0 8
.
››8 9
TblFileUploadNops
››9 J
.
››J K
Add
››K N
(
››N O
model
››O T
)
››T U
;
››U V
_context
ﬁﬁ0 8
.
ﬁﬁ8 9
SaveChanges
ﬁﬁ9 D
(
ﬁﬁD E
)
ﬁﬁE F
;
ﬁﬁF G
trx
‡‡0 3
.
‡‡3 4
Complete
‡‡4 <
(
‡‡< =
)
‡‡= >
;
‡‡> ?
}
··, -
catch
‚‚, 1
(
‚‚2 3
	Exception
‚‚3 <
ex
‚‚= ?
)
‚‚? @
{
„„, -
throw
‰‰0 5
;
‰‰5 6
}
ÂÂ, -
}
ÊÊ( )
}
ÁÁ$ %
}
ËË  !
}
òò 
}
ôô 
else
öö 
{
õõ 
return
úú "
Content
úú# *
(
úú* +
	GetConfig
úú+ 4
.
úú4 5

AppSetting
úú5 ?
[
úú? @
$str
úú@ [
]
úú[ \
)
úú\ ]
;
úú] ^
}
ùù 
}
ûû 
}
üü 
else
†† 
{
°° 
var
¢¢ 
FilePath
¢¢  
=
¢¢! "
_context
¢¢# +
.
¢¢+ ,'
TblMasterSystemParameters
¢¢, E
.
¢¢E F
Where
¢¢F K
(
¢¢K L
m
¢¢L M
=>
¢¢N P
m
¢¢Q R
.
¢¢R S
Key
¢¢S V
==
¢¢W Y
$str
¢¢Z i
)
¢¢i j
.
¢¢j k
Select
¢¢k q
(
¢¢q r
m
¢¢r s
=>
¢¢t v
m
¢¢w x
.
¢¢x y
Value
¢¢y ~
)
¢¢~ 
.¢¢ Ä
FirstOrDefault¢¢Ä é
(¢¢é è
)¢¢è ê
;¢¢ê ë
if
££ 
(
££ 
data
££ 
.
££ 
File
££ !
==
££" $
null
££% )
)
££) *
{
§§ 
return
•• 
Content
•• &
(
••& '
$str
••' F
)
••F G
;
••G H
}
¶¶ 
string
®® 
FileNameNoExt
®® (
=
®®) *
Path
®®+ /
.
®®/ 0)
GetFileNameWithoutExtension
®®0 K
(
®®K L
data
®®L P
.
®®P Q
File
®®Q U
.
®®U V
FileName
®®V ^
)
®®^ _
;
®®_ `
string
©© 
Ext
©© 
=
©©  
Path
©©! %
.
©©% &
GetExtension
©©& 2
(
©©2 3
data
©©3 7
.
©©7 8
File
©©8 <
.
©©< =
FileName
©©= E
)
©©E F
;
©©F G
string
™™ 
FullName
™™ #
=
™™$ %
FileNameNoExt
™™& 3
+
™™4 5
$str
™™6 9
+
™™: ;
DateTime
™™< D
.
™™D E
Now
™™E H
.
™™H I
ToString
™™I Q
(
™™Q R
$str
™™R b
)
™™b c
+
™™d e
Ext
™™f i
;
™™i j
string
´´ 
FullPath
´´ #
=
´´$ %
FilePath
´´& .
+
´´/ 0
FullName
´´1 9
;
´´9 :
using
≠≠ 
(
≠≠ 
TransactionScope
≠≠ +
trx
≠≠, /
=
≠≠0 1
new
≠≠2 5
TransactionScope
≠≠6 F
(
≠≠F G
)
≠≠G H
)
≠≠H I
{
ÆÆ 
try
ØØ 
{
∞∞ 
TblFileUploadNop
±± ,
model
±±- 2
=
±±3 4
new
±±5 8
TblFileUploadNop
±±9 I
(
±±I J
)
±±J K
;
±±K L
model
≤≤ !
.
≤≤! "
IdNop
≤≤" '
=
≤≤( )
int
≤≤* -
.
≤≤- .
Parse
≤≤. 3
(
≤≤3 4
uniq
≤≤4 8
)
≤≤8 9
;
≤≤9 :
model
≥≥ !
.
≥≥! "
FileName
≥≥" *
=
≥≥+ ,
FullName
≥≥- 5
;
≥≥5 6
model
¥¥ !
.
¥¥! "
FileSize
¥¥" *
=
¥¥+ ,
Convert
¥¥- 4
.
¥¥4 5
ToInt32
¥¥5 <
(
¥¥< =
data
¥¥= A
.
¥¥A B
File
¥¥B F
.
¥¥F G
Length
¥¥G M
)
¥¥M N
;
¥¥N O
model
µµ !
.
µµ! "
FilePath
µµ" *
=
µµ+ ,
FullPath
µµ- 5
;
µµ5 6
model
∂∂ !
.
∂∂! "
FileExt
∂∂" )
=
∂∂* +
Ext
∂∂, /
;
∂∂/ 0
model
∑∑ !
.
∑∑! "

UploadTime
∑∑" ,
=
∑∑- .
DateTime
∑∑/ 7
.
∑∑7 8
Now
∑∑8 ;
;
∑∑; <
model
∏∏ !
.
∏∏! "

UploadById
∏∏" ,
=
∏∏- .
int
∏∏/ 2
.
∏∏2 3
Parse
∏∏3 8
(
∏∏8 9
HttpContext
∏∏9 D
.
∏∏D E
Session
∏∏E L
.
∏∏L M
	GetString
∏∏M V
(
∏∏V W
SessionConstan
∏∏W e
.
∏∏e f
Session_UserId
∏∏f t
)
∏∏t u
)
∏∏u v
;
∏∏v w
model
ππ !
.
ππ! "
IsActive
ππ" *
=
ππ+ ,
$num
ππ- .
;
ππ. /
model
∫∫ !
.
∫∫! "
	IsDeleted
∫∫" +
=
∫∫, -
$num
∫∫. /
;
∫∫/ 0
_context
ªª $
.
ªª$ %
TblFileUploadNops
ªª% 6
.
ªª6 7
Add
ªª7 :
(
ªª: ;
model
ªª; @
)
ªª@ A
;
ªªA B
_context
ºº $
.
ºº$ %
SaveChanges
ºº% 0
(
ºº0 1
)
ºº1 2
;
ºº2 3
if
øø 
(
øø  
!
øø  !
	Directory
øø! *
.
øø* +
Exists
øø+ 1
(
øø1 2
FilePath
øø2 :
)
øø: ;
)
øø; <
{
¿¿ 
	Directory
¡¡  )
.
¡¡) *
CreateDirectory
¡¡* 9
(
¡¡9 :
FilePath
¡¡: B
)
¡¡B C
;
¡¡C D
}
¬¬ 
using
ƒƒ !
(
ƒƒ" #

FileStream
ƒƒ# -

fileStream
ƒƒ. 8
=
ƒƒ9 :
new
ƒƒ; >

FileStream
ƒƒ? I
(
ƒƒI J
FullPath
ƒƒJ R
,
ƒƒR S
FileMode
ƒƒT \
.
ƒƒ\ ]
Create
ƒƒ] c
)
ƒƒc d
)
ƒƒd e
{
≈≈ 
data
««  $
.
««$ %
File
««% )
.
««) *
CopyTo
««* 0
(
««0 1

fileStream
««1 ;
)
««; <
;
««< =
}
»» 
trx
   
.
    
Complete
    (
(
  ( )
)
  ) *
;
  * +
}
ÀÀ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ (
ex
ÃÃ) +
)
ÃÃ+ ,
{
ÕÕ 
throw
ŒŒ !
;
ŒŒ! "
}
œœ 
}
–– 
}
—— 
return
““ 
Content
““ 
(
““ 
$str
““ !
)
““! "
;
““" #
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
÷÷ 
return
◊◊ 
Content
◊◊ 
(
◊◊ 
	GetConfig
◊◊ (
.
◊◊( )

AppSetting
◊◊) 3
[
◊◊3 4
$str
◊◊4 O
]
◊◊O P
)
◊◊P Q
;
◊◊Q R
}
ÿÿ 
}
ŸŸ 	
public
›› 
ActionResult
›› 
Edit
››  
(
››  !
int
››! $
id
››% '
)
››' (
{
ﬁﬁ 	
if
ﬂﬂ 
(
ﬂﬂ 
!
ﬂﬂ 
lastSession
ﬂﬂ 
.
ﬂﬂ 
Update
ﬂﬂ #
(
ﬂﬂ# $
)
ﬂﬂ$ %
)
ﬂﬂ% &
{
‡‡ 
return
·· 
RedirectToAction
·· '
(
··' (
$str
··( /
,
··/ 0
	GetConfig
··1 :
.
··: ;

AppSetting
··; E
[
··E F
$str
··F n
]
··n o
+
··p q
$str
··r y
,
··y z
new
··{ ~
{·· Ä
a··Å Ç
=··É Ñ
true··Ö â
}··ä ã
)··ã å
;··å ç
}
‚‚ 
var
„„ 
location
„„ 
=
„„ 
new
„„ 
Uri
„„ "
(
„„" #
$"
„„# %
{
„„% &
Request
„„& -
.
„„- .
Scheme
„„. 4
}
„„4 5
$str
„„5 8
{
„„8 9
Request
„„9 @
.
„„@ A
Host
„„A E
}
„„E F
{
„„F G
Request
„„G N
.
„„N O
Path
„„O S
}
„„S T
"
„„T U
)
„„U V
;
„„V W
string
‰‰ 
Path
‰‰ 
=
‰‰ 
location
‰‰ "
.
‰‰" #
AbsolutePath
‰‰# /
.
‰‰/ 0
Replace
‰‰0 7
(
‰‰7 8
this
‰‰8 <
.
‰‰< =
ControllerContext
‰‰= N
.
‰‰N O
	RouteData
‰‰O X
.
‰‰X Y
Values
‰‰Y _
[
‰‰_ `
$str
‰‰` h
]
‰‰h i
.
‰‰i j
ToString
‰‰j r
(
‰‰r s
)
‰‰s t
,
‰‰t u
$str
‰‰v }
)
‰‰} ~
;
‰‰~ 
if
ÂÂ 
(
ÂÂ 
!
ÂÂ 
accessSecurity
ÂÂ 
.
ÂÂ  
IsGetAccess
ÂÂ  +
(
ÂÂ+ ,
$str
ÂÂ, 0
+
ÂÂ1 2
Path
ÂÂ3 7
)
ÂÂ7 8
)
ÂÂ8 9
{
ÊÊ 
return
ÁÁ 
RedirectToAction
ÁÁ '
(
ÁÁ' (
$str
ÁÁ( 3
,
ÁÁ3 4
$str
ÁÁ5 <
)
ÁÁ< =
;
ÁÁ= >
}
ËË 
try
ÎÎ 
{
ÏÏ  
TblNoticeOfPayment
ÌÌ "
nop
ÌÌ# &
=
ÌÌ' (
_context
ÌÌ) 1
.
ÌÌ1 2!
TblNoticeOfPayments
ÌÌ2 E
.
ÌÌE F
Where
ÌÌF K
(
ÌÌK L
m
ÌÌL M
=>
ÌÌN P
m
ÌÌQ R
.
ÌÌR S
Id
ÌÌS U
==
ÌÌV X
id
ÌÌY [
)
ÌÌ[ \
.
ÌÌ\ ]
FirstOrDefault
ÌÌ] k
(
ÌÌk l
)
ÌÌl m
;
ÌÌm n
var
ÔÔ 
data
ÔÔ 
=
ÔÔ 
new
ÔÔ "
TblNoticeOfPaymentVM
ÔÔ 3
{
 
Id
ÒÒ 
=
ÒÒ 
nop
ÒÒ 
.
ÒÒ 
Id
ÒÒ 
,
ÒÒ  
NopId
ÚÚ 
=
ÚÚ 
nop
ÚÚ 
.
ÚÚ  
Id
ÚÚ  "
,
ÚÚ" #
NopNo
ÛÛ 
=
ÛÛ 
nop
ÛÛ 
.
ÛÛ  
NopNo
ÛÛ  %
,
ÛÛ% &
RekId
ÙÙ 
=
ÙÙ 
nop
ÙÙ 
.
ÙÙ  
RekId
ÙÙ  %
,
ÙÙ% &
DueDate
ıı 
=
ıı 
nop
ıı !
.
ıı! "
DueDate
ıı" )
,
ıı) *
Cur
ˆˆ 
=
ˆˆ 
_context
ˆˆ "
.
ˆˆ" #
TblMasterLookups
ˆˆ# 3
.
ˆˆ3 4
Where
ˆˆ4 9
(
ˆˆ9 :
m
ˆˆ: ;
=>
ˆˆ< >
m
ˆˆ? @
.
ˆˆ@ A
Name
ˆˆA E
==
ˆˆF H
nop
ˆˆI L
.
ˆˆL M
Cur
ˆˆM P
&&
ˆˆQ S
m
ˆˆT U
.
ˆˆU V
Type
ˆˆV Z
==
ˆˆ[ ]
$str
ˆˆ^ h
)
ˆˆh i
.
ˆˆi j
Select
ˆˆj p
(
ˆˆp q
m
ˆˆq r
=>
ˆˆs u
m
ˆˆv w
.
ˆˆw x
Value
ˆˆx }
)
ˆˆ} ~
.
ˆˆ~ 
FirstOrDefaultˆˆ ç
(ˆˆç é
)ˆˆé è
.ˆˆè ê
ToStringˆˆê ò
(ˆˆò ô
)ˆˆô ö
,ˆˆö õ
InterestDays
˜˜  
=
˜˜! "
nop
˜˜# &
.
˜˜& '
InterestDays
˜˜' 3
.
˜˜3 4
ToString
˜˜4 <
(
˜˜< =
)
˜˜= >
.
˜˜> ?
Replace
˜˜? F
(
˜˜F G
$str
˜˜G L
,
˜˜L M
$str
˜˜N P
)
˜˜P Q
,
˜˜Q R
InterestRate
¯¯  
=
¯¯! "
nop
¯¯# &
.
¯¯& '
InterestRate
¯¯' 3
.
¯¯3 4
ToString
¯¯4 <
(
¯¯< =
)
¯¯= >
.
¯¯> ?
Replace
¯¯? F
(
¯¯F G
$str
¯¯G L
,
¯¯L M
$str
¯¯N P
)
¯¯P Q
,
¯¯Q R
	AccountNo
˘˘ 
=
˘˘ 
nop
˘˘  #
.
˘˘# $
	AccountNo
˘˘$ -
,
˘˘- .
AccountName
˙˙ 
=
˙˙  !
nop
˙˙" %
.
˙˙% &
AccountName
˙˙& 1
,
˙˙1 2
IsActive
˚˚ 
=
˚˚ 
nop
˚˚ "
.
˚˚" #
IsActive
˚˚# +
,
˚˚+ ,
}
¸¸ 
;
¸¸ 
if
˛˛ 
(
˛˛ 
nop
˛˛ 
.
˛˛ 
RekId
˛˛ 
!=
˛˛  
null
˛˛! %
)
˛˛% &
{
ˇˇ 
ViewBag
ÄÄ 
.
ÄÄ 
RekId
ÄÄ !
=
ÄÄ" #
new
ÄÄ$ '

SelectList
ÄÄ( 2
(
ÄÄ2 3
Utility
ÄÄ3 :
.
ÄÄ: ;
SelectDataRekId
ÄÄ; J
(
ÄÄJ K
(
ÄÄK L
int
ÄÄL O
)
ÄÄO P
nop
ÄÄP S
.
ÄÄS T
RekId
ÄÄT Y
)
ÄÄY Z
,
ÄÄZ [
$str
ÄÄ\ `
,
ÄÄ` a
$str
ÄÄb h
,
ÄÄh i
nop
ÄÄj m
.
ÄÄm n
RekId
ÄÄn s
)
ÄÄs t
;
ÄÄt u
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
ViewBag
ÑÑ 
.
ÑÑ 
RekId
ÑÑ !
=
ÑÑ" #
new
ÑÑ$ '

SelectList
ÑÑ( 2
(
ÑÑ2 3
$str
ÑÑ3 5
,
ÑÑ5 6
$str
ÑÑ7 9
)
ÑÑ9 :
;
ÑÑ: ;
}
ÖÖ 
if
áá 
(
áá 
data
áá 
.
áá 
Cur
áá 
!=
áá 
null
áá  $
&&
áá% '
data
áá( ,
.
áá, -
Cur
áá- 0
!=
áá1 3
$str
áá4 6
)
áá6 7
{
àà 
ViewBag
ââ 
.
ââ 
Cur
ââ 
=
ââ  !
new
ââ" %

SelectList
ââ& 0
(
ââ0 1
Utility
ââ1 8
.
ââ8 9"
SelectDataLookupById
ââ9 M
(
ââM N
int
ââN Q
.
ââQ R
Parse
ââR W
(
ââW X
data
ââX \
.
ââ\ ]
Cur
ââ] `
)
ââ` a
,
ââa b
$str
ââc m
,
ââm n
_context
ââo w
)
ââw x
,
ââx y
$str
ââz ~
,
ââ~ 
$strââÄ Ü
,ââÜ á
dataââà å
.ââå ç
Curââç ê
)ââê ë
;ââë í
}
ää 
else
ãã 
{
åå 
ViewBag
çç 
.
çç 
Cur
çç 
=
çç  !
new
çç" %

SelectList
çç& 0
(
çç0 1
$str
çç1 3
,
çç3 4
$str
çç5 7
)
çç7 8
;
çç8 9
}
éé 
return
êê 
PartialView
êê "
(
êê" #
$str
êê# *
,
êê* +
data
êê, 0
)
êê0 1
;
êê1 2
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
ìì 
var
îî 
data
îî 
=
îî 
new
îî '
NoticeOfPayment_ViewModel
îî 8
(
îî8 9
)
îî9 :
;
îî: ;
ViewBag
ïï 
.
ïï 
RekId
ïï 
=
ïï 
new
ïï  #

SelectList
ïï$ .
(
ïï. /
$str
ïï/ 1
,
ïï1 2
$str
ïï3 5
)
ïï5 6
;
ïï6 7
return
ññ 
PartialView
ññ "
(
ññ" #
$str
ññ# *
,
ññ* +
data
ññ, 0
)
ññ0 1
;
ññ1 2
}
óó 
}
òò 	
public
ôô 
ActionResult
ôô 
UpdateDetail
ôô (
(
ôô( )
int
ôô) ,
id
ôô- /
)
ôô/ 0
{
öö 	
if
õõ 
(
õõ 
!
õõ 
lastSession
õõ 
.
õõ 
Update
õõ #
(
õõ# $
)
õõ$ %
)
õõ% &
{
úú 
return
ùù 
RedirectToAction
ùù '
(
ùù' (
$str
ùù( /
,
ùù/ 0
	GetConfig
ùù1 :
.
ùù: ;

AppSetting
ùù; E
[
ùùE F
$str
ùùF n
]
ùùn o
+
ùùp q
$str
ùùr y
,
ùùy z
new
ùù{ ~
{ùù Ä
aùùÅ Ç
=ùùÉ Ñ
trueùùÖ â
}ùùä ã
)ùùã å
;ùùå ç
}
ûû 
var
üü 
location
üü 
=
üü 
new
üü 
Uri
üü "
(
üü" #
$"
üü# %
{
üü% &
Request
üü& -
.
üü- .
Scheme
üü. 4
}
üü4 5
$str
üü5 8
{
üü8 9
Request
üü9 @
.
üü@ A
Host
üüA E
}
üüE F
{
üüF G
Request
üüG N
.
üüN O
Path
üüO S
}
üüS T
"
üüT U
)
üüU V
;
üüV W
string
†† 
Path
†† 
=
†† 
location
†† "
.
††" #
AbsolutePath
††# /
.
††/ 0
Replace
††0 7
(
††7 8
this
††8 <
.
††< =
ControllerContext
††= N
.
††N O
	RouteData
††O X
.
††X Y
Values
††Y _
[
††_ `
$str
††` h
]
††h i
.
††i j
ToString
††j r
(
††r s
)
††s t
,
††t u
$str
††v }
)
††} ~
;
††~ 
int
°° 
	lastIndex
°° 
=
°° 
Path
°°  
.
°°  !
LastIndexOf
°°! ,
(
°°, -
$char
°°- 0
)
°°0 1
;
°°1 2
string
¢¢ 
modifiedUrl
¢¢ 
=
¢¢  
Path
¢¢! %
;
¢¢% &
if
££ 
(
££ 
	lastIndex
££ 
!=
££ 
-
££ 
$num
££ 
)
££  
{
§§ 
modifiedUrl
¶¶ 
=
¶¶ 
Path
¶¶ "
.
¶¶" #
	Substring
¶¶# ,
(
¶¶, -
$num
¶¶- .
,
¶¶. /
	lastIndex
¶¶0 9
)
¶¶9 :
;
¶¶: ;
}
ßß 
if
®® 
(
®® 
!
®® 
accessSecurity
®® 
.
®®  
IsGetAccess
®®  +
(
®®+ ,
$str
®®, 0
+
®®1 2
modifiedUrl
®®3 >
)
®®> ?
)
®®? @
{
©© 
return
™™ 
RedirectToAction
™™ '
(
™™' (
$str
™™( 3
,
™™3 4
$str
™™5 <
)
™™< =
;
™™= >
}
´´ &
TblNoticeOfPaymentDetail
≠≠ $
nopDetailList
≠≠% 2
=
≠≠3 4
_context
≠≠5 =
.
≠≠= >'
TblNoticeOfPaymentDetails
≠≠> W
.
≠≠W X
FirstOrDefault
≠≠X f
(
≠≠f g
n
≠≠g h
=>
≠≠i k
n
≠≠l m
.
≠≠m n
Id
≠≠n p
==
≠≠q s
id
≠≠t v
&&
≠≠w y
n
≠≠z {
.
≠≠{ |
	IsDeleted≠≠| Ö
!=≠≠Ü à
$num≠≠â ä
)≠≠ä ã
;≠≠ã å
return
ØØ 
Json
ØØ 
(
ØØ 
nopDetailList
ØØ %
)
ØØ% &
;
ØØ& '
}
∞∞ 	
public
±± 
ActionResult
±± !
EditDetailNopCreate
±± /
(
±±/ 0
int
±±0 3
id
±±4 6
)
±±6 7
{
≤≤ 	
if
≥≥ 
(
≥≥ 
!
≥≥ 
lastSession
≥≥ 
.
≥≥ 
Update
≥≥ #
(
≥≥# $
)
≥≥$ %
)
≥≥% &
{
¥¥ 
return
µµ 
RedirectToAction
µµ '
(
µµ' (
$str
µµ( /
,
µµ/ 0
	GetConfig
µµ1 :
.
µµ: ;

AppSetting
µµ; E
[
µµE F
$str
µµF n
]
µµn o
+
µµp q
$str
µµr y
,
µµy z
new
µµ{ ~
{µµ Ä
aµµÅ Ç
=µµÉ Ñ
trueµµÖ â
}µµä ã
)µµã å
;µµå ç
}
∂∂ 
var
∑∑ 
location
∑∑ 
=
∑∑ 
new
∑∑ 
Uri
∑∑ "
(
∑∑" #
$"
∑∑# %
{
∑∑% &
Request
∑∑& -
.
∑∑- .
Scheme
∑∑. 4
}
∑∑4 5
$str
∑∑5 8
{
∑∑8 9
Request
∑∑9 @
.
∑∑@ A
Host
∑∑A E
}
∑∑E F
{
∑∑F G
Request
∑∑G N
.
∑∑N O
Path
∑∑O S
}
∑∑S T
"
∑∑T U
)
∑∑U V
;
∑∑V W
string
∏∏ 
Path
∏∏ 
=
∏∏ 
location
∏∏ "
.
∏∏" #
AbsolutePath
∏∏# /
.
∏∏/ 0
Replace
∏∏0 7
(
∏∏7 8
this
∏∏8 <
.
∏∏< =
ControllerContext
∏∏= N
.
∏∏N O
	RouteData
∏∏O X
.
∏∏X Y
Values
∏∏Y _
[
∏∏_ `
$str
∏∏` h
]
∏∏h i
.
∏∏i j
ToString
∏∏j r
(
∏∏r s
)
∏∏s t
,
∏∏t u
$str
∏∏v }
)
∏∏} ~
;
∏∏~ 
if
ππ 
(
ππ 
!
ππ 
accessSecurity
ππ 
.
ππ  
IsGetAccess
ππ  +
(
ππ+ ,
$str
ππ, 0
+
ππ1 2
Path
ππ3 7
)
ππ7 8
)
ππ8 9
{
∫∫ 
return
ªª 
RedirectToAction
ªª '
(
ªª' (
$str
ªª( 3
,
ªª3 4
$str
ªª5 <
)
ªª< =
;
ªª= >
}
ºº '
NoticeOfPayment_ViewModel
ææ %
model
ææ& +
=
ææ, -
new
ææ. 1'
NoticeOfPayment_ViewModel
ææ2 K
(
ææK L
)
ææL M
;
ææM N
model
øø 
.
øø 
Id
øø 
=
øø 
id
øø 
;
øø 
return
¡¡ 
PartialView
¡¡ 
(
¡¡ 
$str
¡¡ /
,
¡¡/ 0
model
¡¡1 6
)
¡¡6 7
;
¡¡7 8
}
¬¬ 	
public
ƒƒ 
async
ƒƒ 
Task
ƒƒ 
<
ƒƒ 
ActionResult
ƒƒ &
>
ƒƒ& '
SubmitDetail
ƒƒ( 4
(
ƒƒ4 5(
TblNoticeOfPaymentDetailVM
ƒƒ5 O
model
ƒƒP U
)
ƒƒU V
{
≈≈ 	
if
∆∆ 
(
∆∆ 
!
∆∆ 
lastSession
∆∆ 
.
∆∆ 
Update
∆∆ #
(
∆∆# $
)
∆∆$ %
)
∆∆% &
{
«« 
return
»» 
RedirectToAction
»» '
(
»»' (
$str
»»( /
,
»»/ 0
	GetConfig
»»1 :
.
»»: ;

AppSetting
»»; E
[
»»E F
$str
»»F n
]
»»n o
+
»»p q
$str
»»r y
,
»»y z
new
»»{ ~
{»» Ä
a»»Å Ç
=»»É Ñ
true»»Ö â
}»»ä ã
)»»ã å
;»»å ç
}
…… 
var
   
location
   
=
   
new
   
Uri
   "
(
  " #
$"
  # %
{
  % &
Request
  & -
.
  - .
Scheme
  . 4
}
  4 5
$str
  5 8
{
  8 9
Request
  9 @
.
  @ A
Host
  A E
}
  E F
{
  F G
Request
  G N
.
  N O
Path
  O S
}
  S T
"
  T U
)
  U V
;
  V W
string
ÀÀ 
Path
ÀÀ 
=
ÀÀ 
location
ÀÀ "
.
ÀÀ" #
AbsolutePath
ÀÀ# /
.
ÀÀ/ 0
Replace
ÀÀ0 7
(
ÀÀ7 8
this
ÀÀ8 <
.
ÀÀ< =
ControllerContext
ÀÀ= N
.
ÀÀN O
	RouteData
ÀÀO X
.
ÀÀX Y
Values
ÀÀY _
[
ÀÀ_ `
$str
ÀÀ` h
]
ÀÀh i
.
ÀÀi j
ToString
ÀÀj r
(
ÀÀr s
)
ÀÀs t
,
ÀÀt u
$str
ÀÀv }
)
ÀÀ} ~
;
ÀÀ~ 
if
ÃÃ 
(
ÃÃ 
!
ÃÃ 
accessSecurity
ÃÃ 
.
ÃÃ  
IsGetAccess
ÃÃ  +
(
ÃÃ+ ,
$str
ÃÃ, 0
+
ÃÃ1 2
Path
ÃÃ3 7
)
ÃÃ7 8
)
ÃÃ8 9
{
ÕÕ 
return
ŒŒ 
RedirectToAction
ŒŒ '
(
ŒŒ' (
$str
ŒŒ( 3
,
ŒŒ3 4
$str
ŒŒ5 <
)
ŒŒ< =
;
ŒŒ= >
}
œœ 
try
—— 
{
““ 
var
”” 
regex
”” 
=
”” 
await
”” !
RegexRequest
””" .
.
””. /
RegexValidation
””/ >
(
””> ?
model
””? D
)
””D E
;
””E F
if
‘‘ 
(
‘‘ 
!
‘‘ 
regex
‘‘ 
)
‘‘ 
{
’’ 
return
÷÷ 
Content
÷÷ "
(
÷÷" #
$str
÷÷# 1
)
÷÷1 2
;
÷÷2 3
}
◊◊ 
using
ŸŸ 
(
ŸŸ 
TransactionScope
ŸŸ '
trx
ŸŸ( +
=
ŸŸ, -
new
ŸŸ. 1
TransactionScope
ŸŸ2 B
(
ŸŸB C
)
ŸŸC D
)
ŸŸD E
{
⁄⁄ &
TblNoticeOfPaymentDetail
€€ ,
data
€€- 1
=
€€2 3
_context
€€4 <
.
€€< ='
TblNoticeOfPaymentDetails
€€= V
.
€€V W
Where
€€W \
(
€€\ ]
m
€€] ^
=>
€€_ a
m
€€b c
.
€€c d
Id
€€d f
==
€€g i
model
€€j o
.
€€o p
Id
€€p r
)
€€r s
.
€€s t
FirstOrDefault€€t Ç
(€€Ç É
)€€É Ñ
;€€Ñ Ö
if
‹‹ 
(
‹‹ 
data
‹‹ 
.
‹‹ 
Id
‹‹ 
!=
‹‹  "
$num
‹‹# $
)
‹‹$ %
{
›› 
data
‡‡ 
.
‡‡ 
CreditorRef
‡‡ (
=
‡‡) *
model
‡‡+ 0
.
‡‡0 1
CreditorRef
‡‡1 <
;
‡‡< =
data
·· 
.
·· 
Outstanding
·· (
=
··) *
decimal
··+ 2
.
··2 3
Parse
··3 8
(
··8 9
model
··9 >
.
··> ?
Outstanding
··? J
.
··J K
Replace
··K R
(
··R S
$str
··S V
,
··V W
$str
··X Z
)
··Z [
)
··[ \
;
··\ ]
data
‚‚ 
.
‚‚ 
	Principal
‚‚ &
=
‚‚' (
decimal
‚‚) 0
.
‚‚0 1
Parse
‚‚1 6
(
‚‚6 7
model
‚‚7 <
.
‚‚< =
	Principal
‚‚= F
.
‚‚F G
Replace
‚‚G N
(
‚‚N O
$str
‚‚O R
,
‚‚R S
$str
‚‚T V
)
‚‚V W
)
‚‚W X
;
‚‚X Y
data
„„ 
.
„„ 
Interest
„„ %
=
„„& '
decimal
„„( /
.
„„/ 0
Parse
„„0 5
(
„„5 6
model
„„6 ;
.
„„; <
Interest
„„< D
.
„„D E
Replace
„„E L
(
„„L M
$str
„„M P
,
„„P Q
$str
„„R T
)
„„T U
)
„„U V
;
„„V W
data
‰‰ 
.
‰‰ 
Fee
‰‰  
=
‰‰! "
decimal
‰‰# *
.
‰‰* +
Parse
‰‰+ 0
(
‰‰0 1
model
‰‰1 6
.
‰‰6 7
Fee
‰‰7 :
.
‰‰: ;
Replace
‰‰; B
(
‰‰B C
$str
‰‰C F
,
‰‰F G
$str
‰‰H J
)
‰‰J K
)
‰‰K L
;
‰‰L M
data
ÂÂ 
.
ÂÂ 
IsActive
ÂÂ %
=
ÂÂ& '
model
ÂÂ( -
.
ÂÂ- .
IsActive
ÂÂ. 6
=
ÂÂ7 8
$num
ÂÂ9 :
;
ÂÂ: ;
data
ÊÊ 
.
ÊÊ 
CreatedTime
ÊÊ (
=
ÊÊ) *
DateTime
ÊÊ+ 3
.
ÊÊ3 4
Now
ÊÊ4 7
;
ÊÊ7 8
data
ÁÁ 
.
ÁÁ 
CreatedById
ÁÁ (
=
ÁÁ) *
int
ÁÁ+ .
.
ÁÁ. /
Parse
ÁÁ/ 4
(
ÁÁ4 5
HttpContext
ÁÁ5 @
.
ÁÁ@ A
Session
ÁÁA H
.
ÁÁH I
	GetString
ÁÁI R
(
ÁÁR S
SessionConstan
ÁÁS a
.
ÁÁa b
Session_UserId
ÁÁb p
)
ÁÁp q
)
ÁÁq r
;
ÁÁr s
data
ËË 
.
ËË 
UpdatedById
ËË (
=
ËË) *
int
ËË+ .
.
ËË. /
Parse
ËË/ 4
(
ËË4 5
HttpContext
ËË5 @
.
ËË@ A
Session
ËËA H
.
ËËH I
	GetString
ËËI R
(
ËËR S
SessionConstan
ËËS a
.
ËËa b
Session_UserId
ËËb p
)
ËËp q
)
ËËq r
;
ËËr s
data
ÈÈ 
.
ÈÈ 
UpdatedTime
ÈÈ (
=
ÈÈ) *
DateTime
ÈÈ+ 3
.
ÈÈ3 4
Now
ÈÈ4 7
;
ÈÈ7 8
data
ÍÍ 
.
ÍÍ 
IsActive
ÍÍ %
=
ÍÍ& '
model
ÍÍ( -
.
ÍÍ- .
IsActive
ÍÍ. 6
=
ÍÍ7 8
$num
ÍÍ9 :
;
ÍÍ: ;
_context
ÎÎ  
.
ÎÎ  !
Entry
ÎÎ! &
(
ÎÎ& '
data
ÎÎ' +
)
ÎÎ+ ,
.
ÎÎ, -
State
ÎÎ- 2
=
ÎÎ3 4
EntityState
ÎÎ5 @
.
ÎÎ@ A
Modified
ÎÎA I
;
ÎÎI J
_context
ÏÏ  
.
ÏÏ  !
SaveChanges
ÏÏ! ,
(
ÏÏ, -
)
ÏÏ- .
;
ÏÏ. /
trx
ÓÓ 
.
ÓÓ 
Complete
ÓÓ $
(
ÓÓ$ %
)
ÓÓ% &
;
ÓÓ& '
}
ÔÔ 
}
 
return
ÒÒ 
Content
ÒÒ 
(
ÒÒ 
$str
ÒÒ !
)
ÒÒ! "
;
ÒÒ" #
}
ÛÛ 
catch
ÙÙ 
{
ıı 
return
ˆˆ 
Content
ˆˆ 
(
ˆˆ 
	GetConfig
ˆˆ (
.
ˆˆ( )

AppSetting
ˆˆ) 3
[
ˆˆ3 4
$str
ˆˆ4 M
]
ˆˆM N
)
ˆˆN O
;
ˆˆO P
}
˜˜ 
}
¯¯ 	
public
˘˘ 
ActionResult
˘˘ 
EditView
˘˘ $
(
˘˘$ %
int
˘˘% (
id
˘˘) +
)
˘˘+ ,
{
˙˙ 	
if
˚˚ 
(
˚˚ 
!
˚˚ 
lastSession
˚˚ 
.
˚˚ 
Update
˚˚ #
(
˚˚# $
)
˚˚$ %
)
˚˚% &
{
¸¸ 
return
˝˝ 
RedirectToAction
˝˝ '
(
˝˝' (
$str
˝˝( /
,
˝˝/ 0
	GetConfig
˝˝1 :
.
˝˝: ;

AppSetting
˝˝; E
[
˝˝E F
$str
˝˝F n
]
˝˝n o
+
˝˝p q
$str
˝˝r y
,
˝˝y z
new
˝˝{ ~
{˝˝ Ä
a˝˝Å Ç
=˝˝É Ñ
true˝˝Ö â
}˝˝ä ã
)˝˝ã å
;˝˝å ç
}
˛˛ 
var
ˇˇ 
location
ˇˇ 
=
ˇˇ 
new
ˇˇ 
Uri
ˇˇ "
(
ˇˇ" #
$"
ˇˇ# %
{
ˇˇ% &
Request
ˇˇ& -
.
ˇˇ- .
Scheme
ˇˇ. 4
}
ˇˇ4 5
$str
ˇˇ5 8
{
ˇˇ8 9
Request
ˇˇ9 @
.
ˇˇ@ A
Host
ˇˇA E
}
ˇˇE F
{
ˇˇF G
Request
ˇˇG N
.
ˇˇN O
Path
ˇˇO S
}
ˇˇS T
"
ˇˇT U
)
ˇˇU V
;
ˇˇV W
string
ÄÄ 
Path
ÄÄ 
=
ÄÄ 
location
ÄÄ "
.
ÄÄ" #
AbsolutePath
ÄÄ# /
.
ÄÄ/ 0
Replace
ÄÄ0 7
(
ÄÄ7 8
this
ÄÄ8 <
.
ÄÄ< =
ControllerContext
ÄÄ= N
.
ÄÄN O
	RouteData
ÄÄO X
.
ÄÄX Y
Values
ÄÄY _
[
ÄÄ_ `
$str
ÄÄ` h
]
ÄÄh i
.
ÄÄi j
ToString
ÄÄj r
(
ÄÄr s
)
ÄÄs t
,
ÄÄt u
$str
ÄÄv }
)
ÄÄ} ~
;
ÄÄ~ 
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
accessSecurity
ÅÅ 
.
ÅÅ  
IsGetAccess
ÅÅ  +
(
ÅÅ+ ,
$str
ÅÅ, 0
+
ÅÅ1 2
Path
ÅÅ3 7
)
ÅÅ7 8
)
ÅÅ8 9
{
ÇÇ 
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( 3
,
ÉÉ3 4
$str
ÉÉ5 <
)
ÉÉ< =
;
ÉÉ= >
}
ÑÑ 
try
ÜÜ 
{
áá  
TblNoticeOfPayment
àà "
nop
àà# &
=
àà' (
_context
àà) 1
.
àà1 2!
TblNoticeOfPayments
àà2 E
.
ààE F
Where
ààF K
(
ààK L
m
ààL M
=>
ààN P
m
ààQ R
.
ààR S
Id
ààS U
==
ààV X
id
ààY [
)
àà[ \
.
àà\ ]
FirstOrDefault
àà] k
(
ààk l
)
ààl m
;
ààm n
if
ää 
(
ää 
nop
ää 
.
ää 
RekId
ää 
!=
ää  
null
ää! %
)
ää% &
{
ãã 
ViewBag
åå 
.
åå 
RekId
åå !
=
åå" #
new
åå$ '

SelectList
åå( 2
(
åå2 3
Utility
åå3 :
.
åå: ;
SelectDataRekId
åå; J
(
ååJ K
(
ååK L
int
ååL O
)
ååO P
nop
ååP S
.
ååS T
RekId
ååT Y
)
ååY Z
,
ååZ [
$str
åå\ `
,
åå` a
$str
ååb h
,
ååh i
nop
ååj m
.
ååm n
RekId
åån s
)
åås t
;
ååt u
}
çç 
else
éé 
{
èè 
ViewBag
êê 
.
êê 
RekId
êê !
=
êê" #
new
êê$ '

SelectList
êê( 2
(
êê2 3
$str
êê3 5
,
êê5 6
$str
êê7 9
)
êê9 :
;
êê: ;
}
ëë 
var
ìì 
data
ìì 
=
ìì 
new
ìì "
TblNoticeOfPaymentVM
ìì 3
{
îî 
Id
ïï 
=
ïï 
nop
ïï 
.
ïï 
Id
ïï 
,
ïï  
NopId
ññ 
=
ññ 
nop
ññ 
.
ññ  
Id
ññ  "
,
ññ" #
NopNo
óó 
=
óó 
nop
óó 
.
óó  
NopNo
óó  %
,
óó% &
RekId
òò 
=
òò 
nop
òò 
.
òò  
RekId
òò  %
,
òò% &
DueDate
ôô 
=
ôô 
nop
ôô !
.
ôô! "
DueDate
ôô" )
,
ôô) *
Cur
öö 
=
öö 
_context
öö "
.
öö" #
TblMasterLookups
öö# 3
.
öö3 4
Where
öö4 9
(
öö9 :
m
öö: ;
=>
öö< >
m
öö? @
.
öö@ A
Name
ööA E
==
ööF H
nop
ööI L
.
ööL M
Cur
ööM P
&&
ööQ S
m
ööT U
.
ööU V
Type
ööV Z
==
öö[ ]
$str
öö^ h
)
ööh i
.
ööi j
Select
ööj p
(
ööp q
m
ööq r
=>
öös u
m
ööv w
.
ööw x
Value
ööx }
)
öö} ~
.
öö~ 
FirstOrDefaultöö ç
(ööç é
)ööé è
.ööè ê
ToStringööê ò
(ööò ô
)ööô ö
,ööö õ
InterestDays
õõ  
=
õõ! "
nop
õõ# &
.
õõ& '
InterestDays
õõ' 3
.
õõ3 4
ToString
õõ4 <
(
õõ< =
)
õõ= >
.
õõ> ?
Replace
õõ? F
(
õõF G
$str
õõG L
,
õõL M
$str
õõN P
)
õõP Q
,
õõQ R
InterestRate
úú  
=
úú! "
nop
úú# &
.
úú& '
InterestRate
úú' 3
.
úú3 4
ToString
úú4 <
(
úú< =
)
úú= >
.
úú> ?
Replace
úú? F
(
úúF G
$str
úúG L
,
úúL M
$str
úúN P
)
úúP Q
,
úúQ R
	AccountNo
ùù 
=
ùù 
nop
ùù  #
.
ùù# $
	AccountNo
ùù$ -
,
ùù- .
AccountName
ûû 
=
ûû  !
nop
ûû" %
.
ûû% &
AccountName
ûû& 1
,
ûû1 2
IsActive
üü 
=
üü 
nop
üü "
.
üü" #
IsActive
üü# +
,
üü+ ,
}
†† 
;
†† 
if
¢¢ 
(
¢¢ 
data
¢¢ 
.
¢¢ 
Cur
¢¢ 
!=
¢¢ 
null
¢¢  $
&&
¢¢% '
data
¢¢( ,
.
¢¢, -
Cur
¢¢- 0
!=
¢¢1 3
$str
¢¢4 6
)
¢¢6 7
{
££ 
ViewBag
§§ 
.
§§ 
Cur
§§ 
=
§§  !
new
§§" %

SelectList
§§& 0
(
§§0 1
Utility
§§1 8
.
§§8 9"
SelectDataLookupById
§§9 M
(
§§M N
int
§§N Q
.
§§Q R
Parse
§§R W
(
§§W X
data
§§X \
.
§§\ ]
Cur
§§] `
)
§§` a
,
§§a b
$str
§§c m
,
§§m n
_context
§§o w
)
§§w x
,
§§x y
$str
§§z ~
,
§§~ 
$str§§Ä Ü
,§§Ü á
data§§à å
.§§å ç
Cur§§ç ê
)§§ê ë
;§§ë í
}
•• 
else
¶¶ 
{
ßß 
ViewBag
®® 
.
®® 
Cur
®® 
=
®®  !
new
®®" %

SelectList
®®& 0
(
®®0 1
$str
®®1 3
,
®®3 4
$str
®®5 7
)
®®7 8
;
®®8 9
}
©© 
return
´´ 
PartialView
´´ "
(
´´" #
$str
´´# .
,
´´. /
data
´´0 4
)
´´4 5
;
´´5 6
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
var
ØØ 
data
ØØ 
=
ØØ 
new
ØØ '
NoticeOfPayment_ViewModel
ØØ 8
(
ØØ8 9
)
ØØ9 :
;
ØØ: ;
ViewBag
∞∞ 
.
∞∞ 
RekId
∞∞ 
=
∞∞ 
new
∞∞  #

SelectList
∞∞$ .
(
∞∞. /
$str
∞∞/ 1
,
∞∞1 2
$str
∞∞3 5
)
∞∞5 6
;
∞∞6 7
return
±± 
PartialView
±± "
(
±±" #
$str
±±# .
,
±±. /
data
±±0 4
)
±±4 5
;
±±5 6
}
≤≤ 
}
≥≥ 	
[
¥¥ 	&
ValidateAntiForgeryToken
¥¥	 !
]
¥¥! "
[
µµ 	
HttpPost
µµ	 
]
µµ 
public
∂∂ 
async
∂∂ 
Task
∂∂ 
<
∂∂ 
ActionResult
∂∂ &
>
∂∂& '

SubmitEdit
∂∂( 2
(
∂∂2 3"
TblNoticeOfPaymentVM
∂∂3 G
model
∂∂H M
,
∂∂M N
string
∂∂O U
listDetailNop
∂∂V c
)
∂∂c d
{
∑∑ 	
if
∏∏ 
(
∏∏ 
!
∏∏ 
lastSession
∏∏ 
.
∏∏ 
Update
∏∏ #
(
∏∏# $
)
∏∏$ %
)
∏∏% &
{
ππ 
return
∫∫ 
RedirectToAction
∫∫ '
(
∫∫' (
$str
∫∫( /
,
∫∫/ 0
	GetConfig
∫∫1 :
.
∫∫: ;

AppSetting
∫∫; E
[
∫∫E F
$str
∫∫F n
]
∫∫n o
+
∫∫p q
$str
∫∫r y
,
∫∫y z
new
∫∫{ ~
{∫∫ Ä
a∫∫Å Ç
=∫∫É Ñ
true∫∫Ö â
}∫∫ä ã
)∫∫ã å
;∫∫å ç
}
ªª 
var
ºº 
location
ºº 
=
ºº 
new
ºº 
Uri
ºº "
(
ºº" #
$"
ºº# %
{
ºº% &
Request
ºº& -
.
ºº- .
Scheme
ºº. 4
}
ºº4 5
$str
ºº5 8
{
ºº8 9
Request
ºº9 @
.
ºº@ A
Host
ººA E
}
ººE F
{
ººF G
Request
ººG N
.
ººN O
Path
ººO S
}
ººS T
"
ººT U
)
ººU V
;
ººV W
string
ΩΩ 
Path
ΩΩ 
=
ΩΩ 
location
ΩΩ "
.
ΩΩ" #
AbsolutePath
ΩΩ# /
.
ΩΩ/ 0
Replace
ΩΩ0 7
(
ΩΩ7 8
this
ΩΩ8 <
.
ΩΩ< =
ControllerContext
ΩΩ= N
.
ΩΩN O
	RouteData
ΩΩO X
.
ΩΩX Y
Values
ΩΩY _
[
ΩΩ_ `
$str
ΩΩ` h
]
ΩΩh i
.
ΩΩi j
ToString
ΩΩj r
(
ΩΩr s
)
ΩΩs t
,
ΩΩt u
$str
ΩΩv }
)
ΩΩ} ~
;
ΩΩ~ 
if
ææ 
(
ææ 
!
ææ 
accessSecurity
ææ 
.
ææ  
IsGetAccess
ææ  +
(
ææ+ ,
$str
ææ, 0
+
ææ1 2
Path
ææ3 7
)
ææ7 8
)
ææ8 9
{
øø 
return
¿¿ 
RedirectToAction
¿¿ '
(
¿¿' (
$str
¿¿( 3
,
¿¿3 4
$str
¿¿5 <
)
¿¿< =
;
¿¿= >
}
¡¡ 
try
√√ 
{
ƒƒ 
var
≈≈ 
regex
≈≈ 
=
≈≈ 
await
≈≈ !
RegexRequest
≈≈" .
.
≈≈. /
RegexValidation
≈≈/ >
(
≈≈> ?
model
≈≈? D
)
≈≈D E
;
≈≈E F
if
∆∆ 
(
∆∆ 
!
∆∆ 
regex
∆∆ 
)
∆∆ 
{
«« 
return
»» 
Content
»» "
(
»»" #
$str
»»# 1
)
»»1 2
;
»»2 3
}
…… 
using
ÀÀ 
(
ÀÀ 
TransactionScope
ÀÀ '
trx
ÀÀ( +
=
ÀÀ, -
new
ÀÀ. 1
TransactionScope
ÀÀ2 B
(
ÀÀB C
)
ÀÀC D
)
ÀÀD E
{
ÃÃ  
TblNoticeOfPayment
ÕÕ &
?
ÕÕ& '
data
ÕÕ( ,
=
ÕÕ- .
_context
ÕÕ/ 7
.
ÕÕ7 8!
TblNoticeOfPayments
ÕÕ8 K
.
ÕÕK L
Where
ÕÕL Q
(
ÕÕQ R
m
ÕÕR S
=>
ÕÕT V
m
ÕÕW X
.
ÕÕX Y
Id
ÕÕY [
==
ÕÕ\ ^
model
ÕÕ_ d
.
ÕÕd e
Id
ÕÕe g
)
ÕÕg h
.
ÕÕh i
FirstOrDefault
ÕÕi w
(
ÕÕw x
)
ÕÕx y
;
ÕÕy z
if
ŒŒ 
(
ŒŒ 
data
ŒŒ 
.
ŒŒ 
NopNo
ŒŒ "
!=
ŒŒ# %
model
ŒŒ& +
.
ŒŒ+ ,
NopNo
ŒŒ, 1
)
ŒŒ1 2
{
œœ  
TblNoticeOfPayment
–– *
	dataNopNo
––+ 4
=
––5 6
_context
––7 ?
.
––? @!
TblNoticeOfPayments
––@ S
.
––S T
Where
––T Y
(
––Y Z
m
––Z [
=>
––\ ^
m
––_ `
.
––` a
NopNo
––a f
==
––g i
model
––j o
.
––o p
NopNo
––p u
&&
––v x
m
––y z
.
––z {
	IsDeleted––{ Ñ
!=––Ö á
$num––à â
)––â ä
.––ä ã
FirstOrDefault––ã ô
(––ô ö
)––ö õ
;––õ ú
if
—— 
(
—— 
	dataNopNo
—— %
!=
——& (
null
——) -
)
——- .
{
““ 
return
”” "
Content
””# *
(
””* +
$str
””+ G
+
””H I
	dataNopNo
””J S
.
””S T
Cur
””T W
)
””W X
;
””X Y
}
‘‘ 
}
’’ 
if
◊◊ 
(
◊◊ 
data
◊◊ 
.
◊◊ 
IdNopFromApi
◊◊ )
!=
◊◊* ,
null
◊◊- 1
)
◊◊1 2
{
ÿÿ 
var
ŸŸ "
jsonParseReturnCheck
ŸŸ 0
=
ŸŸ1 2
JsonConvert
ŸŸ3 >
.
ŸŸ> ?
DeserializeObject
ŸŸ? P
<
ŸŸP Q!
ResultStatusDataInt
ŸŸQ d
<
ŸŸd e!
ResultStatusDataNop
ŸŸe x
>
ŸŸx y
>
ŸŸy z
(
ŸŸz {
$str
ŸŸ{ }
)
ŸŸ} ~
;
ŸŸ~ 
var
⁄⁄ 
urlCheck
⁄⁄ $
=
⁄⁄% &
	GetConfig
⁄⁄' 0
.
⁄⁄0 1

AppSetting
⁄⁄1 ;
[
⁄⁄; <
$str
⁄⁄< M
]
⁄⁄M N
+
⁄⁄O P
	GetConfig
⁄⁄Q Z
.
⁄⁄Z [

AppSetting
⁄⁄[ e
[
⁄⁄e f
$str
⁄⁄f 
]⁄⁄ Ä
+⁄⁄Å Ç
data⁄⁄É á
.⁄⁄á à
IdNopFromApi⁄⁄à î
;⁄⁄î ï
(
€€ 
bool
€€ 
resultApiCheck
€€ ,
,
€€, -
string
€€. 4
resultCheck
€€5 @
)
€€@ A
=
€€B C
RequestToAPI
€€D P
.
€€P Q!
GetJsonStringWebApi
€€Q d
(
€€d e
urlCheck
€€e m
,
€€m n
null
€€o s
)
€€s t
;
€€t u
if
‹‹ 
(
‹‹ 
resultApiCheck
‹‹ *
&&
‹‹+ -
!
‹‹. /
string
‹‹/ 5
.
‹‹5 6
IsNullOrEmpty
‹‹6 C
(
‹‹C D
resultCheck
‹‹D O
)
‹‹O P
)
‹‹P Q
{
›› "
jsonParseReturnCheck
ﬁﬁ 0
=
ﬁﬁ1 2
JsonConvert
ﬁﬁ3 >
.
ﬁﬁ> ?
DeserializeObject
ﬁﬁ? P
<
ﬁﬁP Q!
ResultStatusDataInt
ﬁﬁQ d
<
ﬁﬁd e!
ResultStatusDataNop
ﬁﬁe x
>
ﬁﬁx y
>
ﬁﬁy z
(
ﬁﬁz {
resultCheckﬁﬁ{ Ü
)ﬁﬁÜ á
;ﬁﬁá à
if
ﬂﬂ 
(
ﬂﬂ  "
jsonParseReturnCheck
ﬂﬂ  4
.
ﬂﬂ4 5

StatusCode
ﬂﬂ5 ?
==
ﬂﬂ@ B
$num
ﬂﬂC F
||
ﬂﬂG I"
jsonParseReturnCheck
ﬂﬂJ ^
.
ﬂﬂ^ _

StatusCode
ﬂﬂ_ i
==
ﬂﬂj l
$num
ﬂﬂm p
)
ﬂﬂp q
{
‡‡ 
if
··  "
(
··# $"
jsonParseReturnCheck
··$ 8
.
··8 9
Data
··9 =
.
··= >
Status
··> D
==
··E G
$str
··H R
)
··R S
{
‚‚  !
data
„„$ (
.
„„( )
Status
„„) /
=
„„0 1"
jsonParseReturnCheck
„„2 F
.
„„F G
Data
„„G K
.
„„K L
Status
„„L R
;
„„R S
_context
‰‰$ ,
.
‰‰, -
Entry
‰‰- 2
(
‰‰2 3
data
‰‰3 7
)
‰‰7 8
.
‰‰8 9
State
‰‰9 >
=
‰‰? @
EntityState
‰‰A L
.
‰‰L M
Modified
‰‰M U
;
‰‰U V
_context
ÂÂ$ ,
.
ÂÂ, -
SaveChanges
ÂÂ- 8
(
ÂÂ8 9
)
ÂÂ9 :
;
ÂÂ: ;
trx
ÊÊ$ '
.
ÊÊ' (
Complete
ÊÊ( 0
(
ÊÊ0 1
)
ÊÊ1 2
;
ÊÊ2 3
return
ËË$ *
Content
ËË+ 2
(
ËË2 3
$str
ËË3 H
)
ËËH I
;
ËËI J
}
ÈÈ  !
else
ÍÍ  $
{
ÎÎ  !
data
ÏÏ$ (
.
ÏÏ( )
NopNo
ÏÏ) .
=
ÏÏ/ 0
model
ÏÏ1 6
.
ÏÏ6 7
NopNo
ÏÏ7 <
;
ÏÏ< =
data
ÌÌ$ (
.
ÌÌ( )
DueDate
ÌÌ) 0
=
ÌÌ1 2
model
ÌÌ3 8
.
ÌÌ8 9
DueDate
ÌÌ9 @
;
ÌÌ@ A
data
ÓÓ$ (
.
ÓÓ( )
Cur
ÓÓ) ,
=
ÓÓ- .
_context
ÓÓ/ 7
.
ÓÓ7 8
TblMasterLookups
ÓÓ8 H
.
ÓÓH I
Where
ÓÓI N
(
ÓÓN O
m
ÓÓO P
=>
ÓÓQ S
m
ÓÓT U
.
ÓÓU V
Value
ÓÓV [
==
ÓÓ\ ^
int
ÓÓ_ b
.
ÓÓb c
Parse
ÓÓc h
(
ÓÓh i
model
ÓÓi n
.
ÓÓn o
Cur
ÓÓo r
)
ÓÓr s
&&
ÓÓt v
m
ÓÓw x
.
ÓÓx y
Type
ÓÓy }
==ÓÓ~ Ä
$strÓÓÅ ã
)ÓÓã å
.ÓÓå ç
SelectÓÓç ì
(ÓÓì î
mÓÓî ï
=>ÓÓñ ò
mÓÓô ö
.ÓÓö õ
NameÓÓõ ü
)ÓÓü †
.ÓÓ† °
FirstOrDefaultÓÓ° Ø
(ÓÓØ ∞
)ÓÓ∞ ±
;ÓÓ± ≤
data
ÔÔ$ (
.
ÔÔ( )
RekId
ÔÔ) .
=
ÔÔ/ 0
model
ÔÔ1 6
.
ÔÔ6 7
RekId
ÔÔ7 <
;
ÔÔ< =
data
$ (
.
( )

RekNameAcc
) 3
=
4 5
model
6 ;
.
; <

RekNameAcc
< F
;
F G
data
ÒÒ$ (
.
ÒÒ( )
InterestDays
ÒÒ) 5
=
ÒÒ6 7
model
ÒÒ8 =
.
ÒÒ= >
InterestDays
ÒÒ> J
==
ÒÒK M
null
ÒÒN R
||
ÒÒS U
model
ÒÒV [
.
ÒÒ[ \
InterestDays
ÒÒ\ h
==
ÒÒi k
$str
ÒÒl n
?
ÒÒo p
null
ÒÒq u
:
ÒÒv w
decimal
ÒÒx 
.ÒÒ Ä
ParseÒÒÄ Ö
(ÒÒÖ Ü
modelÒÒÜ ã
.ÒÒã å
InterestDaysÒÒå ò
.ÒÒò ô
ReplaceÒÒô †
(ÒÒ† °
$strÒÒ° §
,ÒÒ§ •
$strÒÒ¶ ®
)ÒÒ® ©
)ÒÒ© ™
;ÒÒ™ ´
data
ÚÚ$ (
.
ÚÚ( )
InterestRate
ÚÚ) 5
=
ÚÚ6 7
model
ÚÚ8 =
.
ÚÚ= >
InterestRate
ÚÚ> J
==
ÚÚK M
null
ÚÚN R
||
ÚÚS U
model
ÚÚV [
.
ÚÚ[ \
InterestRate
ÚÚ\ h
==
ÚÚi k
$str
ÚÚl n
?
ÚÚo p
null
ÚÚq u
:
ÚÚv w
decimal
ÚÚx 
.ÚÚ Ä
ParseÚÚÄ Ö
(ÚÚÖ Ü
modelÚÚÜ ã
.ÚÚã å
InterestRateÚÚå ò
.ÚÚò ô
ReplaceÚÚô †
(ÚÚ† °
$strÚÚ° §
,ÚÚ§ •
$strÚÚ¶ ®
)ÚÚ® ©
)ÚÚ© ™
;ÚÚ™ ´
data
ÛÛ$ (
.
ÛÛ( )
AccountName
ÛÛ) 4
=
ÛÛ5 6
model
ÛÛ7 <
.
ÛÛ< =
AccountName
ÛÛ= H
;
ÛÛH I
data
ÙÙ$ (
.
ÙÙ( )
	AccountNo
ÙÙ) 2
=
ÙÙ3 4
model
ÙÙ5 :
.
ÙÙ: ;
	AccountNo
ÙÙ; D
;
ÙÙD E
data
ıı$ (
.
ıı( )
IsActive
ıı) 1
=
ıı2 3
model
ıı4 9
.
ıı9 :
IsActive
ıı: B
=
ııC D
$num
ııE F
;
ııF G
data
ˆˆ$ (
.
ˆˆ( )
UpdatedById
ˆˆ) 4
=
ˆˆ5 6
int
ˆˆ7 :
.
ˆˆ: ;
Parse
ˆˆ; @
(
ˆˆ@ A
HttpContext
ˆˆA L
.
ˆˆL M
Session
ˆˆM T
.
ˆˆT U
	GetString
ˆˆU ^
(
ˆˆ^ _
SessionConstan
ˆˆ_ m
.
ˆˆm n
Session_UserId
ˆˆn |
)
ˆˆ| }
)
ˆˆ} ~
;
ˆˆ~ 
data
˜˜$ (
.
˜˜( )
UpdatedTime
˜˜) 4
=
˜˜5 6
DateTime
˜˜7 ?
.
˜˜? @
Now
˜˜@ C
;
˜˜C D
_context
¯¯$ ,
.
¯¯, -
Entry
¯¯- 2
(
¯¯2 3
data
¯¯3 7
)
¯¯7 8
.
¯¯8 9
State
¯¯9 >
=
¯¯? @
EntityState
¯¯A L
.
¯¯L M
Modified
¯¯M U
;
¯¯U V
_context
˘˘$ ,
.
˘˘, -
SaveChanges
˘˘- 8
(
˘˘8 9
)
˘˘9 :
;
˘˘: ;
List
˚˚$ (
<
˚˚( )'
NoticeOfPayment_ViewModel
˚˚) B
>
˚˚B C
nopDetailList
˚˚D Q
=
˚˚R S
JsonConvert
˚˚T _
.
˚˚_ `
DeserializeObject
˚˚` q
<
˚˚q r
List
˚˚r v
<
˚˚v w(
NoticeOfPayment_ViewModel˚˚w ê
>˚˚ê ë
>˚˚ë í
(˚˚í ì
listDetailNop˚˚ì †
)˚˚† °
;˚˚° ¢
if
¸¸$ &
(
¸¸' (
nopDetailList
¸¸( 5
!=
¸¸6 8
null
¸¸9 =
)
¸¸= >
{
˝˝$ %
var
˛˛( +
Check
˛˛, 1
=
˛˛2 3
false
˛˛4 9
;
˛˛9 :
foreach
ˇˇ( /
(
ˇˇ0 1
var
ˇˇ1 4
item
ˇˇ5 9
in
ˇˇ: <
nopDetailList
ˇˇ= J
)
ˇˇJ K
{
ÄÄ( )
if
ÅÅ, .
(
ÅÅ/ 0
item
ÅÅ0 4
.
ÅÅ4 5
IdDetailFromGet
ÅÅ5 D
!=
ÅÅE G
null
ÅÅH L
)
ÅÅL M
{
ÇÇ, -&
TblNoticeOfPaymentDetail
ÉÉ0 H
	nopDetail
ÉÉI R
=
ÉÉS T
_context
ÉÉU ]
.
ÉÉ] ^'
TblNoticeOfPaymentDetails
ÉÉ^ w
.
ÉÉw x
Where
ÉÉx }
(
ÉÉ} ~
x
ÉÉ~ 
=>ÉÉÄ Ç
xÉÉÉ Ñ
.ÉÉÑ Ö
IdÉÉÖ á
==ÉÉà ä
itemÉÉã è
.ÉÉè ê
IdDetailFromGetÉÉê ü
)ÉÉü †
.ÉÉ† °
FirstOrDefaultÉÉ° Ø
(ÉÉØ ∞
)ÉÉ∞ ±
;ÉÉ± ≤
	nopDetail
ÑÑ0 9
.
ÑÑ9 :
NopId
ÑÑ: ?
=
ÑÑ@ A
model
ÑÑB G
.
ÑÑG H
Id
ÑÑH J
;
ÑÑJ K
	nopDetail
ÖÖ0 9
.
ÖÖ9 :
CreditorRef
ÖÖ: E
=
ÖÖF G
item
ÖÖH L
.
ÖÖL M
CreditorRef
ÖÖM X
;
ÖÖX Y
	nopDetail
ÜÜ0 9
.
ÜÜ9 :
Outstanding
ÜÜ: E
=
ÜÜF G
item
ÜÜH L
.
ÜÜL M
Outstanding
ÜÜM X
;
ÜÜX Y
	nopDetail
áá0 9
.
áá9 :
	Principal
áá: C
=
ááD E
item
ááF J
.
ááJ K
	Principal
ááK T
;
ááT U
	nopDetail
àà0 9
.
àà9 :
Interest
àà: B
=
ààC D
item
ààE I
.
ààI J
Interest
ààJ R
;
ààR S
	nopDetail
ââ0 9
.
ââ9 :
Fee
ââ: =
=
ââ> ?
item
ââ@ D
.
ââD E
Fee
ââE H
;
ââH I
	nopDetail
ää0 9
.
ää9 :
UpdatedTime
ää: E
=
ääF G
DateTime
ääH P
.
ääP Q
Now
ääQ T
;
ääT U
	nopDetail
ãã0 9
.
ãã9 :
UpdatedById
ãã: E
=
ããF G
int
ããH K
.
ããK L
Parse
ããL Q
(
ããQ R
HttpContext
ããR ]
.
ãã] ^
Session
ãã^ e
.
ããe f
	GetString
ããf o
(
ãão p
SessionConstan
ããp ~
.
ãã~ 
Session_UserIdãã ç
)ããç é
)ããé è
;ããè ê
	nopDetail
åå0 9
.
åå9 :
IsActive
åå: B
=
ååC D
$num
ååE F
;
ååF G
	nopDetail
çç0 9
.
çç9 :
	IsDeleted
çç: C
=
ççD E
$num
ççF G
;
ççG H
_context
éé0 8
.
éé8 9
Entry
éé9 >
(
éé> ?
	nopDetail
éé? H
)
ééH I
.
ééI J
State
ééJ O
=
ééP Q
EntityState
ééR ]
.
éé] ^
Modified
éé^ f
;
ééf g
_context
èè0 8
.
èè8 9
SaveChanges
èè9 D
(
èèD E
)
èèE F
;
èèF G
}
êê, -
else
ëë, 0
{
íí, -
if
ìì0 2
(
ìì3 4
!
ìì4 5
Check
ìì5 :
)
ìì: ;
{
îî0 1%
StoredProcedureExecutor
ïï4 K
.
ïïK L
ExecuteSPSingle
ïïL [
<
ïï[ \#
Navigation_ViewModels
ïï\ q
>
ïïq r
(
ïïr s
_context
ïïs {
,
ïï{ |
$strïï} î
,ïïî ï
newïïñ ô
SqlParameterïïö ¶
[ïï¶ ß
]ïïß ®
{ïï® ©
new
ññ8 ;
SqlParameter
ññ< H
(
ññH I
$str
ññI Q
,
ññQ R
model
ññS X
.
ññX Y
Id
ññY [
)
ññ[ \
}
óó4 5
)
óó5 6
;
óó6 7
Check
ôô4 9
=
ôô: ;
true
ôô< @
;
ôô@ A
}
öö0 1&
TblNoticeOfPaymentDetail
úú0 H
	nopDetail
úúI R
=
úúS T
new
úúU X&
TblNoticeOfPaymentDetail
úúY q
(
úúq r
)
úúr s
;
úús t
	nopDetail
ùù0 9
.
ùù9 :
NopId
ùù: ?
=
ùù@ A
model
ùùB G
.
ùùG H
Id
ùùH J
;
ùùJ K
	nopDetail
ûû0 9
.
ûû9 :
CreditorRef
ûû: E
=
ûûF G
item
ûûH L
.
ûûL M
CreditorRef
ûûM X
;
ûûX Y
	nopDetail
üü0 9
.
üü9 :
Outstanding
üü: E
=
üüF G
item
üüH L
.
üüL M
Outstanding
üüM X
;
üüX Y
	nopDetail
††0 9
.
††9 :
	Principal
††: C
=
††D E
item
††F J
.
††J K
	Principal
††K T
;
††T U
	nopDetail
°°0 9
.
°°9 :
Interest
°°: B
=
°°C D
item
°°E I
.
°°I J
Interest
°°J R
;
°°R S
	nopDetail
¢¢0 9
.
¢¢9 :
Fee
¢¢: =
=
¢¢> ?
item
¢¢@ D
.
¢¢D E
Fee
¢¢E H
;
¢¢H I
	nopDetail
££0 9
.
££9 :
CreatedTime
££: E
=
££F G
DateTime
££H P
.
££P Q
Now
££Q T
;
££T U
	nopDetail
§§0 9
.
§§9 :
CreatedById
§§: E
=
§§F G
int
§§H K
.
§§K L
Parse
§§L Q
(
§§Q R
HttpContext
§§R ]
.
§§] ^
Session
§§^ e
.
§§e f
	GetString
§§f o
(
§§o p
SessionConstan
§§p ~
.
§§~ 
Session_UserId§§ ç
)§§ç é
)§§é è
;§§è ê
	nopDetail
••0 9
.
••9 :
IsActive
••: B
=
••C D
$num
••E F
;
••F G
	nopDetail
¶¶0 9
.
¶¶9 :
	IsDeleted
¶¶: C
=
¶¶D E
$num
¶¶F G
;
¶¶G H
_context
ßß0 8
.
ßß8 9'
TblNoticeOfPaymentDetails
ßß9 R
.
ßßR S
Add
ßßS V
(
ßßV W
	nopDetail
ßßW `
)
ßß` a
;
ßßa b
_context
®®0 8
.
®®8 9
SaveChanges
®®9 D
(
®®D E
)
®®E F
;
®®F G
}
™™, -
}
´´( )
}
¨¨$ %
}
≠≠  !
}
ÆÆ 
else
ØØ  
{
∞∞ 
return
±±  &
Content
±±' .
(
±±. /
	GetConfig
±±/ 8
.
±±8 9

AppSetting
±±9 C
[
±±C D
$str
±±D _
]
±±_ `
)
±±` a
;
±±a b
}
≤≤ 
}
≥≥ 
}
∂∂ 
else
∑∑ 
{
∏∏ 
data
ππ 
.
ππ 
NopNo
ππ "
=
ππ# $
model
ππ% *
.
ππ* +
NopNo
ππ+ 0
;
ππ0 1
data
∫∫ 
.
∫∫ 
DueDate
∫∫ $
=
∫∫% &
model
∫∫' ,
.
∫∫, -
DueDate
∫∫- 4
;
∫∫4 5
data
ªª 
.
ªª 
Cur
ªª  
=
ªª! "
_context
ªª# +
.
ªª+ ,
TblMasterLookups
ªª, <
.
ªª< =
Where
ªª= B
(
ªªB C
m
ªªC D
=>
ªªE G
m
ªªH I
.
ªªI J
Value
ªªJ O
==
ªªP R
int
ªªS V
.
ªªV W
Parse
ªªW \
(
ªª\ ]
model
ªª] b
.
ªªb c
Cur
ªªc f
)
ªªf g
&&
ªªh j
m
ªªk l
.
ªªl m
Type
ªªm q
==
ªªr t
$str
ªªu 
)ªª Ä
.ªªÄ Å
SelectªªÅ á
(ªªá à
mªªà â
=>ªªä å
mªªç é
.ªªé è
Nameªªè ì
)ªªì î
.ªªî ï
FirstOrDefaultªªï £
(ªª£ §
)ªª§ •
;ªª• ¶
data
ºº 
.
ºº 
RekId
ºº "
=
ºº# $
model
ºº% *
.
ºº* +
RekId
ºº+ 0
;
ºº0 1
data
ΩΩ 
.
ΩΩ 

RekNameAcc
ΩΩ '
=
ΩΩ( )
model
ΩΩ* /
.
ΩΩ/ 0

RekNameAcc
ΩΩ0 :
;
ΩΩ: ;
data
ææ 
.
ææ 
InterestDays
ææ )
=
ææ* +
model
ææ, 1
.
ææ1 2
InterestDays
ææ2 >
==
ææ? A
null
ææB F
||
ææG I
model
ææJ O
.
ææO P
InterestDays
ææP \
==
ææ] _
$str
ææ` b
?
ææc d
null
ææe i
:
ææj k
decimal
ææl s
.
ææs t
Parse
ææt y
(
ææy z
model
ææz 
.ææ Ä
InterestDaysææÄ å
.ææå ç
Replaceææç î
(ææî ï
$strææï ò
,ææò ô
$strææö ú
)ææú ù
)ææù û
;ææû ü
data
øø 
.
øø 
InterestRate
øø )
=
øø* +
model
øø, 1
.
øø1 2
InterestRate
øø2 >
==
øø? A
null
øøB F
||
øøG I
model
øøJ O
.
øøO P
InterestRate
øøP \
==
øø] _
$str
øø` b
?
øøc d
null
øøe i
:
øøj k
decimal
øøl s
.
øøs t
Parse
øøt y
(
øøy z
model
øøz 
.øø Ä
InterestRateøøÄ å
.øøå ç
Replaceøøç î
(øøî ï
$strøøï ò
,øøò ô
$strøøö ú
)øøú ù
)øøù û
;øøû ü
data
¿¿ 
.
¿¿ 
AccountName
¿¿ (
=
¿¿) *
model
¿¿+ 0
.
¿¿0 1
AccountName
¿¿1 <
;
¿¿< =
data
¡¡ 
.
¡¡ 
	AccountNo
¡¡ &
=
¡¡' (
model
¡¡) .
.
¡¡. /
	AccountNo
¡¡/ 8
;
¡¡8 9
data
¬¬ 
.
¬¬ 
IsActive
¬¬ %
=
¬¬& '
model
¬¬( -
.
¬¬- .
IsActive
¬¬. 6
=
¬¬7 8
$num
¬¬9 :
;
¬¬: ;
data
√√ 
.
√√ 
UpdatedById
√√ (
=
√√) *
int
√√+ .
.
√√. /
Parse
√√/ 4
(
√√4 5
HttpContext
√√5 @
.
√√@ A
Session
√√A H
.
√√H I
	GetString
√√I R
(
√√R S
SessionConstan
√√S a
.
√√a b
Session_UserId
√√b p
)
√√p q
)
√√q r
;
√√r s
data
ƒƒ 
.
ƒƒ 
UpdatedTime
ƒƒ (
=
ƒƒ) *
DateTime
ƒƒ+ 3
.
ƒƒ3 4
Now
ƒƒ4 7
;
ƒƒ7 8
_context
≈≈  
.
≈≈  !
Entry
≈≈! &
(
≈≈& '
data
≈≈' +
)
≈≈+ ,
.
≈≈, -
State
≈≈- 2
=
≈≈3 4
EntityState
≈≈5 @
.
≈≈@ A
Modified
≈≈A I
;
≈≈I J
_context
∆∆  
.
∆∆  !
SaveChanges
∆∆! ,
(
∆∆, -
)
∆∆- .
;
∆∆. /
List
»» 
<
»» '
NoticeOfPayment_ViewModel
»» 6
>
»»6 7
nopDetailList
»»8 E
=
»»F G
JsonConvert
»»H S
.
»»S T
DeserializeObject
»»T e
<
»»e f
List
»»f j
<
»»j k(
NoticeOfPayment_ViewModel»»k Ñ
>»»Ñ Ö
>»»Ö Ü
(»»Ü á
listDetailNop»»á î
)»»î ï
;»»ï ñ
if
…… 
(
…… 
nopDetailList
…… )
!=
……* ,
null
……- 1
)
……1 2
{
   
var
ÀÀ 
Check
ÀÀ  %
=
ÀÀ& '
false
ÀÀ( -
;
ÀÀ- .
foreach
ÃÃ #
(
ÃÃ$ %
var
ÃÃ% (
item
ÃÃ) -
in
ÃÃ. 0
nopDetailList
ÃÃ1 >
)
ÃÃ> ?
{
ÕÕ 
if
ŒŒ  "
(
ŒŒ# $
item
ŒŒ$ (
.
ŒŒ( )
IdDetailFromGet
ŒŒ) 8
!=
ŒŒ9 ;
null
ŒŒ< @
)
ŒŒ@ A
{
œœ  !&
TblNoticeOfPaymentDetail
––$ <
	nopDetail
––= F
=
––G H
_context
––I Q
.
––Q R'
TblNoticeOfPaymentDetails
––R k
.
––k l
Where
––l q
(
––q r
x
––r s
=>
––t v
x
––w x
.
––x y
Id
––y {
==
––| ~
item–– É
.––É Ñ
IdDetailFromGet––Ñ ì
)––ì î
.––î ï
FirstOrDefault––ï £
(––£ §
)––§ •
;––• ¶
	nopDetail
——$ -
.
——- .
NopId
——. 3
=
——4 5
model
——6 ;
.
——; <
Id
——< >
;
——> ?
	nopDetail
““$ -
.
““- .
CreditorRef
““. 9
=
““: ;
item
““< @
.
““@ A
CreditorRef
““A L
;
““L M
	nopDetail
””$ -
.
””- .
Outstanding
””. 9
=
””: ;
item
””< @
.
””@ A
Outstanding
””A L
;
””L M
	nopDetail
‘‘$ -
.
‘‘- .
	Principal
‘‘. 7
=
‘‘8 9
item
‘‘: >
.
‘‘> ?
	Principal
‘‘? H
;
‘‘H I
	nopDetail
’’$ -
.
’’- .
Interest
’’. 6
=
’’7 8
item
’’9 =
.
’’= >
Interest
’’> F
;
’’F G
	nopDetail
÷÷$ -
.
÷÷- .
Fee
÷÷. 1
=
÷÷2 3
item
÷÷4 8
.
÷÷8 9
Fee
÷÷9 <
;
÷÷< =
	nopDetail
◊◊$ -
.
◊◊- .
UpdatedTime
◊◊. 9
=
◊◊: ;
DateTime
◊◊< D
.
◊◊D E
Now
◊◊E H
;
◊◊H I
	nopDetail
ÿÿ$ -
.
ÿÿ- .
UpdatedById
ÿÿ. 9
=
ÿÿ: ;
int
ÿÿ< ?
.
ÿÿ? @
Parse
ÿÿ@ E
(
ÿÿE F
HttpContext
ÿÿF Q
.
ÿÿQ R
Session
ÿÿR Y
.
ÿÿY Z
	GetString
ÿÿZ c
(
ÿÿc d
SessionConstan
ÿÿd r
.
ÿÿr s
Session_UserIdÿÿs Å
)ÿÿÅ Ç
)ÿÿÇ É
;ÿÿÉ Ñ
	nopDetail
ŸŸ$ -
.
ŸŸ- .
IsActive
ŸŸ. 6
=
ŸŸ7 8
$num
ŸŸ9 :
;
ŸŸ: ;
	nopDetail
⁄⁄$ -
.
⁄⁄- .
	IsDeleted
⁄⁄. 7
=
⁄⁄8 9
$num
⁄⁄: ;
;
⁄⁄; <
_context
€€$ ,
.
€€, -
Entry
€€- 2
(
€€2 3
	nopDetail
€€3 <
)
€€< =
.
€€= >
State
€€> C
=
€€D E
EntityState
€€F Q
.
€€Q R
Modified
€€R Z
;
€€Z [
_context
‹‹$ ,
.
‹‹, -
SaveChanges
‹‹- 8
(
‹‹8 9
)
‹‹9 :
;
‹‹: ;
}
››  !
else
ﬁﬁ  $
{
ﬂﬂ  !
if
‡‡$ &
(
‡‡' (
!
‡‡( )
Check
‡‡) .
)
‡‡. /
{
··$ %%
StoredProcedureExecutor
‚‚( ?
.
‚‚? @
ExecuteSPSingle
‚‚@ O
<
‚‚O P#
Navigation_ViewModels
‚‚P e
>
‚‚e f
(
‚‚f g
_context
‚‚g o
,
‚‚o p
$str‚‚q à
,‚‚à â
new‚‚ä ç
SqlParameter‚‚é ö
[‚‚ö õ
]‚‚õ ú
{‚‚ú ù
new
„„( +
SqlParameter
„„, 8
(
„„8 9
$str
„„9 A
,
„„A B
model
„„C H
.
„„H I
Id
„„I K
)
„„K L
}
‰‰$ %
)
‰‰% &
;
‰‰& '
Check
ÊÊ( -
=
ÊÊ. /
true
ÊÊ0 4
;
ÊÊ4 5
}
ÁÁ$ %&
TblNoticeOfPaymentDetail
ÈÈ$ <
	nopDetail
ÈÈ= F
=
ÈÈG H
new
ÈÈI L&
TblNoticeOfPaymentDetail
ÈÈM e
(
ÈÈe f
)
ÈÈf g
;
ÈÈg h
	nopDetail
ÍÍ$ -
.
ÍÍ- .
NopId
ÍÍ. 3
=
ÍÍ4 5
model
ÍÍ6 ;
.
ÍÍ; <
Id
ÍÍ< >
;
ÍÍ> ?
	nopDetail
ÎÎ$ -
.
ÎÎ- .
CreditorRef
ÎÎ. 9
=
ÎÎ: ;
item
ÎÎ< @
.
ÎÎ@ A
CreditorRef
ÎÎA L
;
ÎÎL M
	nopDetail
ÏÏ$ -
.
ÏÏ- .
Outstanding
ÏÏ. 9
=
ÏÏ: ;
item
ÏÏ< @
.
ÏÏ@ A
Outstanding
ÏÏA L
;
ÏÏL M
	nopDetail
ÌÌ$ -
.
ÌÌ- .
	Principal
ÌÌ. 7
=
ÌÌ8 9
item
ÌÌ: >
.
ÌÌ> ?
	Principal
ÌÌ? H
;
ÌÌH I
	nopDetail
ÓÓ$ -
.
ÓÓ- .
Interest
ÓÓ. 6
=
ÓÓ7 8
item
ÓÓ9 =
.
ÓÓ= >
Interest
ÓÓ> F
;
ÓÓF G
	nopDetail
ÔÔ$ -
.
ÔÔ- .
Fee
ÔÔ. 1
=
ÔÔ2 3
item
ÔÔ4 8
.
ÔÔ8 9
Fee
ÔÔ9 <
;
ÔÔ< =
	nopDetail
$ -
.
- .
CreatedTime
. 9
=
: ;
DateTime
< D
.
D E
Now
E H
;
H I
	nopDetail
ÒÒ$ -
.
ÒÒ- .
CreatedById
ÒÒ. 9
=
ÒÒ: ;
int
ÒÒ< ?
.
ÒÒ? @
Parse
ÒÒ@ E
(
ÒÒE F
HttpContext
ÒÒF Q
.
ÒÒQ R
Session
ÒÒR Y
.
ÒÒY Z
	GetString
ÒÒZ c
(
ÒÒc d
SessionConstan
ÒÒd r
.
ÒÒr s
Session_UserIdÒÒs Å
)ÒÒÅ Ç
)ÒÒÇ É
;ÒÒÉ Ñ
	nopDetail
ÚÚ$ -
.
ÚÚ- .
IsActive
ÚÚ. 6
=
ÚÚ7 8
$num
ÚÚ9 :
;
ÚÚ: ;
	nopDetail
ÛÛ$ -
.
ÛÛ- .
	IsDeleted
ÛÛ. 7
=
ÛÛ8 9
$num
ÛÛ: ;
;
ÛÛ; <
_context
ÙÙ$ ,
.
ÙÙ, -'
TblNoticeOfPaymentDetails
ÙÙ- F
.
ÙÙF G
Add
ÙÙG J
(
ÙÙJ K
	nopDetail
ÙÙK T
)
ÙÙT U
;
ÙÙU V
_context
ıı$ ,
.
ıı, -
SaveChanges
ıı- 8
(
ıı8 9
)
ıı9 :
;
ıı: ;
}
˜˜  !
}
¯¯ 
}
˘˘ 
}
˙˙ 
trx
íí 
.
íí 
Complete
íí  
(
íí  !
)
íí! "
;
íí" #
}
îî 
return
ïï 
Content
ïï 
(
ïï 
$str
ïï !
)
ïï! "
;
ïï" #
}
óó 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
ôô 
return
öö 
Content
öö 
(
öö 
	GetConfig
öö (
.
öö( )

AppSetting
öö) 3
[
öö3 4
$str
öö4 M
]
ööM N
)
ööN O
;
ööO P
}
õõ 
}
úú 	
public
†† 
ActionResult
†† 
View
††  
(
††  !
int
††! $
id
††% '
)
††' (
{
°° 	
if
¢¢ 
(
¢¢ 
!
¢¢ 
lastSession
¢¢ 
.
¢¢ 
Update
¢¢ #
(
¢¢# $
)
¢¢$ %
)
¢¢% &
{
££ 
return
§§ 
RedirectToAction
§§ '
(
§§' (
$str
§§( /
,
§§/ 0
	GetConfig
§§1 :
.
§§: ;

AppSetting
§§; E
[
§§E F
$str
§§F n
]
§§n o
+
§§p q
$str
§§r y
,
§§y z
new
§§{ ~
{§§ Ä
a§§Å Ç
=§§É Ñ
true§§Ö â
}§§ä ã
)§§ã å
;§§å ç
}
•• 
var
¶¶ 
location
¶¶ 
=
¶¶ 
new
¶¶ 
Uri
¶¶ "
(
¶¶" #
$"
¶¶# %
{
¶¶% &
Request
¶¶& -
.
¶¶- .
Scheme
¶¶. 4
}
¶¶4 5
$str
¶¶5 8
{
¶¶8 9
Request
¶¶9 @
.
¶¶@ A
Host
¶¶A E
}
¶¶E F
{
¶¶F G
Request
¶¶G N
.
¶¶N O
Path
¶¶O S
}
¶¶S T
"
¶¶T U
)
¶¶U V
;
¶¶V W
string
ßß 
Path
ßß 
=
ßß 
location
ßß "
.
ßß" #
AbsolutePath
ßß# /
.
ßß/ 0
Replace
ßß0 7
(
ßß7 8
this
ßß8 <
.
ßß< =
ControllerContext
ßß= N
.
ßßN O
	RouteData
ßßO X
.
ßßX Y
Values
ßßY _
[
ßß_ `
$str
ßß` h
]
ßßh i
.
ßßi j
ToString
ßßj r
(
ßßr s
)
ßßs t
,
ßßt u
$str
ßßv }
)
ßß} ~
;
ßß~ 
if
®® 
(
®® 
!
®® 
accessSecurity
®® 
.
®®  
IsGetAccess
®®  +
(
®®+ ,
$str
®®, 0
+
®®1 2
Path
®®3 7
)
®®7 8
)
®®8 9
{
©© 
return
™™ 
RedirectToAction
™™ '
(
™™' (
$str
™™( 3
,
™™3 4
$str
™™5 <
)
™™< =
;
™™= >
}
´´ 
try
≠≠ 
{
ÆÆ  
TblNoticeOfPayment
ØØ "
nop
ØØ# &
=
ØØ' (
_context
ØØ) 1
.
ØØ1 2!
TblNoticeOfPayments
ØØ2 E
.
ØØE F
Where
ØØF K
(
ØØK L
m
ØØL M
=>
ØØN P
m
ØØQ R
.
ØØR S
Id
ØØS U
==
ØØV X
id
ØØY [
)
ØØ[ \
.
ØØ\ ]
FirstOrDefault
ØØ] k
(
ØØk l
)
ØØl m
;
ØØm n
if
±± 
(
±± 
nop
±± 
.
±± 
RekId
±± 
!=
±±  
null
±±! %
)
±±% &
{
≤≤ 
ViewBag
≥≥ 
.
≥≥ 
RekId
≥≥ !
=
≥≥" #
new
≥≥$ '

SelectList
≥≥( 2
(
≥≥2 3
Utility
≥≥3 :
.
≥≥: ;
SelectDataRekId
≥≥; J
(
≥≥J K
(
≥≥K L
int
≥≥L O
)
≥≥O P
nop
≥≥P S
.
≥≥S T
RekId
≥≥T Y
)
≥≥Y Z
,
≥≥Z [
$str
≥≥\ `
,
≥≥` a
$str
≥≥b h
,
≥≥h i
nop
≥≥j m
.
≥≥m n
RekId
≥≥n s
)
≥≥s t
;
≥≥t u
}
¥¥ 
else
µµ 
{
∂∂ 
ViewBag
∑∑ 
.
∑∑ 
RekId
∑∑ !
=
∑∑" #
new
∑∑$ '

SelectList
∑∑( 2
(
∑∑2 3
$str
∑∑3 5
,
∑∑5 6
$str
∑∑7 9
)
∑∑9 :
;
∑∑: ;
}
∏∏ 
var
∫∫ 
data
∫∫ 
=
∫∫ 
new
∫∫ "
TblNoticeOfPaymentVM
∫∫ 3
{
ªª 
Id
ºº 
=
ºº 
nop
ºº 
.
ºº 
Id
ºº 
,
ºº  
NopNo
ΩΩ 
=
ΩΩ 
nop
ΩΩ 
.
ΩΩ  
NopNo
ΩΩ  %
,
ΩΩ% &
Cur
ææ 
=
ææ 
_context
ææ "
.
ææ" #
TblMasterLookups
ææ# 3
.
ææ3 4
Where
ææ4 9
(
ææ9 :
m
ææ: ;
=>
ææ< >
m
ææ? @
.
ææ@ A
Name
ææA E
==
ææF H
nop
ææI L
.
ææL M
Cur
ææM P
&&
ææQ S
m
ææT U
.
ææU V
Type
ææV Z
==
ææ[ ]
$str
ææ^ h
)
ææh i
.
ææi j
Select
ææj p
(
ææp q
m
ææq r
=>
ææs u
m
ææv w
.
ææw x
Value
ææx }
)
ææ} ~
.
ææ~ 
FirstOrDefaultææ ç
(ææç é
)ææé è
.ææè ê
ToStringææê ò
(ææò ô
)ææô ö
,ææö õ
DueDate
øø 
=
øø 
nop
øø !
.
øø! "
DueDate
øø" )
,
øø) *
InterestDays
¿¿  
=
¿¿! "
nop
¿¿# &
.
¿¿& '
InterestDays
¿¿' 3
.
¿¿3 4
ToString
¿¿4 <
(
¿¿< =
)
¿¿= >
.
¿¿> ?
Replace
¿¿? F
(
¿¿F G
$str
¿¿G L
,
¿¿L M
$str
¿¿N P
)
¿¿P Q
,
¿¿Q R
InterestRate
¡¡  
=
¡¡! "
nop
¡¡# &
.
¡¡& '
InterestRate
¡¡' 3
.
¡¡3 4
ToString
¡¡4 <
(
¡¡< =
)
¡¡= >
.
¡¡> ?
Replace
¡¡? F
(
¡¡F G
$str
¡¡G L
,
¡¡L M
$str
¡¡N P
)
¡¡P Q
,
¡¡Q R
	AccountNo
¬¬ 
=
¬¬ 
nop
¬¬  #
.
¬¬# $
	AccountNo
¬¬$ -
,
¬¬- .
RekId
√√ 
=
√√ 
nop
√√ 
.
√√  
RekId
√√  %
,
√√% &
AccountName
ƒƒ 
=
ƒƒ  !
nop
ƒƒ" %
.
ƒƒ% &
AccountName
ƒƒ& 1
,
ƒƒ1 2
IsActive
≈≈ 
=
≈≈ 
nop
≈≈ "
.
≈≈" #
IsActive
≈≈# +
,
≈≈+ ,
}
∆∆ 
;
∆∆ 
if
»» 
(
»» 
data
»» 
.
»» 
Cur
»» 
!=
»» 
null
»»  $
&&
»»% '
data
»»( ,
.
»», -
Cur
»»- 0
!=
»»1 3
$str
»»4 6
)
»»6 7
{
…… 
ViewBag
   
.
   
Cur
   
=
    !
new
  " %

SelectList
  & 0
(
  0 1
Utility
  1 8
.
  8 9"
SelectDataLookupById
  9 M
(
  M N
int
  N Q
.
  Q R
Parse
  R W
(
  W X
data
  X \
.
  \ ]
Cur
  ] `
)
  ` a
,
  a b
$str
  c m
,
  m n
_context
  o w
)
  w x
,
  x y
$str
  z ~
,
  ~ 
$str  Ä Ü
,  Ü á
data  à å
.  å ç
Cur  ç ê
)  ê ë
;  ë í
}
ÀÀ 
else
ÃÃ 
{
ÕÕ 
ViewBag
ŒŒ 
.
ŒŒ 
Cur
ŒŒ 
=
ŒŒ  !
new
ŒŒ" %

SelectList
ŒŒ& 0
(
ŒŒ0 1
$str
ŒŒ1 3
,
ŒŒ3 4
$str
ŒŒ5 7
)
ŒŒ7 8
;
ŒŒ8 9
}
œœ 
return
—— 
PartialView
—— "
(
——" #
$str
——# *
,
——* +
data
——, 0
)
——0 1
;
——1 2
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
‘‘ 
var
’’ 
data
’’ 
=
’’ 
new
’’ '
NoticeOfPayment_ViewModel
’’ 8
(
’’8 9
)
’’9 :
;
’’: ;
return
◊◊ 
PartialView
◊◊ "
(
◊◊" #
$str
◊◊# *
,
◊◊* +
data
◊◊, 0
)
◊◊0 1
;
◊◊1 2
}
ÿÿ 
}
ŸŸ 	
public
›› 
ActionResult
›› 
Delete
›› "
(
››" #
string
››# )
Ids
››* -
)
››- .
{
ﬁﬁ 	
if
ﬂﬂ 
(
ﬂﬂ 
!
ﬂﬂ 
lastSession
ﬂﬂ 
.
ﬂﬂ 
Update
ﬂﬂ #
(
ﬂﬂ# $
)
ﬂﬂ$ %
)
ﬂﬂ% &
{
‡‡ 
return
·· 
RedirectToAction
·· '
(
··' (
$str
··( /
,
··/ 0
	GetConfig
··1 :
.
··: ;

AppSetting
··; E
[
··E F
$str
··F n
]
··n o
+
··p q
$str
··r y
,
··y z
new
··{ ~
{·· Ä
a··Å Ç
=··É Ñ
true··Ö â
}··ä ã
)··ã å
;··å ç
}
‚‚ 
var
„„ 
location
„„ 
=
„„ 
new
„„ 
Uri
„„ "
(
„„" #
$"
„„# %
{
„„% &
Request
„„& -
.
„„- .
Scheme
„„. 4
}
„„4 5
$str
„„5 8
{
„„8 9
Request
„„9 @
.
„„@ A
Host
„„A E
}
„„E F
{
„„F G
Request
„„G N
.
„„N O
Path
„„O S
}
„„S T
"
„„T U
)
„„U V
;
„„V W
string
‰‰ 
Path
‰‰ 
=
‰‰ 
location
‰‰ "
.
‰‰" #
AbsolutePath
‰‰# /
.
‰‰/ 0
Replace
‰‰0 7
(
‰‰7 8
this
‰‰8 <
.
‰‰< =
ControllerContext
‰‰= N
.
‰‰N O
	RouteData
‰‰O X
.
‰‰X Y
Values
‰‰Y _
[
‰‰_ `
$str
‰‰` h
]
‰‰h i
.
‰‰i j
ToString
‰‰j r
(
‰‰r s
)
‰‰s t
,
‰‰t u
$str
‰‰v }
)
‰‰} ~
;
‰‰~ 
if
ÂÂ 
(
ÂÂ 
!
ÂÂ 
accessSecurity
ÂÂ 
.
ÂÂ  
IsGetAccess
ÂÂ  +
(
ÂÂ+ ,
$str
ÂÂ, 0
+
ÂÂ1 2
Path
ÂÂ3 7
)
ÂÂ7 8
)
ÂÂ8 9
{
ÊÊ 
return
ÁÁ 
RedirectToAction
ÁÁ '
(
ÁÁ' (
$str
ÁÁ( 3
,
ÁÁ3 4
$str
ÁÁ5 <
)
ÁÁ< =
;
ÁÁ= >
}
ËË 
try
ÍÍ 
{
ÎÎ 
long
ÏÏ 
[
ÏÏ 
]
ÏÏ 
confirmedDeleteId
ÏÏ (
=
ÏÏ) *
Ids
ÏÏ+ .
.
ÏÏ. /
Split
ÏÏ/ 4
(
ÏÏ4 5
$char
ÏÏ5 8
)
ÏÏ8 9
.
ÏÏ9 :
Select
ÏÏ: @
(
ÏÏ@ A
long
ÏÏA E
.
ÏÏE F
Parse
ÏÏF K
)
ÏÏK L
.
ÏÏL M
ToArray
ÏÏM T
(
ÏÏT U
)
ÏÏU V
;
ÏÏV W
List
ÓÓ 
<
ÓÓ  
TblNoticeOfPayment
ÓÓ '
>
ÓÓ' (

Transaksis
ÓÓ) 3
=
ÓÓ4 5
_context
ÓÓ6 >
.
ÓÓ> ?!
TblNoticeOfPayments
ÓÓ? R
.
ÓÓR S
Where
ÓÓS X
(
ÓÓX Y
x
ÓÓY Z
=>
ÓÓ[ ]
confirmedDeleteId
ÓÓ^ o
.
ÓÓo p
Contains
ÓÓp x
(
ÓÓx y
x
ÓÓy z
.
ÓÓz {
Id
ÓÓ{ }
)
ÓÓ} ~
)
ÓÓ~ 
.ÓÓ Ä
ToListÓÓÄ Ü
(ÓÓÜ á
)ÓÓá à
;ÓÓà â
for
ÔÔ 
(
ÔÔ 
int
ÔÔ 
i
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
;
ÔÔ 
i
ÔÔ  !
<
ÔÔ" #
confirmedDeleteId
ÔÔ$ 5
.
ÔÔ5 6
Length
ÔÔ6 <
;
ÔÔ< =
i
ÔÔ> ?
++
ÔÔ? A
)
ÔÔA B
{
 
if
ÒÒ 
(
ÒÒ 

Transaksis
ÒÒ "
[
ÒÒ" #
i
ÒÒ# $
]
ÒÒ$ %
.
ÒÒ% &
IdNopFromApi
ÒÒ& 2
!=
ÒÒ3 5
null
ÒÒ6 :
)
ÒÒ: ;
{
ÚÚ 
var
ÛÛ "
jsonParseReturnCheck
ÛÛ 0
=
ÛÛ1 2
JsonConvert
ÛÛ3 >
.
ÛÛ> ?
DeserializeObject
ÛÛ? P
<
ÛÛP Q!
ResultStatusDataInt
ÛÛQ d
<
ÛÛd e!
ResultStatusDataNop
ÛÛe x
>
ÛÛx y
>
ÛÛy z
(
ÛÛz {
$str
ÛÛ{ }
)
ÛÛ} ~
;
ÛÛ~ 
var
ÙÙ 
urlCheck
ÙÙ $
=
ÙÙ% &
	GetConfig
ÙÙ' 0
.
ÙÙ0 1

AppSetting
ÙÙ1 ;
[
ÙÙ; <
$str
ÙÙ< M
]
ÙÙM N
+
ÙÙO P
	GetConfig
ÙÙQ Z
.
ÙÙZ [

AppSetting
ÙÙ[ e
[
ÙÙe f
$str
ÙÙf 
]ÙÙ Ä
+ÙÙÅ Ç

TransaksisÙÙÉ ç
[ÙÙç é
iÙÙé è
]ÙÙè ê
.ÙÙê ë
IdNopFromApiÙÙë ù
;ÙÙù û
(
ıı 
bool
ıı 
resultApiCheck
ıı ,
,
ıı, -
string
ıı. 4
resultCheck
ıı5 @
)
ıı@ A
=
ııB C
RequestToAPI
ııD P
.
ııP Q!
GetJsonStringWebApi
ııQ d
(
ııd e
urlCheck
ııe m
,
ıım n
null
ııo s
)
ııs t
;
ııt u
if
ˆˆ 
(
ˆˆ 
resultApiCheck
ˆˆ *
&&
ˆˆ+ -
!
ˆˆ. /
string
ˆˆ/ 5
.
ˆˆ5 6
IsNullOrEmpty
ˆˆ6 C
(
ˆˆC D
resultCheck
ˆˆD O
)
ˆˆO P
)
ˆˆP Q
{
˜˜ "
jsonParseReturnCheck
¯¯ 0
=
¯¯1 2
JsonConvert
¯¯3 >
.
¯¯> ?
DeserializeObject
¯¯? P
<
¯¯P Q!
ResultStatusDataInt
¯¯Q d
<
¯¯d e!
ResultStatusDataNop
¯¯e x
>
¯¯x y
>
¯¯y z
(
¯¯z {
resultCheck¯¯{ Ü
)¯¯Ü á
;¯¯á à
}
˘˘ 
if
˚˚ 
(
˚˚ "
jsonParseReturnCheck
˚˚ 0
.
˚˚0 1

StatusCode
˚˚1 ;
==
˚˚< >
$num
˚˚? B
||
˚˚C E"
jsonParseReturnCheck
˚˚F Z
.
˚˚Z [

StatusCode
˚˚[ e
==
˚˚f h
$num
˚˚i l
)
˚˚l m
{
¸¸ 
if
˝˝ 
(
˝˝  "
jsonParseReturnCheck
˝˝  4
.
˝˝4 5
Data
˝˝5 9
.
˝˝9 :
Status
˝˝: @
==
˝˝A C
$str
˝˝D P
)
˝˝P Q
{
˛˛ 
var
ˇˇ  ##
jsonParseReturnDelete
ˇˇ$ 9
=
ˇˇ: ;
JsonConvert
ˇˇ< G
.
ˇˇG H
DeserializeObject
ˇˇH Y
<
ˇˇY Z!
ResultStatusDataInt
ˇˇZ m
<
ˇˇm n"
ResultStatusDataNopˇˇn Å
>ˇˇÅ Ç
>ˇˇÇ É
(ˇˇÉ Ñ
$strˇˇÑ Ü
)ˇˇÜ á
;ˇˇá à
var
ÄÄ  #
	urlDelete
ÄÄ$ -
=
ÄÄ. /
	GetConfig
ÄÄ0 9
.
ÄÄ9 :

AppSetting
ÄÄ: D
[
ÄÄD E
$str
ÄÄE V
]
ÄÄV W
+
ÄÄX Y
	GetConfig
ÄÄZ c
.
ÄÄc d

AppSetting
ÄÄd n
[
ÄÄn o
$strÄÄo É
]ÄÄÉ Ñ
+ÄÄÖ Ü

TransaksisÄÄá ë
[ÄÄë í
iÄÄí ì
]ÄÄì î
.ÄÄî ï
IdNopFromApiÄÄï °
;ÄÄ° ¢
(
ÅÅ  !
bool
ÅÅ! %
resultApiDelete
ÅÅ& 5
,
ÅÅ5 6
string
ÅÅ7 =
resultDelete
ÅÅ> J
)
ÅÅJ K
=
ÅÅL M
RequestToAPI
ÅÅN Z
.
ÅÅZ [#
DeleteRequestToWebApi
ÅÅ[ p
(
ÅÅp q
	urlDelete
ÅÅq z
,
ÅÅz {
nullÅÅ| Ä
)ÅÅÄ Å
;ÅÅÅ Ç
if
ÇÇ  "
(
ÇÇ# $
resultApiDelete
ÇÇ$ 3
&&
ÇÇ4 6
!
ÇÇ7 8
string
ÇÇ8 >
.
ÇÇ> ?
IsNullOrEmpty
ÇÇ? L
(
ÇÇL M
resultDelete
ÇÇM Y
)
ÇÇY Z
)
ÇÇZ [
{
ÉÉ  !#
jsonParseReturnDelete
ÑÑ$ 9
=
ÑÑ: ;
JsonConvert
ÑÑ< G
.
ÑÑG H
DeserializeObject
ÑÑH Y
<
ÑÑY Z!
ResultStatusDataInt
ÑÑZ m
<
ÑÑm n"
ResultStatusDataNopÑÑn Å
>ÑÑÅ Ç
>ÑÑÇ É
(ÑÑÉ Ñ
resultDeleteÑÑÑ ê
)ÑÑê ë
;ÑÑë í
}
ÖÖ  !
if
áá  "
(
áá# $#
jsonParseReturnDelete
áá$ 9
.
áá9 :

StatusCode
áá: D
==
ááE G
$num
ááH K
||
ááL N#
jsonParseReturnDelete
ááO d
.
áád e

StatusCode
ááe o
==
ááp r
$num
áás v
)
ááv w
{
àà  ! 
TblNoticeOfPayment
ââ$ 6
data
ââ7 ;
=
ââ< =
_context
ââ> F
.
ââF G!
TblNoticeOfPayments
ââG Z
.
ââZ [
Find
ââ[ _
(
ââ_ `

Transaksis
ââ` j
[
ââj k
i
ââk l
]
ââl m
.
ââm n
Id
âân p
)
ââp q
;
ââq r
data
ää$ (
.
ää( )
	IsDeleted
ää) 2
=
ää3 4
$num
ää5 6
;
ää6 7
_context
ãã$ ,
.
ãã, -
Entry
ãã- 2
(
ãã2 3
data
ãã3 7
)
ãã7 8
.
ãã8 9
State
ãã9 >
=
ãã? @
EntityState
ããA L
.
ããL M
Modified
ããM U
;
ããU V
_context
åå$ ,
.
åå, -
SaveChanges
åå- 8
(
åå8 9
)
åå9 :
;
åå: ;
}
çç  !
}
éé 
}
èè 
}
êê 
else
ëë 
{
íí  
TblNoticeOfPayment
ìì *
data
ìì+ /
=
ìì0 1
_context
ìì2 :
.
ìì: ;!
TblNoticeOfPayments
ìì; N
.
ììN O
Find
ììO S
(
ììS T

Transaksis
ììT ^
[
ìì^ _
i
ìì_ `
]
ìì` a
.
ììa b
Id
ììb d
)
ììd e
;
ììe f
data
îî 
.
îî 
	IsDeleted
îî &
=
îî' (
$num
îî) *
;
îî* +
_context
ïï  
.
ïï  !
Entry
ïï! &
(
ïï& '
data
ïï' +
)
ïï+ ,
.
ïï, -
State
ïï- 2
=
ïï3 4
EntityState
ïï5 @
.
ïï@ A
Modified
ïïA I
;
ïïI J
_context
ññ  
.
ññ  !
SaveChanges
ññ! ,
(
ññ, -
)
ññ- .
;
ññ. /
}
óó 
List
ôô 
<
ôô &
TblNoticeOfPaymentDetail
ôô 1
>
ôô1 2
NopDetailList
ôô3 @
=
ôôA B
_context
ôôC K
.
ôôK L'
TblNoticeOfPaymentDetails
ôôL e
.
ôôe f
Where
ôôf k
(
ôôk l
n
ôôl m
=>
ôôn p
n
ôôq r
.
ôôr s
NopId
ôôs x
==
ôôy {

Transaksisôô| Ü
[ôôÜ á
iôôá à
]ôôà â
.ôôâ ä
Idôôä å
&&ôôç è
nôôê ë
.ôôë í
	IsDeletedôôí õ
!=ôôú û
$numôôü †
)ôô† °
.ôô° ¢
ToListôô¢ ®
(ôô® ©
)ôô© ™
;ôô™ ´
if
õõ 
(
õõ 
NopDetailList
õõ %
.
õõ% &
Count
õõ& +
!=
õõ, .
$num
õõ/ 0
)
õõ0 1
{
úú 
foreach
ùù 
(
ùù  !
var
ùù! $
detail
ùù% +
in
ùù, .
NopDetailList
ùù/ <
)
ùù< =
{
ûû 
detail
üü "
.
üü" #
	IsDeleted
üü# ,
=
üü- .
$num
üü/ 0
;
üü0 1
_context
†† $
.
††$ %
Entry
††% *
(
††* +
detail
††+ 1
)
††1 2
.
††2 3
State
††3 8
=
††9 :
EntityState
††; F
.
††F G
Modified
††G O
;
††O P
_context
°° $
.
°°$ %
SaveChanges
°°% 0
(
°°0 1
)
°°1 2
;
°°2 3
}
¢¢ 
}
££ 
}
§§ 
return
•• 
Content
•• 
(
•• 
$str
•• !
)
••! "
;
••" #
}
¶¶ 
catch
ßß 
{
®® 
return
©© 
Content
©© 
(
©© 
$str
©© &
)
©©& '
;
©©' (
}
™™ 
}
´´ 	
public
¨¨ 
ActionResult
¨¨ !
DeleteDetailNopTemp
¨¨ /
(
¨¨/ 0
string
¨¨0 6
Ids
¨¨7 :
)
¨¨: ;
{
≠≠ 	
if
ÆÆ 
(
ÆÆ 
!
ÆÆ 
lastSession
ÆÆ 
.
ÆÆ 
Update
ÆÆ #
(
ÆÆ# $
)
ÆÆ$ %
)
ÆÆ% &
{
ØØ 
return
∞∞ 
RedirectToAction
∞∞ '
(
∞∞' (
$str
∞∞( /
,
∞∞/ 0
	GetConfig
∞∞1 :
.
∞∞: ;

AppSetting
∞∞; E
[
∞∞E F
$str
∞∞F n
]
∞∞n o
+
∞∞p q
$str
∞∞r y
,
∞∞y z
new
∞∞{ ~
{∞∞ Ä
a∞∞Å Ç
=∞∞É Ñ
true∞∞Ö â
}∞∞ä ã
)∞∞ã å
;∞∞å ç
}
±± 
var
≤≤ 
location
≤≤ 
=
≤≤ 
new
≤≤ 
Uri
≤≤ "
(
≤≤" #
$"
≤≤# %
{
≤≤% &
Request
≤≤& -
.
≤≤- .
Scheme
≤≤. 4
}
≤≤4 5
$str
≤≤5 8
{
≤≤8 9
Request
≤≤9 @
.
≤≤@ A
Host
≤≤A E
}
≤≤E F
{
≤≤F G
Request
≤≤G N
.
≤≤N O
Path
≤≤O S
}
≤≤S T
"
≤≤T U
)
≤≤U V
;
≤≤V W
string
≥≥ 
Path
≥≥ 
=
≥≥ 
location
≥≥ "
.
≥≥" #
AbsolutePath
≥≥# /
.
≥≥/ 0
Replace
≥≥0 7
(
≥≥7 8
this
≥≥8 <
.
≥≥< =
ControllerContext
≥≥= N
.
≥≥N O
	RouteData
≥≥O X
.
≥≥X Y
Values
≥≥Y _
[
≥≥_ `
$str
≥≥` h
]
≥≥h i
.
≥≥i j
ToString
≥≥j r
(
≥≥r s
)
≥≥s t
,
≥≥t u
$str
≥≥v }
)
≥≥} ~
;
≥≥~ 
if
¥¥ 
(
¥¥ 
!
¥¥ 
accessSecurity
¥¥ 
.
¥¥  
IsGetAccess
¥¥  +
(
¥¥+ ,
$str
¥¥, 0
+
¥¥1 2
Path
¥¥3 7
)
¥¥7 8
)
¥¥8 9
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( 3
,
∂∂3 4
$str
∂∂5 <
)
∂∂< =
;
∂∂= >
}
∑∑ 
try
ππ 
{
∫∫ 
long
ªª 
[
ªª 
]
ªª 
confirmedDeleteId
ªª (
=
ªª) *
Ids
ªª+ .
.
ªª. /
Split
ªª/ 4
(
ªª4 5
$char
ªª5 8
)
ªª8 9
.
ªª9 :
Select
ªª: @
(
ªª@ A
long
ªªA E
.
ªªE F
Parse
ªªF K
)
ªªK L
.
ªªL M
ToArray
ªªM T
(
ªªT U
)
ªªU V
;
ªªV W
List
ΩΩ 
<
ΩΩ *
TblNoticeOfPaymentDetailTemp
ΩΩ 1
>
ΩΩ1 2

Transaksis
ΩΩ3 =
=
ΩΩ> ?
_context
ΩΩ@ H
.
ΩΩH I+
TblNoticeOfPaymentDetailTemps
ΩΩI f
.
ΩΩf g
Where
ΩΩg l
(
ΩΩl m
x
ΩΩm n
=>
ΩΩo q 
confirmedDeleteIdΩΩr É
.ΩΩÉ Ñ
ContainsΩΩÑ å
(ΩΩå ç
xΩΩç é
.ΩΩé è
IdΩΩè ë
)ΩΩë í
)ΩΩí ì
.ΩΩì î
ToListΩΩî ö
(ΩΩö õ
)ΩΩõ ú
;ΩΩú ù
for
ææ 
(
ææ 
int
ææ 
i
ææ 
=
ææ 
$num
ææ 
;
ææ 
i
ææ  !
<
ææ" #
confirmedDeleteId
ææ$ 5
.
ææ5 6
Length
ææ6 <
;
ææ< =
i
ææ> ?
++
ææ? A
)
ææA B
{
øø *
TblNoticeOfPaymentDetailTemp
¿¿ 0
data
¿¿1 5
=
¿¿6 7
_context
¿¿8 @
.
¿¿@ A+
TblNoticeOfPaymentDetailTemps
¿¿A ^
.
¿¿^ _
Find
¿¿_ c
(
¿¿c d

Transaksis
¿¿d n
[
¿¿n o
i
¿¿o p
]
¿¿p q
.
¿¿q r
Id
¿¿r t
)
¿¿t u
;
¿¿u v
data
¡¡ 
.
¡¡ 
	IsDeleted
¡¡ "
=
¡¡# $
$num
¡¡% &
;
¡¡& '
_context
¬¬ 
.
¬¬ 
Entry
¬¬ "
(
¬¬" #
data
¬¬# '
)
¬¬' (
.
¬¬( )
State
¬¬) .
=
¬¬/ 0
EntityState
¬¬1 <
.
¬¬< =
Modified
¬¬= E
;
¬¬E F
_context
√√ 
.
√√ 
SaveChanges
√√ (
(
√√( )
)
√√) *
;
√√* +
}
ƒƒ 
return
≈≈ 
Content
≈≈ 
(
≈≈ 
$str
≈≈ !
)
≈≈! "
;
≈≈" #
}
∆∆ 
catch
«« 
{
»» 
return
…… 
Content
…… 
(
…… 
$str
…… &
)
……& '
;
……' (
}
   
}
ÀÀ 	
public
ÃÃ 
ActionResult
ÃÃ 
DeleteDetail
ÃÃ (
(
ÃÃ( )
string
ÃÃ) /
Ids
ÃÃ0 3
)
ÃÃ3 4
{
ÕÕ 	
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
lastSession
ŒŒ 
.
ŒŒ 
Update
ŒŒ #
(
ŒŒ# $
)
ŒŒ$ %
)
ŒŒ% &
{
œœ 
return
–– 
RedirectToAction
–– '
(
––' (
$str
––( /
,
––/ 0
	GetConfig
––1 :
.
––: ;

AppSetting
––; E
[
––E F
$str
––F n
]
––n o
+
––p q
$str
––r y
,
––y z
new
––{ ~
{–– Ä
a––Å Ç
=––É Ñ
true––Ö â
}––ä ã
)––ã å
;––å ç
}
—— 
var
““ 
location
““ 
=
““ 
new
““ 
Uri
““ "
(
““" #
$"
““# %
{
““% &
Request
““& -
.
““- .
Scheme
““. 4
}
““4 5
$str
““5 8
{
““8 9
Request
““9 @
.
““@ A
Host
““A E
}
““E F
{
““F G
Request
““G N
.
““N O
Path
““O S
}
““S T
"
““T U
)
““U V
;
““V W
string
”” 
Path
”” 
=
”” 
location
”” "
.
””" #
AbsolutePath
””# /
.
””/ 0
Replace
””0 7
(
””7 8
this
””8 <
.
””< =
ControllerContext
””= N
.
””N O
	RouteData
””O X
.
””X Y
Values
””Y _
[
””_ `
$str
””` h
]
””h i
.
””i j
ToString
””j r
(
””r s
)
””s t
,
””t u
$str
””v }
)
””} ~
;
””~ 
if
‘‘ 
(
‘‘ 
!
‘‘ 
accessSecurity
‘‘ 
.
‘‘  
IsGetAccess
‘‘  +
(
‘‘+ ,
$str
‘‘, 0
+
‘‘1 2
Path
‘‘3 7
)
‘‘7 8
)
‘‘8 9
{
’’ 
return
÷÷ 
RedirectToAction
÷÷ '
(
÷÷' (
$str
÷÷( 3
,
÷÷3 4
$str
÷÷5 <
)
÷÷< =
;
÷÷= >
}
◊◊ 
try
ŸŸ 
{
⁄⁄ 
long
€€ 
[
€€ 
]
€€ 
confirmedDeleteId
€€ (
=
€€) *
Ids
€€+ .
.
€€. /
Split
€€/ 4
(
€€4 5
$char
€€5 8
)
€€8 9
.
€€9 :
Select
€€: @
(
€€@ A
long
€€A E
.
€€E F
Parse
€€F K
)
€€K L
.
€€L M
ToArray
€€M T
(
€€T U
)
€€U V
;
€€V W
List
›› 
<
›› &
TblNoticeOfPaymentDetail
›› -
>
››- .

Transaksis
››/ 9
=
››: ;
_context
››< D
.
››D E'
TblNoticeOfPaymentDetails
››E ^
.
››^ _
Where
››_ d
(
››d e
x
››e f
=>
››g i
confirmedDeleteId
››j {
.
››{ |
Contains››| Ñ
(››Ñ Ö
x››Ö Ü
.››Ü á
Id››á â
)››â ä
)››ä ã
.››ã å
ToList››å í
(››í ì
)››ì î
;››î ï
for
ﬁﬁ 
(
ﬁﬁ 
int
ﬁﬁ 
i
ﬁﬁ 
=
ﬁﬁ 
$num
ﬁﬁ 
;
ﬁﬁ 
i
ﬁﬁ  !
<
ﬁﬁ" #
confirmedDeleteId
ﬁﬁ$ 5
.
ﬁﬁ5 6
Length
ﬁﬁ6 <
;
ﬁﬁ< =
i
ﬁﬁ> ?
++
ﬁﬁ? A
)
ﬁﬁA B
{
ﬂﬂ &
TblNoticeOfPaymentDetail
‡‡ ,
data
‡‡- 1
=
‡‡2 3
_context
‡‡4 <
.
‡‡< ='
TblNoticeOfPaymentDetails
‡‡= V
.
‡‡V W
Find
‡‡W [
(
‡‡[ \

Transaksis
‡‡\ f
[
‡‡f g
i
‡‡g h
]
‡‡h i
.
‡‡i j
Id
‡‡j l
)
‡‡l m
;
‡‡m n
data
·· 
.
·· 
	IsDeleted
·· "
=
··# $
$num
··% &
;
··& '
_context
‰‰ 
.
‰‰ 
Entry
‰‰ "
(
‰‰" #
data
‰‰# '
)
‰‰' (
.
‰‰( )
State
‰‰) .
=
‰‰/ 0
EntityState
‰‰1 <
.
‰‰< =
Modified
‰‰= E
;
‰‰E F
_context
ÂÂ 
.
ÂÂ 
SaveChanges
ÂÂ (
(
ÂÂ( )
)
ÂÂ) *
;
ÂÂ* +
}
ÊÊ 
return
ÁÁ 
Content
ÁÁ 
(
ÁÁ 
$str
ÁÁ !
)
ÁÁ! "
;
ÁÁ" #
}
ËË 
catch
ÈÈ 
{
ÍÍ 
return
ÎÎ 
Content
ÎÎ 
(
ÎÎ 
$str
ÎÎ &
)
ÎÎ& '
;
ÎÎ' (
}
ÏÏ 
}
ÌÌ 	
public
ÓÓ 
ActionResult
ÓÓ 
DeleteDetailNop
ÓÓ +
(
ÓÓ+ ,
string
ÓÓ, 2
Ids
ÓÓ3 6
)
ÓÓ6 7
{
ÔÔ 	
if
 
(
 
!
 
lastSession
 
.
 
Update
 #
(
# $
)
$ %
)
% &
{
ÒÒ 
return
ÚÚ 
RedirectToAction
ÚÚ '
(
ÚÚ' (
$str
ÚÚ( /
,
ÚÚ/ 0
	GetConfig
ÚÚ1 :
.
ÚÚ: ;

AppSetting
ÚÚ; E
[
ÚÚE F
$str
ÚÚF n
]
ÚÚn o
+
ÚÚp q
$str
ÚÚr y
,
ÚÚy z
new
ÚÚ{ ~
{ÚÚ Ä
aÚÚÅ Ç
=ÚÚÉ Ñ
trueÚÚÖ â
}ÚÚä ã
)ÚÚã å
;ÚÚå ç
}
ÛÛ 
var
ÙÙ 
location
ÙÙ 
=
ÙÙ 
new
ÙÙ 
Uri
ÙÙ "
(
ÙÙ" #
$"
ÙÙ# %
{
ÙÙ% &
Request
ÙÙ& -
.
ÙÙ- .
Scheme
ÙÙ. 4
}
ÙÙ4 5
$str
ÙÙ5 8
{
ÙÙ8 9
Request
ÙÙ9 @
.
ÙÙ@ A
Host
ÙÙA E
}
ÙÙE F
{
ÙÙF G
Request
ÙÙG N
.
ÙÙN O
Path
ÙÙO S
}
ÙÙS T
"
ÙÙT U
)
ÙÙU V
;
ÙÙV W
string
ıı 
Path
ıı 
=
ıı 
location
ıı "
.
ıı" #
AbsolutePath
ıı# /
.
ıı/ 0
Replace
ıı0 7
(
ıı7 8
this
ıı8 <
.
ıı< =
ControllerContext
ıı= N
.
ııN O
	RouteData
ııO X
.
ııX Y
Values
ııY _
[
ıı_ `
$str
ıı` h
]
ııh i
.
ııi j
ToString
ııj r
(
ıır s
)
ııs t
,
ııt u
$str
ııv }
)
ıı} ~
;
ıı~ 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
accessSecurity
ˆˆ 
.
ˆˆ  
IsGetAccess
ˆˆ  +
(
ˆˆ+ ,
$str
ˆˆ, 0
+
ˆˆ1 2
Path
ˆˆ3 7
)
ˆˆ7 8
)
ˆˆ8 9
{
˜˜ 
return
¯¯ 
RedirectToAction
¯¯ '
(
¯¯' (
$str
¯¯( 3
,
¯¯3 4
$str
¯¯5 <
)
¯¯< =
;
¯¯= >
}
˘˘ 
try
˚˚ 
{
¸¸ 
long
˝˝ 
[
˝˝ 
]
˝˝ 
confirmedDeleteId
˝˝ (
=
˝˝) *
Ids
˝˝+ .
.
˝˝. /
Split
˝˝/ 4
(
˝˝4 5
$char
˝˝5 8
)
˝˝8 9
.
˝˝9 :
Select
˝˝: @
(
˝˝@ A
long
˝˝A E
.
˝˝E F
Parse
˝˝F K
)
˝˝K L
.
˝˝L M
ToArray
˝˝M T
(
˝˝T U
)
˝˝U V
;
˝˝V W
List
ˇˇ 
<
ˇˇ &
TblNoticeOfPaymentDetail
ˇˇ -
>
ˇˇ- .

Transaksis
ˇˇ/ 9
=
ˇˇ: ;
_context
ˇˇ< D
.
ˇˇD E'
TblNoticeOfPaymentDetails
ˇˇE ^
.
ˇˇ^ _
Where
ˇˇ_ d
(
ˇˇd e
x
ˇˇe f
=>
ˇˇg i
confirmedDeleteId
ˇˇj {
.
ˇˇ{ |
Containsˇˇ| Ñ
(ˇˇÑ Ö
xˇˇÖ Ü
.ˇˇÜ á
Idˇˇá â
)ˇˇâ ä
)ˇˇä ã
.ˇˇã å
ToListˇˇå í
(ˇˇí ì
)ˇˇì î
;ˇˇî ï
for
ÄÄ 
(
ÄÄ 
int
ÄÄ 
i
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
i
ÄÄ  !
<
ÄÄ" #
confirmedDeleteId
ÄÄ$ 5
.
ÄÄ5 6
Length
ÄÄ6 <
;
ÄÄ< =
i
ÄÄ> ?
++
ÄÄ? A
)
ÄÄA B
{
ÅÅ &
TblNoticeOfPaymentDetail
ÇÇ ,
data
ÇÇ- 1
=
ÇÇ2 3
_context
ÇÇ4 <
.
ÇÇ< ='
TblNoticeOfPaymentDetails
ÇÇ= V
.
ÇÇV W
Find
ÇÇW [
(
ÇÇ[ \

Transaksis
ÇÇ\ f
[
ÇÇf g
i
ÇÇg h
]
ÇÇh i
.
ÇÇi j
Id
ÇÇj l
)
ÇÇl m
;
ÇÇm n
data
ÉÉ 
.
ÉÉ 
	IsDeleted
ÉÉ "
=
ÉÉ# $
$num
ÉÉ% &
;
ÉÉ& '
_context
ÑÑ 
.
ÑÑ 
Entry
ÑÑ "
(
ÑÑ" #
data
ÑÑ# '
)
ÑÑ' (
.
ÑÑ( )
State
ÑÑ) .
=
ÑÑ/ 0
EntityState
ÑÑ1 <
.
ÑÑ< =
Modified
ÑÑ= E
;
ÑÑE F
_context
ÖÖ 
.
ÖÖ 
SaveChanges
ÖÖ (
(
ÖÖ( )
)
ÖÖ) *
;
ÖÖ* +
}
ÜÜ 
return
áá 
Content
áá 
(
áá 
$str
áá !
)
áá! "
;
áá" #
}
àà 
catch
ââ 
{
ää 
return
ãã 
Content
ãã 
(
ãã 
$str
ãã &
)
ãã& '
;
ãã' (
}
åå 
}
çç 	
public
éé 
ActionResult
éé 
DeleteFileNopTemp
éé -
(
éé- .
string
éé. 4
Ids
éé5 8
)
éé8 9
{
èè 	
if
êê 
(
êê 
!
êê 
lastSession
êê 
.
êê 
Update
êê #
(
êê# $
)
êê$ %
)
êê% &
{
ëë 
return
íí 
RedirectToAction
íí '
(
íí' (
$str
íí( /
,
íí/ 0
	GetConfig
íí1 :
.
íí: ;

AppSetting
íí; E
[
ííE F
$str
ííF n
]
íín o
+
ííp q
$str
íír y
,
ííy z
new
íí{ ~
{íí Ä
aííÅ Ç
=ííÉ Ñ
trueííÖ â
}ííä ã
)ííã å
;ííå ç
}
ìì 
var
îî 
location
îî 
=
îî 
new
îî 
Uri
îî "
(
îî" #
$"
îî# %
{
îî% &
Request
îî& -
.
îî- .
Scheme
îî. 4
}
îî4 5
$str
îî5 8
{
îî8 9
Request
îî9 @
.
îî@ A
Host
îîA E
}
îîE F
{
îîF G
Request
îîG N
.
îîN O
Path
îîO S
}
îîS T
"
îîT U
)
îîU V
;
îîV W
string
ïï 
Path
ïï 
=
ïï 
location
ïï "
.
ïï" #
AbsolutePath
ïï# /
.
ïï/ 0
Replace
ïï0 7
(
ïï7 8
this
ïï8 <
.
ïï< =
ControllerContext
ïï= N
.
ïïN O
	RouteData
ïïO X
.
ïïX Y
Values
ïïY _
[
ïï_ `
$str
ïï` h
]
ïïh i
.
ïïi j
ToString
ïïj r
(
ïïr s
)
ïïs t
,
ïït u
$str
ïïv }
)
ïï} ~
;
ïï~ 
if
ññ 
(
ññ 
!
ññ 
accessSecurity
ññ 
.
ññ  
IsGetAccess
ññ  +
(
ññ+ ,
$str
ññ, 0
+
ññ1 2
Path
ññ3 7
)
ññ7 8
)
ññ8 9
{
óó 
return
òò 
RedirectToAction
òò '
(
òò' (
$str
òò( 3
,
òò3 4
$str
òò5 <
)
òò< =
;
òò= >
}
ôô 
try
õõ 
{
úú 
long
ùù 
[
ùù 
]
ùù 
confirmedDeleteId
ùù (
=
ùù) *
Ids
ùù+ .
.
ùù. /
Split
ùù/ 4
(
ùù4 5
$char
ùù5 8
)
ùù8 9
.
ùù9 :
Select
ùù: @
(
ùù@ A
long
ùùA E
.
ùùE F
Parse
ùùF K
)
ùùK L
.
ùùL M
ToArray
ùùM T
(
ùùT U
)
ùùU V
;
ùùV W
List
üü 
<
üü "
TblFileUploadNopTemp
üü )
>
üü) *

Transaksis
üü+ 5
=
üü6 7
_context
üü8 @
.
üü@ A#
TblFileUploadNopTemps
üüA V
.
üüV W
Where
üüW \
(
üü\ ]
x
üü] ^
=>
üü_ a
confirmedDeleteId
üüb s
.
üüs t
Contains
üüt |
(
üü| }
x
üü} ~
.
üü~ 
Idüü Å
)üüÅ Ç
)üüÇ É
.üüÉ Ñ
ToListüüÑ ä
(üüä ã
)üüã å
;üüå ç
for
†† 
(
†† 
int
†† 
i
†† 
=
†† 
$num
†† 
;
†† 
i
††  !
<
††" #
confirmedDeleteId
††$ 5
.
††5 6
Length
††6 <
;
††< =
i
††> ?
++
††? A
)
††A B
{
°° "
TblFileUploadNopTemp
¢¢ (
data
¢¢) -
=
¢¢. /
_context
¢¢0 8
.
¢¢8 9#
TblFileUploadNopTemps
¢¢9 N
.
¢¢N O
Find
¢¢O S
(
¢¢S T

Transaksis
¢¢T ^
[
¢¢^ _
i
¢¢_ `
]
¢¢` a
.
¢¢a b
Id
¢¢b d
)
¢¢d e
;
¢¢e f
data
££ 
.
££ 
	IsDeleted
££ "
=
££# $
$num
££% &
;
££& '
if
§§ 
(
§§ 
System
§§ 
.
§§ 
IO
§§ !
.
§§! "
File
§§" &
.
§§& '
Exists
§§' -
(
§§- .

Transaksis
§§. 8
[
§§8 9
i
§§9 :
]
§§: ;
.
§§; <
FilePath
§§< D
)
§§D E
)
§§E F
{
•• 
System
¶¶ 
.
¶¶ 
IO
¶¶ !
.
¶¶! "
File
¶¶" &
.
¶¶& '
Delete
¶¶' -
(
¶¶- .

Transaksis
¶¶. 8
[
¶¶8 9
i
¶¶9 :
]
¶¶: ;
.
¶¶; <
FilePath
¶¶< D
)
¶¶D E
;
¶¶E F
}
ßß 
_context
®® 
.
®® 
RemoveRange
®® (
(
®®( )
data
®®) -
)
®®- .
;
®®. /
_context
©© 
.
©© 
SaveChanges
©© (
(
©©( )
)
©©) *
;
©©* +
}
™™ 
return
´´ 
Content
´´ 
(
´´ 
$str
´´ !
)
´´! "
;
´´" #
}
¨¨ 
catch
≠≠ 
{
ÆÆ 
return
ØØ 
Content
ØØ 
(
ØØ 
$str
ØØ &
)
ØØ& '
;
ØØ' (
}
∞∞ 
}
±± 	
public
≤≤ 
ActionResult
≤≤ 
DeleteFileNop
≤≤ )
(
≤≤) *
string
≤≤* 0
Ids
≤≤1 4
)
≤≤4 5
{
≥≥ 	
if
¥¥ 
(
¥¥ 
!
¥¥ 
lastSession
¥¥ 
.
¥¥ 
Update
¥¥ #
(
¥¥# $
)
¥¥$ %
)
¥¥% &
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( /
,
∂∂/ 0
	GetConfig
∂∂1 :
.
∂∂: ;

AppSetting
∂∂; E
[
∂∂E F
$str
∂∂F n
]
∂∂n o
+
∂∂p q
$str
∂∂r y
,
∂∂y z
new
∂∂{ ~
{∂∂ Ä
a∂∂Å Ç
=∂∂É Ñ
true∂∂Ö â
}∂∂ä ã
)∂∂ã å
;∂∂å ç
}
∑∑ 
var
∏∏ 
location
∏∏ 
=
∏∏ 
new
∏∏ 
Uri
∏∏ "
(
∏∏" #
$"
∏∏# %
{
∏∏% &
Request
∏∏& -
.
∏∏- .
Scheme
∏∏. 4
}
∏∏4 5
$str
∏∏5 8
{
∏∏8 9
Request
∏∏9 @
.
∏∏@ A
Host
∏∏A E
}
∏∏E F
{
∏∏F G
Request
∏∏G N
.
∏∏N O
Path
∏∏O S
}
∏∏S T
"
∏∏T U
)
∏∏U V
;
∏∏V W
string
ππ 
Path
ππ 
=
ππ 
location
ππ "
.
ππ" #
AbsolutePath
ππ# /
.
ππ/ 0
Replace
ππ0 7
(
ππ7 8
this
ππ8 <
.
ππ< =
ControllerContext
ππ= N
.
ππN O
	RouteData
ππO X
.
ππX Y
Values
ππY _
[
ππ_ `
$str
ππ` h
]
ππh i
.
ππi j
ToString
ππj r
(
ππr s
)
ππs t
,
ππt u
$str
ππv }
)
ππ} ~
;
ππ~ 
if
∫∫ 
(
∫∫ 
!
∫∫ 
accessSecurity
∫∫ 
.
∫∫  
IsGetAccess
∫∫  +
(
∫∫+ ,
$str
∫∫, 0
+
∫∫1 2
Path
∫∫3 7
)
∫∫7 8
)
∫∫8 9
{
ªª 
return
ºº 
RedirectToAction
ºº '
(
ºº' (
$str
ºº( 3
,
ºº3 4
$str
ºº5 <
)
ºº< =
;
ºº= >
}
ΩΩ 
try
øø 
{
¿¿ 
long
¡¡ 
[
¡¡ 
]
¡¡ 
confirmedDeleteId
¡¡ (
=
¡¡) *
Ids
¡¡+ .
.
¡¡. /
Split
¡¡/ 4
(
¡¡4 5
$char
¡¡5 8
)
¡¡8 9
.
¡¡9 :
Select
¡¡: @
(
¡¡@ A
long
¡¡A E
.
¡¡E F
Parse
¡¡F K
)
¡¡K L
.
¡¡L M
ToArray
¡¡M T
(
¡¡T U
)
¡¡U V
;
¡¡V W
List
√√ 
<
√√ 
TblFileUploadNop
√√ %
>
√√% &

Transaksis
√√' 1
=
√√2 3
_context
√√4 <
.
√√< =
TblFileUploadNops
√√= N
.
√√N O
Where
√√O T
(
√√T U
x
√√U V
=>
√√W Y
confirmedDeleteId
√√Z k
.
√√k l
Contains
√√l t
(
√√t u
x
√√u v
.
√√v w
Id
√√w y
)
√√y z
)
√√z {
.
√√{ |
ToList√√| Ç
(√√Ç É
)√√É Ñ
;√√Ñ Ö
for
ƒƒ 
(
ƒƒ 
int
ƒƒ 
i
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
i
ƒƒ  !
<
ƒƒ" #
confirmedDeleteId
ƒƒ$ 5
.
ƒƒ5 6
Length
ƒƒ6 <
;
ƒƒ< =
i
ƒƒ> ?
++
ƒƒ? A
)
ƒƒA B
{
≈≈ 
if
∆∆ 
(
∆∆ 

Transaksis
∆∆ "
[
∆∆" #
i
∆∆# $
]
∆∆$ %
.
∆∆% &
IdFileFromApi
∆∆& 3
!=
∆∆4 6
null
∆∆7 ;
)
∆∆; <
{
««  
TblNoticeOfPayment
»» *
checkParent
»»+ 6
=
»»7 8
_context
»»9 A
.
»»A B!
TblNoticeOfPayments
»»B U
.
»»U V
Where
»»V [
(
»»[ \
x
»»\ ]
=>
»»^ `
x
»»a b
.
»»b c
Id
»»c e
==
»»f h

Transaksis
»»i s
[
»»s t
i
»»t u
]
»»u v
.
»»v w
IdNop
»»w |
)
»»| }
.
»»} ~
FirstOrDefault»»~ å
(»»å ç
)»»ç é
;»»é è
var
   "
jsonParseReturnCheck
   0
=
  1 2
JsonConvert
  3 >
.
  > ?
DeserializeObject
  ? P
<
  P Q!
ResultStatusDataInt
  Q d
<
  d e!
ResultStatusDataNop
  e x
>
  x y
>
  y z
(
  z {
$str
  { }
)
  } ~
;
  ~ 
var
ÀÀ 
urlCheck
ÀÀ $
=
ÀÀ% &
	GetConfig
ÀÀ' 0
.
ÀÀ0 1

AppSetting
ÀÀ1 ;
[
ÀÀ; <
$str
ÀÀ< M
]
ÀÀM N
+
ÀÀO P
	GetConfig
ÀÀQ Z
.
ÀÀZ [

AppSetting
ÀÀ[ e
[
ÀÀe f
$str
ÀÀf 
]ÀÀ Ä
+ÀÀÅ Ç
checkParentÀÀÉ é
.ÀÀé è
IdNopFromApiÀÀè õ
;ÀÀõ ú
(
ÃÃ 
bool
ÃÃ 
resultApiCheck
ÃÃ ,
,
ÃÃ, -
string
ÃÃ. 4
resultCheck
ÃÃ5 @
)
ÃÃ@ A
=
ÃÃB C
RequestToAPI
ÃÃD P
.
ÃÃP Q!
GetJsonStringWebApi
ÃÃQ d
(
ÃÃd e
urlCheck
ÃÃe m
,
ÃÃm n
null
ÃÃo s
)
ÃÃs t
;
ÃÃt u
if
ÕÕ 
(
ÕÕ 
resultApiCheck
ÕÕ *
&&
ÕÕ+ -
!
ÕÕ. /
string
ÕÕ/ 5
.
ÕÕ5 6
IsNullOrEmpty
ÕÕ6 C
(
ÕÕC D
resultCheck
ÕÕD O
)
ÕÕO P
)
ÕÕP Q
{
ŒŒ "
jsonParseReturnCheck
œœ 0
=
œœ1 2
JsonConvert
œœ3 >
.
œœ> ?
DeserializeObject
œœ? P
<
œœP Q!
ResultStatusDataInt
œœQ d
<
œœd e!
ResultStatusDataNop
œœe x
>
œœx y
>
œœy z
(
œœz {
resultCheckœœ{ Ü
)œœÜ á
;œœá à
if
–– 
(
––  "
jsonParseReturnCheck
––  4
.
––4 5

StatusCode
––5 ?
==
––@ B
$num
––C F
||
––G I"
jsonParseReturnCheck
––J ^
.
––^ _

StatusCode
––_ i
==
––j l
$num
––m p
)
––p q
{
—— 
if
““  "
(
““# $"
jsonParseReturnCheck
““$ 8
.
““8 9
Data
““9 =
.
““= >
Status
““> D
==
““E G
$str
““H T
)
““T U
{
””  !
var
‘‘$ '#
jsonParseReturnDelete
‘‘( =
=
‘‘> ?
JsonConvert
‘‘@ K
.
‘‘K L
DeserializeObject
‘‘L ]
<
‘‘] ^!
ResultStatusDataInt
‘‘^ q
<
‘‘q r"
ResultStatusDataNop‘‘r Ö
>‘‘Ö Ü
>‘‘Ü á
(‘‘á à
$str‘‘à ä
)‘‘ä ã
;‘‘ã å
var
’’$ '
	urlDelete
’’( 1
=
’’2 3
	GetConfig
’’4 =
.
’’= >

AppSetting
’’> H
[
’’H I
$str
’’I Z
]
’’Z [
+
’’\ ]
	GetConfig
’’^ g
.
’’g h

AppSetting
’’h r
[
’’r s
$str’’s à
]’’à â
+’’ä ã

Transaksis’’å ñ
[’’ñ ó
i’’ó ò
]’’ò ô
.’’ô ö
IdFileFromApi’’ö ß
;’’ß ®
(
÷÷$ %
bool
÷÷% )
resultApiDelete
÷÷* 9
,
÷÷9 :
string
÷÷; A
resultDelete
÷÷B N
)
÷÷N O
=
÷÷P Q
RequestToAPI
÷÷R ^
.
÷÷^ _#
DeleteRequestToWebApi
÷÷_ t
(
÷÷t u
	urlDelete
÷÷u ~
,
÷÷~ 
null÷÷Ä Ñ
)÷÷Ñ Ö
;÷÷Ö Ü
if
◊◊$ &
(
◊◊' (
resultApiDelete
◊◊( 7
&&
◊◊8 :
!
◊◊; <
string
◊◊< B
.
◊◊B C
IsNullOrEmpty
◊◊C P
(
◊◊P Q
resultDelete
◊◊Q ]
)
◊◊] ^
)
◊◊^ _
{
ÿÿ$ %#
jsonParseReturnDelete
ŸŸ( =
=
ŸŸ> ?
JsonConvert
ŸŸ@ K
.
ŸŸK L
DeserializeObject
ŸŸL ]
<
ŸŸ] ^!
ResultStatusDataInt
ŸŸ^ q
<
ŸŸq r"
ResultStatusDataNopŸŸr Ö
>ŸŸÖ Ü
>ŸŸÜ á
(ŸŸá à
resultDeleteŸŸà î
)ŸŸî ï
;ŸŸï ñ
if
⁄⁄( *
(
⁄⁄+ ,#
jsonParseReturnDelete
⁄⁄, A
.
⁄⁄A B

StatusCode
⁄⁄B L
==
⁄⁄M O
$num
⁄⁄P S
||
⁄⁄T V#
jsonParseReturnDelete
⁄⁄W l
.
⁄⁄l m

StatusCode
⁄⁄m w
==
⁄⁄x z
$num
⁄⁄{ ~
)
⁄⁄~ 
{
€€( )
TblFileUploadNop
‹‹, <
data
‹‹= A
=
‹‹B C
_context
‹‹D L
.
‹‹L M
TblFileUploadNops
‹‹M ^
.
‹‹^ _
Find
‹‹_ c
(
‹‹c d

Transaksis
‹‹d n
[
‹‹n o
i
‹‹o p
]
‹‹p q
.
‹‹q r
Id
‹‹r t
)
‹‹t u
;
‹‹u v
data
››, 0
.
››0 1
IsActive
››1 9
=
››: ;
$num
››< =
;
››= >
data
ﬁﬁ, 0
.
ﬁﬁ0 1
	IsDeleted
ﬁﬁ1 :
=
ﬁﬁ; <
$num
ﬁﬁ= >
;
ﬁﬁ> ?
if
ﬂﬂ, .
(
ﬂﬂ/ 0
System
ﬂﬂ0 6
.
ﬂﬂ6 7
IO
ﬂﬂ7 9
.
ﬂﬂ9 :
File
ﬂﬂ: >
.
ﬂﬂ> ?
Exists
ﬂﬂ? E
(
ﬂﬂE F

Transaksis
ﬂﬂF P
[
ﬂﬂP Q
i
ﬂﬂQ R
]
ﬂﬂR S
.
ﬂﬂS T
FilePath
ﬂﬂT \
)
ﬂﬂ\ ]
)
ﬂﬂ] ^
{
‡‡, -
System
··0 6
.
··6 7
IO
··7 9
.
··9 :
File
··: >
.
··> ?
Delete
··? E
(
··E F

Transaksis
··F P
[
··P Q
i
··Q R
]
··R S
.
··S T
FilePath
··T \
)
··\ ]
;
··] ^
}
‚‚, -
_context
„„, 4
.
„„4 5
Entry
„„5 :
(
„„: ;
data
„„; ?
)
„„? @
.
„„@ A
State
„„A F
=
„„G H
EntityState
„„I T
.
„„T U
Modified
„„U ]
;
„„] ^
_context
‰‰, 4
.
‰‰4 5
SaveChanges
‰‰5 @
(
‰‰@ A
)
‰‰A B
;
‰‰B C
}
ÂÂ( )
}
ÊÊ$ %
if
ËË$ &
(
ËË' (
resultApiDelete
ËË( 7
)
ËË7 8
{
ÈÈ$ %
TblFileUploadNop
ÍÍ( 8
data
ÍÍ9 =
=
ÍÍ> ?
_context
ÍÍ@ H
.
ÍÍH I
TblFileUploadNops
ÍÍI Z
.
ÍÍZ [
Find
ÍÍ[ _
(
ÍÍ_ `

Transaksis
ÍÍ` j
[
ÍÍj k
i
ÍÍk l
]
ÍÍl m
.
ÍÍm n
Id
ÍÍn p
)
ÍÍp q
;
ÍÍq r
data
ÎÎ( ,
.
ÎÎ, -
IsActive
ÎÎ- 5
=
ÎÎ6 7
$num
ÎÎ8 9
;
ÎÎ9 :
data
ÏÏ( ,
.
ÏÏ, -
	IsDeleted
ÏÏ- 6
=
ÏÏ7 8
$num
ÏÏ9 :
;
ÏÏ: ;
if
ÌÌ( *
(
ÌÌ+ ,
System
ÌÌ, 2
.
ÌÌ2 3
IO
ÌÌ3 5
.
ÌÌ5 6
File
ÌÌ6 :
.
ÌÌ: ;
Exists
ÌÌ; A
(
ÌÌA B

Transaksis
ÌÌB L
[
ÌÌL M
i
ÌÌM N
]
ÌÌN O
.
ÌÌO P
FilePath
ÌÌP X
)
ÌÌX Y
)
ÌÌY Z
{
ÓÓ( )
System
ÔÔ, 2
.
ÔÔ2 3
IO
ÔÔ3 5
.
ÔÔ5 6
File
ÔÔ6 :
.
ÔÔ: ;
Delete
ÔÔ; A
(
ÔÔA B

Transaksis
ÔÔB L
[
ÔÔL M
i
ÔÔM N
]
ÔÔN O
.
ÔÔO P
FilePath
ÔÔP X
)
ÔÔX Y
;
ÔÔY Z
}
( )
_context
ÒÒ( 0
.
ÒÒ0 1
Entry
ÒÒ1 6
(
ÒÒ6 7
data
ÒÒ7 ;
)
ÒÒ; <
.
ÒÒ< =
State
ÒÒ= B
=
ÒÒC D
EntityState
ÒÒE P
.
ÒÒP Q
Modified
ÒÒQ Y
;
ÒÒY Z
_context
ÚÚ( 0
.
ÚÚ0 1
SaveChanges
ÚÚ1 <
(
ÚÚ< =
)
ÚÚ= >
;
ÚÚ> ?
}
ÛÛ$ %
}
ÙÙ  !
else
ıı  $
{
ˆˆ  !
var
˜˜$ '#
jsonParseReturnDelete
˜˜( =
=
˜˜> ?
JsonConvert
˜˜@ K
.
˜˜K L
DeserializeObject
˜˜L ]
<
˜˜] ^!
ResultStatusDataInt
˜˜^ q
<
˜˜q r"
ResultStatusDataNop˜˜r Ö
>˜˜Ö Ü
>˜˜Ü á
(˜˜á à
$str˜˜à ä
)˜˜ä ã
;˜˜ã å
var
¯¯$ '
	urlDelete
¯¯( 1
=
¯¯2 3
	GetConfig
¯¯4 =
.
¯¯= >

AppSetting
¯¯> H
[
¯¯H I
$str
¯¯I Z
]
¯¯Z [
+
¯¯\ ]
	GetConfig
¯¯^ g
.
¯¯g h

AppSetting
¯¯h r
[
¯¯r s
$str¯¯s à
]¯¯à â
+¯¯ä ã

Transaksis¯¯å ñ
[¯¯ñ ó
i¯¯ó ò
]¯¯ò ô
.¯¯ô ö
IdFileFromApi¯¯ö ß
;¯¯ß ®
(
˘˘$ %
bool
˘˘% )
resultApiDelete
˘˘* 9
,
˘˘9 :
string
˘˘; A
resultDelete
˘˘B N
)
˘˘N O
=
˘˘P Q
RequestToAPI
˘˘R ^
.
˘˘^ _#
DeleteRequestToWebApi
˘˘_ t
(
˘˘t u
	urlDelete
˘˘u ~
,
˘˘~ 
null˘˘Ä Ñ
)˘˘Ñ Ö
;˘˘Ö Ü
if
˙˙$ &
(
˙˙' (
resultApiDelete
˙˙( 7
&&
˙˙8 :
!
˙˙; <
string
˙˙< B
.
˙˙B C
IsNullOrEmpty
˙˙C P
(
˙˙P Q
resultDelete
˙˙Q ]
)
˙˙] ^
)
˙˙^ _
{
˚˚$ %#
jsonParseReturnDelete
¸¸( =
=
¸¸> ?
JsonConvert
¸¸@ K
.
¸¸K L
DeserializeObject
¸¸L ]
<
¸¸] ^!
ResultStatusDataInt
¸¸^ q
<
¸¸q r"
ResultStatusDataNop¸¸r Ö
>¸¸Ö Ü
>¸¸Ü á
(¸¸á à
resultDelete¸¸à î
)¸¸î ï
;¸¸ï ñ
if
˝˝( *
(
˝˝+ ,#
jsonParseReturnDelete
˝˝, A
.
˝˝A B

StatusCode
˝˝B L
==
˝˝M O
$num
˝˝P S
||
˝˝T V#
jsonParseReturnDelete
˝˝W l
.
˝˝l m

StatusCode
˝˝m w
==
˝˝x z
$num
˝˝{ ~
)
˝˝~ 
{
˛˛( )
TblFileUploadNop
ˇˇ, <
data
ˇˇ= A
=
ˇˇB C
_context
ˇˇD L
.
ˇˇL M
TblFileUploadNops
ˇˇM ^
.
ˇˇ^ _
Find
ˇˇ_ c
(
ˇˇc d

Transaksis
ˇˇd n
[
ˇˇn o
i
ˇˇo p
]
ˇˇp q
.
ˇˇq r
Id
ˇˇr t
)
ˇˇt u
;
ˇˇu v
data
ÄÄ, 0
.
ÄÄ0 1
IsActive
ÄÄ1 9
=
ÄÄ: ;
$num
ÄÄ< =
;
ÄÄ= >
data
ÅÅ, 0
.
ÅÅ0 1
	IsDeleted
ÅÅ1 :
=
ÅÅ; <
$num
ÅÅ= >
;
ÅÅ> ?
if
ÇÇ, .
(
ÇÇ/ 0
System
ÇÇ0 6
.
ÇÇ6 7
IO
ÇÇ7 9
.
ÇÇ9 :
File
ÇÇ: >
.
ÇÇ> ?
Exists
ÇÇ? E
(
ÇÇE F

Transaksis
ÇÇF P
[
ÇÇP Q
i
ÇÇQ R
]
ÇÇR S
.
ÇÇS T
FilePath
ÇÇT \
)
ÇÇ\ ]
)
ÇÇ] ^
{
ÉÉ, -
System
ÑÑ0 6
.
ÑÑ6 7
IO
ÑÑ7 9
.
ÑÑ9 :
File
ÑÑ: >
.
ÑÑ> ?
Delete
ÑÑ? E
(
ÑÑE F

Transaksis
ÑÑF P
[
ÑÑP Q
i
ÑÑQ R
]
ÑÑR S
.
ÑÑS T
FilePath
ÑÑT \
)
ÑÑ\ ]
;
ÑÑ] ^
}
ÖÖ, -
_context
ÜÜ, 4
.
ÜÜ4 5
Entry
ÜÜ5 :
(
ÜÜ: ;
data
ÜÜ; ?
)
ÜÜ? @
.
ÜÜ@ A
State
ÜÜA F
=
ÜÜG H
EntityState
ÜÜI T
.
ÜÜT U
Modified
ÜÜU ]
;
ÜÜ] ^
_context
áá, 4
.
áá4 5
SaveChanges
áá5 @
(
áá@ A
)
ááA B
;
ááB C
}
àà( )
}
ää$ %
if
åå$ &
(
åå' (
resultApiDelete
åå( 7
)
åå7 8
{
çç$ %
TblFileUploadNop
éé( 8
data
éé9 =
=
éé> ?
_context
éé@ H
.
ééH I
TblFileUploadNops
ééI Z
.
ééZ [
Find
éé[ _
(
éé_ `

Transaksis
éé` j
[
ééj k
i
éék l
]
éél m
.
éém n
Id
één p
)
éép q
;
ééq r
data
èè( ,
.
èè, -
IsActive
èè- 5
=
èè6 7
$num
èè8 9
;
èè9 :
data
êê( ,
.
êê, -
	IsDeleted
êê- 6
=
êê7 8
$num
êê9 :
;
êê: ;
if
ëë( *
(
ëë+ ,
System
ëë, 2
.
ëë2 3
IO
ëë3 5
.
ëë5 6
File
ëë6 :
.
ëë: ;
Exists
ëë; A
(
ëëA B

Transaksis
ëëB L
[
ëëL M
i
ëëM N
]
ëëN O
.
ëëO P
FilePath
ëëP X
)
ëëX Y
)
ëëY Z
{
íí( )
System
ìì, 2
.
ìì2 3
IO
ìì3 5
.
ìì5 6
File
ìì6 :
.
ìì: ;
Delete
ìì; A
(
ììA B

Transaksis
ììB L
[
ììL M
i
ììM N
]
ììN O
.
ììO P
FilePath
ììP X
)
ììX Y
;
ììY Z
}
îî( )
_context
ïï( 0
.
ïï0 1
Entry
ïï1 6
(
ïï6 7
data
ïï7 ;
)
ïï; <
.
ïï< =
State
ïï= B
=
ïïC D
EntityState
ïïE P
.
ïïP Q
Modified
ïïQ Y
;
ïïY Z
_context
ññ( 0
.
ññ0 1
SaveChanges
ññ1 <
(
ññ< =
)
ññ= >
;
ññ> ?
}
óó$ %
}
üü  !
}
†† 
else
°°  
{
¢¢ 
return
££  &
Content
££' .
(
££. /
	GetConfig
££/ 8
.
££8 9

AppSetting
££9 C
[
££C D
$str
££D _
]
££_ `
)
££` a
;
££a b
}
§§ 
}
•• 
}
¶¶ 
else
ßß 
{
®® 
TblFileUploadNop
©© (
data
©©) -
=
©©. /
_context
©©0 8
.
©©8 9
TblFileUploadNops
©©9 J
.
©©J K
Find
©©K O
(
©©O P

Transaksis
©©P Z
[
©©Z [
i
©©[ \
]
©©\ ]
.
©©] ^
Id
©©^ `
)
©©` a
;
©©a b
data
™™ 
.
™™ 
	IsDeleted
™™ &
=
™™' (
$num
™™) *
;
™™* +
if
´´ 
(
´´ 
System
´´ "
.
´´" #
IO
´´# %
.
´´% &
File
´´& *
.
´´* +
Exists
´´+ 1
(
´´1 2

Transaksis
´´2 <
[
´´< =
i
´´= >
]
´´> ?
.
´´? @
FilePath
´´@ H
)
´´H I
)
´´I J
{
¨¨ 
System
≠≠ "
.
≠≠" #
IO
≠≠# %
.
≠≠% &
File
≠≠& *
.
≠≠* +
Delete
≠≠+ 1
(
≠≠1 2

Transaksis
≠≠2 <
[
≠≠< =
i
≠≠= >
]
≠≠> ?
.
≠≠? @
FilePath
≠≠@ H
)
≠≠H I
;
≠≠I J
}
ÆÆ 
_context
ØØ  
.
ØØ  !
Entry
ØØ! &
(
ØØ& '
data
ØØ' +
)
ØØ+ ,
.
ØØ, -
State
ØØ- 2
=
ØØ3 4
EntityState
ØØ5 @
.
ØØ@ A
Modified
ØØA I
;
ØØI J
_context
∞∞  
.
∞∞  !
SaveChanges
∞∞! ,
(
∞∞, -
)
∞∞- .
;
∞∞. /
}
±± 
}
≤≤ 
return
≥≥ 
Content
≥≥ 
(
≥≥ 
$str
≥≥ !
)
≥≥! "
;
≥≥" #
}
¥¥ 
catch
µµ 
{
∂∂ 
return
∑∑ 
Content
∑∑ 
(
∑∑ 
$str
∑∑ &
)
∑∑& '
;
∑∑' (
}
∏∏ 
}
ππ 	
[
ΩΩ 	
HttpPost
ΩΩ	 
]
ΩΩ 
public
ææ 
async
ææ 
Task
ææ 
<
ææ 
IActionResult
ææ '
>
ææ' (

SendToDeva
ææ) 3
(
ææ3 4
string
ææ4 :
Ids
ææ; >
)
ææ> ?
{
øø 	
if
¿¿ 
(
¿¿ 
!
¿¿ 
lastSession
¿¿ 
.
¿¿ 
Update
¿¿ #
(
¿¿# $
)
¿¿$ %
)
¿¿% &
{
¡¡ 
return
¬¬ 
RedirectToAction
¬¬ '
(
¬¬' (
$str
¬¬( /
,
¬¬/ 0
	GetConfig
¬¬1 :
.
¬¬: ;

AppSetting
¬¬; E
[
¬¬E F
$str
¬¬F n
]
¬¬n o
+
¬¬p q
$str
¬¬r y
,
¬¬y z
new
¬¬{ ~
{¬¬ Ä
a¬¬Å Ç
=¬¬É Ñ
true¬¬Ö â
}¬¬ä ã
)¬¬ã å
;¬¬å ç
}
√√ 
var
ƒƒ 
location
ƒƒ 
=
ƒƒ 
new
ƒƒ 
Uri
ƒƒ "
(
ƒƒ" #
$"
ƒƒ# %
{
ƒƒ% &
Request
ƒƒ& -
.
ƒƒ- .
Scheme
ƒƒ. 4
}
ƒƒ4 5
$str
ƒƒ5 8
{
ƒƒ8 9
Request
ƒƒ9 @
.
ƒƒ@ A
Host
ƒƒA E
}
ƒƒE F
{
ƒƒF G
Request
ƒƒG N
.
ƒƒN O
Path
ƒƒO S
}
ƒƒS T
"
ƒƒT U
)
ƒƒU V
;
ƒƒV W
string
≈≈ 
path
≈≈ 
=
≈≈ 
location
≈≈ "
.
≈≈" #
AbsolutePath
≈≈# /
.
≈≈/ 0
Replace
≈≈0 7
(
≈≈7 8
this
≈≈8 <
.
≈≈< =
ControllerContext
≈≈= N
.
≈≈N O
	RouteData
≈≈O X
.
≈≈X Y
Values
≈≈Y _
[
≈≈_ `
$str
≈≈` h
]
≈≈h i
.
≈≈i j
ToString
≈≈j r
(
≈≈r s
)
≈≈s t
,
≈≈t u
$str
≈≈v }
)
≈≈} ~
;
≈≈~ 
if
∆∆ 
(
∆∆ 
!
∆∆ 
accessSecurity
∆∆ 
.
∆∆  
IsGetAccess
∆∆  +
(
∆∆+ ,
$str
∆∆, 0
+
∆∆1 2
path
∆∆3 7
)
∆∆7 8
)
∆∆8 9
{
«« 
return
»» 
RedirectToAction
»» '
(
»»' (
$str
»»( 3
,
»»3 4
$str
»»5 <
)
»»< =
;
»»= >
}
…… 
try
ÀÀ 
{
ÃÃ 
var
ÕÕ 
regex
ÕÕ 
=
ÕÕ 
await
ÕÕ !
RegexRequest
ÕÕ" .
.
ÕÕ. /
RegexValidation
ÕÕ/ >
(
ÕÕ> ?
Ids
ÕÕ? B
)
ÕÕB C
;
ÕÕC D
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
regex
ŒŒ 
)
ŒŒ 
{
œœ 
return
–– 
Content
–– "
(
––" #
$str
––# 1
)
––1 2
;
––2 3
}
—— 
var
”” 
send
”” 
=
”” 
new
”” 

SendToDeva
”” )
(
””) *

_converter
””* 4
)
””4 5
;
””5 6
Task
‘‘ 
.
‘‘ 
Run
‘‘ 
(
‘‘ 
(
‘‘ 
)
‘‘ 
=>
‘‘ 
send
‘‘ #
.
‘‘# $
SendToDevaNop
‘‘$ 1
(
‘‘1 2
Ids
‘‘2 5
)
‘‘5 6
)
‘‘6 7
;
‘‘7 8
return
’’ 
Content
’’ 
(
’’ 
$str
’’ o
)
’’o p
;
’’p q
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
return
ŸŸ 
Content
ŸŸ 
(
ŸŸ 
$str
ŸŸ 9
)
ŸŸ9 :
;
ŸŸ: ;
}
⁄⁄ 
}
€€ 	
[
ﬁﬁ 	
HttpPost
ﬁﬁ	 
]
ﬁﬁ 
public
ﬂﬂ 
async
ﬂﬂ 
Task
ﬂﬂ 
<
ﬂﬂ 
ActionResult
ﬂﬂ &
>
ﬂﬂ& '
SendToDevaOld
ﬂﬂ( 5
(
ﬂﬂ5 6
string
ﬂﬂ6 <
Ids
ﬂﬂ= @
)
ﬂﬂ@ A
{
‡‡ 	
if
·· 
(
·· 
!
·· 
lastSession
·· 
.
·· 
Update
·· #
(
··# $
)
··$ %
)
··% &
{
‚‚ 
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( /
,
„„/ 0
	GetConfig
„„1 :
.
„„: ;

AppSetting
„„; E
[
„„E F
$str
„„F n
]
„„n o
+
„„p q
$str
„„r y
,
„„y z
new
„„{ ~
{„„ Ä
a„„Å Ç
=„„É Ñ
true„„Ö â
}„„ä ã
)„„ã å
;„„å ç
}
‰‰ 
var
ÂÂ 
location
ÂÂ 
=
ÂÂ 
new
ÂÂ 
Uri
ÂÂ "
(
ÂÂ" #
$"
ÂÂ# %
{
ÂÂ% &
Request
ÂÂ& -
.
ÂÂ- .
Scheme
ÂÂ. 4
}
ÂÂ4 5
$str
ÂÂ5 8
{
ÂÂ8 9
Request
ÂÂ9 @
.
ÂÂ@ A
Host
ÂÂA E
}
ÂÂE F
{
ÂÂF G
Request
ÂÂG N
.
ÂÂN O
Path
ÂÂO S
}
ÂÂS T
"
ÂÂT U
)
ÂÂU V
;
ÂÂV W
string
ÊÊ 
Path
ÊÊ 
=
ÊÊ 
location
ÊÊ "
.
ÊÊ" #
AbsolutePath
ÊÊ# /
.
ÊÊ/ 0
Replace
ÊÊ0 7
(
ÊÊ7 8
this
ÊÊ8 <
.
ÊÊ< =
ControllerContext
ÊÊ= N
.
ÊÊN O
	RouteData
ÊÊO X
.
ÊÊX Y
Values
ÊÊY _
[
ÊÊ_ `
$str
ÊÊ` h
]
ÊÊh i
.
ÊÊi j
ToString
ÊÊj r
(
ÊÊr s
)
ÊÊs t
,
ÊÊt u
$str
ÊÊv }
)
ÊÊ} ~
;
ÊÊ~ 
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
accessSecurity
ÁÁ 
.
ÁÁ  
IsGetAccess
ÁÁ  +
(
ÁÁ+ ,
$str
ÁÁ, 0
+
ÁÁ1 2
Path
ÁÁ3 7
)
ÁÁ7 8
)
ÁÁ8 9
{
ËË 
return
ÈÈ 
RedirectToAction
ÈÈ '
(
ÈÈ' (
$str
ÈÈ( 3
,
ÈÈ3 4
$str
ÈÈ5 <
)
ÈÈ< =
;
ÈÈ= >
}
ÍÍ 
try
ÏÏ 
{
ÌÌ 
string
ÓÓ 
[
ÓÓ 
]
ÓÓ 
ArrayIds
ÓÓ %
=
ÓÓ& '
Ids
ÓÓ( +
.
ÓÓ+ ,
Split
ÓÓ, 1
(
ÓÓ1 2
$char
ÓÓ2 5
)
ÓÓ5 6
;
ÓÓ6 7
foreach
 
(
 
var
  
item
! %
in
& (
ArrayIds
) 1
)
1 2
{
ÒÒ  
TblNoticeOfPayment
ÚÚ *

dataAssign
ÚÚ+ 5
=
ÚÚ6 7
_context
ÚÚ8 @
.
ÚÚ@ A!
TblNoticeOfPayments
ÚÚA T
.
ÚÚT U
Where
ÚÚU Z
(
ÚÚZ [
m
ÚÚ[ \
=>
ÚÚ] _
m
ÚÚ` a
.
ÚÚa b
Id
ÚÚb d
==
ÚÚe g
int
ÚÚh k
.
ÚÚk l
Parse
ÚÚl q
(
ÚÚq r
item
ÚÚr v
)
ÚÚv w
&&
ÚÚx z
m
ÚÚ{ |
.
ÚÚ| }
	IsDeletedÚÚ} Ü
==ÚÚá â
$numÚÚä ã
)ÚÚã å
.ÚÚå ç
FirstOrDefaultÚÚç õ
(ÚÚõ ú
)ÚÚú ù
;ÚÚù û-
NoticeOfPaymentToAPI_ViewModels
ÙÙ 7
model
ÙÙ8 =
=
ÙÙ> ?
new
ÙÙ@ C-
NoticeOfPaymentToAPI_ViewModels
ÙÙD c
(
ÙÙc d
)
ÙÙd e
;
ÙÙe f
model
ıı 
.
ıı 
NopNo
ıı #
=
ıı$ %

dataAssign
ıı& 0
.
ıı0 1
NopNo
ıı1 6
;
ıı6 7
model
ˆˆ 
.
ˆˆ 
DueDate
ˆˆ %
=
ˆˆ& '

dataAssign
ˆˆ( 2
.
ˆˆ2 3
DueDate
ˆˆ3 :
;
ˆˆ: ;
model
˜˜ 
.
˜˜ 
RekId
˜˜ #
=
˜˜$ %

dataAssign
˜˜& 0
.
˜˜0 1
RekId
˜˜1 6
;
˜˜6 7
model
¯¯ 
.
¯¯ 
InterestRate
¯¯ *
=
¯¯+ ,

dataAssign
¯¯- 7
.
¯¯7 8
InterestRate
¯¯8 D
;
¯¯D E
model
˘˘ 
.
˘˘ 
InterestDays
˘˘ *
=
˘˘+ ,

dataAssign
˘˘- 7
.
˘˘7 8
InterestDays
˘˘8 D
;
˘˘D E
model
˙˙ 
.
˙˙ 
Cur
˙˙ !
=
˙˙" #

dataAssign
˙˙$ .
.
˙˙. /
Cur
˙˙/ 2
;
˙˙2 3
model
˚˚ 
.
˚˚ 
	NopDetail
˚˚ '
=
˚˚( )
_context
˚˚* 2
.
˚˚2 3'
TblNoticeOfPaymentDetails
˚˚3 L
.
˚˚L M
Where
˚˚M R
(
˚˚R S
m
˚˚S T
=>
˚˚U W
m
˚˚X Y
.
˚˚Y Z
NopId
˚˚Z _
==
˚˚` b
int
˚˚c f
.
˚˚f g
Parse
˚˚g l
(
˚˚l m
item
˚˚m q
)
˚˚q r
&&
˚˚s u
m
˚˚v w
.
˚˚w x
	IsDeleted˚˚x Å
==˚˚Ç Ñ
$num˚˚Ö Ü
)˚˚Ü á
.˚˚á à
ToList˚˚à é
(˚˚é è
)˚˚è ê
;˚˚ê ë
if
˛˛ 
(
˛˛ 

dataAssign
˛˛ &
.
˛˛& '
IdNopFromApi
˛˛' 3
!=
˛˛4 6
null
˛˛7 ;
)
˛˛; <
{
ˇˇ 
var
ÄÄ "
jsonParseReturnCheck
ÄÄ  4
=
ÄÄ5 6
JsonConvert
ÄÄ7 B
.
ÄÄB C
DeserializeObject
ÄÄC T
<
ÄÄT U!
ResultStatusDataInt
ÄÄU h
<
ÄÄh i!
ResultStatusDataNop
ÄÄi |
>
ÄÄ| }
>
ÄÄ} ~
(
ÄÄ~ 
$strÄÄ Å
)ÄÄÅ Ç
;ÄÄÇ É
var
ÅÅ 
urlCheck
ÅÅ  (
=
ÅÅ) *
	GetConfig
ÅÅ+ 4
.
ÅÅ4 5

AppSetting
ÅÅ5 ?
[
ÅÅ? @
$str
ÅÅ@ Q
]
ÅÅQ R
+
ÅÅS T
	GetConfig
ÅÅU ^
.
ÅÅ^ _

AppSetting
ÅÅ_ i
[
ÅÅi j
$strÅÅj É
]ÅÅÉ Ñ
+ÅÅÖ Ü

dataAssignÅÅá ë
.ÅÅë í
IdNopFromApiÅÅí û
;ÅÅû ü
(
ÇÇ 
bool
ÇÇ !
resultApiCheck
ÇÇ" 0
,
ÇÇ0 1
string
ÇÇ2 8
resultCheck
ÇÇ9 D
)
ÇÇD E
=
ÇÇF G
RequestToAPI
ÇÇH T
.
ÇÇT U!
GetJsonStringWebApi
ÇÇU h
(
ÇÇh i
urlCheck
ÇÇi q
,
ÇÇq r
null
ÇÇs w
)
ÇÇw x
;
ÇÇx y
if
ÉÉ 
(
ÉÉ  
resultApiCheck
ÉÉ  .
&&
ÉÉ/ 1
!
ÉÉ2 3
string
ÉÉ3 9
.
ÉÉ9 :
IsNullOrEmpty
ÉÉ: G
(
ÉÉG H
resultCheck
ÉÉH S
)
ÉÉS T
)
ÉÉT U
{
ÑÑ "
jsonParseReturnCheck
ÖÖ  4
=
ÖÖ5 6
JsonConvert
ÖÖ7 B
.
ÖÖB C
DeserializeObject
ÖÖC T
<
ÖÖT U!
ResultStatusDataInt
ÖÖU h
<
ÖÖh i!
ResultStatusDataNop
ÖÖi |
>
ÖÖ| }
>
ÖÖ} ~
(
ÖÖ~ 
resultCheckÖÖ ä
)ÖÖä ã
;ÖÖã å
}
ÜÜ 
if
àà 
(
àà  "
jsonParseReturnCheck
àà  4
.
àà4 5

StatusCode
àà5 ?
==
àà@ B
$num
ààC F
||
ààG I"
jsonParseReturnCheck
ààJ ^
.
àà^ _

StatusCode
àà_ i
==
ààj l
$num
ààm p
)
ààp q
{
ââ 
if
ää  "
(
ää# $"
jsonParseReturnCheck
ää$ 8
.
ää8 9
Data
ää9 =
.
ää= >
Status
ää> D
==
ääE G
$str
ääH T
)
ääT U
{
ãã  !
List
çç$ (
<
çç( )&
TblNoticeOfPaymentDetail
çç) A
>
ççA B
dataAssignDetail
ççC S
=
ççT U
_context
ççV ^
.
çç^ _'
TblNoticeOfPaymentDetails
çç_ x
.
ççx y
Where
ççy ~
(
çç~ 
mçç Ä
=>ççÅ É
mççÑ Ö
.ççÖ Ü
NopIdççÜ ã
==ççå é
intççè í
.ççí ì
Parseççì ò
(ççò ô
itemççô ù
)ççù û
&&ççü °
mçç¢ £
.çç£ §
IsActiveçç§ ¨
==çç≠ Ø
$numçç∞ ±
&&çç≤ ¥
mççµ ∂
.çç∂ ∑
	IsDeletedçç∑ ¿
==çç¡ √
$numççƒ ≈
)çç≈ ∆
.çç∆ «
ToListçç« Õ
(ççÕ Œ
)ççŒ œ
;ççœ –
List
éé$ (
<
éé( )&
TblNoticeOfPaymentDetail
éé) A
>
ééA B%
dataAssignDetailDeleted
ééC Z
=
éé[ \
_context
éé] e
.
éée f'
TblNoticeOfPaymentDetails
ééf 
.éé Ä
WhereééÄ Ö
(ééÖ Ü
mééÜ á
=>ééà ä
mééã å
.ééå ç
NopIdééç í
==ééì ï
intééñ ô
.ééô ö
Parseééö ü
(ééü †
iteméé† §
)éé§ •
&&éé¶ ®
méé© ™
.éé™ ´"
IdNopDetailFromApiéé´ Ω
!=ééæ ¿
nulléé¡ ≈
&&éé∆ »
méé…  
.éé  À
	IsDeletedééÀ ‘
==éé’ ◊
$numééÿ Ÿ
&&éé⁄ ‹
méé› ﬁ
.ééﬁ ﬂ
IsActiveééﬂ Á
==ééË Í
$numééÎ Ï
)ééÏ Ì
.ééÌ Ó
ToListééÓ Ù
(ééÙ ı
)ééı ˆ
;ééˆ ˜
foreach
êê$ +
(
êê, -
var
êê- 0
itemDetailDelete
êê1 A
in
êêB D%
dataAssignDetailDeleted
êêE \
)
êê\ ]
{
ëë$ %
if
íí( *
(
íí+ ,
itemDetailDelete
íí, <
.
íí< = 
IdNopDetailFromApi
íí= O
!=
ííP R
null
ííS W
)
ííW X
{
ìì( )
var
îî, /)
jsonParseReturnUpdateDetail
îî0 K
=
îîL M
JsonConvert
îîN Y
.
îîY Z
DeserializeObject
îîZ k
<
îîk l!
ResultStatusDataInt
îîl 
<îî Ä#
ResultStatusDataNopîîÄ ì
>îîì î
>îîî ï
(îîï ñ
$strîîñ ò
)îîò ô
;îîô ö
var
ïï, /
urlUpdateDetail
ïï0 ?
=
ïï@ A
	GetConfig
ïïB K
.
ïïK L

AppSetting
ïïL V
[
ïïV W
$str
ïïW h
]
ïïh i
+
ïïj k
	GetConfig
ïïl u
.
ïïu v

AppSettingïïv Ä
[ïïÄ Å
$strïïÅ õ
]ïïõ ú
+ïïù û 
itemDetailDeleteïïü Ø
.ïïØ ∞"
IdNopDetailFromApiïï∞ ¬
;ïï¬ √
(
ññ, -
bool
ññ- 1#
resultApiUpdateDetail
ññ2 G
,
ññG H
string
ññI O 
resultUpdateDetail
ññP b
)
ññb c
=
ññd e
RequestToAPI
ññf r
.
ññr s$
DeleteRequestToWebApiññs à
(ññà â
urlUpdateDetailññâ ò
,ññò ô
nullññö û
)ññû ü
;ññü †
if
óó, .
(
óó/ 0#
resultApiUpdateDetail
óó0 E
&&
óóF H
!
óóI J
string
óóJ P
.
óóP Q
IsNullOrEmpty
óóQ ^
(
óó^ _ 
resultUpdateDetail
óó_ q
)
óóq r
)
óór s
{
òò, -)
jsonParseReturnUpdateDetail
ôô0 K
=
ôôL M
JsonConvert
ôôN Y
.
ôôY Z
DeserializeObject
ôôZ k
<
ôôk l!
ResultStatusDataInt
ôôl 
<ôô Ä#
ResultStatusDataNopôôÄ ì
>ôôì î
>ôôî ï
(ôôï ñ"
resultUpdateDetailôôñ ®
)ôô® ©
;ôô© ™
if
öö0 2
(
öö3 4)
jsonParseReturnUpdateDetail
öö4 O
.
ööO P

StatusCode
ööP Z
==
öö[ ]
$num
öö^ a
||
ööb d*
jsonParseReturnUpdateDetailööe Ä
.ööÄ Å

StatusCodeööÅ ã
==ööå é
$numööè í
)ööí ì
{
õõ0 1
itemDetailDelete
úú4 D
.
úúD E
IsActive
úúE M
=
úúN O
$num
úúP Q
;
úúQ R
itemDetailDelete
ùù4 D
.
ùùD E
	IsDeleted
ùùE N
=
ùùO P
$num
ùùQ R
;
ùùR S
_context
ûû4 <
.
ûû< =
Entry
ûû= B
(
ûûB C
itemDetailDelete
ûûC S
)
ûûS T
.
ûûT U
State
ûûU Z
=
ûû[ \
EntityState
ûû] h
.
ûûh i
Modified
ûûi q
;
ûûq r
_context
üü4 <
.
üü< =
SaveChanges
üü= H
(
üüH I
)
üüI J
;
üüJ K
}
††0 1
}
°°, -
}
¢¢( )
}
££$ %
foreach
••$ +
(
••, -
var
••- 0

itemDetail
••1 ;
in
••< >
dataAssignDetail
••? O
)
••O P
{
¶¶( )
if
®®, .
(
®®/ 0

itemDetail
®®0 :
.
®®: ; 
IdNopDetailFromApi
®®; M
!=
®®N P
null
®®Q U
)
®®U V
{
©©, -
var
™™0 3)
jsonParseReturnUpdateDetail
™™4 O
=
™™P Q
JsonConvert
™™R ]
.
™™] ^
DeserializeObject
™™^ o
<
™™o p"
ResultStatusDataInt™™p É
<™™É Ñ#
ResultStatusDataNop™™Ñ ó
>™™ó ò
>™™ò ô
(™™ô ö
$str™™ö ú
)™™ú ù
;™™ù û
var
´´0 3
urlUpdateDetail
´´4 C
=
´´D E
	GetConfig
´´F O
.
´´O P

AppSetting
´´P Z
[
´´Z [
$str
´´[ l
]
´´l m
+
´´n o
	GetConfig
´´p y
.
´´y z

AppSetting´´z Ñ
[´´Ñ Ö
$str´´Ö ü
]´´ü †
+´´° ¢

itemDetail´´£ ≠
.´´≠ Æ"
IdNopDetailFromApi´´Æ ¿
;´´¿ ¡
(
¨¨0 1
bool
¨¨1 5#
resultApiUpdateDetail
¨¨6 K
,
¨¨K L
string
¨¨M S 
resultUpdateDetail
¨¨T f
)
¨¨f g
=
¨¨h i
RequestToAPI
¨¨j v
.
¨¨v w!
PutRequestToWebApi¨¨w â
(¨¨â ä
urlUpdateDetail¨¨ä ô
,¨¨ô ö
new¨¨õ û
{
≠≠0 1
NopId
ÆÆ4 9
=
ÆÆ: ;

dataAssign
ÆÆ< F
.
ÆÆF G
IdNopFromApi
ÆÆG S
,
ÆÆS T
CreditorRef
ØØ4 ?
=
ØØ@ A

itemDetail
ØØB L
.
ØØL M
CreditorRef
ØØM X
,
ØØX Y
Outstanding
∞∞4 ?
=
∞∞@ A

itemDetail
∞∞B L
.
∞∞L M
Outstanding
∞∞M X
,
∞∞X Y
	Principal
±±4 =
=
±±> ?

itemDetail
±±@ J
.
±±J K
	Principal
±±K T
,
±±T U
Interest
≤≤4 <
=
≤≤= >

itemDetail
≤≤? I
.
≤≤I J
Interest
≤≤J R
,
≤≤R S
Fee
≥≥4 7
=
≥≥8 9

itemDetail
≥≥: D
.
≥≥D E
Fee
≥≥E H
}
¥¥0 1
,
¥¥1 2
null
¥¥3 7
)
¥¥7 8
;
¥¥8 9
if
µµ0 2
(
µµ3 4#
resultApiUpdateDetail
µµ4 I
&&
µµJ L
!
µµM N
string
µµN T
.
µµT U
IsNullOrEmpty
µµU b
(
µµb c 
resultUpdateDetail
µµc u
)
µµu v
)
µµv w
{
∂∂0 1)
jsonParseReturnUpdateDetail
∑∑4 O
=
∑∑P Q
JsonConvert
∑∑R ]
.
∑∑] ^
DeserializeObject
∑∑^ o
<
∑∑o p"
ResultStatusDataInt∑∑p É
<∑∑É Ñ#
ResultStatusDataNop∑∑Ñ ó
>∑∑ó ò
>∑∑ò ô
(∑∑ô ö"
resultUpdateDetail∑∑ö ¨
)∑∑¨ ≠
;∑∑≠ Æ
if
∏∏4 6
(
∏∏7 8)
jsonParseReturnUpdateDetail
∏∏8 S
.
∏∏S T

StatusCode
∏∏T ^
==
∏∏_ a
$num
∏∏b e
||
∏∏f h*
jsonParseReturnUpdateDetail∏∏i Ñ
.∏∏Ñ Ö

StatusCode∏∏Ö è
==∏∏ê í
$num∏∏ì ñ
)∏∏ñ ó
{
ππ4 5

itemDetail
∫∫8 B
.
∫∫B C 
IdNopDetailFromApi
∫∫C U
=
∫∫V W)
jsonParseReturnUpdateDetail
∫∫X s
.
∫∫s t
Data
∫∫t x
.
∫∫x y
Id
∫∫y {
;
∫∫{ |
_context
ªª8 @
.
ªª@ A
Entry
ªªA F
(
ªªF G

itemDetail
ªªG Q
)
ªªQ R
.
ªªR S
State
ªªS X
=
ªªY Z
EntityState
ªª[ f
.
ªªf g
Modified
ªªg o
;
ªªo p
_context
ºº8 @
.
ºº@ A
SaveChanges
ººA L
(
ººL M
)
ººM N
;
ººN O
}
ΩΩ4 5
}
ææ0 1
}
¡¡, -
else
¬¬, 0
{
√√, -
var
ƒƒ0 3&
jsonParseReturnAddDetail
ƒƒ4 L
=
ƒƒM N
JsonConvert
ƒƒO Z
.
ƒƒZ [
DeserializeObject
ƒƒ[ l
<
ƒƒl m"
ResultStatusDataIntƒƒm Ä
<ƒƒÄ Å#
ResultStatusDataNopƒƒÅ î
>ƒƒî ï
>ƒƒï ñ
(ƒƒñ ó
$strƒƒó ô
)ƒƒô ö
;ƒƒö õ
var
≈≈0 3
urlAddDetail
≈≈4 @
=
≈≈A B
	GetConfig
≈≈C L
.
≈≈L M

AppSetting
≈≈M W
[
≈≈W X
$str
≈≈X i
]
≈≈i j
+
≈≈k l
	GetConfig
≈≈m v
.
≈≈v w

AppSetting≈≈w Å
[≈≈Å Ç
$str≈≈Ç ô
]≈≈ô ö
;≈≈ö õ
(
∆∆0 1
bool
∆∆1 5 
resultApiAddDetail
∆∆6 H
,
∆∆H I
string
∆∆J P
resultAddDetail
∆∆Q `
)
∆∆` a
=
∆∆b c
RequestToAPI
∆∆d p
.
∆∆p q"
PostRequestToWebApi∆∆q Ñ
(∆∆Ñ Ö
urlAddDetail∆∆Ö ë
,∆∆ë í
new∆∆ì ñ
{
««0 1
NopId
»»4 9
=
»»: ;

dataAssign
»»< F
.
»»F G
IdNopFromApi
»»G S
,
»»S T
CreditorRef
……4 ?
=
……@ A

itemDetail
……B L
.
……L M
CreditorRef
……M X
,
……X Y
Outstanding
  4 ?
=
  @ A

itemDetail
  B L
.
  L M
Outstanding
  M X
,
  X Y
	Principal
ÀÀ4 =
=
ÀÀ> ?

itemDetail
ÀÀ@ J
.
ÀÀJ K
	Principal
ÀÀK T
,
ÀÀT U
Interest
ÃÃ4 <
=
ÃÃ= >

itemDetail
ÃÃ? I
.
ÃÃI J
Interest
ÃÃJ R
,
ÃÃR S
Fee
ÕÕ4 7
=
ÕÕ8 9

itemDetail
ÕÕ: D
.
ÕÕD E
Fee
ÕÕE H
}
ŒŒ0 1
,
ŒŒ1 2
null
ŒŒ3 7
)
ŒŒ7 8
;
ŒŒ8 9
if
œœ0 2
(
œœ3 4 
resultApiAddDetail
œœ4 F
&&
œœG I
!
œœJ K
string
œœK Q
.
œœQ R
IsNullOrEmpty
œœR _
(
œœ_ `
resultAddDetail
œœ` o
)
œœo p
)
œœp q
{
––0 1&
jsonParseReturnAddDetail
——4 L
=
——M N
JsonConvert
——O Z
.
——Z [
DeserializeObject
——[ l
<
——l m"
ResultStatusDataInt——m Ä
<——Ä Å#
ResultStatusDataNop——Å î
>——î ï
>——ï ñ
(——ñ ó
resultAddDetail——ó ¶
)——¶ ß
;——ß ®
if
““4 6
(
““7 8&
jsonParseReturnAddDetail
““8 P
.
““P Q

StatusCode
““Q [
==
““\ ^
$num
““_ b
||
““c e&
jsonParseReturnAddDetail
““f ~
.
““~ 

StatusCode““ â
==““ä å
$num““ç ê
)““ê ë
{
””4 5

itemDetail
‘‘8 B
.
‘‘B C 
IdNopDetailFromApi
‘‘C U
=
‘‘V W&
jsonParseReturnAddDetail
‘‘X p
.
‘‘p q
Data
‘‘q u
.
‘‘u v
Id
‘‘v x
;
‘‘x y
_context
’’8 @
.
’’@ A
Entry
’’A F
(
’’F G

itemDetail
’’G Q
)
’’Q R
.
’’R S
State
’’S X
=
’’Y Z
EntityState
’’[ f
.
’’f g
Modified
’’g o
;
’’o p
_context
÷÷8 @
.
÷÷@ A
SaveChanges
÷÷A L
(
÷÷L M
)
÷÷M N
;
÷÷N O
}
◊◊4 5
}
ﬂﬂ0 1
}
‡‡, -
}
··( )
List
‰‰$ (
<
‰‰( )
TblFileUploadNop
‰‰) 9
>
‰‰9 :
dataAssignFile
‰‰; I
=
‰‰J K
_context
‰‰L T
.
‰‰T U
TblFileUploadNops
‰‰U f
.
‰‰f g
Where
‰‰g l
(
‰‰l m
m
‰‰m n
=>
‰‰o q
m
‰‰r s
.
‰‰s t
IdNop
‰‰t y
==
‰‰z |
int‰‰} Ä
.‰‰Ä Å
Parse‰‰Å Ü
(‰‰Ü á
item‰‰á ã
)‰‰ã å
&&‰‰ç è
m‰‰ê ë
.‰‰ë í
	IsDeleted‰‰í õ
==‰‰ú û
$num‰‰ü †
)‰‰† °
.‰‰° ¢
ToList‰‰¢ ®
(‰‰® ©
)‰‰© ™
;‰‰™ ´
List
ÂÂ$ (
<
ÂÂ( )
TblFileUploadNop
ÂÂ) 9
>
ÂÂ9 :#
dataAssignFileDeleted
ÂÂ; P
=
ÂÂQ R
_context
ÂÂS [
.
ÂÂ[ \
TblFileUploadNops
ÂÂ\ m
.
ÂÂm n
Where
ÂÂn s
(
ÂÂs t
m
ÂÂt u
=>
ÂÂv x
m
ÂÂy z
.
ÂÂz {
IdNopÂÂ{ Ä
==ÂÂÅ É
intÂÂÑ á
.ÂÂá à
ParseÂÂà ç
(ÂÂç é
itemÂÂé í
)ÂÂí ì
&&ÂÂî ñ
mÂÂó ò
.ÂÂò ô
IdFileFromApiÂÂô ¶
!=ÂÂß ©
nullÂÂ™ Æ
&&ÂÂØ ±
mÂÂ≤ ≥
.ÂÂ≥ ¥
	IsDeletedÂÂ¥ Ω
==ÂÂæ ¿
$numÂÂ¡ ¬
&&ÂÂ√ ≈
mÂÂ∆ «
.ÂÂ« »
IsActiveÂÂ» –
==ÂÂ— ”
$numÂÂ‘ ’
)ÂÂ’ ÷
.ÂÂ÷ ◊
ToListÂÂ◊ ›
(ÂÂ› ﬁ
)ÂÂﬁ ﬂ
;ÂÂﬂ ‡
foreach
ÁÁ$ +
(
ÁÁ, -
var
ÁÁ- 0
itemFileDelete
ÁÁ1 ?
in
ÁÁ@ B#
dataAssignFileDeleted
ÁÁC X
)
ÁÁX Y
{
ËË$ %
if
ÈÈ( *
(
ÈÈ+ ,
itemFileDelete
ÈÈ, :
.
ÈÈ: ;
IdFileFromApi
ÈÈ; H
!=
ÈÈI K
null
ÈÈL P
)
ÈÈP Q
{
ÍÍ( )
var
ÎÎ, /'
jsonParseReturnUpdateFile
ÎÎ0 I
=
ÎÎJ K
JsonConvert
ÎÎL W
.
ÎÎW X
DeserializeObject
ÎÎX i
<
ÎÎi j!
ResultStatusDataInt
ÎÎj }
<
ÎÎ} ~"
ResultStatusDataNopÎÎ~ ë
>ÎÎë í
>ÎÎí ì
(ÎÎì î
$strÎÎî ñ
)ÎÎñ ó
;ÎÎó ò
var
ÏÏ, /
urlUpdateFile
ÏÏ0 =
=
ÏÏ> ?
	GetConfig
ÏÏ@ I
.
ÏÏI J

AppSetting
ÏÏJ T
[
ÏÏT U
$str
ÏÏU f
]
ÏÏf g
+
ÏÏh i
	GetConfig
ÏÏj s
.
ÏÏs t

AppSetting
ÏÏt ~
[
ÏÏ~ 
$strÏÏ î
]ÏÏî ï
+ÏÏñ ó
itemFileDeleteÏÏò ¶
.ÏÏ¶ ß
IdFileFromApiÏÏß ¥
;ÏÏ¥ µ
(
ÌÌ, -
bool
ÌÌ- 1!
resultApiUpdateFile
ÌÌ2 E
,
ÌÌE F
string
ÌÌG M
resultUpdateFile
ÌÌN ^
)
ÌÌ^ _
=
ÌÌ` a
RequestToAPI
ÌÌb n
.
ÌÌn o$
DeleteRequestToWebApiÌÌo Ñ
(ÌÌÑ Ö
urlUpdateFileÌÌÖ í
,ÌÌí ì
nullÌÌî ò
)ÌÌò ô
;ÌÌô ö
if
ÓÓ, .
(
ÓÓ/ 0!
resultApiUpdateFile
ÓÓ0 C
&&
ÓÓD F
!
ÓÓG H
string
ÓÓH N
.
ÓÓN O
IsNullOrEmpty
ÓÓO \
(
ÓÓ\ ]
resultUpdateFile
ÓÓ] m
)
ÓÓm n
)
ÓÓn o
{
ÔÔ, -'
jsonParseReturnUpdateFile
0 I
=
J K
JsonConvert
L W
.
W X
DeserializeObject
X i
<
i j!
ResultStatusDataInt
j }
<
} ~"
ResultStatusDataNop~ ë
>ë í
>í ì
(ì î 
resultUpdateFileî §
)§ •
;• ¶
if
ÒÒ0 2
(
ÒÒ3 4'
jsonParseReturnUpdateFile
ÒÒ4 M
.
ÒÒM N

StatusCode
ÒÒN X
==
ÒÒY [
$num
ÒÒ\ _
||
ÒÒ` b'
jsonParseReturnUpdateFile
ÒÒc |
.
ÒÒ| }

StatusCodeÒÒ} á
==ÒÒà ä
$numÒÒã é
)ÒÒé è
{
ÚÚ0 1
itemFileDelete
ÛÛ4 B
.
ÛÛB C
IsActive
ÛÛC K
=
ÛÛL M
$num
ÛÛN O
;
ÛÛO P
itemFileDelete
ÙÙ4 B
.
ÙÙB C
	IsDeleted
ÙÙC L
=
ÙÙM N
$num
ÙÙO P
;
ÙÙP Q
_context
ıı4 <
.
ıı< =
Entry
ıı= B
(
ııB C
itemFileDelete
ııC Q
)
ııQ R
.
ııR S
State
ııS X
=
ııY Z
EntityState
ıı[ f
.
ııf g
Modified
ııg o
;
ııo p
_context
ˆˆ4 <
.
ˆˆ< =
SaveChanges
ˆˆ= H
(
ˆˆH I
)
ˆˆI J
;
ˆˆJ K
}
˜˜0 1
}
¯¯, -
if
˘˘, .
(
˘˘/ 0!
resultApiUpdateFile
˘˘0 C
)
˘˘C D
{
˙˙, -
itemFileDelete
˚˚0 >
.
˚˚> ?
IsActive
˚˚? G
=
˚˚H I
$num
˚˚J K
;
˚˚K L
itemFileDelete
¸¸0 >
.
¸¸> ?
	IsDeleted
¸¸? H
=
¸¸I J
$num
¸¸K L
;
¸¸L M
_context
˝˝0 8
.
˝˝8 9
Entry
˝˝9 >
(
˝˝> ?
itemFileDelete
˝˝? M
)
˝˝M N
.
˝˝N O
State
˝˝O T
=
˝˝U V
EntityState
˝˝W b
.
˝˝b c
Modified
˝˝c k
;
˝˝k l
_context
˛˛0 8
.
˛˛8 9
SaveChanges
˛˛9 D
(
˛˛D E
)
˛˛E F
;
˛˛F G
}
ˇˇ, -
}
ÄÄ( )
}
ÅÅ$ %
foreach
ÉÉ$ +
(
ÉÉ, -
var
ÉÉ- 0
itemFile
ÉÉ1 9
in
ÉÉ: <
dataAssignFile
ÉÉ= K
)
ÉÉK L
{
ÑÑ( )
var
ÖÖ, /
data
ÖÖ0 4
=
ÖÖ5 6
new
ÖÖ7 :
object
ÖÖ; A
(
ÖÖA B
)
ÖÖB C
;
ÖÖC D
var
ÜÜ, /
check
ÜÜ0 5
=
ÜÜ6 7
await
ÜÜ8 =
_context
ÜÜ> F
.
ÜÜF G
TblFileUploadNops
ÜÜG X
.
ÜÜX Y
Where
ÜÜY ^
(
ÜÜ^ _
x
ÜÜ_ `
=>
ÜÜa c
x
ÜÜd e
.
ÜÜe f
Id
ÜÜf h
==
ÜÜi k
itemFile
ÜÜl t
.
ÜÜt u
Id
ÜÜu w
)
ÜÜw x
.
ÜÜx y"
FirstOrDefaultAsyncÜÜy å
(ÜÜå ç
)ÜÜç é
;ÜÜé è
if
áá, .
(
áá/ 0
System
áá0 6
.
áá6 7
IO
áá7 9
.
áá9 :
File
áá: >
.
áá> ?
Exists
áá? E
(
ááE F
check
ááF K
.
ááK L
FilePath
ááL T
)
ááT U
)
ááU V
{
àà, -
byte
ââ0 4
[
ââ4 5
]
ââ5 6
	fileBytes
ââ7 @
=
ââA B
System
ââC I
.
ââI J
IO
ââJ L
.
ââL M
File
ââM Q
.
ââQ R
ReadAllBytes
ââR ^
(
ââ^ _
check
ââ_ d
.
ââd e
FilePath
ââe m
)
ââm n
;
âân o
string
åå0 6
base64String
åå7 C
=
ååD E
Convert
ååF M
.
ååM N
ToBase64String
ååN \
(
åå\ ]
	fileBytes
åå] f
)
ååf g
;
ååg h
var
éé0 3)
jsonParseReturnUploadBase64
éé4 O
=
ééP Q
JsonConvert
ééR ]
.
éé] ^
DeserializeObject
éé^ o
<
ééo p"
ResultStatusDataIntéép É
<ééÉ Ñ#
ResultStatusDataNopééÑ ó
>ééó ò
>ééò ô
(ééô ö
$strééö ú
)ééú ù
;ééù û
var
èè0 3
urlUploadBase64
èè4 C
=
èèD E
	GetConfig
èèF O
.
èèO P

AppSetting
èèP Z
[
èèZ [
$str
èè[ l
]
èèl m
+
èèn o
	GetConfig
èèp y
.
èèy z

AppSettingèèz Ñ
[èèÑ Ö
$strèèÖ ü
]èèü †
+èè° ¢

dataAssignèè£ ≠
.èè≠ Æ
IdNopFromApièèÆ ∫
;èè∫ ª
(
êê0 1
bool
êê1 5#
resultApiUploadBase64
êê6 K
,
êêK L
string
êêM S 
resultUploadBase64
êêT f
)
êêf g
=
êêh i
RequestToAPI
êêj v
.
êêv w"
PostRequestToWebApiêêw ä
(êêä ã
urlUploadBase64êêã ö
,êêö õ
newêêú ü
{
ëë0 1
FileName
íí4 <
=
íí= >
itemFile
íí? G
.
ííG H
FileName
ííH P
,
ííP Q
FileContent
ìì4 ?
=
ìì@ A
base64String
ììB N
,
ììN O
}
îî0 1
,
îî1 2
null
îî3 7
)
îî7 8
;
îî8 9
if
ïï0 2
(
ïï3 4#
resultApiUploadBase64
ïï4 I
&&
ïïJ L
!
ïïM N
string
ïïN T
.
ïïT U
IsNullOrEmpty
ïïU b
(
ïïb c 
resultUploadBase64
ïïc u
)
ïïu v
)
ïïv w
{
ññ0 1)
jsonParseReturnUploadBase64
óó4 O
=
óóP Q
JsonConvert
óóR ]
.
óó] ^
DeserializeObject
óó^ o
<
óóo p"
ResultStatusDataIntóóp É
<óóÉ Ñ#
ResultStatusDataNopóóÑ ó
>óóó ò
>óóò ô
(óóô ö"
resultUploadBase64óóö ¨
)óó¨ ≠
;óó≠ Æ
if
òò4 6
(
òò7 8)
jsonParseReturnUploadBase64
òò8 S
.
òòS T

StatusCode
òòT ^
==
òò_ a
$num
òòb e
||
òòf h*
jsonParseReturnUploadBase64òòi Ñ
.òòÑ Ö

StatusCodeòòÖ è
==òòê í
$numòòì ñ
)òòñ ó
{
ôô4 5
itemFile
öö8 @
.
öö@ A
IdFileFromApi
ööA N
=
ööO P)
jsonParseReturnUploadBase64
ööQ l
.
ööl m
Data
ööm q
.
ööq r
Key
öör u
;
ööu v
_context
õõ8 @
.
õõ@ A
Entry
õõA F
(
õõF G
itemFile
õõG O
)
õõO P
.
õõP Q
State
õõQ V
=
õõW X
EntityState
õõY d
.
õõd e
Modified
õõe m
;
õõm n
_context
úú8 @
.
úú@ A
SaveChanges
úúA L
(
úúL M
)
úúM N
;
úúN O
}
ùù4 5
}
ûû0 1
}
üü, -
}
††( )
var
§§$ '#
jsonParseReturnUpdate
§§( =
=
§§> ?
JsonConvert
§§@ K
.
§§K L
DeserializeObject
§§L ]
<
§§] ^!
ResultStatusDataInt
§§^ q
<
§§q r"
ResultStatusDataNop§§r Ö
>§§Ö Ü
>§§Ü á
(§§á à
$str§§à ä
)§§ä ã
;§§ã å
var
••$ '
	urlUpdate
••( 1
=
••2 3
	GetConfig
••4 =
.
••= >

AppSetting
••> H
[
••H I
$str
••I Z
]
••Z [
+
••\ ]
	GetConfig
••^ g
.
••g h

AppSetting
••h r
[
••r s
$str••s á
]••á à
+••â ä

dataAssign••ã ï
.••ï ñ
IdNopFromApi••ñ ¢
;••¢ £
(
¶¶$ %
bool
¶¶% )
resultApiUpdate
¶¶* 9
,
¶¶9 :
string
¶¶; A
resultUpdate
¶¶B N
)
¶¶N O
=
¶¶P Q
RequestToAPI
¶¶R ^
.
¶¶^ _ 
PutRequestToWebApi
¶¶_ q
(
¶¶q r
	urlUpdate
¶¶r {
,
¶¶{ |
model¶¶} Ç
,¶¶Ç É
null¶¶Ñ à
)¶¶à â
;¶¶â ä
if
ßß$ &
(
ßß' (
resultApiUpdate
ßß( 7
&&
ßß8 :
!
ßß; <
string
ßß< B
.
ßßB C
IsNullOrEmpty
ßßC P
(
ßßP Q
resultUpdate
ßßQ ]
)
ßß] ^
)
ßß^ _
{
®®$ %#
jsonParseReturnUpdate
©©( =
=
©©> ?
JsonConvert
©©@ K
.
©©K L
DeserializeObject
©©L ]
<
©©] ^!
ResultStatusDataInt
©©^ q
<
©©q r"
ResultStatusDataNop©©r Ö
>©©Ö Ü
>©©Ü á
(©©á à
resultUpdate©©à î
)©©î ï
;©©ï ñ
if
™™( *
(
™™+ ,#
jsonParseReturnUpdate
™™, A
.
™™A B

StatusCode
™™B L
==
™™M O
$num
™™P S
||
™™T V#
jsonParseReturnUpdate
™™W l
.
™™l m

StatusCode
™™m w
==
™™x z
$num
™™{ ~
)
™™~ 
{
´´( )

dataAssign
¨¨, 6
.
¨¨6 7
Status
¨¨7 =
=
¨¨> ?#
jsonParseReturnUpdate
¨¨@ U
.
¨¨U V
Data
¨¨V Z
.
¨¨Z [
Status
¨¨[ a
;
¨¨a b

dataAssign
≠≠, 6
.
≠≠6 7
LastSentDate
≠≠7 C
=
≠≠D E
DateTime
≠≠F N
.
≠≠N O
Now
≠≠O R
;
≠≠R S
_context
ÆÆ, 4
.
ÆÆ4 5
Entry
ÆÆ5 :
(
ÆÆ: ;

dataAssign
ÆÆ; E
)
ÆÆE F
.
ÆÆF G
State
ÆÆG L
=
ÆÆM N
EntityState
ÆÆO Z
.
ÆÆZ [
Modified
ÆÆ[ c
;
ÆÆc d
_context
ØØ, 4
.
ØØ4 5
SaveChanges
ØØ5 @
(
ØØ@ A
)
ØØA B
;
ØØB C
}
∞∞( )
}
±±$ %
}
≤≤  !
else
≥≥  $
{
¥¥  !

dataAssign
µµ$ .
.
µµ. /
Status
µµ/ 5
=
µµ6 7"
jsonParseReturnCheck
µµ8 L
.
µµL M
Data
µµM Q
.
µµQ R
Status
µµR X
;
µµX Y

dataAssign
∂∂$ .
.
∂∂. /
LastSentDate
∂∂/ ;
=
∂∂< =
DateTime
∂∂> F
.
∂∂F G
Now
∂∂G J
;
∂∂J K
_context
∑∑$ ,
.
∑∑, -
Entry
∑∑- 2
(
∑∑2 3

dataAssign
∑∑3 =
)
∑∑= >
.
∑∑> ?
State
∑∑? D
=
∑∑E F
EntityState
∑∑G R
.
∑∑R S
Modified
∑∑S [
;
∑∑[ \
_context
∏∏$ ,
.
∏∏, -
SaveChanges
∏∏- 8
(
∏∏8 9
)
∏∏9 :
;
∏∏: ;
}
ππ  !
}
∫∫ 
}
ªª 
else
ΩΩ 
{
ææ 
var
øø  
jsonParseReturnAdd
øø  2
=
øø3 4
JsonConvert
øø5 @
.
øø@ A
DeserializeObject
øøA R
<
øøR S!
ResultStatusDataInt
øøS f
<
øøf g!
ResultStatusDataNop
øøg z
>
øøz {
>
øø{ |
(
øø| }
$str
øø} 
)øø Ä
;øøÄ Å
var
¿¿ 
urlAdd
¿¿  &
=
¿¿' (
	GetConfig
¿¿) 2
.
¿¿2 3

AppSetting
¿¿3 =
[
¿¿= >
$str
¿¿> O
]
¿¿O P
+
¿¿Q R
	GetConfig
¿¿S \
.
¿¿\ ]

AppSetting
¿¿] g
[
¿¿g h
$str
¿¿h y
]
¿¿y z
;
¿¿z {
(
¡¡ 
bool
¡¡ !
resultApiAdd
¡¡" .
,
¡¡. /
string
¡¡0 6
	resultAdd
¡¡7 @
)
¡¡@ A
=
¡¡B C
RequestToAPI
¡¡D P
.
¡¡P Q!
PostRequestToWebApi
¡¡Q d
(
¡¡d e
urlAdd
¡¡e k
,
¡¡k l
model
¡¡m r
,
¡¡r s
null
¡¡t x
)
¡¡x y
;
¡¡y z
if
¬¬ 
(
¬¬  
resultApiAdd
¬¬  ,
&&
¬¬- /
!
¬¬0 1
string
¬¬1 7
.
¬¬7 8
IsNullOrEmpty
¬¬8 E
(
¬¬E F
	resultAdd
¬¬F O
)
¬¬O P
)
¬¬P Q
{
√√  
jsonParseReturnAdd
ƒƒ  2
=
ƒƒ3 4
JsonConvert
ƒƒ5 @
.
ƒƒ@ A
DeserializeObject
ƒƒA R
<
ƒƒR S!
ResultStatusDataInt
ƒƒS f
<
ƒƒf g!
ResultStatusDataNop
ƒƒg z
>
ƒƒz {
>
ƒƒ{ |
(
ƒƒ| }
	resultAddƒƒ} Ü
)ƒƒÜ á
;ƒƒá à
if
≈≈  "
(
≈≈# $ 
jsonParseReturnAdd
≈≈$ 6
.
≈≈6 7

StatusCode
≈≈7 A
==
≈≈B D
$num
≈≈E H
||
≈≈I K 
jsonParseReturnAdd
≈≈L ^
.
≈≈^ _

StatusCode
≈≈_ i
==
≈≈j l
$num
≈≈m p
)
≈≈p q
{
∆∆  !

dataAssign
««$ .
.
««. /
IdNopFromApi
««/ ;
=
««< = 
jsonParseReturnAdd
««> P
.
««P Q
Data
««Q U
.
««U V
Id
««V X
;
««X Y

dataAssign
»»$ .
.
»». /
Status
»»/ 5
=
»»6 7 
jsonParseReturnAdd
»»8 J
.
»»J K
Data
»»K O
.
»»O P
Status
»»P V
;
»»V W

dataAssign
……$ .
.
……. /
LastSentDate
……/ ;
=
……< =
DateTime
……> F
.
……F G
Now
……G J
;
……J K
_context
  $ ,
.
  , -
Entry
  - 2
(
  2 3

dataAssign
  3 =
)
  = >
.
  > ?
State
  ? D
=
  E F
EntityState
  G R
.
  R S
Modified
  S [
;
  [ \
_context
ÀÀ$ ,
.
ÀÀ, -
SaveChanges
ÀÀ- 8
(
ÀÀ8 9
)
ÀÀ9 :
;
ÀÀ: ;
List
ŒŒ$ (
<
ŒŒ( )&
TblNoticeOfPaymentDetail
ŒŒ) A
>
ŒŒA B
dataAssignDetail
ŒŒC S
=
ŒŒT U
_context
ŒŒV ^
.
ŒŒ^ _'
TblNoticeOfPaymentDetails
ŒŒ_ x
.
ŒŒx y
Where
ŒŒy ~
(
ŒŒ~ 
mŒŒ Ä
=>ŒŒÅ É
mŒŒÑ Ö
.ŒŒÖ Ü
NopIdŒŒÜ ã
==ŒŒå é
intŒŒè í
.ŒŒí ì
ParseŒŒì ò
(ŒŒò ô
itemŒŒô ù
)ŒŒù û
&&ŒŒü °
mŒŒ¢ £
.ŒŒ£ §
	IsDeletedŒŒ§ ≠
==ŒŒÆ ∞
$numŒŒ± ≤
)ŒŒ≤ ≥
.ŒŒ≥ ¥
ToListŒŒ¥ ∫
(ŒŒ∫ ª
)ŒŒª º
;ŒŒº Ω
foreach
œœ$ +
(
œœ, -
var
œœ- 0

itemDetail
œœ1 ;
in
œœ< >
dataAssignDetail
œœ? O
)
œœO P
{
––$ %
var
““( +&
jsonParseReturnAddDetail
““, D
=
““E F
JsonConvert
““G R
.
““R S
DeserializeObject
““S d
<
““d e!
ResultStatusDataInt
““e x
<
““x y"
ResultStatusDataNop““y å
>““å ç
>““ç é
(““é è
$str““è ë
)““ë í
;““í ì
var
””( +
urlAddDetail
””, 8
=
””9 :
	GetConfig
””; D
.
””D E

AppSetting
””E O
[
””O P
$str
””P a
]
””a b
+
””c d
	GetConfig
””e n
.
””n o

AppSetting
””o y
[
””y z
$str””z ë
]””ë í
;””í ì
(
‘‘( )
bool
‘‘) - 
resultApiAddDetail
‘‘. @
,
‘‘@ A
string
‘‘B H
resultAddDetail
‘‘I X
)
‘‘X Y
=
‘‘Z [
RequestToAPI
‘‘\ h
.
‘‘h i!
PostRequestToWebApi
‘‘i |
(
‘‘| }
urlAddDetail‘‘} â
,‘‘â ä
new‘‘ã é
{
’’( )
NopId
÷÷, 1
=
÷÷2 3

dataAssign
÷÷4 >
.
÷÷> ?
IdNopFromApi
÷÷? K
,
÷÷K L
CreditorRef
◊◊, 7
=
◊◊8 9

itemDetail
◊◊: D
.
◊◊D E
CreditorRef
◊◊E P
,
◊◊P Q
Outstanding
ÿÿ, 7
=
ÿÿ8 9

itemDetail
ÿÿ: D
.
ÿÿD E
Outstanding
ÿÿE P
,
ÿÿP Q
	Principal
ŸŸ, 5
=
ŸŸ6 7

itemDetail
ŸŸ8 B
.
ŸŸB C
	Principal
ŸŸC L
,
ŸŸL M
Interest
⁄⁄, 4
=
⁄⁄5 6

itemDetail
⁄⁄7 A
.
⁄⁄A B
Interest
⁄⁄B J
,
⁄⁄J K
Fee
€€, /
=
€€0 1

itemDetail
€€2 <
.
€€< =
Fee
€€= @
}
‹‹( )
,
‹‹) *
null
‹‹+ /
)
‹‹/ 0
;
‹‹0 1
if
››( *
(
››+ , 
resultApiAddDetail
››, >
&&
››? A
!
››B C
string
››C I
.
››I J
IsNullOrEmpty
››J W
(
››W X
resultAddDetail
››X g
)
››g h
)
››h i
{
ﬁﬁ( )&
jsonParseReturnAddDetail
ﬂﬂ, D
=
ﬂﬂE F
JsonConvert
ﬂﬂG R
.
ﬂﬂR S
DeserializeObject
ﬂﬂS d
<
ﬂﬂd e!
ResultStatusDataInt
ﬂﬂe x
<
ﬂﬂx y"
ResultStatusDataNopﬂﬂy å
>ﬂﬂå ç
>ﬂﬂç é
(ﬂﬂé è
resultAddDetailﬂﬂè û
)ﬂﬂû ü
;ﬂﬂü †
if
‡‡, .
(
‡‡/ 0&
jsonParseReturnAddDetail
‡‡0 H
.
‡‡H I

StatusCode
‡‡I S
==
‡‡T V
$num
‡‡W Z
||
‡‡[ ]&
jsonParseReturnAddDetail
‡‡^ v
.
‡‡v w

StatusCode‡‡w Å
==‡‡Ç Ñ
$num‡‡Ö à
)‡‡à â
{
··, -

itemDetail
‚‚0 :
.
‚‚: ; 
IdNopDetailFromApi
‚‚; M
=
‚‚N O&
jsonParseReturnAddDetail
‚‚P h
.
‚‚h i
Data
‚‚i m
.
‚‚m n
Id
‚‚n p
;
‚‚p q
_context
„„0 8
.
„„8 9
Entry
„„9 >
(
„„> ?

itemDetail
„„? I
)
„„I J
.
„„J K
State
„„K P
=
„„Q R
EntityState
„„S ^
.
„„^ _
Modified
„„_ g
;
„„g h
_context
‰‰0 8
.
‰‰8 9
SaveChanges
‰‰9 D
(
‰‰D E
)
‰‰E F
;
‰‰F G
}
ÂÂ, -
else
ÊÊ, 0
{
ÁÁ, -

itemDetail
ËË0 :
.
ËË: ;
	IsDeleted
ËË; D
=
ËËE F
$num
ËËG H
;
ËËH I
_context
ÈÈ0 8
.
ÈÈ8 9
Entry
ÈÈ9 >
(
ÈÈ> ?

itemDetail
ÈÈ? I
)
ÈÈI J
.
ÈÈJ K
State
ÈÈK P
=
ÈÈQ R
EntityState
ÈÈS ^
.
ÈÈ^ _
Modified
ÈÈ_ g
;
ÈÈg h
_context
ÍÍ0 8
.
ÍÍ8 9
SaveChanges
ÍÍ9 D
(
ÍÍD E
)
ÍÍE F
;
ÍÍF G
}
ÎÎ, -
}
ÏÏ( )
}
ÌÌ$ %
List
$ (
<
( )
TblFileUploadNop
) 9
>
9 :
dataAssignFile
; I
=
J K
_context
L T
.
T U
TblFileUploadNops
U f
.
f g
Where
g l
(
l m
m
m n
=>
o q
m
r s
.
s t
IdNop
t y
==
z |
int} Ä
.Ä Å
ParseÅ Ü
(Ü á
itemá ã
)ã å
&&ç è
mê ë
.ë í
	IsDeletedí õ
==ú û
$numü †
)† °
.° ¢
ToList¢ ®
(® ©
)© ™
;™ ´
foreach
ÒÒ$ +
(
ÒÒ, -
var
ÒÒ- 0
itemFile
ÒÒ1 9
in
ÒÒ: <
dataAssignFile
ÒÒ= K
)
ÒÒK L
{
ÚÚ$ %
var
ÛÛ( +
data
ÛÛ, 0
=
ÛÛ1 2
new
ÛÛ3 6
object
ÛÛ7 =
(
ÛÛ= >
)
ÛÛ> ?
;
ÛÛ? @
var
ÙÙ( +
check
ÙÙ, 1
=
ÙÙ2 3
await
ÙÙ4 9
_context
ÙÙ: B
.
ÙÙB C
TblFileUploadNops
ÙÙC T
.
ÙÙT U
Where
ÙÙU Z
(
ÙÙZ [
x
ÙÙ[ \
=>
ÙÙ] _
x
ÙÙ` a
.
ÙÙa b
Id
ÙÙb d
==
ÙÙe g
itemFile
ÙÙh p
.
ÙÙp q
Id
ÙÙq s
)
ÙÙs t
.
ÙÙt u"
FirstOrDefaultAsyncÙÙu à
(ÙÙà â
)ÙÙâ ä
;ÙÙä ã
if
ıı( *
(
ıı+ ,
System
ıı, 2
.
ıı2 3
IO
ıı3 5
.
ıı5 6
File
ıı6 :
.
ıı: ;
Exists
ıı; A
(
ııA B
check
ııB G
.
ııG H
FilePath
ııH P
)
ııP Q
)
ııQ R
{
ˆˆ( )
byte
˜˜, 0
[
˜˜0 1
]
˜˜1 2
	fileBytes
˜˜3 <
=
˜˜= >
System
˜˜? E
.
˜˜E F
IO
˜˜F H
.
˜˜H I
File
˜˜I M
.
˜˜M N
ReadAllBytes
˜˜N Z
(
˜˜Z [
check
˜˜[ `
.
˜˜` a
FilePath
˜˜a i
)
˜˜i j
;
˜˜j k
string
˙˙, 2
base64String
˙˙3 ?
=
˙˙@ A
Convert
˙˙B I
.
˙˙I J
ToBase64String
˙˙J X
(
˙˙X Y
	fileBytes
˙˙Y b
)
˙˙b c
;
˙˙c d
var
˝˝, /)
jsonParseReturnUploadBase64
˝˝0 K
=
˝˝L M
JsonConvert
˝˝N Y
.
˝˝Y Z
DeserializeObject
˝˝Z k
<
˝˝k l!
ResultStatusDataInt
˝˝l 
<˝˝ Ä#
ResultStatusDataNop˝˝Ä ì
>˝˝ì î
>˝˝î ï
(˝˝ï ñ
$str˝˝ñ ò
)˝˝ò ô
;˝˝ô ö
var
˛˛, /
urlUploadBase64
˛˛0 ?
=
˛˛@ A
	GetConfig
˛˛B K
.
˛˛K L

AppSetting
˛˛L V
[
˛˛V W
$str
˛˛W h
]
˛˛h i
+
˛˛j k
	GetConfig
˛˛l u
.
˛˛u v

AppSetting˛˛v Ä
[˛˛Ä Å
$str˛˛Å õ
]˛˛õ ú
+˛˛ù û"
jsonParseReturnAdd˛˛ü ±
.˛˛± ≤
Data˛˛≤ ∂
.˛˛∂ ∑
Id˛˛∑ π
;˛˛π ∫
(
ˇˇ, -
bool
ˇˇ- 1#
resultApiUploadBase64
ˇˇ2 G
,
ˇˇG H
string
ˇˇI O 
resultUploadBase64
ˇˇP b
)
ˇˇb c
=
ˇˇd e
RequestToAPI
ˇˇf r
.
ˇˇr s"
PostRequestToWebApiˇˇs Ü
(ˇˇÜ á
urlUploadBase64ˇˇá ñ
,ˇˇñ ó
newˇˇò õ
{
ÄÄ, -
FileName
ÅÅ0 8
=
ÅÅ9 :
itemFile
ÅÅ; C
.
ÅÅC D
FileName
ÅÅD L
,
ÅÅL M
FileContent
ÇÇ0 ;
=
ÇÇ< =
base64String
ÇÇ> J
,
ÇÇJ K
}
ÉÉ, -
,
ÉÉ- .
null
ÉÉ/ 3
)
ÉÉ3 4
;
ÉÉ4 5
if
ÑÑ, .
(
ÑÑ/ 0#
resultApiUploadBase64
ÑÑ0 E
&&
ÑÑF H
!
ÑÑI J
string
ÑÑJ P
.
ÑÑP Q
IsNullOrEmpty
ÑÑQ ^
(
ÑÑ^ _ 
resultUploadBase64
ÑÑ_ q
)
ÑÑq r
)
ÑÑr s
{
ÖÖ, -)
jsonParseReturnUploadBase64
ÜÜ0 K
=
ÜÜL M
JsonConvert
ÜÜN Y
.
ÜÜY Z
DeserializeObject
ÜÜZ k
<
ÜÜk l!
ResultStatusDataInt
ÜÜl 
<ÜÜ Ä#
ResultStatusDataNopÜÜÄ ì
>ÜÜì î
>ÜÜî ï
(ÜÜï ñ"
resultUploadBase64ÜÜñ ®
)ÜÜ® ©
;ÜÜ© ™
if
áá0 2
(
áá3 4)
jsonParseReturnUploadBase64
áá4 O
.
ááO P

StatusCode
ááP Z
==
áá[ ]
$num
áá^ a
||
ááb d*
jsonParseReturnUploadBase64ááe Ä
.ááÄ Å

StatusCodeááÅ ã
==ááå é
$numááè í
)ááí ì
{
àà0 1
itemFile
ââ4 <
.
ââ< =
IdFileFromApi
ââ= J
=
ââK L)
jsonParseReturnUploadBase64
ââM h
.
ââh i
Data
ââi m
.
ââm n
Key
âân q
;
ââq r
_context
ää4 <
.
ää< =
Entry
ää= B
(
ääB C
itemFile
ääC K
)
ääK L
.
ääL M
State
ääM R
=
ääS T
EntityState
ääU `
.
ää` a
Modified
ääa i
;
ääi j
_context
ãã4 <
.
ãã< =
SaveChanges
ãã= H
(
ããH I
)
ããI J
;
ããJ K
}
åå0 1
}
çç, -
}
¥¥( )
}
µµ$ %
}
∂∂  !
}
∏∏ 
}
ππ 
}
∫∫ 
return
ªª 
Content
ªª "
(
ªª" #
$str
ªª# %
)
ªª% &
;
ªª& '
}
ºº 
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ 
ex
ΩΩ 
)
ΩΩ  
{
ææ 
return
øø 
Content
øø 
(
øø 
$str
øø 4
)
øø4 5
;
øø5 6
}
¿¿ 
}
¡¡ 	
[
≈≈ 	
HttpPost
≈≈	 
]
≈≈ 
public
∆∆ 
async
∆∆ 
Task
∆∆ 
CheckToDeva
∆∆ %
(
∆∆% &
)
∆∆& '
{
«« 	
try
»» 
{
…… 
List
   
<
    
TblNoticeOfPayment
   '
>
  ' (
data
  ) -
=
  . /
_context
  0 8
.
  8 9!
TblNoticeOfPayments
  9 L
.
  L M
Where
  M R
(
  R S
m
  S T
=>
  U W
m
  X Y
.
  Y Z
Status
  Z `
==
  a c
$str
  d p
)
  p q
.
  q r
ToList
  r x
(
  x y
)
  y z
;
  z {
List
ÃÃ 
<
ÃÃ 
string
ÃÃ 
>
ÃÃ 
dataId
ÃÃ #
=
ÃÃ$ %
_context
ÃÃ& .
.
ÃÃ. /!
TblNoticeOfPayments
ÃÃ/ B
.
ÃÃB C
Where
ÃÃC H
(
ÃÃH I
m
ÃÃI J
=>
ÃÃK M
m
ÃÃN O
.
ÃÃO P
Status
ÃÃP V
==
ÃÃW Y
$str
ÃÃZ f
)
ÃÃf g
.
ÃÃg h
Select
ÃÃh n
(
ÃÃn o
m
ÃÃo p
=>
ÃÃq s
m
ÃÃt u
.
ÃÃu v
IdNopFromApiÃÃv Ç
)ÃÃÇ É
.ÃÃÉ Ñ
ToListÃÃÑ ä
(ÃÃä ã
)ÃÃã å
;ÃÃå ç
string
ŒŒ 
formattedData
ŒŒ $
=
ŒŒ% &
$"
ŒŒ' )
$str
ŒŒ) +
{
ŒŒ+ ,
string
ŒŒ, 2
.
ŒŒ2 3
Join
ŒŒ3 7
(
ŒŒ7 8
$str
ŒŒ8 =
,
ŒŒ= >
dataId
ŒŒ? E
)
ŒŒE F
}
ŒŒF G
$str
ŒŒG I
"
ŒŒI J
;
ŒŒJ K
var
–– "
jsonParseReturnCheck
–– (
=
––) *
JsonConvert
––+ 6
.
––6 7
DeserializeObject
––7 H
<
––H I!
ResultStatusDataInt
––I \
<
––\ ]*
NoticeOfPaymentJOB_ViewModel
––] y
>
––y z
>
––z {
(
––{ |
$str
––| ~
)
––~ 
;–– Ä
var
—— 
urlCheck
—— 
=
—— 
	GetConfig
—— (
.
——( )

AppSetting
——) 3
[
——3 4
$str
——4 E
]
——E F
+
——G H
	GetConfig
——I R
.
——R S

AppSetting
——S ]
[
——] ^
$str
——^ s
]
——s t
+
——u v
$str——w Ö
+——Ü á
formattedData——à ï
;——ï ñ
(
““ 
bool
““ 
resultApiCheck
““ $
,
““$ %
string
““& ,
resultCheck
““- 8
)
““8 9
=
““: ;
RequestToAPI
““< H
.
““H I!
GetJsonStringWebApi
““I \
(
““\ ]
urlCheck
““] e
,
““e f
null
““g k
)
““k l
;
““l m
if
”” 
(
”” 
resultApiCheck
”” "
&&
””# %
!
””& '
string
””' -
.
””- .
IsNullOrEmpty
””. ;
(
””; <
resultCheck
””< G
)
””G H
)
””H I
{
‘‘ "
jsonParseReturnCheck
’’ (
=
’’) *
JsonConvert
’’+ 6
.
’’6 7
DeserializeObject
’’7 H
<
’’H I!
ResultStatusDataInt
’’I \
<
’’\ ]*
NoticeOfPaymentJOB_ViewModel
’’] y
>
’’y z
>
’’z {
(
’’{ |
resultCheck’’| á
)’’á à
;’’à â
if
◊◊ 
(
◊◊ "
jsonParseReturnCheck
◊◊ ,
.
◊◊, -
Value
◊◊- 2
!=
◊◊3 5
null
◊◊6 :
)
◊◊: ;
{
ÿÿ 
foreach
ŸŸ 
(
ŸŸ  !
var
ŸŸ! $
item
ŸŸ% )
in
ŸŸ* ,
data
ŸŸ- 1
)
ŸŸ1 2
{
⁄⁄ 
var
€€ 
updatedStatus
€€  -
=
€€. /"
jsonParseReturnCheck
€€0 D
.
€€D E
Value
€€E J
.
€€J K
FirstOrDefault
€€K Y
(
€€Y Z
m
€€Z [
=>
€€\ ^
m
€€_ `
.
€€` a
Id
€€a c
==
€€d f
item
€€g k
.
€€k l
IdNopFromApi
€€l x
)
€€x y
;
€€y z
if
‹‹ 
(
‹‹  
updatedStatus
‹‹  -
!=
‹‹. 0
null
‹‹1 5
)
‹‹5 6
{
›› 
item
ﬁﬁ  $
.
ﬁﬁ$ %
Status
ﬁﬁ% +
=
ﬁﬁ, -
updatedStatus
ﬁﬁ. ;
.
ﬁﬁ; <
Status
ﬁﬁ< B
;
ﬁﬁB C
item
ﬂﬂ  $
.
ﬂﬂ$ %
UpdatedTime
ﬂﬂ% 0
=
ﬂﬂ1 2
DateTime
ﬂﬂ3 ;
.
ﬂﬂ; <
Now
ﬂﬂ< ?
;
ﬂﬂ? @
_context
‡‡  (
.
‡‡( )
Entry
‡‡) .
(
‡‡. /
item
‡‡/ 3
)
‡‡3 4
.
‡‡4 5
State
‡‡5 :
=
‡‡; <
EntityState
‡‡= H
.
‡‡H I
Modified
‡‡I Q
;
‡‡Q R
_context
··  (
.
··( )
SaveChanges
··) 4
(
··4 5
)
··5 6
;
··6 7
}
‚‚ 
}
„„ 
}
‰‰ 
}
ÂÂ 
}
ÊÊ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
ex
ÁÁ 
)
ÁÁ  
{
ËË 
throw
ÈÈ 
;
ÈÈ 
}
ÍÍ 
}
ÎÎ 	
[
ÏÏ 	
HttpPost
ÏÏ	 
]
ÏÏ 
public
ÌÌ 
async
ÌÌ 
Task
ÌÌ 
CheckToDevaOld
ÌÌ (
(
ÌÌ( )
)
ÌÌ) *
{
ÓÓ 	
try
ÔÔ 
{
 
List
ÒÒ 
<
ÒÒ  
TblNoticeOfPayment
ÒÒ '
>
ÒÒ' (
data
ÒÒ) -
=
ÒÒ. /
_context
ÒÒ0 8
.
ÒÒ8 9!
TblNoticeOfPayments
ÒÒ9 L
.
ÒÒL M
Where
ÒÒM R
(
ÒÒR S
m
ÒÒS T
=>
ÒÒU W
m
ÒÒX Y
.
ÒÒY Z
Status
ÒÒZ `
==
ÒÒa c
$str
ÒÒd p
)
ÒÒp q
.
ÒÒq r
ToList
ÒÒr x
(
ÒÒx y
)
ÒÒy z
;
ÒÒz {
foreach
ÚÚ 
(
ÚÚ 
var
ÚÚ 
item
ÚÚ !
in
ÚÚ" $
data
ÚÚ% )
)
ÚÚ) *
{
ÛÛ 
if
ıı 
(
ıı 
item
ıı 
.
ıı 
IdNopFromApi
ıı )
!=
ıı* ,
null
ıı- 1
)
ıı1 2
{
ˆˆ 
var
˜˜ 

dataAssign
˜˜ &
=
˜˜' (
await
˜˜) .
_context
˜˜/ 7
.
˜˜7 8!
TblNoticeOfPayments
˜˜8 K
.
˜˜K L
Where
˜˜L Q
(
˜˜Q R
m
˜˜R S
=>
˜˜T V
m
˜˜W X
.
˜˜X Y
Id
˜˜Y [
==
˜˜\ ^
item
˜˜_ c
.
˜˜c d
Id
˜˜d f
&&
˜˜g i
m
˜˜j k
.
˜˜k l
	IsDeleted
˜˜l u
==
˜˜v x
$num
˜˜y z
)
˜˜z {
.
˜˜{ |"
FirstOrDefaultAsync˜˜| è
(˜˜è ê
)˜˜ê ë
;˜˜ë í
var
¯¯ "
jsonParseReturnCheck
¯¯ 0
=
¯¯1 2
JsonConvert
¯¯3 >
.
¯¯> ?
DeserializeObject
¯¯? P
<
¯¯P Q!
ResultStatusDataInt
¯¯Q d
<
¯¯d e!
ResultStatusDataNop
¯¯e x
>
¯¯x y
>
¯¯y z
(
¯¯z {
$str
¯¯{ }
)
¯¯} ~
;
¯¯~ 
var
˘˘ 
urlCheck
˘˘ $
=
˘˘% &
	GetConfig
˘˘' 0
.
˘˘0 1

AppSetting
˘˘1 ;
[
˘˘; <
$str
˘˘< M
]
˘˘M N
+
˘˘O P
	GetConfig
˘˘Q Z
.
˘˘Z [

AppSetting
˘˘[ e
[
˘˘e f
$str
˘˘f 
]˘˘ Ä
+˘˘Å Ç

dataAssign˘˘É ç
.˘˘ç é
IdNopFromApi˘˘é ö
;˘˘ö õ
(
˙˙ 
bool
˙˙ 
resultApiCheck
˙˙ ,
,
˙˙, -
string
˙˙. 4
resultCheck
˙˙5 @
)
˙˙@ A
=
˙˙B C
RequestToAPI
˙˙D P
.
˙˙P Q!
GetJsonStringWebApi
˙˙Q d
(
˙˙d e
urlCheck
˙˙e m
,
˙˙m n
null
˙˙o s
)
˙˙s t
;
˙˙t u
if
˚˚ 
(
˚˚ 
resultApiCheck
˚˚ *
&&
˚˚+ -
!
˚˚. /
string
˚˚/ 5
.
˚˚5 6
IsNullOrEmpty
˚˚6 C
(
˚˚C D
resultCheck
˚˚D O
)
˚˚O P
)
˚˚P Q
{
¸¸ "
jsonParseReturnCheck
˝˝ 0
=
˝˝1 2
JsonConvert
˝˝3 >
.
˝˝> ?
DeserializeObject
˝˝? P
<
˝˝P Q!
ResultStatusDataInt
˝˝Q d
<
˝˝d e!
ResultStatusDataNop
˝˝e x
>
˝˝x y
>
˝˝y z
(
˝˝z {
resultCheck˝˝{ Ü
)˝˝Ü á
;˝˝á à
if
˛˛ 
(
˛˛  "
jsonParseReturnCheck
˛˛  4
.
˛˛4 5

StatusCode
˛˛5 ?
==
˛˛@ B
$num
˛˛C F
||
˛˛G I"
jsonParseReturnCheck
˛˛J ^
.
˛˛^ _

StatusCode
˛˛_ i
==
˛˛j l
$num
˛˛m p
)
˛˛p q
{
ˇˇ 
if
ÄÄ  "
(
ÄÄ# $"
jsonParseReturnCheck
ÄÄ$ 8
.
ÄÄ8 9
Data
ÄÄ9 =
.
ÄÄ= >
Status
ÄÄ> D
==
ÄÄE G
$str
ÄÄH R
)
ÄÄR S
{
ÅÅ  !
item
ÇÇ$ (
.
ÇÇ( )
Status
ÇÇ) /
=
ÇÇ0 1"
jsonParseReturnCheck
ÇÇ2 F
.
ÇÇF G
Data
ÇÇG K
.
ÇÇK L
Status
ÇÇL R
;
ÇÇR S
_context
ÉÉ$ ,
.
ÉÉ, -
Entry
ÉÉ- 2
(
ÉÉ2 3
item
ÉÉ3 7
)
ÉÉ7 8
.
ÉÉ8 9
State
ÉÉ9 >
=
ÉÉ? @
EntityState
ÉÉA L
.
ÉÉL M
Modified
ÉÉM U
;
ÉÉU V
_context
ÑÑ$ ,
.
ÑÑ, -
SaveChanges
ÑÑ- 8
(
ÑÑ8 9
)
ÑÑ9 :
;
ÑÑ: ;
}
ÖÖ  !
}
ÜÜ 
}
áá 
}
àà 
}
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
åå 
throw
çç 
;
çç 
}
éé 
}
èè 	
public
ìì 
async
ìì 
Task
ìì 
<
ìì 
IActionResult
ìì '
>
ìì' (
PrintExcelNoP
ìì) 6
(
ìì6 7
string
ìì7 =
Tanggal
ìì> E
,
ììE F
string
ììF L
	TypeExcel
ììM V
)
ììV W
{
îî 	
if
ïï 
(
ïï 
!
ïï 
lastSession
ïï 
.
ïï 
Update
ïï #
(
ïï# $
)
ïï$ %
)
ïï% &
{
ññ 
return
óó 
RedirectToAction
óó '
(
óó' (
$str
óó( /
,
óó/ 0
	GetConfig
óó1 :
.
óó: ;

AppSetting
óó; E
[
óóE F
$str
óóF n
]
óón o
+
óóp q
$str
óór y
,
óóy z
new
óó{ ~
{óó Ä
aóóÅ Ç
=óóÉ Ñ
trueóóÖ â
}óóä ã
)óóã å
;óóå ç
}
òò 
var
ôô 
location
ôô 
=
ôô 
new
ôô 
Uri
ôô "
(
ôô" #
$"
ôô# %
{
ôô% &
Request
ôô& -
.
ôô- .
Scheme
ôô. 4
}
ôô4 5
$str
ôô5 8
{
ôô8 9
Request
ôô9 @
.
ôô@ A
Host
ôôA E
}
ôôE F
{
ôôF G
Request
ôôG N
.
ôôN O
Path
ôôO S
}
ôôS T
"
ôôT U
)
ôôU V
;
ôôV W
string
öö 
path
öö 
=
öö 
location
öö "
.
öö" #
AbsolutePath
öö# /
.
öö/ 0
Replace
öö0 7
(
öö7 8
this
öö8 <
.
öö< =
ControllerContext
öö= N
.
ööN O
	RouteData
ööO X
.
ööX Y
Values
ööY _
[
öö_ `
$str
öö` h
]
ööh i
.
ööi j
ToString
ööj r
(
öör s
)
öös t
,
ööt u
$str
ööv }
)
öö} ~
;
öö~ 
if
õõ 
(
õõ 
!
õõ 
accessSecurity
õõ 
.
õõ  
IsGetAccess
õõ  +
(
õõ+ ,
$str
õõ, 0
+
õõ1 2
path
õõ3 7
)
õõ7 8
)
õõ8 9
{
úú 
return
ùù 
RedirectToAction
ùù '
(
ùù' (
$str
ùù( 3
,
ùù3 4
$str
ùù5 <
)
ùù< =
;
ùù= >
}
ûû 
var
†† 

insertData
†† 
=
†† 
new
††   
TblDownloadBigFile
††! 3
(
††3 4
)
††4 5
;
††5 6
try
¢¢ 
{
££ 
var
§§ 
req
§§ 
=
§§ 
new
§§ 
{
§§ 
	TypeExcel
§§  )
=
§§* +
	TypeExcel
§§, 5
}
§§6 7
;
§§7 8
var
¶¶ 
regex
¶¶ 
=
¶¶ 
await
¶¶ !
RegexRequest
¶¶" .
.
¶¶. /
RegexValidation
¶¶/ >
(
¶¶> ?
req
¶¶? B
)
¶¶B C
;
¶¶C D
if
ßß 
(
ßß 
!
ßß 
regex
ßß 
)
ßß 
{
®® 
return
©© 
Content
©© "
(
©©" #
$str
©©# 1
)
©©1 2
;
©©2 3
}
™™ 

insertData
¨¨ 
.
¨¨ 
Path
¨¨ 
=
¨¨  !
	GetConfig
¨¨" +
.
¨¨+ ,

AppSetting
¨¨, 6
[
¨¨6 7
$str
¨¨7 =
]
¨¨= >
+
¨¨? @
$str
¨¨A T
+
¨¨U V
DateTime
¨¨W _
.
¨¨_ `
Now
¨¨` c
.
¨¨c d
ToString
¨¨d l
(
¨¨l m
$str¨¨m Ä
)¨¨Ä Å
+¨¨Ç É
$str¨¨Ñ á
+¨¨à â
	TypeExcel¨¨ä ì
;¨¨ì î

insertData
≠≠ 
.
≠≠ 
FileName
≠≠ #
=
≠≠$ %
$str
≠≠& 9
+
≠≠: ;
DateTime
≠≠< D
.
≠≠D E
Now
≠≠E H
.
≠≠H I
ToString
≠≠I Q
(
≠≠Q R
$str
≠≠R e
)
≠≠e f
;
≠≠f g

insertData
ÆÆ 
.
ÆÆ 
StatusDownload
ÆÆ )
=
ÆÆ* +
$num
ÆÆ, -
;
ÆÆ- .

insertData
ØØ 
.
ØØ 
FileExt
ØØ "
=
ØØ# $
$str
ØØ% +
;
ØØ+ ,

insertData
∞∞ 
.
∞∞ 
CreatedTime
∞∞ &
=
∞∞' (
DateTime
∞∞) 1
.
∞∞1 2
Now
∞∞2 5
;
∞∞5 6

insertData
±± 
.
±± 
CreatedById
±± &
=
±±' (
int
±±) ,
.
±±, -
Parse
±±- 2
(
±±2 3
HttpContext
±±3 >
.
±±> ?
Session
±±? F
.
±±F G
	GetString
±±G P
(
±±P Q
SessionConstan
±±Q _
.
±±_ `
Session_UserId
±±` n
)
±±n o
)
±±o p
;
±±p q
await
≤≤ 
_context
≤≤ 
.
≤≤ !
TblDownloadBigFiles
≤≤ 2
.
≤≤2 3
AddAsync
≤≤3 ;
(
≤≤; <

insertData
≤≤< F
)
≤≤F G
;
≤≤G H
await
≥≥ 
_context
≥≥ 
.
≥≥ 
SaveChangesAsync
≥≥ /
(
≥≥/ 0
)
≥≥0 1
;
≥≥1 2
var
µµ 
print
µµ 
=
µµ 
new
µµ 
PrintExport
µµ  +
(
µµ+ ,

_converter
µµ, 6
)
µµ6 7
;
µµ7 8
Task
∂∂ 
.
∂∂ 
Run
∂∂ 
(
∂∂ 
(
∂∂ 
)
∂∂ 
=>
∂∂ 
print
∂∂ $
.
∂∂$ %
PrintNoPExcel
∂∂% 2
(
∂∂2 3
	TypeExcel
∂∂3 <
,
∂∂< =

insertData
∂∂> H
.
∂∂H I
FileName
∂∂I Q
,
∂∂Q R

insertData
∂∂S ]
.
∂∂] ^
Id
∂∂^ `
,
∂∂` a
Tanggal
∂∂b i
)
∂∂i j
)
∂∂j k
;
∂∂k l
return
∑∑ 
Content
∑∑ 
(
∑∑ 
$str
∑∑ o
)
∑∑o p
;
∑∑p q
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ 
ex
ππ 
)
ππ  
{
∫∫ 
throw
ªª 
;
ªª 
}
ºº 
}
ΩΩ 	
public
ææ 
async
ææ 
Task
ææ 
<
ææ 
IActionResult
ææ '
>
ææ' (
PrintPDFNoP
ææ) 4
(
ææ4 5
string
ææ5 ;
Tanggal
ææ< C
)
ææC D
{
øø 	
if
¿¿ 
(
¿¿ 
!
¿¿ 
lastSession
¿¿ 
.
¿¿ 
Update
¿¿ #
(
¿¿# $
)
¿¿$ %
)
¿¿% &
{
¡¡ 
return
¬¬ 
RedirectToAction
¬¬ '
(
¬¬' (
$str
¬¬( /
,
¬¬/ 0
	GetConfig
¬¬1 :
.
¬¬: ;

AppSetting
¬¬; E
[
¬¬E F
$str
¬¬F n
]
¬¬n o
+
¬¬p q
$str
¬¬r y
,
¬¬y z
new
¬¬{ ~
{¬¬ Ä
a¬¬Å Ç
=¬¬É Ñ
true¬¬Ö â
}¬¬ä ã
)¬¬ã å
;¬¬å ç
}
√√ 
var
ƒƒ 
location
ƒƒ 
=
ƒƒ 
new
ƒƒ 
Uri
ƒƒ "
(
ƒƒ" #
$"
ƒƒ# %
{
ƒƒ% &
Request
ƒƒ& -
.
ƒƒ- .
Scheme
ƒƒ. 4
}
ƒƒ4 5
$str
ƒƒ5 8
{
ƒƒ8 9
Request
ƒƒ9 @
.
ƒƒ@ A
Host
ƒƒA E
}
ƒƒE F
{
ƒƒF G
Request
ƒƒG N
.
ƒƒN O
Path
ƒƒO S
}
ƒƒS T
"
ƒƒT U
)
ƒƒU V
;
ƒƒV W
string
≈≈ 
path
≈≈ 
=
≈≈ 
location
≈≈ "
.
≈≈" #
AbsolutePath
≈≈# /
.
≈≈/ 0
Replace
≈≈0 7
(
≈≈7 8
this
≈≈8 <
.
≈≈< =
ControllerContext
≈≈= N
.
≈≈N O
	RouteData
≈≈O X
.
≈≈X Y
Values
≈≈Y _
[
≈≈_ `
$str
≈≈` h
]
≈≈h i
.
≈≈i j
ToString
≈≈j r
(
≈≈r s
)
≈≈s t
,
≈≈t u
$str
≈≈v }
)
≈≈} ~
;
≈≈~ 
if
∆∆ 
(
∆∆ 
!
∆∆ 
accessSecurity
∆∆ 
.
∆∆  
IsGetAccess
∆∆  +
(
∆∆+ ,
$str
∆∆, 0
+
∆∆1 2
path
∆∆3 7
)
∆∆7 8
)
∆∆8 9
{
«« 
return
»» 
RedirectToAction
»» '
(
»»' (
$str
»»( 3
,
»»3 4
$str
»»5 <
)
»»< =
;
»»= >
}
…… 
var
ÀÀ 

insertData
ÀÀ 
=
ÀÀ 
new
ÀÀ   
TblDownloadBigFile
ÀÀ! 3
(
ÀÀ3 4
)
ÀÀ4 5
;
ÀÀ5 6
try
ÕÕ 
{
ŒŒ 
var
œœ 
req
œœ 
=
œœ 
new
œœ 
{
œœ 
tanggal
œœ  '
=
œœ( )
Tanggal
œœ* 1
}
œœ2 3
;
œœ3 4
var
—— 
regex
—— 
=
—— 
await
—— !
RegexRequest
——" .
.
——. /
RegexValidation
——/ >
(
——> ?
req
——? B
)
——B C
;
——C D
if
““ 
(
““ 
!
““ 
regex
““ 
)
““ 
{
”” 
return
‘‘ 
Content
‘‘ "
(
‘‘" #
$str
‘‘# 1
)
‘‘1 2
;
‘‘2 3
}
’’ 

insertData
ŸŸ 
.
ŸŸ 
Path
ŸŸ 
=
ŸŸ  !
	GetConfig
ŸŸ" +
.
ŸŸ+ ,

AppSetting
ŸŸ, 6
[
ŸŸ6 7
$str
ŸŸ7 =
]
ŸŸ= >
+
ŸŸ? @
$str
ŸŸA R
+
ŸŸS T
DateTime
ŸŸU ]
.
ŸŸ] ^
Now
ŸŸ^ a
.
ŸŸa b
ToString
ŸŸb j
(
ŸŸj k
$str
ŸŸk ~
)
ŸŸ~ 
+ŸŸÄ Å
$strŸŸÇ à
;ŸŸà â

insertData
⁄⁄ 
.
⁄⁄ 
FileName
⁄⁄ #
=
⁄⁄$ %
$str
⁄⁄& 7
+
⁄⁄8 9
DateTime
⁄⁄: B
.
⁄⁄B C
Now
⁄⁄C F
.
⁄⁄F G
ToString
⁄⁄G O
(
⁄⁄O P
$str
⁄⁄P c
)
⁄⁄c d
;
⁄⁄d e

insertData
€€ 
.
€€ 
StatusDownload
€€ )
=
€€* +
$num
€€, -
;
€€- .

insertData
‹‹ 
.
‹‹ 
FileExt
‹‹ "
=
‹‹# $
$str
‹‹% *
;
‹‹* +

insertData
›› 
.
›› 
CreatedTime
›› &
=
››' (
DateTime
››) 1
.
››1 2
Now
››2 5
;
››5 6

insertData
ﬁﬁ 
.
ﬁﬁ 
CreatedById
ﬁﬁ &
=
ﬁﬁ' (
int
ﬁﬁ) ,
.
ﬁﬁ, -
Parse
ﬁﬁ- 2
(
ﬁﬁ2 3
HttpContext
ﬁﬁ3 >
.
ﬁﬁ> ?
Session
ﬁﬁ? F
.
ﬁﬁF G
	GetString
ﬁﬁG P
(
ﬁﬁP Q
SessionConstan
ﬁﬁQ _
.
ﬁﬁ_ `
Session_UserId
ﬁﬁ` n
)
ﬁﬁn o
)
ﬁﬁo p
;
ﬁﬁp q
await
ﬂﬂ 
_context
ﬂﬂ 
.
ﬂﬂ !
TblDownloadBigFiles
ﬂﬂ 2
.
ﬂﬂ2 3
AddAsync
ﬂﬂ3 ;
(
ﬂﬂ; <

insertData
ﬂﬂ< F
)
ﬂﬂF G
;
ﬂﬂG H
await
‡‡ 
_context
‡‡ 
.
‡‡ 
SaveChangesAsync
‡‡ /
(
‡‡/ 0
)
‡‡0 1
;
‡‡1 2
var
‚‚ 
print
‚‚ 
=
‚‚ 
new
‚‚ 
PrintExport
‚‚  +
(
‚‚+ ,

_converter
‚‚, 6
)
‚‚6 7
;
‚‚7 8
var
„„ 
namaPegawai
„„ 
=
„„  !
HttpContext
„„" -
.
„„- .
Session
„„. 5
.
„„5 6
	GetString
„„6 ?
(
„„? @
SessionConstan
„„@ N
.
„„N O
Session_Name
„„O [
)
„„[ \
;
„„\ ]
var
‰‰ 
requestScheme
‰‰ !
=
‰‰" #
Request
‰‰$ +
.
‰‰+ ,
Scheme
‰‰, 2
;
‰‰2 3
var
ÂÂ 
requestHost
ÂÂ 
=
ÂÂ  !
Request
ÂÂ" )
.
ÂÂ) *
Host
ÂÂ* .
.
ÂÂ. /
ToString
ÂÂ/ 7
(
ÂÂ7 8
)
ÂÂ8 9
;
ÂÂ9 :
Task
ÊÊ 
.
ÊÊ 
Run
ÊÊ 
(
ÊÊ 
(
ÊÊ 
)
ÊÊ 
=>
ÊÊ 
print
ÊÊ $
.
ÊÊ$ %
PrintNoPPDF
ÊÊ% 0
(
ÊÊ0 1
Tanggal
ÊÊ1 8
,
ÊÊ8 9
namaPegawai
ÊÊ: E
,
ÊÊE F
requestScheme
ÊÊG T
,
ÊÊT U
requestHost
ÊÊV a
,
ÊÊa b

insertData
ÊÊc m
.
ÊÊm n
Id
ÊÊn p
)
ÊÊp q
)
ÊÊq r
;
ÊÊr s
return
ÁÁ 
Content
ÁÁ 
(
ÁÁ 
$str
ÁÁ o
)
ÁÁo p
;
ÁÁp q
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
var
ÏÏ 
log
ÏÏ 
=
ÏÏ 
new
ÏÏ 
TblLogErrorPrint
ÏÏ .
(
ÏÏ. /
)
ÏÏ/ 0
;
ÏÏ0 1
log
ÌÌ 
.
ÌÌ 
IdFile
ÌÌ 
=
ÌÌ 

insertData
ÌÌ '
.
ÌÌ' (
Id
ÌÌ( *
;
ÌÌ* +
log
ÓÓ 
.
ÓÓ 
ErrorMessage
ÓÓ  
=
ÓÓ! "
ex
ÓÓ# %
.
ÓÓ% &
Message
ÓÓ& -
+
ÓÓ. /
$str
ÓÓ0 5
+
ÓÓ6 7
ex
ÓÓ8 :
.
ÓÓ: ;
InnerException
ÓÓ; I
;
ÓÓI J
log
ÔÔ 
.
ÔÔ 
CreatedTime
ÔÔ 
=
ÔÔ  !
DateTime
ÔÔ" *
.
ÔÔ* +
Now
ÔÔ+ .
;
ÔÔ. /
await
 
_context
 
.
 
TblLogErrorPrints
 0
.
0 1
AddAsync
1 9
(
9 :
log
: =
)
= >
;
> ?
await
ÒÒ 
_context
ÒÒ 
.
ÒÒ 
SaveChangesAsync
ÒÒ /
(
ÒÒ/ 0
)
ÒÒ0 1
;
ÒÒ1 2
throw
ÚÚ 
;
ÚÚ 
}
ÛÛ 
}
ÙÙ 	
public
¯¯ 
async
¯¯ 
Task
¯¯ 
<
¯¯ 
object
¯¯  
>
¯¯  !'
DownloadFilePendukungTemp
¯¯" ;
(
¯¯; <
int
¯¯< ?
id
¯¯@ B
)
¯¯B C
{
˘˘ 	
if
˚˚ 
(
˚˚ 
!
˚˚ 
lastSession
˚˚ 
.
˚˚ 
Update
˚˚ #
(
˚˚# $
)
˚˚$ %
)
˚˚% &
{
¸¸ 
return
˝˝ 
RedirectToAction
˝˝ '
(
˝˝' (
$str
˝˝( /
,
˝˝/ 0
$str
˝˝1 8
,
˝˝8 9
new
˝˝: =
{
˝˝> ?
a
˝˝@ A
=
˝˝B C
true
˝˝D H
}
˝˝I J
)
˝˝J K
;
˝˝K L
}
˛˛ 
var
ˇˇ 
location
ˇˇ 
=
ˇˇ 
new
ˇˇ 
Uri
ˇˇ "
(
ˇˇ" #
$"
ˇˇ# %
{
ˇˇ% &
Request
ˇˇ& -
.
ˇˇ- .
Scheme
ˇˇ. 4
}
ˇˇ4 5
$str
ˇˇ5 8
{
ˇˇ8 9
Request
ˇˇ9 @
.
ˇˇ@ A
Host
ˇˇA E
}
ˇˇE F
{
ˇˇF G
Request
ˇˇG N
.
ˇˇN O
Path
ˇˇO S
}
ˇˇS T
"
ˇˇT U
)
ˇˇU V
;
ˇˇV W
string
ÄÄ 
Patha
ÄÄ 
=
ÄÄ 
location
ÄÄ #
.
ÄÄ# $
AbsolutePath
ÄÄ$ 0
.
ÄÄ0 1
Replace
ÄÄ1 8
(
ÄÄ8 9
this
ÄÄ9 =
.
ÄÄ= >
ControllerContext
ÄÄ> O
.
ÄÄO P
	RouteData
ÄÄP Y
.
ÄÄY Z
Values
ÄÄZ `
[
ÄÄ` a
$str
ÄÄa i
]
ÄÄi j
.
ÄÄj k
ToString
ÄÄk s
(
ÄÄs t
)
ÄÄt u
,
ÄÄu v
$str
ÄÄw ~
)
ÄÄ~ 
;ÄÄ Ä
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
accessSecurity
ÅÅ 
.
ÅÅ  
IsGetAccess
ÅÅ  +
(
ÅÅ+ ,
$str
ÅÅ, 0
+
ÅÅ1 2
Patha
ÅÅ3 8
)
ÅÅ8 9
)
ÅÅ9 :
{
ÇÇ 
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( 3
,
ÉÉ3 4
$str
ÉÉ5 <
)
ÉÉ< =
;
ÉÉ= >
}
ÑÑ 
try
ÜÜ 
{
áá 
var
ââ 
data
ââ 
=
ââ 
new
ââ 
object
ââ %
(
ââ% &
)
ââ& '
;
ââ' (
var
ää 
check
ää 
=
ää 
await
ää !
_context
ää" *
.
ää* +#
TblFileUploadNopTemps
ää+ @
.
ää@ A
Where
ääA F
(
ääF G
x
ääG H
=>
ääI K
x
ääL M
.
ääM N
Id
ääN P
==
ääQ S
id
ääT V
)
ääV W
.
ääW X!
FirstOrDefaultAsync
ääX k
(
ääk l
)
ääl m
;
ääm n
if
ãã 
(
ãã 
System
ãã 
.
ãã 
IO
ãã 
.
ãã 
File
ãã "
.
ãã" #
Exists
ãã# )
(
ãã) *
check
ãã* /
.
ãã/ 0
FilePath
ãã0 8
)
ãã8 9
)
ãã9 :
{
åå 
byte
éé 
[
éé 
]
éé 
	fileBytes
éé $
=
éé% &
System
éé' -
.
éé- .
IO
éé. 0
.
éé0 1
File
éé1 5
.
éé5 6
ReadAllBytes
éé6 B
(
ééB C
check
ééC H
.
ééH I
FilePath
ééI Q
)
ééQ R
;
ééR S
Response
ëë 
.
ëë 
Headers
ëë $
.
ëë$ %
Add
ëë% (
(
ëë( )
$str
ëë) >
,
ëë> ?
$str
ëë@ Y
+
ëëZ [
check
ëë\ a
.
ëëa b
FileName
ëëb j
+
ëëk l
$str
ëëm p
+
ëëq r
check
ëës x
.
ëëx y
FileExtëëy Ä
+ëëÅ Ç
$strëëÉ á
)ëëá à
;ëëà â
Response
íí 
.
íí 
Headers
íí $
.
íí$ %
Add
íí% (
(
íí( )
$str
íí) 7
,
íí7 8
$str
íí9 S
)
ííS T
;
ííT U
return
ïï 
File
ïï 
(
ïï  
	fileBytes
ïï  )
,
ïï) *
$str
ïï+ E
)
ïïE F
;
ïïF G
}
ññ 
else
óó 
{
òò 
return
ôô 
NotFound
ôô #
(
ôô# $
$str
ôô$ 4
)
ôô4 5
;
ôô5 6
}
öö 
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
Ex
úú 
)
úú  
{
ùù 
return
ûû 
Content
ûû 
(
ûû 
Ex
ûû !
.
ûû! "
Message
ûû" )
.
ûû) *
ToString
ûû* 2
(
ûû2 3
)
ûû3 4
)
ûû4 5
;
ûû5 6
}
üü 
}
†† 	
public
°° 
async
°° 
Task
°° 
<
°° 
object
°°  
>
°°  !#
DownloadFilePendukung
°°" 7
(
°°7 8
int
°°8 ;
id
°°< >
)
°°> ?
{
¢¢ 	
if
§§ 
(
§§ 
!
§§ 
lastSession
§§ 
.
§§ 
Update
§§ #
(
§§# $
)
§§$ %
)
§§% &
{
•• 
return
¶¶ 
RedirectToAction
¶¶ '
(
¶¶' (
$str
¶¶( /
,
¶¶/ 0
$str
¶¶1 8
,
¶¶8 9
new
¶¶: =
{
¶¶> ?
a
¶¶@ A
=
¶¶B C
true
¶¶D H
}
¶¶I J
)
¶¶J K
;
¶¶K L
}
ßß 
var
®® 
location
®® 
=
®® 
new
®® 
Uri
®® "
(
®®" #
$"
®®# %
{
®®% &
Request
®®& -
.
®®- .
Scheme
®®. 4
}
®®4 5
$str
®®5 8
{
®®8 9
Request
®®9 @
.
®®@ A
Host
®®A E
}
®®E F
{
®®F G
Request
®®G N
.
®®N O
Path
®®O S
}
®®S T
"
®®T U
)
®®U V
;
®®V W
string
©© 
Patha
©© 
=
©© 
location
©© #
.
©©# $
AbsolutePath
©©$ 0
.
©©0 1
Replace
©©1 8
(
©©8 9
this
©©9 =
.
©©= >
ControllerContext
©©> O
.
©©O P
	RouteData
©©P Y
.
©©Y Z
Values
©©Z `
[
©©` a
$str
©©a i
]
©©i j
.
©©j k
ToString
©©k s
(
©©s t
)
©©t u
,
©©u v
$str
©©w ~
)
©©~ 
;©© Ä
if
™™ 
(
™™ 
!
™™ 
accessSecurity
™™ 
.
™™  
IsGetAccess
™™  +
(
™™+ ,
$str
™™, 0
+
™™1 2
Patha
™™3 8
)
™™8 9
)
™™9 :
{
´´ 
return
¨¨ 
RedirectToAction
¨¨ '
(
¨¨' (
$str
¨¨( 3
,
¨¨3 4
$str
¨¨5 <
)
¨¨< =
;
¨¨= >
}
≠≠ 
try
ØØ 
{
∞∞ 
var
≤≤ 
data
≤≤ 
=
≤≤ 
new
≤≤ 
object
≤≤ %
(
≤≤% &
)
≤≤& '
;
≤≤' (
var
≥≥ 
check
≥≥ 
=
≥≥ 
await
≥≥ !
_context
≥≥" *
.
≥≥* +
TblFileUploadNops
≥≥+ <
.
≥≥< =
Where
≥≥= B
(
≥≥B C
x
≥≥C D
=>
≥≥E G
x
≥≥H I
.
≥≥I J
Id
≥≥J L
==
≥≥M O
id
≥≥P R
)
≥≥R S
.
≥≥S T!
FirstOrDefaultAsync
≥≥T g
(
≥≥g h
)
≥≥h i
;
≥≥i j
if
¥¥ 
(
¥¥ 
System
¥¥ 
.
¥¥ 
IO
¥¥ 
.
¥¥ 
File
¥¥ "
.
¥¥" #
Exists
¥¥# )
(
¥¥) *
check
¥¥* /
.
¥¥/ 0
FilePath
¥¥0 8
)
¥¥8 9
)
¥¥9 :
{
µµ 
byte
∑∑ 
[
∑∑ 
]
∑∑ 
	fileBytes
∑∑ $
=
∑∑% &
System
∑∑' -
.
∑∑- .
IO
∑∑. 0
.
∑∑0 1
File
∑∑1 5
.
∑∑5 6
ReadAllBytes
∑∑6 B
(
∑∑B C
check
∑∑C H
.
∑∑H I
FilePath
∑∑I Q
)
∑∑Q R
;
∑∑R S
Response
∫∫ 
.
∫∫ 
Headers
∫∫ $
.
∫∫$ %
Add
∫∫% (
(
∫∫( )
$str
∫∫) >
,
∫∫> ?
$str
∫∫@ Y
+
∫∫Z [
check
∫∫\ a
.
∫∫a b
FileName
∫∫b j
+
∫∫k l
$str
∫∫m p
+
∫∫q r
check
∫∫s x
.
∫∫x y
FileExt∫∫y Ä
+∫∫Å Ç
$str∫∫É á
)∫∫á à
;∫∫à â
Response
ªª 
.
ªª 
Headers
ªª $
.
ªª$ %
Add
ªª% (
(
ªª( )
$str
ªª) 7
,
ªª7 8
$str
ªª9 S
)
ªªS T
;
ªªT U
return
ææ 
File
ææ 
(
ææ  
	fileBytes
ææ  )
,
ææ) *
$str
ææ+ E
)
ææE F
;
ææF G
}
øø 
else
¿¿ 
{
¡¡ 
return
¬¬ 
NotFound
¬¬ #
(
¬¬# $
$str
¬¬$ 4
)
¬¬4 5
;
¬¬5 6
}
√√ 
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
	Exception
≈≈ 
Ex
≈≈ 
)
≈≈  
{
∆∆ 
return
«« 
Content
«« 
(
«« 
Ex
«« !
.
««! "
Message
««" )
.
««) *
ToString
««* 2
(
««2 3
)
««3 4
)
««4 5
;
««5 6
}
»» 
}
…… 	
public
ÕÕ 
bool
ÕÕ 
CheckCreditorRef
ÕÕ $
(
ÕÕ$ %
string
ÕÕ% +
CreditorRef
ÕÕ, 7
)
ÕÕ7 8
{
ŒŒ 	,
ListDataDropdownServerSideDeva
–– *
source
––+ 1
=
––2 3
new
––4 7,
ListDataDropdownServerSideDeva
––8 V
(
––V W
)
––W X
;
––X Y
var
““ 
Search
““ 
=
““ 
CreditorRef
““ $
==
““% '
null
““( ,
?
““- .
$str
““/ 1
:
““2 3
CreditorRef
““4 ?
;
““? @
try
”” 
{
‘‘ 
var
’’ 
url
’’ 
=
’’ 
	GetConfig
’’ #
.
’’# $

AppSetting
’’$ .
[
’’. /
$str
’’/ @
]
’’@ A
+
’’B C
	GetConfig
’’D M
.
’’M N

AppSetting
’’N X
[
’’X Y
$str
’’Y n
]
’’n o
+
’’p q
$str
’’r x
+
’’y z
$num
’’{ |
+
’’} ~
$str’’ á
+’’à â
$num’’ä ã
+’’å ç
$str’’é »
+’’…  
Search’’À —
+’’“ ”
$str’’‘ ÿ
;’’ÿ Ÿ
(
÷÷ 
bool
÷÷ 
	resultApi
÷÷ 
,
÷÷  
string
÷÷! '
result
÷÷( .
)
÷÷. /
=
÷÷0 1
RequestToAPI
÷÷2 >
.
÷÷> ?!
GetJsonStringWebApi
÷÷? R
(
÷÷R S
url
÷÷S V
,
÷÷V W
null
÷÷X \
)
÷÷\ ]
;
÷÷] ^
if
◊◊ 
(
◊◊ 
	resultApi
◊◊ 
&&
◊◊  
!
◊◊! "
string
◊◊" (
.
◊◊( )
IsNullOrEmpty
◊◊) 6
(
◊◊6 7
result
◊◊7 =
)
◊◊= >
)
◊◊> ?
{
ÿÿ 
var
ŸŸ 
jsonParseReturn
ŸŸ '
=
ŸŸ( )
JsonConvert
ŸŸ* 5
.
ŸŸ5 6
DeserializeObject
ŸŸ6 G
<
ŸŸG H!
ResultStatusDataInt
ŸŸH [
<
ŸŸ[ \(
DataDropdownServerSideDeva
ŸŸ\ v
>
ŸŸv w
>
ŸŸw x
(
ŸŸx y
result
ŸŸy 
)ŸŸ Ä
;ŸŸÄ Å
if
€€ 
(
€€ 
jsonParseReturn
€€ '
.
€€' (
Value
€€( -
.
€€- .
Count
€€. 3
(
€€3 4
)
€€4 5
!=
€€6 8
$num
€€9 :
)
€€: ;
{
‹‹ 
return
›› 
true
›› #
;
››# $
}
ﬁﬁ 
else
ﬂﬂ 
{
‡‡ 
return
·· 
false
·· $
;
··$ %
}
‚‚ 
}
„„ 
else
‰‰ 
{
ÂÂ 
return
ÊÊ 
false
ÊÊ  
;
ÊÊ  !
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
Ex
ÈÈ 
)
ÈÈ  
{
ÍÍ 
return
ÎÎ 
false
ÎÎ 
;
ÎÎ 
}
ÏÏ 
}
ÌÌ 	
public
ÓÓ %
DropdownServerSideIntVM
ÓÓ &
SelectDataRekId
ÓÓ' 6
(
ÓÓ6 7
string
ÓÓ7 =
rekName
ÓÓ> E
)
ÓÓE F
{
ÔÔ 	%
DropdownServerSideIntVM
 #

dataReturn
$ .
=
/ 0
new
1 4%
DropdownServerSideIntVM
5 L
(
L M
)
M N
;
N O
var
ÚÚ 
url
ÚÚ 
=
ÚÚ 
	GetConfig
ÚÚ 
.
ÚÚ  

AppSetting
ÚÚ  *
[
ÚÚ* +
$str
ÚÚ+ <
]
ÚÚ< =
+
ÚÚ> ?
	GetConfig
ÚÚ@ I
.
ÚÚI J

AppSetting
ÚÚJ T
[
ÚÚT U
$str
ÚÚU d
]
ÚÚd e
+
ÚÚf g
$strÚÚh ¢
+ÚÚ£ §
rekNameÚÚ• ¨
+ÚÚ≠ Æ
$strÚÚØ ≥
;ÚÚ≥ ¥
(
ÛÛ 
bool
ÛÛ 
	resultApi
ÛÛ 
,
ÛÛ 
string
ÛÛ #
result
ÛÛ$ *
)
ÛÛ* +
=
ÛÛ, -
RequestToAPI
ÛÛ. :
.
ÛÛ: ;!
GetJsonStringWebApi
ÛÛ; N
(
ÛÛN O
url
ÛÛO R
,
ÛÛR S
null
ÛÛT X
)
ÛÛX Y
;
ÛÛY Z
if
ıı 
(
ıı 
	resultApi
ıı 
&&
ıı 
!
ıı 
string
ıı $
.
ıı$ %
IsNullOrEmpty
ıı% 2
(
ıı2 3
result
ıı3 9
)
ıı9 :
)
ıı: ;
{
ˆˆ 
var
˜˜ 
jsonParseReturn
˜˜ #
=
˜˜$ %
JsonConvert
˜˜& 1
.
˜˜1 2
DeserializeObject
˜˜2 C
<
˜˜C D!
ResultStatusDataInt
˜˜D W
<
˜˜W X(
DataDropdownServerSideDeva
˜˜X r
>
˜˜r s
>
˜˜s t
(
˜˜t u
result
˜˜u {
)
˜˜{ |
;
˜˜| }
if
˘˘ 
(
˘˘ 
jsonParseReturn
˘˘ #
.
˘˘# $
Value
˘˘$ )
!=
˘˘* ,
null
˘˘- 1
)
˘˘1 2
{
˙˙ 

dataReturn
˚˚ 
.
˚˚ 
id
˚˚ !
=
˚˚" #
jsonParseReturn
˚˚$ 3
.
˚˚3 4
Value
˚˚4 9
[
˚˚9 :
$num
˚˚: ;
]
˚˚; <
.
˚˚< =
RekId
˚˚= B
;
˚˚B C

dataReturn
¸¸ 
.
¸¸ 
text
¸¸ #
=
¸¸$ %
jsonParseReturn
¸¸& 5
.
¸¸5 6
Value
¸¸6 ;
[
¸¸; <
$num
¸¸< =
]
¸¸= >
.
¸¸> ?
acc
¸¸? B
;
¸¸B C
}
˝˝ 
else
˛˛ 
{
˛˛ 

dataReturn
ˇˇ 
.
ˇˇ 
id
ˇˇ !
=
ˇˇ" #
null
ˇˇ$ (
;
ˇˇ( )

dataReturn
ÄÄ 
.
ÄÄ 
text
ÄÄ #
=
ÄÄ$ %
null
ÄÄ& *
;
ÄÄ* +
}
ÇÇ 
}
ÉÉ 
return
ÑÑ 

dataReturn
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
}
àà 
}ââ ß
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\ErrorViewModel.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ¸¢
\D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\MasterSystemParameterController.cs
	namespace		 	
DashboardDevaBNI		
 
.		 
Controllers		 &
{

 
public 

class +
MasterSystemParameterController 0
:1 2

Controller3 =
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public +
MasterSystemParameterController .
(. /
IConfiguration/ =
config> D
,D E%
DbDashboardDevaBniContextF _
context` g
,g h 
IHttpContextAccessori }
accessor	~ Ü
)
Ü á
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
	GetConfig1 :
.: ;

AppSetting; E
[E F
$strF n
]n o
+p q
$strr y
,y z
new{ ~
{	 Ä
a
Å Ç
=
É Ñ
true
Ö â
}
ä ã
)
ã å
;
å ç
} 
var 
location 
= 
new 
Uri "
(" #
$"# %
{% &
Request& -
.- .
Scheme. 4
}4 5
$str5 8
{8 9
Request9 @
.@ A
HostA E
}E F
{F G
RequestG N
.N O
PathO S
}S T
"T U
)U V
;V W
string   
Path   
=   
location   "
.  " #
AbsolutePath  # /
;  / 0
if!! 
(!! 
!!! 
accessSecurity!! 
.!!  
IsGetAccess!!  +
(!!+ ,
$str!!, 0
+!!1 2
Path!!3 7
)!!7 8
)!!8 9
{"" 
return## 
RedirectToAction## '
(##' (
$str##( 3
,##3 4
	GetConfig##5 >
.##> ?

AppSetting##? I
[##I J
$str##J r
]##r s
+##t u
$str##v }
)##} ~
;##~ 
}$$ 
ViewBag&& 
.&& 
CurrentPath&& 
=&&  !
Path&&" &
;&&& '
ViewBag'' 
.'' 

Pengumuman'' 
=''  
_context''! )
.'') *%
TblMasterSystemParameters''* C
.''C D
Where''D I
(''I J
x''J K
=>''L N
x''O P
.''P Q
Key''Q T
==''U W
$str''X d
)''d e
.''e f
Select''f l
(''l m
x''m n
=>''o q
x''r s
.''s t
Value''t y
)''y z
.''z {
FirstOrDefault	''{ â
(
''â ä
)
''ä ã
;
''ã å
ViewBag(( 
.(( 
Speed(( 
=(( 
int(( 
.((  
Parse((  %
(((% &
_context((& .
.((. /%
TblMasterSystemParameters((/ H
.((H I
Where((I N
(((N O
x((O P
=>((Q S
x((T U
.((U V
Key((V Y
==((Z \
$str((] d
)((d e
.((e f
Select((f l
(((l m
x((m n
=>((o q
x((r s
.((s t
Value((t y
)((y z
.((z {
FirstOrDefault	(({ â
(
((â ä
)
((ä ã
)
((ã å
;
((å ç
return)) 
View)) 
()) 
))) 
;)) 
}** 	
[-- 	
HttpPost--	 
]-- 
public.. 
IActionResult.. 
LoadData.. %
(..% &
)..& '
{// 	
if00 
(00 
!00 
lastSession00 
.00 
Update00 #
(00# $
)00$ %
)00% &
{11 
return22 
RedirectToAction22 '
(22' (
$str22( /
,22/ 0
	GetConfig221 :
.22: ;

AppSetting22; E
[22E F
$str22F n
]22n o
+22p q
$str22r y
,22y z
new22{ ~
{	22 Ä
a
22Å Ç
=
22É Ñ
true
22Ö â
}
22ä ã
)
22ã å
;
22å ç
}33 
var44 
location44 
=44 
new44 
Uri44 "
(44" #
$"44# %
{44% &
Request44& -
.44- .
Scheme44. 4
}444 5
$str445 8
{448 9
Request449 @
.44@ A
Host44A E
}44E F
{44F G
Request44G N
.44N O
Path44O S
}44S T
"44T U
)44U V
;44V W
string55 
Path55 
=55 
location55 "
.55" #
AbsolutePath55# /
.55/ 0
Replace550 7
(557 8
this558 <
.55< =
ControllerContext55= N
.55N O
	RouteData55O X
.55X Y
Values55Y _
[55_ `
$str55` h
]55h i
.55i j
ToString55j r
(55r s
)55s t
,55t u
$str55v }
)55} ~
;55~ 
if66 
(66 
!66 
accessSecurity66 
.66  
IsGetAccess66  +
(66+ ,
$str66, 0
+661 2
Path663 7
)667 8
)668 9
{77 
return88 
RedirectToAction88 '
(88' (
$str88( 3
,883 4
$str885 <
)88< =
;88= >
}99 
try;; 
{<< 
var== 
dict== 
=== 
Request== "
.==" #
Form==# '
.==' (
ToDictionary==( 4
(==4 5
x==5 6
=>==7 9
x==: ;
.==; <
Key==< ?
,==? @
x==A B
=>==C E
x==F G
.==G H
Value==H M
.==M N
ToString==N V
(==V W
)==W X
)==X Y
;==Y Z
var?? 
draw?? 
=?? 
dict?? 
[??  
$str??  &
]??& '
;??' (
varBB 
startBB 
=BB 
dictBB  
[BB  !
$strBB! (
]BB( )
;BB) *
varCC 
lengthCC 
=CC 
dictCC !
[CC! "
$strCC" *
]CC* +
;CC+ ,
varGG 

pageNumberGG 
=GG  
(GG! "
intGG" %
.GG% &
ParseGG& +
(GG+ ,
startGG, 1
)GG1 2
/GG3 4
intGG5 8
.GG8 9
ParseGG9 >
(GG> ?
lengthGG? E
)GGE F
)GGF G
+GGH I
$numGGJ K
;GGK L
varJJ 

sortColumnJJ 
=JJ  
dictJJ! %
[JJ% &
$strJJ& 0
+JJ1 2
dictJJ3 7
[JJ7 8
$strJJ8 J
]JJJ K
+JJL M
$strJJN W
]JJW X
;JJX Y
varKK 
sortColumnDirKK !
=KK" #
dictKK$ (
[KK( )
$strKK) 8
]KK8 9
;KK9 :
varLL 
KeySearchParamLL "
=LL# $
dictLL% )
[LL) *
$strLL* E
]LLE F
;LLF G
varMM 
ValueSearchParamMM $
=MM% &
dictMM' +
[MM+ ,
$strMM, G
]MMG H
;MMH I
intQQ 
pageSizeQQ 
=QQ 
lengthQQ %
!=QQ& (
nullQQ) -
?QQ. /
ConvertQQ0 7
.QQ7 8
ToInt32QQ8 ?
(QQ? @
lengthQQ@ F
)QQF G
:QQH I
$numQQJ K
;QQK L
intRR 
skipRR 
=RR 
startRR  
!=RR! #
nullRR$ (
?RR) *
ConvertRR+ 2
.RR2 3
ToInt32RR3 :
(RR: ;
startRR; @
)RR@ A
:RRB C
$numRRD E
;RRE F
intSS 
recordsTotalSS  
=SS! "
$numSS# $
;SS$ %
ListTT 
<TT +
MasterSystemParameter_ViewModelTT 4
>TT4 5
listTT6 :
=TT; <
newTT= @
ListTTA E
<TTE F+
MasterSystemParameter_ViewModelTTF e
>TTe f
(TTf g
)TTg h
;TTh i
listVV 
=VV #
StoredProcedureExecutorVV .
.VV. /
ExecuteSPListVV/ <
<VV< =+
MasterSystemParameter_ViewModelVV= \
>VV\ ]
(VV] ^
_contextVV^ f
,VVf g
$str	VVh å
,
VVå ç
new
VVé ë
SqlParameter
VVí û
[
VVû ü
]
VVü †
{
VV† °
newWW 
SqlParameterWW (
(WW( )
$strWW) /
,WW/ 0
KeySearchParamWW1 ?
)WW? @
,WW@ A
newXX 
SqlParameterXX (
(XX( )
$strXX) 1
,XX1 2
ValueSearchParamXX3 C
)XXC D
,XXD E
newYY 
SqlParameterYY (
(YY( )
$strYY) 6
,YY6 7

sortColumnYY8 B
)YYB C
,YYC D
newZZ 
SqlParameterZZ (
(ZZ( )
$strZZ) 9
,ZZ9 :
sortColumnDirZZ; H
)ZZH I
,ZZI J
new[[ 
SqlParameter[[ (
([[( )
$str[[) 6
,[[6 7

pageNumber[[8 B
)[[B C
,[[C D
new\\ 
SqlParameter\\ (
(\\( )
$str\\) 4
,\\4 5
pageSize\\6 >
)\\> ?
}\\? @
)\\@ A
;\\A B
recordsTotal^^ 
=^^ #
StoredProcedureExecutor^^ 6
.^^6 7
ExecuteScalarInt^^7 G
(^^G H
_context^^H P
,^^P Q
$str^^R w
,^^w x
new^^y |
SqlParameter	^^} â
[
^^â ä
]
^^ä ã
{
^^ã å
new__ 
SqlParameter__ (
(__( )
$str__) /
,__/ 0
KeySearchParam__1 ?
)__? @
,__@ A
new`` 
SqlParameter`` (
(``( )
$str``) 1
,``1 2
ValueSearchParam``3 C
)``C D
,``D E
}aa 
)aa 
;aa 
ifcc 
(cc 
listcc 
==cc 
nullcc  
)cc  !
{dd 
listee 
=ee 
newee 
Listee #
<ee# $+
MasterSystemParameter_ViewModelee$ C
>eeC D
(eeD E
)eeE F
;eeF G
recordsTotalff  
=ff! "
$numff# $
;ff$ %
}gg 
returnii 
Jsonii 
(ii 
newii 
{ii  !
drawii" &
=ii' (
drawii) -
,ii- .
recordsFilteredii/ >
=ii? @
recordsTotaliiA M
,iiM N
recordsTotaliiO [
=ii\ ]
recordsTotalii^ j
,iij k
dataiil p
=iiq r
listiis w
}iix y
)iiy z
;iiz {
}jj 
catchkk 
(kk 
	Exceptionkk 
Exkk 
)kk  
{ll 
throwmm 
;mm 
}nn 
}oo 	
publicss 
ActionResultss 
Createss "
(ss" #
)ss# $
{tt 	
ifuu 
(uu 
!uu 
lastSessionuu 
.uu 
Updateuu #
(uu# $
)uu$ %
)uu% &
{vv 
returnww 
RedirectToActionww '
(ww' (
$strww( /
,ww/ 0
	GetConfigww1 :
.ww: ;

AppSettingww; E
[wwE F
$strwwF n
]wwn o
+wwp q
$strwwr y
,wwy z
newww{ ~
{	ww Ä
a
wwÅ Ç
=
wwÉ Ñ
true
wwÖ â
}
wwä ã
)
wwã å
;
wwå ç
}xx 
varyy 
locationyy 
=yy 
newyy 
Uriyy "
(yy" #
$"yy# %
{yy% &
Requestyy& -
.yy- .
Schemeyy. 4
}yy4 5
$stryy5 8
{yy8 9
Requestyy9 @
.yy@ A
HostyyA E
}yyE F
{yyF G
RequestyyG N
.yyN O
PathyyO S
}yyS T
"yyT U
)yyU V
;yyV W
stringzz 
Pathzz 
=zz 
locationzz "
.zz" #
AbsolutePathzz# /
.zz/ 0
Replacezz0 7
(zz7 8
thiszz8 <
.zz< =
ControllerContextzz= N
.zzN O
	RouteDatazzO X
.zzX Y
ValueszzY _
[zz_ `
$strzz` h
]zzh i
.zzi j
ToStringzzj r
(zzr s
)zzs t
,zzt u
$strzzv }
)zz} ~
;zz~ 
if{{ 
({{ 
!{{ 
accessSecurity{{ 
.{{  
IsGetAccess{{  +
({{+ ,
$str{{, 0
+{{1 2
Path{{3 7
){{7 8
){{8 9
{|| 
return}} 
RedirectToAction}} '
(}}' (
$str}}( 3
,}}3 4
$str}}5 <
)}}< =
;}}= >
}~~ 
return 
PartialView 
( 
$str (
)( )
;) *
}
ÄÄ 	
[
ÉÉ 	&
ValidateAntiForgeryToken
ÉÉ	 !
]
ÉÉ! "
[
ÑÑ 	
HttpPost
ÑÑ	 
]
ÑÑ 
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
ActionResult
ÖÖ &
>
ÖÖ& '
SubmitCreate
ÖÖ( 4
(
ÖÖ4 5&
TblMasterSystemParameter
ÖÖ5 M
model
ÖÖN S
)
ÖÖS T
{
ÜÜ 	
if
áá 
(
áá 
!
áá 
lastSession
áá 
.
áá 
Update
áá #
(
áá# $
)
áá$ %
)
áá% &
{
àà 
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( /
,
ââ/ 0
	GetConfig
ââ1 :
.
ââ: ;

AppSetting
ââ; E
[
ââE F
$str
ââF n
]
âân o
+
ââp q
$str
ââr y
,
âây z
new
ââ{ ~
{ââ Ä
aââÅ Ç
=ââÉ Ñ
trueââÖ â
}ââä ã
)ââã å
;ââå ç
}
ää 
var
ãã 
location
ãã 
=
ãã 
new
ãã 
Uri
ãã "
(
ãã" #
$"
ãã# %
{
ãã% &
Request
ãã& -
.
ãã- .
Scheme
ãã. 4
}
ãã4 5
$str
ãã5 8
{
ãã8 9
Request
ãã9 @
.
ãã@ A
Host
ããA E
}
ããE F
{
ããF G
Request
ããG N
.
ããN O
Path
ããO S
}
ããS T
"
ããT U
)
ããU V
;
ããV W
string
åå 
Path
åå 
=
åå 
location
åå "
.
åå" #
AbsolutePath
åå# /
.
åå/ 0
Replace
åå0 7
(
åå7 8
this
åå8 <
.
åå< =
ControllerContext
åå= N
.
ååN O
	RouteData
ååO X
.
ååX Y
Values
ååY _
[
åå_ `
$str
åå` h
]
ååh i
.
ååi j
ToString
ååj r
(
åår s
)
åås t
,
ååt u
$str
ååv }
)
åå} ~
;
åå~ 
if
çç 
(
çç 
!
çç 
accessSecurity
çç 
.
çç  
IsGetAccess
çç  +
(
çç+ ,
$str
çç, 0
+
çç1 2
Path
çç3 7
)
çç7 8
)
çç8 9
{
éé 
return
èè 
RedirectToAction
èè '
(
èè' (
$str
èè( 3
,
èè3 4
$str
èè5 <
)
èè< =
;
èè= >
}
êê 
try
íí 
{
ìì 
var
îî 
regex
îî 
=
îî 
await
îî !
RegexRequest
îî" .
.
îî. /
RegexValidation
îî/ >
(
îî> ?
model
îî? D
)
îîD E
;
îîE F
if
ïï 
(
ïï 
!
ïï 
regex
ïï 
)
ïï 
{
ññ 
return
óó 
Content
óó "
(
óó" #
$str
óó# 1
)
óó1 2
;
óó2 3
}
òò 
using
öö 
(
öö 
TransactionScope
öö '
trx
öö( +
=
öö, -
new
öö. 1
TransactionScope
öö2 B
(
ööB C
)
ööC D
)
ööD E
{
õõ 
model
úú 
.
úú 
	IsDeleted
úú #
=
úú$ %
false
úú& +
;
úú+ ,
model
ùù 
.
ùù 
CreatedById
ùù %
=
ùù& '
int
ùù( +
.
ùù+ ,
Parse
ùù, 1
(
ùù1 2
HttpContext
ùù2 =
.
ùù= >
Session
ùù> E
.
ùùE F
	GetString
ùùF O
(
ùùO P
SessionConstan
ùùP ^
.
ùù^ _
Session_UserId
ùù_ m
)
ùùm n
)
ùùn o
;
ùùo p
model
ûû 
.
ûû 
CreatedTime
ûû %
=
ûû& '
DateTime
ûû( 0
.
ûû0 1
Now
ûû1 4
;
ûû4 5
_context
üü 
.
üü '
TblMasterSystemParameters
üü 6
.
üü6 7
Add
üü7 :
(
üü: ;
model
üü; @
)
üü@ A
;
üüA B
_context
†† 
.
†† 
SaveChanges
†† (
(
††( )
)
††) *
;
††* +
trx
¢¢ 
.
¢¢ 
Complete
¢¢  
(
¢¢  !
)
¢¢! "
;
¢¢" #
}
££ 
return
•• 
Content
•• 
(
•• 
$str
•• !
)
••! "
;
••" #
}
ßß 
catch
®® 
(
®® 
	Exception
®® 
Ex
®® 
)
®®  
{
©© 
return
™™ 
Content
™™ 
(
™™ 
	GetConfig
™™ (
.
™™( )

AppSetting
™™) 3
[
™™3 4
$str
™™4 M
]
™™M N
)
™™N O
;
™™O P
}
´´ 
}
¨¨ 	
public
∞∞ 
ActionResult
∞∞ 
Edit
∞∞  
(
∞∞  !
int
∞∞! $
id
∞∞% '
)
∞∞' (
{
±± 	
if
≤≤ 
(
≤≤ 
!
≤≤ 
lastSession
≤≤ 
.
≤≤ 
Update
≤≤ #
(
≤≤# $
)
≤≤$ %
)
≤≤% &
{
≥≥ 
return
¥¥ 
RedirectToAction
¥¥ '
(
¥¥' (
$str
¥¥( /
,
¥¥/ 0
	GetConfig
¥¥1 :
.
¥¥: ;

AppSetting
¥¥; E
[
¥¥E F
$str
¥¥F n
]
¥¥n o
+
¥¥p q
$str
¥¥r y
,
¥¥y z
new
¥¥{ ~
{¥¥ Ä
a¥¥Å Ç
=¥¥É Ñ
true¥¥Ö â
}¥¥ä ã
)¥¥ã å
;¥¥å ç
}
µµ 
var
∂∂ 
location
∂∂ 
=
∂∂ 
new
∂∂ 
Uri
∂∂ "
(
∂∂" #
$"
∂∂# %
{
∂∂% &
Request
∂∂& -
.
∂∂- .
Scheme
∂∂. 4
}
∂∂4 5
$str
∂∂5 8
{
∂∂8 9
Request
∂∂9 @
.
∂∂@ A
Host
∂∂A E
}
∂∂E F
{
∂∂F G
Request
∂∂G N
.
∂∂N O
Path
∂∂O S
}
∂∂S T
"
∂∂T U
)
∂∂U V
;
∂∂V W
string
∑∑ 
Path
∑∑ 
=
∑∑ 
location
∑∑ "
.
∑∑" #
AbsolutePath
∑∑# /
.
∑∑/ 0
Replace
∑∑0 7
(
∑∑7 8
this
∑∑8 <
.
∑∑< =
ControllerContext
∑∑= N
.
∑∑N O
	RouteData
∑∑O X
.
∑∑X Y
Values
∑∑Y _
[
∑∑_ `
$str
∑∑` h
]
∑∑h i
.
∑∑i j
ToString
∑∑j r
(
∑∑r s
)
∑∑s t
,
∑∑t u
$str
∑∑v }
)
∑∑} ~
;
∑∑~ 
if
∏∏ 
(
∏∏ 
!
∏∏ 
accessSecurity
∏∏ 
.
∏∏  
IsGetAccess
∏∏  +
(
∏∏+ ,
$str
∏∏, 0
+
∏∏1 2
Path
∏∏3 7
)
∏∏7 8
)
∏∏8 9
{
ππ 
return
∫∫ 
RedirectToAction
∫∫ '
(
∫∫' (
$str
∫∫( 3
,
∫∫3 4
$str
∫∫5 <
)
∫∫< =
;
∫∫= >
}
ªª &
TblMasterSystemParameter
ΩΩ $
data
ΩΩ% )
=
ΩΩ* +
_context
ΩΩ, 4
.
ΩΩ4 5'
TblMasterSystemParameters
ΩΩ5 N
.
ΩΩN O
Where
ΩΩO T
(
ΩΩT U
m
ΩΩU V
=>
ΩΩW Y
m
ΩΩZ [
.
ΩΩ[ \
Id
ΩΩ\ ^
==
ΩΩ_ a
id
ΩΩb d
)
ΩΩd e
.
ΩΩe f
FirstOrDefault
ΩΩf t
(
ΩΩt u
)
ΩΩu v
;
ΩΩv w
if
ææ 
(
ææ 
data
ææ 
==
ææ 
null
ææ 
)
ææ 
{
øø 
data
¿¿ 
=
¿¿ 
new
¿¿ &
TblMasterSystemParameter
¿¿ 3
(
¿¿3 4
)
¿¿4 5
;
¿¿5 6
}
¡¡ 
return
√√ 
PartialView
√√ 
(
√√ 
$str
√√ &
,
√√& '
data
√√( ,
)
√√, -
;
√√- .
}
ƒƒ 	
[
∆∆ 	&
ValidateAntiForgeryToken
∆∆	 !
]
∆∆! "
[
«« 	
HttpPost
««	 
]
«« 
public
»» 
async
»» 
Task
»» 
<
»» 
ActionResult
»» &
>
»»& '

SubmitEdit
»»( 2
(
»»2 3&
TblMasterSystemParameter
»»3 K
model
»»L Q
)
»»Q R
{
…… 	
if
   
(
   
!
   
lastSession
   
.
   
Update
   #
(
  # $
)
  $ %
)
  % &
{
ÀÀ 
return
ÃÃ 
RedirectToAction
ÃÃ '
(
ÃÃ' (
$str
ÃÃ( /
,
ÃÃ/ 0
	GetConfig
ÃÃ1 :
.
ÃÃ: ;

AppSetting
ÃÃ; E
[
ÃÃE F
$str
ÃÃF n
]
ÃÃn o
+
ÃÃp q
$str
ÃÃr y
,
ÃÃy z
new
ÃÃ{ ~
{ÃÃ Ä
aÃÃÅ Ç
=ÃÃÉ Ñ
trueÃÃÖ â
}ÃÃä ã
)ÃÃã å
;ÃÃå ç
}
ÕÕ 
var
ŒŒ 
location
ŒŒ 
=
ŒŒ 
new
ŒŒ 
Uri
ŒŒ "
(
ŒŒ" #
$"
ŒŒ# %
{
ŒŒ% &
Request
ŒŒ& -
.
ŒŒ- .
Scheme
ŒŒ. 4
}
ŒŒ4 5
$str
ŒŒ5 8
{
ŒŒ8 9
Request
ŒŒ9 @
.
ŒŒ@ A
Host
ŒŒA E
}
ŒŒE F
{
ŒŒF G
Request
ŒŒG N
.
ŒŒN O
Path
ŒŒO S
}
ŒŒS T
"
ŒŒT U
)
ŒŒU V
;
ŒŒV W
string
œœ 
Path
œœ 
=
œœ 
location
œœ "
.
œœ" #
AbsolutePath
œœ# /
.
œœ/ 0
Replace
œœ0 7
(
œœ7 8
this
œœ8 <
.
œœ< =
ControllerContext
œœ= N
.
œœN O
	RouteData
œœO X
.
œœX Y
Values
œœY _
[
œœ_ `
$str
œœ` h
]
œœh i
.
œœi j
ToString
œœj r
(
œœr s
)
œœs t
,
œœt u
$str
œœv }
)
œœ} ~
;
œœ~ 
if
–– 
(
–– 
!
–– 
accessSecurity
–– 
.
––  
IsGetAccess
––  +
(
––+ ,
$str
––, 0
+
––1 2
Path
––3 7
)
––7 8
)
––8 9
{
—— 
return
““ 
RedirectToAction
““ '
(
““' (
$str
““( 3
,
““3 4
$str
““5 <
)
““< =
;
““= >
}
”” 
try
’’ 
{
÷÷ 
var
ÿÿ 
regex
ÿÿ 
=
ÿÿ 
await
ÿÿ !
RegexRequest
ÿÿ" .
.
ÿÿ. /
RegexValidation
ÿÿ/ >
(
ÿÿ> ?
model
ÿÿ? D
)
ÿÿD E
;
ÿÿE F
if
ŸŸ 
(
ŸŸ 
!
ŸŸ 
regex
ŸŸ 
)
ŸŸ 
{
⁄⁄ 
return
€€ 
Content
€€ "
(
€€" #
$str
€€# 1
)
€€1 2
;
€€2 3
}
‹‹ 
using
ﬁﬁ 
(
ﬁﬁ 
TransactionScope
ﬁﬁ '
trx
ﬁﬁ( +
=
ﬁﬁ, -
new
ﬁﬁ. 1
TransactionScope
ﬁﬁ2 B
(
ﬁﬁB C
)
ﬁﬁC D
)
ﬁﬁD E
{
ﬂﬂ &
TblMasterSystemParameter
‡‡ ,
data
‡‡- 1
=
‡‡2 3
_context
‡‡4 <
.
‡‡< ='
TblMasterSystemParameters
‡‡= V
.
‡‡V W
Where
‡‡W \
(
‡‡\ ]
m
‡‡] ^
=>
‡‡_ a
m
‡‡b c
.
‡‡c d
Id
‡‡d f
==
‡‡g i
model
‡‡j o
.
‡‡o p
Id
‡‡p r
)
‡‡r s
.
‡‡s t
FirstOrDefault‡‡t Ç
(‡‡Ç É
)‡‡É Ñ
;‡‡Ñ Ö
data
·· 
.
·· 
Value
·· 
=
··  
model
··! &
.
··& '
Value
··' ,
;
··, -
data
‚‚ 
.
‚‚ 
Key
‚‚ 
=
‚‚ 
model
‚‚ $
.
‚‚$ %
Key
‚‚% (
;
‚‚( )
data
„„ 
.
„„ 
Description
„„ $
=
„„% &
model
„„' ,
.
„„, -
Description
„„- 8
;
„„8 9
data
‰‰ 
.
‰‰ 
IsActive
‰‰ !
=
‰‰" #
model
‰‰$ )
.
‰‰) *
IsActive
‰‰* 2
;
‰‰2 3
data
ÂÂ 
.
ÂÂ 
UpdatedById
ÂÂ $
=
ÂÂ% &
int
ÂÂ' *
.
ÂÂ* +
Parse
ÂÂ+ 0
(
ÂÂ0 1
HttpContext
ÂÂ1 <
.
ÂÂ< =
Session
ÂÂ= D
.
ÂÂD E
	GetString
ÂÂE N
(
ÂÂN O
SessionConstan
ÂÂO ]
.
ÂÂ] ^
Session_UserId
ÂÂ^ l
)
ÂÂl m
)
ÂÂm n
;
ÂÂn o
data
ÊÊ 
.
ÊÊ 
UpdatedTime
ÊÊ $
=
ÊÊ% &
DateTime
ÊÊ' /
.
ÊÊ/ 0
Now
ÊÊ0 3
;
ÊÊ3 4
_context
ÁÁ 
.
ÁÁ 
Entry
ÁÁ "
(
ÁÁ" #
data
ÁÁ# '
)
ÁÁ' (
.
ÁÁ( )
State
ÁÁ) .
=
ÁÁ/ 0
EntityState
ÁÁ1 <
.
ÁÁ< =
Modified
ÁÁ= E
;
ÁÁE F
_context
ËË 
.
ËË 
SaveChanges
ËË (
(
ËË( )
)
ËË) *
;
ËË* +
trx
ÍÍ 
.
ÍÍ 
Complete
ÍÍ  
(
ÍÍ  !
)
ÍÍ! "
;
ÍÍ" #
}
ÏÏ 
return
ÌÌ 
Content
ÌÌ 
(
ÌÌ 
$str
ÌÌ !
)
ÌÌ! "
;
ÌÌ" #
}
ÔÔ 
catch
 
{
ÒÒ 
return
ÚÚ 
Content
ÚÚ 
(
ÚÚ 
	GetConfig
ÚÚ (
.
ÚÚ( )

AppSetting
ÚÚ) 3
[
ÚÚ3 4
$str
ÚÚ4 M
]
ÚÚM N
)
ÚÚN O
;
ÚÚO P
}
ÛÛ 
}
ÙÙ 	
public
¯¯ 
ActionResult
¯¯ 
View
¯¯  
(
¯¯  !
int
¯¯! $
id
¯¯% '
)
¯¯' (
{
˘˘ 	
if
˙˙ 
(
˙˙ 
!
˙˙ 
lastSession
˙˙ 
.
˙˙ 
Update
˙˙ #
(
˙˙# $
)
˙˙$ %
)
˙˙% &
{
˚˚ 
return
¸¸ 
RedirectToAction
¸¸ '
(
¸¸' (
$str
¸¸( /
,
¸¸/ 0
	GetConfig
¸¸1 :
.
¸¸: ;

AppSetting
¸¸; E
[
¸¸E F
$str
¸¸F n
]
¸¸n o
+
¸¸p q
$str
¸¸r y
,
¸¸y z
new
¸¸{ ~
{¸¸ Ä
a¸¸Å Ç
=¸¸É Ñ
true¸¸Ö â
}¸¸ä ã
)¸¸ã å
;¸¸å ç
}
˝˝ 
var
˛˛ 
location
˛˛ 
=
˛˛ 
new
˛˛ 
Uri
˛˛ "
(
˛˛" #
$"
˛˛# %
{
˛˛% &
Request
˛˛& -
.
˛˛- .
Scheme
˛˛. 4
}
˛˛4 5
$str
˛˛5 8
{
˛˛8 9
Request
˛˛9 @
.
˛˛@ A
Host
˛˛A E
}
˛˛E F
{
˛˛F G
Request
˛˛G N
.
˛˛N O
Path
˛˛O S
}
˛˛S T
"
˛˛T U
)
˛˛U V
;
˛˛V W
string
ˇˇ 
Path
ˇˇ 
=
ˇˇ 
location
ˇˇ "
.
ˇˇ" #
AbsolutePath
ˇˇ# /
.
ˇˇ/ 0
Replace
ˇˇ0 7
(
ˇˇ7 8
this
ˇˇ8 <
.
ˇˇ< =
ControllerContext
ˇˇ= N
.
ˇˇN O
	RouteData
ˇˇO X
.
ˇˇX Y
Values
ˇˇY _
[
ˇˇ_ `
$str
ˇˇ` h
]
ˇˇh i
.
ˇˇi j
ToString
ˇˇj r
(
ˇˇr s
)
ˇˇs t
,
ˇˇt u
$str
ˇˇv }
)
ˇˇ} ~
;
ˇˇ~ 
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
accessSecurity
ÄÄ 
.
ÄÄ  
IsGetAccess
ÄÄ  +
(
ÄÄ+ ,
$str
ÄÄ, 0
+
ÄÄ1 2
Path
ÄÄ3 7
)
ÄÄ7 8
)
ÄÄ8 9
{
ÅÅ 
return
ÇÇ 
RedirectToAction
ÇÇ '
(
ÇÇ' (
$str
ÇÇ( 3
,
ÇÇ3 4
$str
ÇÇ5 <
)
ÇÇ< =
;
ÇÇ= >
}
ÉÉ &
TblMasterSystemParameter
ÖÖ $
data
ÖÖ% )
=
ÖÖ* +
_context
ÖÖ, 4
.
ÖÖ4 5'
TblMasterSystemParameters
ÖÖ5 N
.
ÖÖN O
Where
ÖÖO T
(
ÖÖT U
m
ÖÖU V
=>
ÖÖW Y
m
ÖÖZ [
.
ÖÖ[ \
Id
ÖÖ\ ^
==
ÖÖ_ a
id
ÖÖb d
)
ÖÖd e
.
ÖÖe f
FirstOrDefault
ÖÖf t
(
ÖÖt u
)
ÖÖu v
;
ÖÖv w
if
ÜÜ 
(
ÜÜ 
data
ÜÜ 
==
ÜÜ 
null
ÜÜ 
)
ÜÜ 
{
áá 
data
àà 
=
àà 
new
àà &
TblMasterSystemParameter
àà 3
(
àà3 4
)
àà4 5
;
àà5 6
}
ââ 
return
ãã 
PartialView
ãã 
(
ãã 
$str
ãã &
,
ãã& '
data
ãã( ,
)
ãã, -
;
ãã- .
}
åå 	
public
ëë 
ActionResult
ëë 
Delete
ëë "
(
ëë" #
string
ëë# )
Ids
ëë* -
)
ëë- .
{
íí 	
if
ìì 
(
ìì 
!
ìì 
lastSession
ìì 
.
ìì 
Update
ìì #
(
ìì# $
)
ìì$ %
)
ìì% &
{
îî 
return
ïï 
RedirectToAction
ïï '
(
ïï' (
$str
ïï( /
,
ïï/ 0
	GetConfig
ïï1 :
.
ïï: ;

AppSetting
ïï; E
[
ïïE F
$str
ïïF n
]
ïïn o
+
ïïp q
$str
ïïr y
,
ïïy z
new
ïï{ ~
{ïï Ä
aïïÅ Ç
=ïïÉ Ñ
trueïïÖ â
}ïïä ã
)ïïã å
;ïïå ç
}
ññ 
var
óó 
location
óó 
=
óó 
new
óó 
Uri
óó "
(
óó" #
$"
óó# %
{
óó% &
Request
óó& -
.
óó- .
Scheme
óó. 4
}
óó4 5
$str
óó5 8
{
óó8 9
Request
óó9 @
.
óó@ A
Host
óóA E
}
óóE F
{
óóF G
Request
óóG N
.
óóN O
Path
óóO S
}
óóS T
"
óóT U
)
óóU V
;
óóV W
string
òò 
Path
òò 
=
òò 
location
òò "
.
òò" #
AbsolutePath
òò# /
.
òò/ 0
Replace
òò0 7
(
òò7 8
this
òò8 <
.
òò< =
ControllerContext
òò= N
.
òòN O
	RouteData
òòO X
.
òòX Y
Values
òòY _
[
òò_ `
$str
òò` h
]
òòh i
.
òòi j
ToString
òòj r
(
òòr s
)
òòs t
,
òòt u
$str
òòv }
)
òò} ~
;
òò~ 
if
ôô 
(
ôô 
!
ôô 
accessSecurity
ôô 
.
ôô  
IsGetAccess
ôô  +
(
ôô+ ,
$str
ôô, 0
+
ôô1 2
Path
ôô3 7
)
ôô7 8
)
ôô8 9
{
öö 
return
õõ 
RedirectToAction
õõ '
(
õõ' (
$str
õõ( 3
,
õõ3 4
$str
õõ5 <
)
õõ< =
;
õõ= >
}
úú 
try
ûû 
{
üü 
long
†† 
[
†† 
]
†† 
confirmedDeleteId
†† (
=
††) *
Ids
††+ .
.
††. /
Split
††/ 4
(
††4 5
$char
††5 8
)
††8 9
.
††9 :
Select
††: @
(
††@ A
long
††A E
.
††E F
Parse
††F K
)
††K L
.
††L M
ToArray
††M T
(
††T U
)
††U V
;
††V W
List
¢¢ 
<
¢¢ &
TblMasterSystemParameter
¢¢ -
>
¢¢- .

Transaksis
¢¢/ 9
=
¢¢: ;
_context
¢¢< D
.
¢¢D E'
TblMasterSystemParameters
¢¢E ^
.
¢¢^ _
Where
¢¢_ d
(
¢¢d e
x
¢¢e f
=>
¢¢g i
confirmedDeleteId
¢¢j {
.
¢¢{ |
Contains¢¢| Ñ
(¢¢Ñ Ö
x¢¢Ö Ü
.¢¢Ü á
Id¢¢á â
)¢¢â ä
)¢¢ä ã
.¢¢ã å
ToList¢¢å í
(¢¢í ì
)¢¢ì î
;¢¢î ï
for
££ 
(
££ 
int
££ 
i
££ 
=
££ 
$num
££ 
;
££ 
i
££  !
<
££" #
confirmedDeleteId
££$ 5
.
££5 6
Length
££6 <
;
££< =
i
££> ?
++
££? A
)
££A B
{
§§ &
TblMasterSystemParameter
•• ,
data
••- 1
=
••2 3
_context
••4 <
.
••< ='
TblMasterSystemParameters
••= V
.
••V W
Find
••W [
(
••[ \

Transaksis
••\ f
[
••f g
i
••g h
]
••h i
.
••i j
Id
••j l
)
••l m
;
••m n
data
¶¶ 
.
¶¶ 
	IsDeleted
¶¶ "
=
¶¶# $
true
¶¶% )
;
¶¶) *
data
ßß 
.
ßß 
DeletedById
ßß $
=
ßß% &
int
ßß' *
.
ßß* +
Parse
ßß+ 0
(
ßß0 1
HttpContext
ßß1 <
.
ßß< =
Session
ßß= D
.
ßßD E
	GetString
ßßE N
(
ßßN O
SessionConstan
ßßO ]
.
ßß] ^
Session_UserId
ßß^ l
)
ßßl m
)
ßßm n
;
ßßn o
;
ßßp q
data
®® 
.
®® 
DeletedTime
®® $
=
®®% &
DateTime
®®' /
.
®®/ 0
Now
®®0 3
;
®®3 4
_context
©© 
.
©© 
Entry
©© "
(
©©" #
data
©©# '
)
©©' (
.
©©( )
State
©©) .
=
©©/ 0
EntityState
©©1 <
.
©©< =
Modified
©©= E
;
©©E F
_context
™™ 
.
™™ 
SaveChanges
™™ (
(
™™( )
)
™™) *
;
™™* +
}
´´ 
return
¨¨ 
Content
¨¨ 
(
¨¨ 
$str
¨¨ !
)
¨¨! "
;
¨¨" #
}
≠≠ 
catch
ÆÆ 
{
ØØ 
return
∞∞ 
Content
∞∞ 
(
∞∞ 
$str
∞∞ &
)
∞∞& '
;
∞∞' (
}
±± 
}
≤≤ 	
}
¥¥ 
}µµ ñú
QD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Models\DbDashboardDevaBniContext.cs
	namespace 	
DashboardDevaBNI
 
. 
Models !
;! "
public

 
partial

 
class

 %
DbDashboardDevaBniContext

 .
:

/ 0
	DbContext

1 :
{ 
public 
%
DbDashboardDevaBniContext $
($ %
)% &
{ 
} 
public 
%
DbDashboardDevaBniContext $
($ %
DbContextOptions% 5
<5 6%
DbDashboardDevaBniContext6 O
>O P
optionsQ X
)X Y
: 	
base
 
( 
options 
) 
{ 
} 
public 

virtual 
DbSet 
< 
TblDownloadBigFile +
>+ ,
TblDownloadBigFiles- @
{A B
getC F
;F G
setH K
;K L
}M N
public 

virtual 
DbSet 
< 
TblFileUploadNod )
>) *
TblFileUploadNods+ <
{= >
get? B
;B C
setD G
;G H
}I J
public 

virtual 
DbSet 
<  
TblFileUploadNodTemp -
>- .!
TblFileUploadNodTemps/ D
{E F
getG J
;J K
setL O
;O P
}Q R
public 

virtual 
DbSet 
< 
TblFileUploadNop )
>) *
TblFileUploadNops+ <
{= >
get? B
;B C
setD G
;G H
}I J
public 

virtual 
DbSet 
<  
TblFileUploadNopTemp -
>- .!
TblFileUploadNopTemps/ D
{E F
getG J
;J K
setL O
;O P
}Q R
public 

virtual 
DbSet 
< 
	TblGetOtp "
>" #

TblGetOtps$ .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public!! 

virtual!! 
DbSet!! 
<!! 
TblLogActivity!! '
>!!' (
TblLogActivities!!) 9
{!!: ;
get!!< ?
;!!? @
set!!A D
;!!D E
}!!F G
public## 

virtual## 
DbSet## 
<## 
TblLogErrorPrint## )
>##) *
TblLogErrorPrints##+ <
{##= >
get##? B
;##B C
set##D G
;##G H
}##I J
public%% 

virtual%% 
DbSet%% 
<%% 
TblMasterLookup%% (
>%%( )
TblMasterLookups%%* :
{%%; <
get%%= @
;%%@ A
set%%B E
;%%E F
}%%G H
public'' 

virtual'' 
DbSet'' 
<'' 
TblMasterRole'' &
>''& '
TblMasterRoles''( 6
{''7 8
get''9 <
;''< =
set''> A
;''A B
}''C D
public)) 

virtual)) 
DbSet)) 
<)) $
TblMasterSystemParameter)) 1
>))1 2%
TblMasterSystemParameters))3 L
{))M N
get))O R
;))R S
set))T W
;))W X
}))Y Z
public++ 

virtual++ 
DbSet++ 
<++ 
TblMasterUnit++ &
>++& '
TblMasterUnits++( 6
{++7 8
get++9 <
;++< =
set++> A
;++A B
}++C D
public-- 

virtual-- 
DbSet-- 
<-- 
TblMasterUser-- &
>--& '
TblMasterUsers--( 6
{--7 8
get--9 <
;--< =
set--> A
;--A B
}--C D
public// 

virtual// 
DbSet// 
<// 
TblMasterUserVerif// +
>//+ ,
TblMasterUserVerifs//- @
{//A B
get//C F
;//F G
set//H K
;//K L
}//M N
public11 

virtual11 
DbSet11 
<11 
TblNavigation11 &
>11& '
TblNavigations11( 6
{117 8
get119 <
;11< =
set11> A
;11A B
}11C D
public33 

virtual33 
DbSet33 
<33 #
TblNavigationAssignment33 0
>330 1$
TblNavigationAssignments332 J
{33K L
get33M P
;33P Q
set33R U
;33U V
}33W X
public55 

virtual55 
DbSet55 
<55 #
TblNoticeOfDisbursement55 0
>550 1$
TblNoticeOfDisbursements552 J
{55K L
get55M P
;55P Q
set55R U
;55U V
}55W X
public77 

virtual77 
DbSet77 
<77 )
TblNoticeOfDisbursementDetail77 6
>776 7*
TblNoticeOfDisbursementDetails778 V
{77W X
get77Y \
;77\ ]
set77^ a
;77a b
}77c d
public99 

virtual99 
DbSet99 
<99 -
!TblNoticeOfDisbursementDetailTemp99 :
>99: ;.
"TblNoticeOfDisbursementDetailTemps99< ^
{99_ `
get99a d
;99d e
set99f i
;99i j
}99k l
public;; 

virtual;; 
DbSet;; 
<;; 
TblNoticeOfPayment;; +
>;;+ ,
TblNoticeOfPayments;;- @
{;;A B
get;;C F
;;;F G
set;;H K
;;;K L
};;M N
public== 

virtual== 
DbSet== 
<== $
TblNoticeOfPaymentDetail== 1
>==1 2%
TblNoticeOfPaymentDetails==3 L
{==M N
get==O R
;==R S
set==T W
;==W X
}==Y Z
public?? 

virtual?? 
DbSet?? 
<?? (
TblNoticeOfPaymentDetailTemp?? 5
>??5 6)
TblNoticeOfPaymentDetailTemps??7 T
{??U V
get??W Z
;??Z [
set??\ _
;??_ `
}??a b
publicAA 

virtualAA 
DbSetAA 
<AA 
TblUserSessionAA '
>AA' (
TblUserSessionsAA) 8
{AA9 :
getAA; >
;AA> ?
setAA@ C
;AAC D
}AAE F
	protectedCC 
overrideCC 
voidCC 
OnConfiguringCC )
(CC) *#
DbContextOptionsBuilderCC* A
optionsBuilderCCB P
)CCP Q
{CCR S
stringDD 
?DD 
decodedStringDD 
=DD 
	GetConfigDD  )
.DD) *

AppSettingDD* 4
[DD4 5
$strDD5 N
]DDN O
;DDO P
ifEE 

(EE 
stringEE 
.EE 
IsNullOrWhiteSpaceEE %
(EE% &
decodedStringEE& 3
)EE3 4
)EE4 5
{FF 	
throwGG 
newGG 
	ExceptionGG 
(GG  
$strGG  9
)GG9 :
;GG: ;
}HH 	
tryJJ 
{KK 	
byteLL 
[LL 
]LL 

connStringLL 
=LL 
ConvertLL  '
.LL' (
FromBase64StringLL( 8
(LL8 9
decodedStringLL9 F
!LLF G
)LLG H
;LLH I
optionsBuilderMM 
.MM 
UseSqlServerMM '
(MM' (
EncodingMM( 0
.MM0 1
UTF8MM1 5
.MM5 6
	GetStringMM6 ?
(MM? @

connStringMM@ J
)MMJ K
)MMK L
;MML M
}NN 	
catchNN
 
{OO 	
throwPP 
newPP 
	ExceptionPP 
(PP  
$strPP  ;
)PP; <
;PP< =
}QQ 	
}RR 
	protectedTT 
overrideTT 
voidTT 
OnModelCreatingTT +
(TT+ ,
ModelBuilderTT, 8
modelBuilderTT9 E
)TTE F
{UU 
modelBuilderVV 
.VV 
EntityVV 
<VV 
TblDownloadBigFileVV .
>VV. /
(VV/ 0
entityVV0 6
=>VV7 9
{WW 	
entityXX 
.XX 
HasKeyXX 
(XX 
eXX 
=>XX 
eXX  
.XX  !
IdXX! #
)XX# $
.XX$ %
HasNameXX% ,
(XX, -
$strXX- M
)XXM N
;XXN O
entityZZ 
.ZZ 
ToTableZZ 
(ZZ 
$strZZ 2
)ZZ2 3
;ZZ3 4
entity\\ 
.\\ 
Property\\ 
(\\ 
e\\ 
=>\\  
e\\! "
.\\" #
FileExt\\# *
)\\* +
.]] 
HasMaxLength]] 
(]] 
$num]] !
)]]! "
.^^ 
	IsUnicode^^ 
(^^ 
false^^  
)^^  !
;^^! "
entity__ 
.__ 
Property__ 
(__ 
e__ 
=>__  
e__! "
.__" #
FileName__# +
)__+ ,
.`` 
HasMaxLength`` 
(`` 
$num`` !
)``! "
.aa 
	IsUnicodeaa 
(aa 
falseaa  
)aa  !
;aa! "
entitybb 
.bb 
Propertybb 
(bb 
ebb 
=>bb  
ebb! "
.bb" #
Pathbb# '
)bb' (
.cc 
HasMaxLengthcc 
(cc 
$numcc !
)cc! "
.dd 
	IsUnicodedd 
(dd 
falsedd  
)dd  !
;dd! "
}ee 	
)ee	 

;ee
 
modelBuildergg 
.gg 
Entitygg 
<gg 
TblFileUploadNodgg ,
>gg, -
(gg- .
entitygg. 4
=>gg5 7
{hh 	
entityii 
.ii 
HasKeyii 
(ii 
eii 
=>ii 
eii  
.ii  !
Idii! #
)ii# $
.ii$ %
HasNameii% ,
(ii, -
$strii- M
)iiM N
;iiN O
entitykk 
.kk 
ToTablekk 
(kk 
$strkk 0
)kk0 1
;kk1 2
entitymm 
.mm 
Propertymm 
(mm 
emm 
=>mm  
emm! "
.mm" #
FileExtmm# *
)mm* +
.nn 
HasMaxLengthnn 
(nn 
$numnn !
)nn! "
.oo 
	IsUnicodeoo 
(oo 
falseoo  
)oo  !
;oo! "
entitypp 
.pp 
Propertypp 
(pp 
epp 
=>pp  
epp! "
.pp" #
FileNamepp# +
)pp+ ,
.qq 
HasMaxLengthqq 
(qq 
$numqq !
)qq! "
.rr 
	IsUnicoderr 
(rr 
falserr  
)rr  !
;rr! "
entityss 
.ss 
Propertyss 
(ss 
ess 
=>ss  
ess! "
.ss" #
FilePathss# +
)ss+ ,
.tt 
HasMaxLengthtt 
(tt 
$numtt "
)tt" #
.uu 
	IsUnicodeuu 
(uu 
falseuu  
)uu  !
;uu! "
entityvv 
.vv 
Propertyvv 
(vv 
evv 
=>vv  
evv! "
.vv" #
IdFileFromApivv# 0
)vv0 1
.ww 
HasMaxLengthww 
(ww 
$numww !
)ww! "
.xx 
	IsUnicodexx 
(xx 
falsexx  
)xx  !
.yy 
HasColumnNameyy 
(yy 
$stryy .
)yy. /
;yy/ 0
}zz 	
)zz	 

;zz
 
modelBuilder|| 
.|| 
Entity|| 
<||  
TblFileUploadNodTemp|| 0
>||0 1
(||1 2
entity||2 8
=>||9 ;
{}} 	
entity~~ 
.~~ 
HasKey~~ 
(~~ 
e~~ 
=>~~ 
e~~  
.~~  !
Id~~! #
)~~# $
.~~$ %
HasName~~% ,
(~~, -
$str~~- M
)~~M N
;~~N O
entity
ÄÄ 
.
ÄÄ 
ToTable
ÄÄ 
(
ÄÄ 
$str
ÄÄ 5
)
ÄÄ5 6
;
ÄÄ6 7
entity
ÇÇ 
.
ÇÇ 
Property
ÇÇ 
(
ÇÇ 
e
ÇÇ 
=>
ÇÇ  
e
ÇÇ! "
.
ÇÇ" #
FileExt
ÇÇ# *
)
ÇÇ* +
.
ÉÉ 
HasMaxLength
ÉÉ 
(
ÉÉ 
$num
ÉÉ !
)
ÉÉ! "
.
ÑÑ 
	IsUnicode
ÑÑ 
(
ÑÑ 
false
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
entity
ÖÖ 
.
ÖÖ 
Property
ÖÖ 
(
ÖÖ 
e
ÖÖ 
=>
ÖÖ  
e
ÖÖ! "
.
ÖÖ" #
FileName
ÖÖ# +
)
ÖÖ+ ,
.
ÜÜ 
HasMaxLength
ÜÜ 
(
ÜÜ 
$num
ÜÜ !
)
ÜÜ! "
.
áá 
	IsUnicode
áá 
(
áá 
false
áá  
)
áá  !
;
áá! "
entity
àà 
.
àà 
Property
àà 
(
àà 
e
àà 
=>
àà  
e
àà! "
.
àà" #
FilePath
àà# +
)
àà+ ,
.
ââ 
HasMaxLength
ââ 
(
ââ 
$num
ââ "
)
ââ" #
.
ää 
	IsUnicode
ää 
(
ää 
false
ää  
)
ää  !
;
ää! "
entity
ãã 
.
ãã 
Property
ãã 
(
ãã 
e
ãã 
=>
ãã  
e
ãã! "
.
ãã" #
IdFileFromApi
ãã# 0
)
ãã0 1
.
åå 
HasMaxLength
åå 
(
åå 
$num
åå !
)
åå! "
.
çç 
	IsUnicode
çç 
(
çç 
false
çç  
)
çç  !
.
éé 
HasColumnName
éé 
(
éé 
$str
éé .
)
éé. /
;
éé/ 0
}
èè 	
)
èè	 

;
èè
 
modelBuilder
ëë 
.
ëë 
Entity
ëë 
<
ëë 
TblFileUploadNop
ëë ,
>
ëë, -
(
ëë- .
entity
ëë. 4
=>
ëë5 7
{
íí 	
entity
ìì 
.
ìì 
HasKey
ìì 
(
ìì 
e
ìì 
=>
ìì 
e
ìì  
.
ìì  !
Id
ìì! #
)
ìì# $
.
ìì$ %
HasName
ìì% ,
(
ìì, -
$str
ìì- M
)
ììM N
;
ììN O
entity
ïï 
.
ïï 
ToTable
ïï 
(
ïï 
$str
ïï 0
)
ïï0 1
;
ïï1 2
entity
óó 
.
óó 
Property
óó 
(
óó 
e
óó 
=>
óó  
e
óó! "
.
óó" #
FileExt
óó# *
)
óó* +
.
òò 
HasMaxLength
òò 
(
òò 
$num
òò !
)
òò! "
.
ôô 
	IsUnicode
ôô 
(
ôô 
false
ôô  
)
ôô  !
;
ôô! "
entity
öö 
.
öö 
Property
öö 
(
öö 
e
öö 
=>
öö  
e
öö! "
.
öö" #
FileName
öö# +
)
öö+ ,
.
õõ 
HasMaxLength
õõ 
(
õõ 
$num
õõ !
)
õõ! "
.
úú 
	IsUnicode
úú 
(
úú 
false
úú  
)
úú  !
;
úú! "
entity
ùù 
.
ùù 
Property
ùù 
(
ùù 
e
ùù 
=>
ùù  
e
ùù! "
.
ùù" #
FilePath
ùù# +
)
ùù+ ,
.
ûû 
HasMaxLength
ûû 
(
ûû 
$num
ûû "
)
ûû" #
.
üü 
	IsUnicode
üü 
(
üü 
false
üü  
)
üü  !
;
üü! "
entity
†† 
.
†† 
Property
†† 
(
†† 
e
†† 
=>
††  
e
††! "
.
††" #
IdFileFromApi
††# 0
)
††0 1
.
°° 
HasMaxLength
°° 
(
°° 
$num
°° !
)
°°! "
.
¢¢ 
	IsUnicode
¢¢ 
(
¢¢ 
false
¢¢  
)
¢¢  !
.
££ 
HasColumnName
££ 
(
££ 
$str
££ .
)
££. /
;
££/ 0
}
§§ 	
)
§§	 

;
§§
 
modelBuilder
¶¶ 
.
¶¶ 
Entity
¶¶ 
<
¶¶ "
TblFileUploadNopTemp
¶¶ 0
>
¶¶0 1
(
¶¶1 2
entity
¶¶2 8
=>
¶¶9 ;
{
ßß 	
entity
®® 
.
®® 
HasKey
®® 
(
®® 
e
®® 
=>
®® 
e
®®  
.
®®  !
Id
®®! #
)
®®# $
.
®®$ %
HasName
®®% ,
(
®®, -
$str
®®- M
)
®®M N
;
®®N O
entity
™™ 
.
™™ 
ToTable
™™ 
(
™™ 
$str
™™ 5
)
™™5 6
;
™™6 7
entity
¨¨ 
.
¨¨ 
Property
¨¨ 
(
¨¨ 
e
¨¨ 
=>
¨¨  
e
¨¨! "
.
¨¨" #
FileExt
¨¨# *
)
¨¨* +
.
≠≠ 
HasMaxLength
≠≠ 
(
≠≠ 
$num
≠≠ !
)
≠≠! "
.
ÆÆ 
	IsUnicode
ÆÆ 
(
ÆÆ 
false
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
entity
ØØ 
.
ØØ 
Property
ØØ 
(
ØØ 
e
ØØ 
=>
ØØ  
e
ØØ! "
.
ØØ" #
FileName
ØØ# +
)
ØØ+ ,
.
∞∞ 
HasMaxLength
∞∞ 
(
∞∞ 
$num
∞∞ !
)
∞∞! "
.
±± 
	IsUnicode
±± 
(
±± 
false
±±  
)
±±  !
;
±±! "
entity
≤≤ 
.
≤≤ 
Property
≤≤ 
(
≤≤ 
e
≤≤ 
=>
≤≤  
e
≤≤! "
.
≤≤" #
FilePath
≤≤# +
)
≤≤+ ,
.
≥≥ 
HasMaxLength
≥≥ 
(
≥≥ 
$num
≥≥ "
)
≥≥" #
.
¥¥ 
	IsUnicode
¥¥ 
(
¥¥ 
false
¥¥  
)
¥¥  !
;
¥¥! "
entity
µµ 
.
µµ 
Property
µµ 
(
µµ 
e
µµ 
=>
µµ  
e
µµ! "
.
µµ" #
IdFileFromApi
µµ# 0
)
µµ0 1
.
∂∂ 
HasMaxLength
∂∂ 
(
∂∂ 
$num
∂∂ !
)
∂∂! "
.
∑∑ 
	IsUnicode
∑∑ 
(
∑∑ 
false
∑∑  
)
∑∑  !
.
∏∏ 
HasColumnName
∏∏ 
(
∏∏ 
$str
∏∏ .
)
∏∏. /
;
∏∏/ 0
}
ππ 	
)
ππ	 

;
ππ
 
modelBuilder
ªª 
.
ªª 
Entity
ªª 
<
ªª 
	TblGetOtp
ªª %
>
ªª% &
(
ªª& '
entity
ªª' -
=>
ªª. 0
{
ºº 	
entity
ΩΩ 
.
ΩΩ 
ToTable
ΩΩ 
(
ΩΩ 
$str
ΩΩ '
)
ΩΩ' (
;
ΩΩ( )
entity
øø 
.
øø 
Property
øø 
(
øø 
e
øø 
=>
øø  
e
øø! "
.
øø" #
ExpiredTime
øø# .
)
øø. /
.
øø/ 0
HasColumnType
øø0 =
(
øø= >
$str
øø> H
)
øøH I
;
øøI J
entity
¿¿ 
.
¿¿ 
Property
¿¿ 
(
¿¿ 
e
¿¿ 
=>
¿¿  
e
¿¿! "
.
¿¿" #
KodeOtp
¿¿# *
)
¿¿* +
.
¿¿+ ,
HasMaxLength
¿¿, 8
(
¿¿8 9
$num
¿¿9 ;
)
¿¿; <
;
¿¿< =
entity
¡¡ 
.
¡¡ 
Property
¡¡ 
(
¡¡ 
e
¡¡ 
=>
¡¡  
e
¡¡! "
.
¡¡" #
Username
¡¡# +
)
¡¡+ ,
.
¡¡, -
HasMaxLength
¡¡- 9
(
¡¡9 :
$num
¡¡: =
)
¡¡= >
;
¡¡> ?
}
¬¬ 	
)
¬¬	 

;
¬¬
 
modelBuilder
ƒƒ 
.
ƒƒ 
Entity
ƒƒ 
<
ƒƒ 
TblLogActivity
ƒƒ *
>
ƒƒ* +
(
ƒƒ+ ,
entity
ƒƒ, 2
=>
ƒƒ3 5
{
≈≈ 	
entity
∆∆ 
.
∆∆ 
ToTable
∆∆ 
(
∆∆ 
$str
∆∆ ,
)
∆∆, -
;
∆∆- .
entity
»» 
.
»» 
Property
»» 
(
»» 
e
»» 
=>
»»  
e
»»! "
.
»»" #

ActionTime
»»# -
)
»»- .
.
»». /
HasColumnType
»»/ <
(
»»< =
$str
»»= G
)
»»G H
;
»»H I
entity
…… 
.
…… 
Property
…… 
(
…… 
e
…… 
=>
……  
e
……! "
.
……" #
Username
……# +
)
……+ ,
.
……, -
HasMaxLength
……- 9
(
……9 :
$num
……: <
)
……< =
;
……= >
}
   	
)
  	 

;
  
 
modelBuilder
ÃÃ 
.
ÃÃ 
Entity
ÃÃ 
<
ÃÃ 
TblLogErrorPrint
ÃÃ ,
>
ÃÃ, -
(
ÃÃ- .
entity
ÃÃ. 4
=>
ÃÃ5 7
{
ÕÕ 	
entity
ŒŒ 
.
ŒŒ 
HasKey
ŒŒ 
(
ŒŒ 
e
ŒŒ 
=>
ŒŒ 
e
ŒŒ  
.
ŒŒ  !
Id
ŒŒ! #
)
ŒŒ# $
.
ŒŒ$ %
HasName
ŒŒ% ,
(
ŒŒ, -
$str
ŒŒ- M
)
ŒŒM N
;
ŒŒN O
entity
–– 
.
–– 
ToTable
–– 
(
–– 
$str
–– .
)
––. /
;
––/ 0
entity
““ 
.
““ 
Property
““ 
(
““ 
e
““ 
=>
““  
e
““! "
.
““" #
Id
““# %
)
““% &
.
““& '!
ValueGeneratedNever
““' :
(
““: ;
)
““; <
;
““< =
entity
”” 
.
”” 
Property
”” 
(
”” 
e
”” 
=>
””  
e
””! "
.
””" #
CreatedTime
””# .
)
””. /
.
””/ 0
HasColumnType
””0 =
(
””= >
$str
””> H
)
””H I
;
””I J
entity
‘‘ 
.
‘‘ 
Property
‘‘ 
(
‘‘ 
e
‘‘ 
=>
‘‘  
e
‘‘! "
.
‘‘" #
ErrorMessage
‘‘# /
)
‘‘/ 0
.
‘‘0 1
HasColumnType
‘‘1 >
(
‘‘> ?
$str
‘‘? E
)
‘‘E F
;
‘‘F G
}
’’ 	
)
’’	 

;
’’
 
modelBuilder
◊◊ 
.
◊◊ 
Entity
◊◊ 
<
◊◊ 
TblMasterLookup
◊◊ +
>
◊◊+ ,
(
◊◊, -
entity
◊◊- 3
=>
◊◊4 6
{
ÿÿ 	
entity
ŸŸ 
.
ŸŸ 
ToTable
ŸŸ 
(
ŸŸ 
$str
ŸŸ -
)
ŸŸ- .
;
ŸŸ. /
entity
€€ 
.
€€ 
Property
€€ 
(
€€ 
e
€€ 
=>
€€  
e
€€! "
.
€€" #
CreatedTime
€€# .
)
€€. /
.
€€/ 0
HasColumnType
€€0 =
(
€€= >
$str
€€> H
)
€€H I
;
€€I J
entity
‹‹ 
.
‹‹ 
Property
‹‹ 
(
‹‹ 
e
‹‹ 
=>
‹‹  
e
‹‹! "
.
‹‹" #
DeletedTime
‹‹# .
)
‹‹. /
.
‹‹/ 0
HasColumnType
‹‹0 =
(
‹‹= >
$str
‹‹> H
)
‹‹H I
;
‹‹I J
entity
›› 
.
›› 
Property
›› 
(
›› 
e
›› 
=>
››  
e
››! "
.
››" #
Description
››# .
)
››. /
.
››/ 0
HasMaxLength
››0 <
(
››< =
$num
››= @
)
››@ A
;
››A B
entity
ﬁﬁ 
.
ﬁﬁ 
Property
ﬁﬁ 
(
ﬁﬁ 
e
ﬁﬁ 
=>
ﬁﬁ  
e
ﬁﬁ! "
.
ﬁﬁ" #
Name
ﬁﬁ# '
)
ﬁﬁ' (
.
ﬁﬁ( )
HasMaxLength
ﬁﬁ) 5
(
ﬁﬁ5 6
$num
ﬁﬁ6 9
)
ﬁﬁ9 :
;
ﬁﬁ: ;
entity
ﬂﬂ 
.
ﬂﬂ 
Property
ﬂﬂ 
(
ﬂﬂ 
e
ﬂﬂ 
=>
ﬂﬂ  
e
ﬂﬂ! "
.
ﬂﬂ" #
Type
ﬂﬂ# '
)
ﬂﬂ' (
.
ﬂﬂ( )
HasMaxLength
ﬂﬂ) 5
(
ﬂﬂ5 6
$num
ﬂﬂ6 8
)
ﬂﬂ8 9
;
ﬂﬂ9 :
entity
‡‡ 
.
‡‡ 
Property
‡‡ 
(
‡‡ 
e
‡‡ 
=>
‡‡  
e
‡‡! "
.
‡‡" #
UpdatedTime
‡‡# .
)
‡‡. /
.
‡‡/ 0
HasColumnType
‡‡0 =
(
‡‡= >
$str
‡‡> H
)
‡‡H I
;
‡‡I J
}
·· 	
)
··	 

;
··
 
modelBuilder
„„ 
.
„„ 
Entity
„„ 
<
„„ 
TblMasterRole
„„ )
>
„„) *
(
„„* +
entity
„„+ 1
=>
„„2 4
{
‰‰ 	
entity
ÂÂ 
.
ÂÂ 
ToTable
ÂÂ 
(
ÂÂ 
$str
ÂÂ +
)
ÂÂ+ ,
;
ÂÂ, -
entity
ÁÁ 
.
ÁÁ 
Property
ÁÁ 
(
ÁÁ 
e
ÁÁ 
=>
ÁÁ  
e
ÁÁ! "
.
ÁÁ" #
CreatedTime
ÁÁ# .
)
ÁÁ. /
.
ÁÁ/ 0
HasColumnType
ÁÁ0 =
(
ÁÁ= >
$str
ÁÁ> H
)
ÁÁH I
;
ÁÁI J
entity
ËË 
.
ËË 
Property
ËË 
(
ËË 
e
ËË 
=>
ËË  
e
ËË! "
.
ËË" #
DeletedTime
ËË# .
)
ËË. /
.
ËË/ 0
HasColumnType
ËË0 =
(
ËË= >
$str
ËË> H
)
ËËH I
;
ËËI J
entity
ÈÈ 
.
ÈÈ 
Property
ÈÈ 
(
ÈÈ 
e
ÈÈ 
=>
ÈÈ  
e
ÈÈ! "
.
ÈÈ" #
Description
ÈÈ# .
)
ÈÈ. /
.
ÈÈ/ 0
HasMaxLength
ÈÈ0 <
(
ÈÈ< =
$num
ÈÈ= ?
)
ÈÈ? @
;
ÈÈ@ A
entity
ÍÍ 
.
ÍÍ 
Property
ÍÍ 
(
ÍÍ 
e
ÍÍ 
=>
ÍÍ  
e
ÍÍ! "
.
ÍÍ" #
Kode
ÍÍ# '
)
ÍÍ' (
.
ÎÎ 
HasMaxLength
ÎÎ 
(
ÎÎ 
$num
ÎÎ  
)
ÎÎ  !
.
ÏÏ 
	IsUnicode
ÏÏ 
(
ÏÏ 
false
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
entity
ÌÌ 
.
ÌÌ 
Property
ÌÌ 
(
ÌÌ 
e
ÌÌ 
=>
ÌÌ  
e
ÌÌ! "
.
ÌÌ" #
Name
ÌÌ# '
)
ÌÌ' (
.
ÓÓ 
HasMaxLength
ÓÓ 
(
ÓÓ 
$num
ÓÓ  
)
ÓÓ  !
.
ÔÔ 
	IsUnicode
ÔÔ 
(
ÔÔ 
false
ÔÔ  
)
ÔÔ  !
;
ÔÔ! "
entity
 
.
 
Property
 
(
 
e
 
=>
  
e
! "
.
" #
UpdatedTime
# .
)
. /
.
/ 0
HasColumnType
0 =
(
= >
$str
> H
)
H I
;
I J
}
ÒÒ 	
)
ÒÒ	 

;
ÒÒ
 
modelBuilder
ÛÛ 
.
ÛÛ 
Entity
ÛÛ 
<
ÛÛ &
TblMasterSystemParameter
ÛÛ 4
>
ÛÛ4 5
(
ÛÛ5 6
entity
ÛÛ6 <
=>
ÛÛ= ?
{
ÙÙ 	
entity
ıı 
.
ıı 
ToTable
ıı 
(
ıı 
$str
ıı 6
)
ıı6 7
;
ıı7 8
entity
˜˜ 
.
˜˜ 
Property
˜˜ 
(
˜˜ 
e
˜˜ 
=>
˜˜  
e
˜˜! "
.
˜˜" #
CreatedTime
˜˜# .
)
˜˜. /
.
˜˜/ 0
HasColumnType
˜˜0 =
(
˜˜= >
$str
˜˜> H
)
˜˜H I
;
˜˜I J
entity
¯¯ 
.
¯¯ 
Property
¯¯ 
(
¯¯ 
e
¯¯ 
=>
¯¯  
e
¯¯! "
.
¯¯" #
DeletedTime
¯¯# .
)
¯¯. /
.
¯¯/ 0
HasColumnType
¯¯0 =
(
¯¯= >
$str
¯¯> H
)
¯¯H I
;
¯¯I J
entity
˘˘ 
.
˘˘ 
Property
˘˘ 
(
˘˘ 
e
˘˘ 
=>
˘˘  
e
˘˘! "
.
˘˘" #
Description
˘˘# .
)
˘˘. /
.
˙˙ 
HasMaxLength
˙˙ 
(
˙˙ 
$num
˙˙  
)
˙˙  !
.
˚˚ 
	IsUnicode
˚˚ 
(
˚˚ 
false
˚˚  
)
˚˚  !
;
˚˚! "
entity
¸¸ 
.
¸¸ 
Property
¸¸ 
(
¸¸ 
e
¸¸ 
=>
¸¸  
e
¸¸! "
.
¸¸" #
Key
¸¸# &
)
¸¸& '
.
˝˝ 
HasMaxLength
˝˝ 
(
˝˝ 
$num
˝˝  
)
˝˝  !
.
˛˛ 
	IsUnicode
˛˛ 
(
˛˛ 
false
˛˛  
)
˛˛  !
;
˛˛! "
entity
ˇˇ 
.
ˇˇ 
Property
ˇˇ 
(
ˇˇ 
e
ˇˇ 
=>
ˇˇ  
e
ˇˇ! "
.
ˇˇ" #
UpdatedTime
ˇˇ# .
)
ˇˇ. /
.
ˇˇ/ 0
HasColumnType
ˇˇ0 =
(
ˇˇ= >
$str
ˇˇ> H
)
ˇˇH I
;
ˇˇI J
entity
ÄÄ 
.
ÄÄ 
Property
ÄÄ 
(
ÄÄ 
e
ÄÄ 
=>
ÄÄ  
e
ÄÄ! "
.
ÄÄ" #
Value
ÄÄ# (
)
ÄÄ( )
.
ÄÄ) *
HasColumnType
ÄÄ* 7
(
ÄÄ7 8
$str
ÄÄ8 >
)
ÄÄ> ?
;
ÄÄ? @
}
ÅÅ 	
)
ÅÅ	 

;
ÅÅ
 
modelBuilder
ÉÉ 
.
ÉÉ 
Entity
ÉÉ 
<
ÉÉ 
TblMasterUnit
ÉÉ )
>
ÉÉ) *
(
ÉÉ* +
entity
ÉÉ+ 1
=>
ÉÉ2 4
{
ÑÑ 	
entity
ÖÖ 
.
ÖÖ 
ToTable
ÖÖ 
(
ÖÖ 
$str
ÖÖ +
)
ÖÖ+ ,
;
ÖÖ, -
entity
áá 
.
áá 
Property
áá 
(
áá 
e
áá 
=>
áá  
e
áá! "
.
áá" #
Address
áá# *
)
áá* +
.
áá+ ,
HasColumnType
áá, 9
(
áá9 :
$str
áá: @
)
áá@ A
;
ááA B
entity
àà 
.
àà 
Property
àà 
(
àà 
e
àà 
=>
àà  
e
àà! "
.
àà" #
Code
àà# '
)
àà' (
.
àà( )
HasMaxLength
àà) 5
(
àà5 6
$num
àà6 8
)
àà8 9
;
àà9 :
entity
ââ 
.
ââ 
Property
ââ 
(
ââ 
e
ââ 
=>
ââ  
e
ââ! "
.
ââ" #
CreatedById
ââ# .
)
ââ. /
.
ââ/ 0
HasColumnName
ââ0 =
(
ââ= >
$str
ââ> L
)
ââL M
;
ââM N
entity
ää 
.
ää 
Property
ää 
(
ää 
e
ää 
=>
ää  
e
ää! "
.
ää" #
CreatedTime
ää# .
)
ää. /
.
ää/ 0
HasColumnType
ää0 =
(
ää= >
$str
ää> H
)
ääH I
;
ääI J
entity
ãã 
.
ãã 
Property
ãã 
(
ãã 
e
ãã 
=>
ãã  
e
ãã! "
.
ãã" #
DeletedById
ãã# .
)
ãã. /
.
ãã/ 0
HasColumnName
ãã0 =
(
ãã= >
$str
ãã> L
)
ããL M
;
ããM N
entity
åå 
.
åå 
Property
åå 
(
åå 
e
åå 
=>
åå  
e
åå! "
.
åå" #
DeletedTime
åå# .
)
åå. /
.
åå/ 0
HasColumnType
åå0 =
(
åå= >
$str
åå> H
)
ååH I
;
ååI J
entity
çç 
.
çç 
Property
çç 
(
çç 
e
çç 
=>
çç  
e
çç! "
.
çç" #
Email
çç# (
)
çç( )
.
çç) *
HasMaxLength
çç* 6
(
çç6 7
$num
çç7 :
)
çç: ;
;
çç; <
entity
éé 
.
éé 
Property
éé 
(
éé 
e
éé 
=>
éé  
e
éé! "
.
éé" #
FullCode
éé# +
)
éé+ ,
.
éé, -
HasMaxLength
éé- 9
(
éé9 :
$num
éé: <
)
éé< =
;
éé= >
entity
èè 
.
èè 
Property
èè 
(
èè 
e
èè 
=>
èè  
e
èè! "
.
èè" #
KodeWilayah
èè# .
)
èè. /
.
èè/ 0
HasMaxLength
èè0 <
(
èè< =
$num
èè= ?
)
èè? @
;
èè@ A
entity
êê 
.
êê 
Property
êê 
(
êê 
e
êê 
=>
êê  
e
êê! "
.
êê" #
Latitude
êê# +
)
êê+ ,
.
êê, -
HasMaxLength
êê- 9
(
êê9 :
$num
êê: =
)
êê= >
;
êê> ?
entity
ëë 
.
ëë 
Property
ëë 
(
ëë 
e
ëë 
=>
ëë  
e
ëë! "
.
ëë" #
	Longitude
ëë# ,
)
ëë, -
.
ëë- .
HasMaxLength
ëë. :
(
ëë: ;
$num
ëë; >
)
ëë> ?
;
ëë? @
entity
íí 
.
íí 
Property
íí 
(
íí 
e
íí 
=>
íí  
e
íí! "
.
íí" #
Name
íí# '
)
íí' (
.
íí( )
HasMaxLength
íí) 5
(
íí5 6
$num
íí6 9
)
íí9 :
;
íí: ;
entity
ìì 
.
ìì 
Property
ìì 
(
ìì 
e
ìì 
=>
ìì  
e
ìì! "
.
ìì" #
ParentId
ìì# +
)
ìì+ ,
.
ìì, -
HasColumnName
ìì- :
(
ìì: ;
$str
ìì; F
)
ììF G
;
ììG H
entity
îî 
.
îî 
Property
îî 
(
îî 
e
îî 
=>
îî  
e
îî! "
.
îî" #
ParentLevel
îî# .
)
îî. /
.
îî/ 0
HasColumnName
îî0 =
(
îî= >
$str
îî> L
)
îîL M
;
îîM N
entity
ïï 
.
ïï 
Property
ïï 
(
ïï 
e
ïï 
=>
ïï  
e
ïï! "
.
ïï" #
	ShortName
ïï# ,
)
ïï, -
.
ïï- .
HasMaxLength
ïï. :
(
ïï: ;
$num
ïï; =
)
ïï= >
;
ïï> ?
entity
ññ 
.
ññ 
Property
ññ 
(
ññ 
e
ññ 
=>
ññ  
e
ññ! "
.
ññ" #
StatusOutlet
ññ# /
)
ññ/ 0
.
ññ0 1
HasMaxLength
ññ1 =
(
ññ= >
$num
ññ> @
)
ññ@ A
;
ññA B
entity
óó 
.
óó 
Property
óó 
(
óó 
e
óó 
=>
óó  
e
óó! "
.
óó" #
Telepon
óó# *
)
óó* +
.
óó+ ,
HasColumnType
óó, 9
(
óó9 :
$str
óó: @
)
óó@ A
;
óóA B
entity
òò 
.
òò 
Property
òò 
(
òò 
e
òò 
=>
òò  
e
òò! "
.
òò" #
UpdatedById
òò# .
)
òò. /
.
òò/ 0
HasColumnName
òò0 =
(
òò= >
$str
òò> L
)
òòL M
;
òòM N
entity
ôô 
.
ôô 
Property
ôô 
(
ôô 
e
ôô 
=>
ôô  
e
ôô! "
.
ôô" #
UpdatedTime
ôô# .
)
ôô. /
.
ôô/ 0
HasColumnType
ôô0 =
(
ôô= >
$str
ôô> H
)
ôôH I
;
ôôI J
}
öö 	
)
öö	 

;
öö
 
modelBuilder
úú 
.
úú 
Entity
úú 
<
úú 
TblMasterUser
úú )
>
úú) *
(
úú* +
entity
úú+ 1
=>
úú2 4
{
ùù 	
entity
ûû 
.
ûû 
ToTable
ûû 
(
ûû 
$str
ûû +
)
ûû+ ,
;
ûû, -
entity
†† 
.
†† 
Property
†† 
(
†† 
e
†† 
=>
††  
e
††! "
.
††" #
CreatedTime
††# .
)
††. /
.
††/ 0
HasColumnType
††0 =
(
††= >
$str
††> H
)
††H I
;
††I J
entity
°° 
.
°° 
Property
°° 
(
°° 
e
°° 
=>
°°  
e
°°! "
.
°°" #
DeletedTime
°°# .
)
°°. /
.
°°/ 0
HasColumnType
°°0 =
(
°°= >
$str
°°> H
)
°°H I
;
°°I J
entity
¢¢ 
.
¢¢ 
Property
¢¢ 
(
¢¢ 
e
¢¢ 
=>
¢¢  
e
¢¢! "
.
¢¢" #
Email
¢¢# (
)
¢¢( )
.
££ 
HasMaxLength
££ 
(
££ 
$num
££  
)
££  !
.
§§ 
	IsUnicode
§§ 
(
§§ 
false
§§  
)
§§  !
;
§§! "
entity
•• 
.
•• 
Property
•• 
(
•• 
e
•• 
=>
••  
e
••! "
.
••" #
Fullname
••# +
)
••+ ,
.
¶¶ 
HasMaxLength
¶¶ 
(
¶¶ 
$num
¶¶  
)
¶¶  !
.
ßß 
	IsUnicode
ßß 
(
ßß 
false
ßß  
)
ßß  !
;
ßß! "
entity
®® 
.
®® 
Property
®® 
(
®® 
e
®® 
=>
®®  
e
®®! "
.
®®" #
IsVerifEmail
®®# /
)
®®/ 0
.
®®0 1
HasMaxLength
®®1 =
(
®®= >
$num
®®> @
)
®®@ A
;
®®A B
entity
©© 
.
©© 
Property
©© 
(
©© 
e
©© 
=>
©©  
e
©©! "
.
©©" #
IsVerifNoTelp
©©# 0
)
©©0 1
.
©©1 2
HasMaxLength
©©2 >
(
©©> ?
$num
©©? A
)
©©A B
;
©©B C
entity
™™ 
.
™™ 
Property
™™ 
(
™™ 
e
™™ 
=>
™™  
e
™™! "
.
™™" #
	LastLogin
™™# ,
)
™™, -
.
™™- .
HasColumnType
™™. ;
(
™™; <
$str
™™< F
)
™™F G
;
™™G H
entity
´´ 
.
´´ 
Property
´´ 
(
´´ 
e
´´ 
=>
´´  
e
´´! "
.
´´" #
NoTelp
´´# )
)
´´) *
.
¨¨ 
HasMaxLength
¨¨ 
(
¨¨ 
$num
¨¨  
)
¨¨  !
.
≠≠ 
	IsUnicode
≠≠ 
(
≠≠ 
false
≠≠  
)
≠≠  !
;
≠≠! "
entity
ÆÆ 
.
ÆÆ 
Property
ÆÆ 
(
ÆÆ 
e
ÆÆ 
=>
ÆÆ  
e
ÆÆ! "
.
ÆÆ" #
Password
ÆÆ# +
)
ÆÆ+ ,
.
ØØ 
HasMaxLength
ØØ 
(
ØØ 
$num
ØØ !
)
ØØ! "
.
∞∞ 
	IsUnicode
∞∞ 
(
∞∞ 
false
∞∞  
)
∞∞  !
;
∞∞! "
entity
±± 
.
±± 
Property
±± 
(
±± 
e
±± 
=>
±±  
e
±±! "
.
±±" #
UpdatedTime
±±# .
)
±±. /
.
±±/ 0
HasColumnType
±±0 =
(
±±= >
$str
±±> H
)
±±H I
;
±±I J
entity
≤≤ 
.
≤≤ 
Property
≤≤ 
(
≤≤ 
e
≤≤ 
=>
≤≤  
e
≤≤! "
.
≤≤" #
Username
≤≤# +
)
≤≤+ ,
.
≥≥ 
HasMaxLength
≥≥ 
(
≥≥ 
$num
≥≥  
)
≥≥  !
.
¥¥ 
	IsUnicode
¥¥ 
(
¥¥ 
false
¥¥  
)
¥¥  !
;
¥¥! "
}
µµ 	
)
µµ	 

;
µµ
 
modelBuilder
∑∑ 
.
∑∑ 
Entity
∑∑ 
<
∑∑  
TblMasterUserVerif
∑∑ .
>
∑∑. /
(
∑∑/ 0
entity
∑∑0 6
=>
∑∑7 9
{
∏∏ 	
entity
ππ 
.
ππ 
ToTable
ππ 
(
ππ 
$str
ππ 1
)
ππ1 2
;
ππ2 3
entity
ªª 
.
ªª 
Property
ªª 
(
ªª 
e
ªª 
=>
ªª  
e
ªª! "
.
ªª" #
CreatedTime
ªª# .
)
ªª. /
.
ªª/ 0
HasColumnType
ªª0 =
(
ªª= >
$str
ªª> H
)
ªªH I
;
ªªI J
entity
ºº 
.
ºº 
Property
ºº 
(
ºº 
e
ºº 
=>
ºº  
e
ºº! "
.
ºº" #
DeletedTime
ºº# .
)
ºº. /
.
ºº/ 0
HasColumnType
ºº0 =
(
ºº= >
$str
ºº> H
)
ººH I
;
ººI J
entity
ΩΩ 
.
ΩΩ 
Property
ΩΩ 
(
ΩΩ 
e
ΩΩ 
=>
ΩΩ  
e
ΩΩ! "
.
ΩΩ" #
Email
ΩΩ# (
)
ΩΩ( )
.
ææ 
HasMaxLength
ææ 
(
ææ 
$num
ææ  
)
ææ  !
.
øø 
	IsUnicode
øø 
(
øø 
false
øø  
)
øø  !
;
øø! "
entity
¿¿ 
.
¿¿ 
Property
¿¿ 
(
¿¿ 
e
¿¿ 
=>
¿¿  
e
¿¿! "
.
¿¿" #
NoTelp
¿¿# )
)
¿¿) *
.
¡¡ 
HasMaxLength
¡¡ 
(
¡¡ 
$num
¡¡  
)
¡¡  !
.
¬¬ 
	IsUnicode
¬¬ 
(
¬¬ 
false
¬¬  
)
¬¬  !
;
¬¬! "
entity
√√ 
.
√√ 
Property
√√ 
(
√√ 
e
√√ 
=>
√√  
e
√√! "
.
√√" #
UpdatedTime
√√# .
)
√√. /
.
√√/ 0
HasColumnType
√√0 =
(
√√= >
$str
√√> H
)
√√H I
;
√√I J
entity
ƒƒ 
.
ƒƒ 
Property
ƒƒ 
(
ƒƒ 
e
ƒƒ 
=>
ƒƒ  
e
ƒƒ! "
.
ƒƒ" #
Username
ƒƒ# +
)
ƒƒ+ ,
.
≈≈ 
HasMaxLength
≈≈ 
(
≈≈ 
$num
≈≈  
)
≈≈  !
.
∆∆ 
	IsUnicode
∆∆ 
(
∆∆ 
false
∆∆  
)
∆∆  !
;
∆∆! "
}
«« 	
)
««	 

;
««
 
modelBuilder
…… 
.
…… 
Entity
…… 
<
…… 
TblNavigation
…… )
>
……) *
(
……* +
entity
……+ 1
=>
……2 4
{
   	
entity
ÀÀ 
.
ÀÀ 
ToTable
ÀÀ 
(
ÀÀ 
$str
ÀÀ +
)
ÀÀ+ ,
;
ÀÀ, -
entity
ÕÕ 
.
ÕÕ 
Property
ÕÕ 
(
ÕÕ 
e
ÕÕ 
=>
ÕÕ  
e
ÕÕ! "
.
ÕÕ" #
CreatedTime
ÕÕ# .
)
ÕÕ. /
.
ÕÕ/ 0
HasColumnType
ÕÕ0 =
(
ÕÕ= >
$str
ÕÕ> H
)
ÕÕH I
;
ÕÕI J
entity
ŒŒ 
.
ŒŒ 
Property
ŒŒ 
(
ŒŒ 
e
ŒŒ 
=>
ŒŒ  
e
ŒŒ! "
.
ŒŒ" #
DeletedTime
ŒŒ# .
)
ŒŒ. /
.
ŒŒ/ 0
HasColumnType
ŒŒ0 =
(
ŒŒ= >
$str
ŒŒ> H
)
ŒŒH I
;
ŒŒI J
entity
œœ 
.
œœ 
Property
œœ 
(
œœ 
e
œœ 
=>
œœ  
e
œœ! "
.
œœ" #
Icon
œœ# '
)
œœ' (
.
œœ( )
HasMaxLength
œœ) 5
(
œœ5 6
$num
œœ6 8
)
œœ8 9
;
œœ9 :
entity
–– 
.
–– 
Property
–– 
(
–– 
e
–– 
=>
––  
e
––! "
.
––" #
Name
––# '
)
––' (
.
—— 
HasMaxLength
—— 
(
—— 
$num
——  
)
——  !
.
““ 
	IsUnicode
““ 
(
““ 
false
““  
)
““  !
;
““! "
entity
”” 
.
”” 
Property
”” 
(
”” 
e
”” 
=>
””  
e
””! "
.
””" #
Route
””# (
)
””( )
.
””) *
HasMaxLength
””* 6
(
””6 7
$num
””7 9
)
””9 :
;
””: ;
entity
‘‘ 
.
‘‘ 
Property
‘‘ 
(
‘‘ 
e
‘‘ 
=>
‘‘  
e
‘‘! "
.
‘‘" #
UpdatedTime
‘‘# .
)
‘‘. /
.
‘‘/ 0
HasColumnType
‘‘0 =
(
‘‘= >
$str
‘‘> H
)
‘‘H I
;
‘‘I J
}
’’ 	
)
’’	 

;
’’
 
modelBuilder
◊◊ 
.
◊◊ 
Entity
◊◊ 
<
◊◊ %
TblNavigationAssignment
◊◊ 3
>
◊◊3 4
(
◊◊4 5
entity
◊◊5 ;
=>
◊◊< >
{
ÿÿ 	
entity
ŸŸ 
.
ŸŸ 
ToTable
ŸŸ 
(
ŸŸ 
$str
ŸŸ 5
)
ŸŸ5 6
;
ŸŸ6 7
entity
€€ 
.
€€ 
Property
€€ 
(
€€ 
e
€€ 
=>
€€  
e
€€! "
.
€€" #
CreatedTime
€€# .
)
€€. /
.
€€/ 0
HasColumnType
€€0 =
(
€€= >
$str
€€> H
)
€€H I
;
€€I J
entity
‹‹ 
.
‹‹ 
Property
‹‹ 
(
‹‹ 
e
‹‹ 
=>
‹‹  
e
‹‹! "
.
‹‹" #
DeletedTime
‹‹# .
)
‹‹. /
.
‹‹/ 0
HasColumnType
‹‹0 =
(
‹‹= >
$str
‹‹> H
)
‹‹H I
;
‹‹I J
entity
›› 
.
›› 
Property
›› 
(
›› 
e
›› 
=>
››  
e
››! "
.
››" #
UpdatedTime
››# .
)
››. /
.
››/ 0
HasColumnType
››0 =
(
››= >
$str
››> H
)
››H I
;
››I J
}
ﬁﬁ 	
)
ﬁﬁ	 

;
ﬁﬁ
 
modelBuilder
‡‡ 
.
‡‡ 
Entity
‡‡ 
<
‡‡ %
TblNoticeOfDisbursement
‡‡ 3
>
‡‡3 4
(
‡‡4 5
entity
‡‡5 ;
=>
‡‡< >
{
·· 	
entity
‚‚ 
.
‚‚ 
HasKey
‚‚ 
(
‚‚ 
e
‚‚ 
=>
‚‚ 
e
‚‚  
.
‚‚  !
Id
‚‚! #
)
‚‚# $
.
‚‚$ %
HasName
‚‚% ,
(
‚‚, -
$str
‚‚- M
)
‚‚M N
;
‚‚N O
entity
‰‰ 
.
‰‰ 
ToTable
‰‰ 
(
‰‰ 
$str
‰‰ 7
)
‰‰7 8
;
‰‰8 9
entity
ÊÊ 
.
ÊÊ 
Property
ÊÊ 
(
ÊÊ 
e
ÊÊ 
=>
ÊÊ  
e
ÊÊ! "
.
ÊÊ" #
Beneficiary
ÊÊ# .
)
ÊÊ. /
.
ÁÁ 
HasMaxLength
ÁÁ 
(
ÁÁ 
$num
ÁÁ !
)
ÁÁ! "
.
ËË 
	IsUnicode
ËË 
(
ËË 
false
ËË  
)
ËË  !
;
ËË! "
entity
ÈÈ 
.
ÈÈ 
Property
ÈÈ 
(
ÈÈ 
e
ÈÈ 
=>
ÈÈ  
e
ÈÈ! "
.
ÈÈ" #
Cur
ÈÈ# &
)
ÈÈ& '
.
ÍÍ 
HasMaxLength
ÍÍ 
(
ÍÍ 
$num
ÍÍ  
)
ÍÍ  !
.
ÎÎ 
	IsUnicode
ÎÎ 
(
ÎÎ 
false
ÎÎ  
)
ÎÎ  !
;
ÎÎ! "
entity
ÏÏ 
.
ÏÏ 
Property
ÏÏ 
(
ÏÏ 
e
ÏÏ 
=>
ÏÏ  
e
ÏÏ! "
.
ÏÏ" #
FileUploadNodid
ÏÏ# 2
)
ÏÏ2 3
.
ÏÏ3 4
HasColumnName
ÏÏ4 A
(
ÏÏA B
$str
ÏÏB S
)
ÏÏS T
;
ÏÏT U
entity
ÌÌ 
.
ÌÌ 
Property
ÌÌ 
(
ÌÌ 
e
ÌÌ 
=>
ÌÌ  
e
ÌÌ! "
.
ÌÌ" #
IdNodFromApi
ÌÌ# /
)
ÌÌ/ 0
.
ÌÌ0 1
HasMaxLength
ÌÌ1 =
(
ÌÌ= >
$num
ÌÌ> A
)
ÌÌA B
;
ÌÌB C
entity
ÓÓ 
.
ÓÓ 
Property
ÓÓ 
(
ÓÓ 
e
ÓÓ 
=>
ÓÓ  
e
ÓÓ! "
.
ÓÓ" #
NodDate
ÓÓ# *
)
ÓÓ* +
.
ÓÓ+ ,
HasColumnName
ÓÓ, 9
(
ÓÓ9 :
$str
ÓÓ: C
)
ÓÓC D
;
ÓÓD E
entity
ÔÔ 
.
ÔÔ 
Property
ÔÔ 
(
ÔÔ 
e
ÔÔ 
=>
ÔÔ  
e
ÔÔ! "
.
ÔÔ" #
NodNo
ÔÔ# (
)
ÔÔ( )
.
 
HasMaxLength
 
(
 
$num
  
)
  !
.
ÒÒ 
	IsUnicode
ÒÒ 
(
ÒÒ 
false
ÒÒ  
)
ÒÒ  !
;
ÒÒ! "
entity
ÚÚ 
.
ÚÚ 
Property
ÚÚ 
(
ÚÚ 
e
ÚÚ 
=>
ÚÚ  
e
ÚÚ! "
.
ÚÚ" #
Status
ÚÚ# )
)
ÚÚ) *
.
ÛÛ 
HasMaxLength
ÛÛ 
(
ÛÛ 
$num
ÛÛ !
)
ÛÛ! "
.
ÙÙ 
	IsUnicode
ÙÙ 
(
ÙÙ 
false
ÙÙ  
)
ÙÙ  !
;
ÙÙ! "
}
ıı 	
)
ıı	 

;
ıı
 
modelBuilder
˜˜ 
.
˜˜ 
Entity
˜˜ 
<
˜˜ +
TblNoticeOfDisbursementDetail
˜˜ 9
>
˜˜9 :
(
˜˜: ;
entity
˜˜; A
=>
˜˜B D
{
¯¯ 	
entity
˘˘ 
.
˘˘ 
HasKey
˘˘ 
(
˘˘ 
e
˘˘ 
=>
˘˘ 
e
˘˘  
.
˘˘  !
Id
˘˘! #
)
˘˘# $
.
˘˘$ %
HasName
˘˘% ,
(
˘˘, -
$str
˘˘- M
)
˘˘M N
;
˘˘N O
entity
˚˚ 
.
˚˚ 
ToTable
˚˚ 
(
˚˚ 
$str
˚˚ >
)
˚˚> ?
;
˚˚? @
entity
˝˝ 
.
˝˝ 
Property
˝˝ 
(
˝˝ 
e
˝˝ 
=>
˝˝  
e
˝˝! "
.
˝˝" #
Amount
˝˝# )
)
˝˝) *
.
˝˝* +
HasColumnType
˝˝+ 8
(
˝˝8 9
$str
˝˝9 I
)
˝˝I J
;
˝˝J K
entity
˛˛ 
.
˛˛ 
Property
˛˛ 
(
˛˛ 
e
˛˛ 
=>
˛˛  
e
˛˛! "
.
˛˛" #
	AmountIdr
˛˛# ,
)
˛˛, -
.
ˇˇ 
HasColumnType
ˇˇ 
(
ˇˇ 
$str
ˇˇ /
)
ˇˇ/ 0
.
ÄÄ 
HasColumnName
ÄÄ 
(
ÄÄ 
$str
ÄÄ *
)
ÄÄ* +
;
ÄÄ+ ,
entity
ÅÅ 
.
ÅÅ 
Property
ÅÅ 
(
ÅÅ 
e
ÅÅ 
=>
ÅÅ  
e
ÅÅ! "
.
ÅÅ" #
	Apdpldate
ÅÅ# ,
)
ÅÅ, -
.
ÅÅ- .
HasColumnName
ÅÅ. ;
(
ÅÅ; <
$str
ÅÅ< G
)
ÅÅG H
;
ÅÅH I
entity
ÇÇ 
.
ÇÇ 
Property
ÇÇ 
(
ÇÇ 
e
ÇÇ 
=>
ÇÇ  
e
ÇÇ! "
.
ÇÇ" #
Apdplno
ÇÇ# *
)
ÇÇ* +
.
ÉÉ 
HasMaxLength
ÉÉ 
(
ÉÉ 
$num
ÉÉ !
)
ÉÉ! "
.
ÑÑ 
	IsUnicode
ÑÑ 
(
ÑÑ 
false
ÑÑ  
)
ÑÑ  !
.
ÖÖ 
HasColumnName
ÖÖ 
(
ÖÖ 
$str
ÖÖ (
)
ÖÖ( )
;
ÖÖ) *
entity
ÜÜ 
.
ÜÜ 
Property
ÜÜ 
(
ÜÜ 
e
ÜÜ 
=>
ÜÜ  
e
ÜÜ! "
.
ÜÜ" #

ContractNo
ÜÜ# -
)
ÜÜ- .
.
áá 
HasMaxLength
áá 
(
áá 
$num
áá !
)
áá! "
.
àà 
	IsUnicode
àà 
(
àà 
false
àà  
)
àà  !
;
àà! "
entity
ââ 
.
ââ 
Property
ââ 
(
ââ 
e
ââ 
=>
ââ  
e
ââ! "
.
ââ" #
CreditorRef
ââ# .
)
ââ. /
.
ää 
HasMaxLength
ää 
(
ää 
$num
ää !
)
ää! "
.
ãã 
	IsUnicode
ãã 
(
ãã 
false
ãã  
)
ãã  !
;
ãã! "
entity
åå 
.
åå 
Property
åå 
(
åå 
e
åå 
=>
åå  
e
åå! "
.
åå" # 
IdNodDetailFromApi
åå# 5
)
åå5 6
.
åå6 7
HasMaxLength
åå7 C
(
ååC D
$num
ååD G
)
ååG H
;
ååH I
entity
çç 
.
çç 
Property
çç 
(
çç 
e
çç 
=>
çç  
e
çç! "
.
çç" #
RealisasiNo
çç# .
)
çç. /
.
éé 
HasMaxLength
éé 
(
éé 
$num
éé !
)
éé! "
.
èè 
	IsUnicode
èè 
(
èè 
false
èè  
)
èè  !
;
èè! "
}
êê 	
)
êê	 

;
êê
 
modelBuilder
íí 
.
íí 
Entity
íí 
<
íí /
!TblNoticeOfDisbursementDetailTemp
íí =
>
íí= >
(
íí> ?
entity
íí? E
=>
ííF H
{
ìì 	
entity
îî 
.
îî 
HasKey
îî 
(
îî 
e
îî 
=>
îî 
e
îî  
.
îî  !
Id
îî! #
)
îî# $
.
îî$ %
HasName
îî% ,
(
îî, -
$str
îî- M
)
îîM N
;
îîN O
entity
ññ 
.
ññ 
ToTable
ññ 
(
ññ 
$str
ññ B
)
ññB C
;
ññC D
entity
òò 
.
òò 
Property
òò 
(
òò 
e
òò 
=>
òò  
e
òò! "
.
òò" #
Amount
òò# )
)
òò) *
.
òò* +
HasColumnType
òò+ 8
(
òò8 9
$str
òò9 I
)
òòI J
;
òòJ K
entity
ôô 
.
ôô 
Property
ôô 
(
ôô 
e
ôô 
=>
ôô  
e
ôô! "
.
ôô" #
	AmountIdr
ôô# ,
)
ôô, -
.
öö 
HasColumnType
öö 
(
öö 
$str
öö /
)
öö/ 0
.
õõ 
HasColumnName
õõ 
(
õõ 
$str
õõ *
)
õõ* +
;
õõ+ ,
entity
úú 
.
úú 
Property
úú 
(
úú 
e
úú 
=>
úú  
e
úú! "
.
úú" #
	Apdpldate
úú# ,
)
úú, -
.
úú- .
HasColumnName
úú. ;
(
úú; <
$str
úú< G
)
úúG H
;
úúH I
entity
ùù 
.
ùù 
Property
ùù 
(
ùù 
e
ùù 
=>
ùù  
e
ùù! "
.
ùù" #
Apdplno
ùù# *
)
ùù* +
.
ûû 
HasMaxLength
ûû 
(
ûû 
$num
ûû !
)
ûû! "
.
üü 
	IsUnicode
üü 
(
üü 
false
üü  
)
üü  !
.
†† 
HasColumnName
†† 
(
†† 
$str
†† (
)
††( )
;
††) *
entity
°° 
.
°° 
Property
°° 
(
°° 
e
°° 
=>
°°  
e
°°! "
.
°°" #

ContractNo
°°# -
)
°°- .
.
¢¢ 
HasMaxLength
¢¢ 
(
¢¢ 
$num
¢¢ !
)
¢¢! "
.
££ 
	IsUnicode
££ 
(
££ 
false
££  
)
££  !
;
££! "
entity
§§ 
.
§§ 
Property
§§ 
(
§§ 
e
§§ 
=>
§§  
e
§§! "
.
§§" #
CreditorRef
§§# .
)
§§. /
.
•• 
HasMaxLength
•• 
(
•• 
$num
•• !
)
••! "
.
¶¶ 
	IsUnicode
¶¶ 
(
¶¶ 
false
¶¶  
)
¶¶  !
;
¶¶! "
entity
ßß 
.
ßß 
Property
ßß 
(
ßß 
e
ßß 
=>
ßß  
e
ßß! "
.
ßß" #
RandomString
ßß# /
)
ßß/ 0
.
®® 
HasMaxLength
®® 
(
®® 
$num
®®  
)
®®  !
.
©© 
	IsUnicode
©© 
(
©© 
false
©©  
)
©©  !
;
©©! "
entity
™™ 
.
™™ 
Property
™™ 
(
™™ 
e
™™ 
=>
™™  
e
™™! "
.
™™" #
RealisasiNo
™™# .
)
™™. /
.
´´ 
HasMaxLength
´´ 
(
´´ 
$num
´´ !
)
´´! "
.
¨¨ 
	IsUnicode
¨¨ 
(
¨¨ 
false
¨¨  
)
¨¨  !
;
¨¨! "
}
≠≠ 	
)
≠≠	 

;
≠≠
 
modelBuilder
ØØ 
.
ØØ 
Entity
ØØ 
<
ØØ  
TblNoticeOfPayment
ØØ .
>
ØØ. /
(
ØØ/ 0
entity
ØØ0 6
=>
ØØ7 9
{
∞∞ 	
entity
±± 
.
±± 
ToTable
±± 
(
±± 
$str
±± 0
)
±±0 1
;
±±1 2
entity
≥≥ 
.
≥≥ 
Property
≥≥ 
(
≥≥ 
e
≥≥ 
=>
≥≥  
e
≥≥! "
.
≥≥" #
AccountName
≥≥# .
)
≥≥. /
.
¥¥ 
HasMaxLength
¥¥ 
(
¥¥ 
$num
¥¥  
)
¥¥  !
.
µµ 
	IsUnicode
µµ 
(
µµ 
false
µµ  
)
µµ  !
;
µµ! "
entity
∂∂ 
.
∂∂ 
Property
∂∂ 
(
∂∂ 
e
∂∂ 
=>
∂∂  
e
∂∂! "
.
∂∂" #
	AccountNo
∂∂# ,
)
∂∂, -
.
∑∑ 
HasMaxLength
∑∑ 
(
∑∑ 
$num
∑∑  
)
∑∑  !
.
∏∏ 
	IsUnicode
∏∏ 
(
∏∏ 
false
∏∏  
)
∏∏  !
;
∏∏! "
entity
ππ 
.
ππ 
Property
ππ 
(
ππ 
e
ππ 
=>
ππ  
e
ππ! "
.
ππ" #
Cur
ππ# &
)
ππ& '
.
∫∫ 
HasMaxLength
∫∫ 
(
∫∫ 
$num
∫∫  
)
∫∫  !
.
ªª 
	IsUnicode
ªª 
(
ªª 
false
ªª  
)
ªª  !
;
ªª! "
entity
ºº 
.
ºº 
Property
ºº 
(
ºº 
e
ºº 
=>
ºº  
e
ºº! "
.
ºº" #
IdNopFromApi
ºº# /
)
ºº/ 0
.
ºº0 1
HasMaxLength
ºº1 =
(
ºº= >
$num
ºº> A
)
ººA B
;
ººB C
entity
ΩΩ 
.
ΩΩ 
Property
ΩΩ 
(
ΩΩ 
e
ΩΩ 
=>
ΩΩ  
e
ΩΩ! "
.
ΩΩ" #
InterestDays
ΩΩ# /
)
ΩΩ/ 0
.
ΩΩ0 1
HasColumnType
ΩΩ1 >
(
ΩΩ> ?
$str
ΩΩ? O
)
ΩΩO P
;
ΩΩP Q
entity
ææ 
.
ææ 
Property
ææ 
(
ææ 
e
ææ 
=>
ææ  
e
ææ! "
.
ææ" #
InterestRate
ææ# /
)
ææ/ 0
.
ææ0 1
HasColumnType
ææ1 >
(
ææ> ?
$str
ææ? O
)
ææO P
;
ææP Q
entity
øø 
.
øø 
Property
øø 
(
øø 
e
øø 
=>
øø  
e
øø! "
.
øø" #
NopNo
øø# (
)
øø( )
.
¿¿ 
HasMaxLength
¿¿ 
(
¿¿ 
$num
¿¿  
)
¿¿  !
.
¡¡ 
	IsUnicode
¡¡ 
(
¡¡ 
false
¡¡  
)
¡¡  !
;
¡¡! "
entity
¬¬ 
.
¬¬ 
Property
¬¬ 
(
¬¬ 
e
¬¬ 
=>
¬¬  
e
¬¬! "
.
¬¬" #

RekNameAcc
¬¬# -
)
¬¬- .
.
√√ 
HasMaxLength
√√ 
(
√√ 
$num
√√  
)
√√  !
.
ƒƒ 
	IsUnicode
ƒƒ 
(
ƒƒ 
false
ƒƒ  
)
ƒƒ  !
;
ƒƒ! "
entity
≈≈ 
.
≈≈ 
Property
≈≈ 
(
≈≈ 
e
≈≈ 
=>
≈≈  
e
≈≈! "
.
≈≈" #
Status
≈≈# )
)
≈≈) *
.
∆∆ 
HasMaxLength
∆∆ 
(
∆∆ 
$num
∆∆ !
)
∆∆! "
.
«« 
	IsUnicode
«« 
(
«« 
false
««  
)
««  !
;
««! "
}
»» 	
)
»»	 

;
»»
 
modelBuilder
   
.
   
Entity
   
<
   &
TblNoticeOfPaymentDetail
   4
>
  4 5
(
  5 6
entity
  6 <
=>
  = ?
{
ÀÀ 	
entity
ÃÃ 
.
ÃÃ 
HasKey
ÃÃ 
(
ÃÃ 
e
ÃÃ 
=>
ÃÃ 
e
ÃÃ  
.
ÃÃ  !
Id
ÃÃ! #
)
ÃÃ# $
.
ÃÃ$ %
HasName
ÃÃ% ,
(
ÃÃ, -
$str
ÃÃ- 1
)
ÃÃ1 2
;
ÃÃ2 3
entity
ŒŒ 
.
ŒŒ 
ToTable
ŒŒ 
(
ŒŒ 
$str
ŒŒ 6
)
ŒŒ6 7
;
ŒŒ7 8
entity
–– 
.
–– 
Property
–– 
(
–– 
e
–– 
=>
––  
e
––! "
.
––" #
CreditorRef
––# .
)
––. /
.
—— 
HasMaxLength
—— 
(
—— 
$num
——  
)
——  !
.
““ 
	IsUnicode
““ 
(
““ 
false
““  
)
““  !
;
““! "
entity
”” 
.
”” 
Property
”” 
(
”” 
e
”” 
=>
””  
e
””! "
.
””" #
Fee
””# &
)
””& '
.
””' (
HasColumnType
””( 5
(
””5 6
$str
””6 F
)
””F G
;
””G H
entity
‘‘ 
.
‘‘ 
Property
‘‘ 
(
‘‘ 
e
‘‘ 
=>
‘‘  
e
‘‘! "
.
‘‘" # 
IdNopDetailFromApi
‘‘# 5
)
‘‘5 6
.
’’ 
HasMaxLength
’’ 
(
’’ 
$num
’’ !
)
’’! "
.
÷÷ 
	IsUnicode
÷÷ 
(
÷÷ 
false
÷÷  
)
÷÷  !
;
÷÷! "
entity
◊◊ 
.
◊◊ 
Property
◊◊ 
(
◊◊ 
e
◊◊ 
=>
◊◊  
e
◊◊! "
.
◊◊" #
Interest
◊◊# +
)
◊◊+ ,
.
◊◊, -
HasColumnType
◊◊- :
(
◊◊: ;
$str
◊◊; K
)
◊◊K L
;
◊◊L M
entity
ÿÿ 
.
ÿÿ 
Property
ÿÿ 
(
ÿÿ 
e
ÿÿ 
=>
ÿÿ  
e
ÿÿ! "
.
ÿÿ" #
Outstanding
ÿÿ# .
)
ÿÿ. /
.
ÿÿ/ 0
HasColumnType
ÿÿ0 =
(
ÿÿ= >
$str
ÿÿ> N
)
ÿÿN O
;
ÿÿO P
entity
ŸŸ 
.
ŸŸ 
Property
ŸŸ 
(
ŸŸ 
e
ŸŸ 
=>
ŸŸ  
e
ŸŸ! "
.
ŸŸ" #
	Principal
ŸŸ# ,
)
ŸŸ, -
.
ŸŸ- .
HasColumnType
ŸŸ. ;
(
ŸŸ; <
$str
ŸŸ< L
)
ŸŸL M
;
ŸŸM N
}
⁄⁄ 	
)
⁄⁄	 

;
⁄⁄
 
modelBuilder
‹‹ 
.
‹‹ 
Entity
‹‹ 
<
‹‹ *
TblNoticeOfPaymentDetailTemp
‹‹ 8
>
‹‹8 9
(
‹‹9 :
entity
‹‹: @
=>
‹‹A C
{
›› 	
entity
ﬁﬁ 
.
ﬁﬁ 
HasKey
ﬁﬁ 
(
ﬁﬁ 
e
ﬁﬁ 
=>
ﬁﬁ 
e
ﬁﬁ  
.
ﬁﬁ  !
Id
ﬁﬁ! #
)
ﬁﬁ# $
.
ﬁﬁ$ %
HasName
ﬁﬁ% ,
(
ﬁﬁ, -
$str
ﬁﬁ- M
)
ﬁﬁM N
;
ﬁﬁN O
entity
‡‡ 
.
‡‡ 
ToTable
‡‡ 
(
‡‡ 
$str
‡‡ =
)
‡‡= >
;
‡‡> ?
entity
‚‚ 
.
‚‚ 
Property
‚‚ 
(
‚‚ 
e
‚‚ 
=>
‚‚  
e
‚‚! "
.
‚‚" #
CreatedTime
‚‚# .
)
‚‚. /
.
‚‚/ 0
HasColumnType
‚‚0 =
(
‚‚= >
$str
‚‚> H
)
‚‚H I
;
‚‚I J
entity
„„ 
.
„„ 
Property
„„ 
(
„„ 
e
„„ 
=>
„„  
e
„„! "
.
„„" #
CreditorRef
„„# .
)
„„. /
.
‰‰ 
HasMaxLength
‰‰ 
(
‰‰ 
$num
‰‰  
)
‰‰  !
.
ÂÂ 
	IsUnicode
ÂÂ 
(
ÂÂ 
false
ÂÂ  
)
ÂÂ  !
;
ÂÂ! "
entity
ÊÊ 
.
ÊÊ 
Property
ÊÊ 
(
ÊÊ 
e
ÊÊ 
=>
ÊÊ  
e
ÊÊ! "
.
ÊÊ" #
Fee
ÊÊ# &
)
ÊÊ& '
.
ÊÊ' (
HasColumnType
ÊÊ( 5
(
ÊÊ5 6
$str
ÊÊ6 F
)
ÊÊF G
;
ÊÊG H
entity
ÁÁ 
.
ÁÁ 
Property
ÁÁ 
(
ÁÁ 
e
ÁÁ 
=>
ÁÁ  
e
ÁÁ! "
.
ÁÁ" #
Interest
ÁÁ# +
)
ÁÁ+ ,
.
ÁÁ, -
HasColumnType
ÁÁ- :
(
ÁÁ: ;
$str
ÁÁ; K
)
ÁÁK L
;
ÁÁL M
entity
ËË 
.
ËË 
Property
ËË 
(
ËË 
e
ËË 
=>
ËË  
e
ËË! "
.
ËË" #
Outstanding
ËË# .
)
ËË. /
.
ËË/ 0
HasColumnType
ËË0 =
(
ËË= >
$str
ËË> N
)
ËËN O
;
ËËO P
entity
ÈÈ 
.
ÈÈ 
Property
ÈÈ 
(
ÈÈ 
e
ÈÈ 
=>
ÈÈ  
e
ÈÈ! "
.
ÈÈ" #
	Principal
ÈÈ# ,
)
ÈÈ, -
.
ÈÈ- .
HasColumnType
ÈÈ. ;
(
ÈÈ; <
$str
ÈÈ< L
)
ÈÈL M
;
ÈÈM N
entity
ÍÍ 
.
ÍÍ 
Property
ÍÍ 
(
ÍÍ 
e
ÍÍ 
=>
ÍÍ  
e
ÍÍ! "
.
ÍÍ" #
RandomString
ÍÍ# /
)
ÍÍ/ 0
.
ÎÎ 
HasMaxLength
ÎÎ 
(
ÎÎ 
$num
ÎÎ  
)
ÎÎ  !
.
ÏÏ 
	IsUnicode
ÏÏ 
(
ÏÏ 
false
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
entity
ÌÌ 
.
ÌÌ 
Property
ÌÌ 
(
ÌÌ 
e
ÌÌ 
=>
ÌÌ  
e
ÌÌ! "
.
ÌÌ" #
UpdatedTime
ÌÌ# .
)
ÌÌ. /
.
ÌÌ/ 0
HasColumnType
ÌÌ0 =
(
ÌÌ= >
$str
ÌÌ> H
)
ÌÌH I
;
ÌÌI J
}
ÓÓ 	
)
ÓÓ	 

;
ÓÓ
 
modelBuilder
 
.
 
Entity
 
<
 
TblUserSession
 *
>
* +
(
+ ,
entity
, 2
=>
3 5
{
ÒÒ 	
entity
ÚÚ 
.
ÚÚ 
ToTable
ÚÚ 
(
ÚÚ 
$str
ÚÚ ,
)
ÚÚ, -
;
ÚÚ- .
entity
ÙÙ 
.
ÙÙ 
Property
ÙÙ 
(
ÙÙ 
e
ÙÙ 
=>
ÙÙ  
e
ÙÙ! "
.
ÙÙ" #
Info
ÙÙ# '
)
ÙÙ' (
.
ÙÙ( )
HasMaxLength
ÙÙ) 5
(
ÙÙ5 6
$num
ÙÙ6 8
)
ÙÙ8 9
;
ÙÙ9 :
entity
ıı 
.
ıı 
Property
ıı 
(
ıı 
e
ıı 
=>
ıı  
e
ıı! "
.
ıı" #

LastActive
ıı# -
)
ıı- .
.
ıı. /
HasColumnType
ıı/ <
(
ıı< =
$str
ıı= G
)
ııG H
;
ııH I
entity
ˆˆ 
.
ˆˆ 
Property
ˆˆ 
(
ˆˆ 
e
ˆˆ 
=>
ˆˆ  
e
ˆˆ! "
.
ˆˆ" #
	SessionId
ˆˆ# ,
)
ˆˆ, -
.
ˆˆ- .
HasMaxLength
ˆˆ. :
(
ˆˆ: ;
$num
ˆˆ; =
)
ˆˆ= >
;
ˆˆ> ?
}
˜˜ 	
)
˜˜	 

;
˜˜
 $
OnModelCreatingPartial
˘˘ 
(
˘˘ 
modelBuilder
˘˘ +
)
˘˘+ ,
;
˘˘, -
}
˙˙ 
partial
¸¸ 
void
¸¸ $
OnModelCreatingPartial
¸¸ '
(
¸¸' (
ModelBuilder
¸¸( 4
modelBuilder
¸¸5 A
)
¸¸A B
;
¸¸B C
}˝˝ ÷ƒ
[D:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\NoticeOfDisbursementController.cs
	namespace%% 	
DashboardDevaBNI%%
 
.%% 
Controllers%% &
{&& 
public'' 

class'' *
NoticeOfDisbursementController'' /
:''0 1

Controller''2 <
{(( 
private)) 
readonly)) %
DbDashboardDevaBniContext)) 2
_context))3 ;
;)); <
private** 
readonly** 
IConfiguration** '
_configuration**( 6
;**6 7
private++ 
readonly++ 

IConverter++ #

_converter++$ .
;++. /
private,, 
readonly,, 
LastSessionLog,, '
lastSession,,( 3
;,,3 4
private-- 
readonly-- 
AccessSecurity-- '
accessSecurity--( 6
;--6 7
public.. *
NoticeOfDisbursementController.. -
(..- .
IConfiguration... <
config..= C
,..C D%
DbDashboardDevaBniContext..E ^
context.._ f
,..f g 
IHttpContextAccessor..h |
accessor	..} Ö
)
..Ö Ü
{// 	
_context00 
=00 
context00 
;00 
_configuration11 
=11 
config11 #
;11# $
lastSession22 
=22 
new22 
LastSessionLog22 ,
(22, -
accessor22- 5
,225 6
context227 >
,22> ?
config22@ F
)22F G
;22G H
accessSecurity33 
=33 
new33  
AccessSecurity33! /
(33/ 0
accessor330 8
,338 9
context33: A
,33A B
config33C I
)33I J
;33J K
}44 	
public66 
IActionResult66 
Index66 "
(66" #
)66# $
{77 	
if88 
(88 
!88 
lastSession88 
.88 
Update88 #
(88# $
)88$ %
)88% &
{99 
return:: 
RedirectToAction:: '
(::' (
$str::( /
,::/ 0
	GetConfig::1 :
.::: ;

AppSetting::; E
[::E F
$str::F n
]::n o
+::p q
$str::r y
,::y z
new::{ ~
{	:: Ä
a
::Å Ç
=
::É Ñ
true
::Ö â
}
::ä ã
)
::ã å
;
::å ç
};; 
var<< 
location<< 
=<< 
new<< 
Uri<< "
(<<" #
$"<<# %
{<<% &
Request<<& -
.<<- .
Scheme<<. 4
}<<4 5
$str<<5 8
{<<8 9
Request<<9 @
.<<@ A
Host<<A E
}<<E F
{<<F G
Request<<G N
.<<N O
Path<<O S
}<<S T
"<<T U
)<<U V
;<<V W
string== 
Path== 
=== 
location== "
.==" #
AbsolutePath==# /
;==/ 0
if>> 
(>> 
!>> 
accessSecurity>> 
.>>  
IsGetAccess>>  +
(>>+ ,
$str>>, 0
+>>1 2
Path>>3 7
)>>7 8
)>>8 9
{?? 
return@@ 
RedirectToAction@@ '
(@@' (
$str@@( 3
,@@3 4
	GetConfig@@5 >
.@@> ?

AppSetting@@? I
[@@I J
$str@@J r
]@@r s
+@@t u
$str@@v }
)@@} ~
;@@~ 
}AA 
ViewBagCC 
.CC 
CurrentPathCC 
=CC  !
PathCC" &
;CC& '
returnDD 
ViewDD 
(DD 
)DD 
;DD 
}EE 	
[HH 	
HttpPostHH	 
]HH 
publicII 
IActionResultII 
LoadDataII %
(II% &
)II& '
{JJ 	
ifKK 
(KK 
!KK 
lastSessionKK 
.KK 
UpdateKK #
(KK# $
)KK$ %
)KK% &
{LL 
returnMM 
RedirectToActionMM '
(MM' (
$strMM( /
,MM/ 0
	GetConfigMM1 :
.MM: ;

AppSettingMM; E
[MME F
$strMMF n
]MMn o
+MMp q
$strMMr y
,MMy z
newMM{ ~
{	MM Ä
a
MMÅ Ç
=
MMÉ Ñ
true
MMÖ â
}
MMä ã
)
MMã å
;
MMå ç
}NN 
varOO 
locationOO 
=OO 
newOO 
UriOO "
(OO" #
$"OO# %
{OO% &
RequestOO& -
.OO- .
SchemeOO. 4
}OO4 5
$strOO5 8
{OO8 9
RequestOO9 @
.OO@ A
HostOOA E
}OOE F
{OOF G
RequestOOG N
.OON O
PathOOO S
}OOS T
"OOT U
)OOU V
;OOV W
stringPP 
PathPP 
=PP 
locationPP "
.PP" #
AbsolutePathPP# /
.PP/ 0
ReplacePP0 7
(PP7 8
thisPP8 <
.PP< =
ControllerContextPP= N
.PPN O
	RouteDataPPO X
.PPX Y
ValuesPPY _
[PP_ `
$strPP` h
]PPh i
.PPi j
ToStringPPj r
(PPr s
)PPs t
,PPt u
$strPPv }
)PP} ~
;PP~ 
ifQQ 
(QQ 
!QQ 
accessSecurityQQ 
.QQ  
IsGetAccessQQ  +
(QQ+ ,
$strQQ, 0
+QQ1 2
PathQQ3 7
)QQ7 8
)QQ8 9
{RR 
returnSS 
RedirectToActionSS '
(SS' (
$strSS( 3
,SS3 4
$strSS5 <
)SS< =
;SS= >
}TT 
tryVV 
{WW 
varXX 
dictXX 
=XX 
RequestXX "
.XX" #
FormXX# '
.XX' (
ToDictionaryXX( 4
(XX4 5
xXX5 6
=>XX7 9
xXX: ;
.XX; <
KeyXX< ?
,XX? @
xXXA B
=>XXC E
xXXF G
.XXG H
ValueXXH M
.XXM N
ToStringXXN V
(XXV W
)XXW X
)XXX Y
;XXY Z
varZZ 
drawZZ 
=ZZ 
dictZZ 
[ZZ  
$strZZ  &
]ZZ& '
;ZZ' (
var]] 
start]] 
=]] 
dict]]  
[]]  !
$str]]! (
]]]( )
;]]) *
var^^ 
length^^ 
=^^ 
dict^^ !
[^^! "
$str^^" *
]^^* +
;^^+ ,
varbb 

pageNumberbb 
=bb  
(bb! "
intbb" %
.bb% &
Parsebb& +
(bb+ ,
startbb, 1
)bb1 2
/bb3 4
intbb5 8
.bb8 9
Parsebb9 >
(bb> ?
lengthbb? E
)bbE F
)bbF G
+bbH I
$numbbJ K
;bbK L
varee 

sortColumnee 
=ee  
dictee! %
[ee% &
$stree& 0
+ee1 2
dictee3 7
[ee7 8
$stree8 J
]eeJ K
+eeL M
$streeN W
]eeW X
;eeX Y
varff 
sortColumnDirff !
=ff" #
dictff$ (
[ff( )
$strff) 8
]ff8 9
;ff9 :
vargg 
NodNogg 
=gg 
dictgg  
[gg  !
$strgg! <
]gg< =
;gg= >
varhh 
NodDatehh 
=hh 
dicthh "
[hh" #
$strhh# >
]hh> ?
;hh? @
intkk 
pageSizekk 
=kk 
lengthkk %
!=kk& (
nullkk) -
?kk. /
Convertkk0 7
.kk7 8
ToInt32kk8 ?
(kk? @
lengthkk@ F
)kkF G
:kkH I
$numkkJ K
;kkK L
intll 
skipll 
=ll 
startll  
!=ll! #
nullll$ (
?ll) *
Convertll+ 2
.ll2 3
ToInt32ll3 :
(ll: ;
startll; @
)ll@ A
:llB C
$numllD E
;llE F
intmm 
recordsTotalmm  
=mm! "
$nummm# $
;mm$ %
CultureInfooo 
cultureoo #
=oo$ %
newoo& )
CultureInfooo* 5
(oo5 6
$stroo6 =
)oo= >
;oo> ?
varpp 
	dateArraypp 
=pp 
newpp  #
stringpp$ *
[pp* +
]pp+ ,
{pp- .
}pp/ 0
;pp0 1
ifrr 
(rr 
!rr 
stringrr 
.rr 
IsNullOrEmptyrr )
(rr) *
NodDaterr* 1
)rr1 2
)rr2 3
{ss 
	dateArraytt 
=tt 
NodDatett  '
.tt' (
Splittt( -
(tt- .
$strtt. 4
)tt4 5
;tt5 6
}uu 
Listww 
<ww *
NoticeOfDisbursement_ViewModelww 3
>ww3 4
listww5 9
=ww: ;
newww< ?
Listww@ D
<wwD E*
NoticeOfDisbursement_ViewModelwwE c
>wwc d
(wwd e
)wwe f
;wwf g
listxx 
=xx #
StoredProcedureExecutorxx .
.xx. /
ExecuteSPListxx/ <
<xx< =*
NoticeOfDisbursement_ViewModelxx= [
>xx[ \
(xx\ ]
_contextxx] e
,xxe f
$str	xxg ã
,
xxã å
new
xxç ê
SqlParameter
xxë ù
[
xxù û
]
xxû ü
{
xxü †
newyy 
SqlParameteryy (
(yy( )
$stryy) 1
,yy1 2
NodNoyy3 8
)yy8 9
,yy9 :
newzz 
SqlParameterzz (
(zz( )
$strzz) 7
,zz7 8
	dateArrayzz9 B
.zzB C
CountzzC H
(zzH I
)zzI J
==zzK M
$numzzN O
?zzP Q
$strzzR T
:zzU V
DateTimezzW _
.zz_ `
Parsezz` e
(zze f
	dateArrayzzf o
[zzo p
$numzzp q
]zzq r
,zzr s
culturezzt {
)zz{ |
)zz| }
,zz} ~
new{{ 
SqlParameter{{ (
({{( )
$str{{) 5
,{{5 6
	dateArray{{7 @
.{{@ A
Count{{A F
({{F G
){{G H
=={{I K
$num{{L M
?{{N O
$str{{P R
:{{S T
DateTime{{U ]
.{{] ^
Parse{{^ c
({{c d
	dateArray{{d m
[{{m n
$num{{n o
]{{o p
,{{p q
culture{{r y
){{y z
){{z {
,{{{ |
new|| 
SqlParameter|| (
(||( )
$str||) 6
,||6 7

sortColumn||8 B
)||B C
,||C D
new}} 
SqlParameter}} (
(}}( )
$str}}) 9
,}}9 :
sortColumnDir}}; H
)}}H I
,}}I J
new~~ 
SqlParameter~~ (
(~~( )
$str~~) 6
,~~6 7

pageNumber~~8 B
)~~B C
,~~C D
new 
SqlParameter (
(( )
$str) 4
,4 5
pageSize6 >
)> ?
}? @
)@ A
;A B
recordsTotal
ÅÅ 
=
ÅÅ %
StoredProcedureExecutor
ÅÅ 6
.
ÅÅ6 7
ExecuteScalarInt
ÅÅ7 G
(
ÅÅG H
_context
ÅÅH P
,
ÅÅP Q
$str
ÅÅR w
,
ÅÅw x
new
ÅÅy |
SqlParameterÅÅ} â
[ÅÅâ ä
]ÅÅä ã
{ÅÅã å
new
ÇÇ 
SqlParameter
ÇÇ (
(
ÇÇ( )
$str
ÇÇ) 1
,
ÇÇ1 2
NodNo
ÇÇ3 8
)
ÇÇ8 9
,
ÇÇ9 :
new
ÉÉ 
SqlParameter
ÉÉ (
(
ÉÉ( )
$str
ÉÉ) 7
,
ÉÉ7 8
	dateArray
ÉÉ9 B
.
ÉÉB C
Count
ÉÉC H
(
ÉÉH I
)
ÉÉI J
==
ÉÉK M
$num
ÉÉN O
?
ÉÉP Q
$str
ÉÉR T
:
ÉÉU V
DateTime
ÉÉW _
.
ÉÉ_ `
Parse
ÉÉ` e
(
ÉÉe f
	dateArray
ÉÉf o
[
ÉÉo p
$num
ÉÉp q
]
ÉÉq r
,
ÉÉr s
culture
ÉÉt {
)
ÉÉ{ |
)
ÉÉ| }
,
ÉÉ} ~
new
ÑÑ 
SqlParameter
ÑÑ (
(
ÑÑ( )
$str
ÑÑ) 5
,
ÑÑ5 6
	dateArray
ÑÑ7 @
.
ÑÑ@ A
Count
ÑÑA F
(
ÑÑF G
)
ÑÑG H
==
ÑÑI K
$num
ÑÑL M
?
ÑÑN O
$str
ÑÑP R
:
ÑÑS T
DateTime
ÑÑU ]
.
ÑÑ] ^
Parse
ÑÑ^ c
(
ÑÑc d
	dateArray
ÑÑd m
[
ÑÑm n
$num
ÑÑn o
]
ÑÑo p
,
ÑÑp q
culture
ÑÑr y
)
ÑÑy z
)
ÑÑz {
,
ÑÑ{ |
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
if
áá 
(
áá 
list
áá 
==
áá 
null
áá  
)
áá  !
{
àà 
list
ââ 
=
ââ 
new
ââ 
List
ââ #
<
ââ# $,
NoticeOfDisbursement_ViewModel
ââ$ B
>
ââB C
(
ââC D
)
ââD E
;
ââE F
recordsTotal
ää  
=
ää! "
$num
ää# $
;
ää$ %
}
ãã 
return
çç 
Json
çç 
(
çç 
new
çç 
{
çç  !
draw
çç" &
=
çç' (
draw
çç) -
,
çç- .
recordsFiltered
çç/ >
=
çç? @
recordsTotal
ççA M
,
ççM N
recordsTotal
ççO [
=
çç\ ]
recordsTotal
çç^ j
,
ççj k
data
ççl p
=
ççq r
list
ççs w
}
ççx y
)
ççy z
;
ççz {
}
éé 
catch
èè 
(
èè 
	Exception
èè 
Ex
èè 
)
èè  
{
êê 
throw
ëë 
;
ëë 
}
íí 
}
ìì 	
[
îî 	
HttpPost
îî	 
]
îî 
public
ïï 
IActionResult
ïï #
LoadDataDetailNodTemp
ïï 2
(
ïï2 3
string
ïï3 9
randomstring
ïï: F
)
ïïF G
{
ññ 	
if
óó 
(
óó 
!
óó 
lastSession
óó 
.
óó 
Update
óó #
(
óó# $
)
óó$ %
)
óó% &
{
òò 
return
ôô 
RedirectToAction
ôô '
(
ôô' (
$str
ôô( /
,
ôô/ 0
	GetConfig
ôô1 :
.
ôô: ;

AppSetting
ôô; E
[
ôôE F
$str
ôôF n
]
ôôn o
+
ôôp q
$str
ôôr y
,
ôôy z
new
ôô{ ~
{ôô Ä
aôôÅ Ç
=ôôÉ Ñ
trueôôÖ â
}ôôä ã
)ôôã å
;ôôå ç
}
öö 
var
õõ 
location
õõ 
=
õõ 
new
õõ 
Uri
õõ "
(
õõ" #
$"
õõ# %
{
õõ% &
Request
õõ& -
.
õõ- .
Scheme
õõ. 4
}
õõ4 5
$str
õõ5 8
{
õõ8 9
Request
õõ9 @
.
õõ@ A
Host
õõA E
}
õõE F
{
õõF G
Request
õõG N
.
õõN O
Path
õõO S
}
õõS T
"
õõT U
)
õõU V
;
õõV W
string
úú 
Path
úú 
=
úú 
location
úú "
.
úú" #
AbsolutePath
úú# /
.
úú/ 0
Replace
úú0 7
(
úú7 8
this
úú8 <
.
úú< =
ControllerContext
úú= N
.
úúN O
	RouteData
úúO X
.
úúX Y
Values
úúY _
[
úú_ `
$str
úú` h
]
úúh i
.
úúi j
ToString
úúj r
(
úúr s
)
úús t
,
úút u
$str
úúv }
)
úú} ~
;
úú~ 
if
ùù 
(
ùù 
!
ùù 
accessSecurity
ùù 
.
ùù  
IsGetAccess
ùù  +
(
ùù+ ,
$str
ùù, 0
+
ùù1 2
Path
ùù3 7
)
ùù7 8
)
ùù8 9
{
ûû 
return
üü 
RedirectToAction
üü '
(
üü' (
$str
üü( 3
,
üü3 4
$str
üü5 <
)
üü< =
;
üü= >
}
†† 
try
¢¢ 
{
££ 
var
§§ 
dict
§§ 
=
§§ 
Request
§§ "
.
§§" #
Form
§§# '
.
§§' (
ToDictionary
§§( 4
(
§§4 5
x
§§5 6
=>
§§7 9
x
§§: ;
.
§§; <
Key
§§< ?
,
§§? @
x
§§A B
=>
§§C E
x
§§F G
.
§§G H
Value
§§H M
.
§§M N
ToString
§§N V
(
§§V W
)
§§W X
)
§§X Y
;
§§Y Z
var
¶¶ 
draw
¶¶ 
=
¶¶ 
dict
¶¶ 
[
¶¶  
$str
¶¶  &
]
¶¶& '
;
¶¶' (
var
©© 
start
©© 
=
©© 
dict
©©  
[
©©  !
$str
©©! (
]
©©( )
;
©©) *
var
™™ 
length
™™ 
=
™™ 
dict
™™ !
[
™™! "
$str
™™" *
]
™™* +
;
™™+ ,
var
ÆÆ 

pageNumber
ÆÆ 
=
ÆÆ  
(
ÆÆ! "
int
ÆÆ" %
.
ÆÆ% &
Parse
ÆÆ& +
(
ÆÆ+ ,
start
ÆÆ, 1
)
ÆÆ1 2
/
ÆÆ3 4
int
ÆÆ5 8
.
ÆÆ8 9
Parse
ÆÆ9 >
(
ÆÆ> ?
length
ÆÆ? E
)
ÆÆE F
)
ÆÆF G
+
ÆÆH I
$num
ÆÆJ K
;
ÆÆK L
var
±± 

sortColumn
±± 
=
±±  
dict
±±! %
[
±±% &
$str
±±& 0
+
±±1 2
dict
±±3 7
[
±±7 8
$str
±±8 J
]
±±J K
+
±±L M
$str
±±N W
]
±±W X
;
±±X Y
var
≤≤ 
sortColumnDir
≤≤ !
=
≤≤" #
dict
≤≤$ (
[
≤≤( )
$str
≤≤) 8
]
≤≤8 9
;
≤≤9 :
int
µµ 
pageSize
µµ 
=
µµ 
length
µµ %
!=
µµ& (
null
µµ) -
?
µµ. /
Convert
µµ0 7
.
µµ7 8
ToInt32
µµ8 ?
(
µµ? @
length
µµ@ F
)
µµF G
:
µµH I
$num
µµJ K
;
µµK L
int
∂∂ 
skip
∂∂ 
=
∂∂ 
start
∂∂  
!=
∂∂! #
null
∂∂$ (
?
∂∂) *
Convert
∂∂+ 2
.
∂∂2 3
ToInt32
∂∂3 :
(
∂∂: ;
start
∂∂; @
)
∂∂@ A
:
∂∂B C
$num
∂∂D E
;
∂∂E F
int
∑∑ 
recordsTotal
∑∑  
=
∑∑! "
$num
∑∑# $
;
∑∑$ %
List
ππ 
<
ππ ,
NoticeOfDisbursement_ViewModel
ππ 3
>
ππ3 4
list
ππ5 9
=
ππ: ;
new
ππ< ?
List
ππ@ D
<
ππD E,
NoticeOfDisbursement_ViewModel
ππE c
>
ππc d
(
ππd e
)
ππe f
;
ππf g
list
ªª 
=
ªª %
StoredProcedureExecutor
ªª .
.
ªª. /
ExecuteSPList
ªª/ <
<
ªª< =,
NoticeOfDisbursement_ViewModel
ªª= [
>
ªª[ \
(
ªª\ ]
_context
ªª] e
,
ªªe f
$strªªg ï
,ªªï ñ
newªªó ö
SqlParameterªªõ ß
[ªªß ®
]ªª® ©
{ªª© ™
new
ºº 
SqlParameter
ºº (
(
ºº( )
$str
ºº) 8
,
ºº8 9
randomstring
ºº: F
)
ººF G
,
ººG H
new
ΩΩ 
SqlParameter
ΩΩ (
(
ΩΩ( )
$str
ΩΩ) 6
,
ΩΩ6 7

sortColumn
ΩΩ8 B
)
ΩΩB C
,
ΩΩC D
new
ææ 
SqlParameter
ææ (
(
ææ( )
$str
ææ) 9
,
ææ9 :
sortColumnDir
ææ; H
)
ææH I
,
ææI J
new
øø 
SqlParameter
øø (
(
øø( )
$str
øø) 6
,
øø6 7

pageNumber
øø8 B
)
øøB C
,
øøC D
new
¿¿ 
SqlParameter
¿¿ (
(
¿¿( )
$str
¿¿) 4
,
¿¿4 5
pageSize
¿¿6 >
)
¿¿> ?
}
¿¿? @
)
¿¿@ A
;
¿¿A B
recordsTotal
¬¬ 
=
¬¬ %
StoredProcedureExecutor
¬¬ 6
.
¬¬6 7
ExecuteScalarInt
¬¬7 G
(
¬¬G H
_context
¬¬H P
,
¬¬P Q
$str¬¬R Å
,¬¬Å Ç
new¬¬É Ü
SqlParameter¬¬á ì
[¬¬ì î
]¬¬î ï
{¬¬ï ñ
new
√√ 
SqlParameter
√√ (
(
√√( )
$str
√√) 8
,
√√8 9
randomstring
√√: F
)
√√F G
,
√√G H
}
ƒƒ 
)
ƒƒ 
;
ƒƒ 
if
∆∆ 
(
∆∆ 
list
∆∆ 
==
∆∆ 
null
∆∆  
)
∆∆  !
{
«« 
list
»» 
=
»» 
new
»» 
List
»» #
<
»»# $,
NoticeOfDisbursement_ViewModel
»»$ B
>
»»B C
(
»»C D
)
»»D E
;
»»E F
recordsTotal
……  
=
……! "
$num
……# $
;
……$ %
}
   
return
ÃÃ 
Json
ÃÃ 
(
ÃÃ 
new
ÃÃ 
{
ÃÃ  !
draw
ÃÃ" &
=
ÃÃ' (
draw
ÃÃ) -
,
ÃÃ- .
recordsFiltered
ÃÃ/ >
=
ÃÃ? @
recordsTotal
ÃÃA M
,
ÃÃM N
recordsTotal
ÃÃO [
=
ÃÃ\ ]
recordsTotal
ÃÃ^ j
,
ÃÃj k
data
ÃÃl p
=
ÃÃq r
list
ÃÃs w
}
ÃÃx y
)
ÃÃy z
;
ÃÃz {
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
Ex
ŒŒ 
)
ŒŒ  
{
œœ 
throw
–– 
;
–– 
}
—— 
}
““ 	
[
”” 	
HttpPost
””	 
]
”” 
public
‘‘ 
IActionResult
‘‘ 
LoadDataDetailNod
‘‘ .
(
‘‘. /
string
‘‘/ 5
NodId
‘‘6 ;
)
‘‘; <
{
’’ 	
if
÷÷ 
(
÷÷ 
!
÷÷ 
lastSession
÷÷ 
.
÷÷ 
Update
÷÷ #
(
÷÷# $
)
÷÷$ %
)
÷÷% &
{
◊◊ 
return
ÿÿ 
RedirectToAction
ÿÿ '
(
ÿÿ' (
$str
ÿÿ( /
,
ÿÿ/ 0
	GetConfig
ÿÿ1 :
.
ÿÿ: ;

AppSetting
ÿÿ; E
[
ÿÿE F
$str
ÿÿF n
]
ÿÿn o
+
ÿÿp q
$str
ÿÿr y
,
ÿÿy z
new
ÿÿ{ ~
{ÿÿ Ä
aÿÿÅ Ç
=ÿÿÉ Ñ
trueÿÿÖ â
}ÿÿä ã
)ÿÿã å
;ÿÿå ç
}
ŸŸ 
var
⁄⁄ 
location
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
Uri
⁄⁄ "
(
⁄⁄" #
$"
⁄⁄# %
{
⁄⁄% &
Request
⁄⁄& -
.
⁄⁄- .
Scheme
⁄⁄. 4
}
⁄⁄4 5
$str
⁄⁄5 8
{
⁄⁄8 9
Request
⁄⁄9 @
.
⁄⁄@ A
Host
⁄⁄A E
}
⁄⁄E F
{
⁄⁄F G
Request
⁄⁄G N
.
⁄⁄N O
Path
⁄⁄O S
}
⁄⁄S T
"
⁄⁄T U
)
⁄⁄U V
;
⁄⁄V W
string
€€ 
Path
€€ 
=
€€ 
location
€€ "
.
€€" #
AbsolutePath
€€# /
.
€€/ 0
Replace
€€0 7
(
€€7 8
this
€€8 <
.
€€< =
ControllerContext
€€= N
.
€€N O
	RouteData
€€O X
.
€€X Y
Values
€€Y _
[
€€_ `
$str
€€` h
]
€€h i
.
€€i j
ToString
€€j r
(
€€r s
)
€€s t
,
€€t u
$str
€€v }
)
€€} ~
;
€€~ 
if
‹‹ 
(
‹‹ 
!
‹‹ 
accessSecurity
‹‹ 
.
‹‹  
IsGetAccess
‹‹  +
(
‹‹+ ,
$str
‹‹, 0
+
‹‹1 2
Path
‹‹3 7
)
‹‹7 8
)
‹‹8 9
{
›› 
return
ﬁﬁ 
RedirectToAction
ﬁﬁ '
(
ﬁﬁ' (
$str
ﬁﬁ( 3
,
ﬁﬁ3 4
$str
ﬁﬁ5 <
)
ﬁﬁ< =
;
ﬁﬁ= >
}
ﬂﬂ 
try
·· 
{
‚‚ 
var
„„ 
dict
„„ 
=
„„ 
Request
„„ "
.
„„" #
Form
„„# '
.
„„' (
ToDictionary
„„( 4
(
„„4 5
x
„„5 6
=>
„„7 9
x
„„: ;
.
„„; <
Key
„„< ?
,
„„? @
x
„„A B
=>
„„C E
x
„„F G
.
„„G H
Value
„„H M
.
„„M N
ToString
„„N V
(
„„V W
)
„„W X
)
„„X Y
;
„„Y Z
var
ÂÂ 
draw
ÂÂ 
=
ÂÂ 
dict
ÂÂ 
[
ÂÂ  
$str
ÂÂ  &
]
ÂÂ& '
;
ÂÂ' (
var
ËË 
start
ËË 
=
ËË 
dict
ËË  
[
ËË  !
$str
ËË! (
]
ËË( )
;
ËË) *
var
ÈÈ 
length
ÈÈ 
=
ÈÈ 
dict
ÈÈ !
[
ÈÈ! "
$str
ÈÈ" *
]
ÈÈ* +
;
ÈÈ+ ,
var
ÌÌ 

pageNumber
ÌÌ 
=
ÌÌ  
(
ÌÌ! "
int
ÌÌ" %
.
ÌÌ% &
Parse
ÌÌ& +
(
ÌÌ+ ,
start
ÌÌ, 1
)
ÌÌ1 2
/
ÌÌ3 4
int
ÌÌ5 8
.
ÌÌ8 9
Parse
ÌÌ9 >
(
ÌÌ> ?
length
ÌÌ? E
)
ÌÌE F
)
ÌÌF G
+
ÌÌH I
$num
ÌÌJ K
;
ÌÌK L
var
 

sortColumn
 
=
  
dict
! %
[
% &
$str
& 0
+
1 2
dict
3 7
[
7 8
$str
8 J
]
J K
+
L M
$str
N W
]
W X
;
X Y
var
ÒÒ 
sortColumnDir
ÒÒ !
=
ÒÒ" #
dict
ÒÒ$ (
[
ÒÒ( )
$str
ÒÒ) 8
]
ÒÒ8 9
;
ÒÒ9 :
int
ÙÙ 
pageSize
ÙÙ 
=
ÙÙ 
length
ÙÙ %
!=
ÙÙ& (
null
ÙÙ) -
?
ÙÙ. /
Convert
ÙÙ0 7
.
ÙÙ7 8
ToInt32
ÙÙ8 ?
(
ÙÙ? @
length
ÙÙ@ F
)
ÙÙF G
:
ÙÙH I
$num
ÙÙJ K
;
ÙÙK L
int
ıı 
skip
ıı 
=
ıı 
start
ıı  
!=
ıı! #
null
ıı$ (
?
ıı) *
Convert
ıı+ 2
.
ıı2 3
ToInt32
ıı3 :
(
ıı: ;
start
ıı; @
)
ıı@ A
:
ııB C
$num
ııD E
;
ııE F
int
ˆˆ 
recordsTotal
ˆˆ  
=
ˆˆ! "
$num
ˆˆ# $
;
ˆˆ$ %
List
¯¯ 
<
¯¯ ,
NoticeOfDisbursement_ViewModel
¯¯ 3
>
¯¯3 4
list
¯¯5 9
=
¯¯: ;
new
¯¯< ?
List
¯¯@ D
<
¯¯D E,
NoticeOfDisbursement_ViewModel
¯¯E c
>
¯¯c d
(
¯¯d e
)
¯¯e f
;
¯¯f g
list
˙˙ 
=
˙˙ %
StoredProcedureExecutor
˙˙ .
.
˙˙. /
ExecuteSPList
˙˙/ <
<
˙˙< =,
NoticeOfDisbursement_ViewModel
˙˙= [
>
˙˙[ \
(
˙˙\ ]
_context
˙˙] e
,
˙˙e f
$str˙˙g ë
,˙˙ë í
new˙˙ì ñ
SqlParameter˙˙ó £
[˙˙£ §
]˙˙§ •
{˙˙• ¶
new
˚˚ 
SqlParameter
˚˚ (
(
˚˚( )
$str
˚˚) 1
,
˚˚1 2
NodId
˚˚3 8
)
˚˚8 9
,
˚˚9 :
new
¸¸ 
SqlParameter
¸¸ (
(
¸¸( )
$str
¸¸) 6
,
¸¸6 7

sortColumn
¸¸8 B
)
¸¸B C
,
¸¸C D
new
˝˝ 
SqlParameter
˝˝ (
(
˝˝( )
$str
˝˝) 9
,
˝˝9 :
sortColumnDir
˝˝; H
)
˝˝H I
,
˝˝I J
new
˛˛ 
SqlParameter
˛˛ (
(
˛˛( )
$str
˛˛) 6
,
˛˛6 7

pageNumber
˛˛8 B
)
˛˛B C
,
˛˛C D
new
ˇˇ 
SqlParameter
ˇˇ (
(
ˇˇ( )
$str
ˇˇ) 4
,
ˇˇ4 5
pageSize
ˇˇ6 >
)
ˇˇ> ?
}
ˇˇ? @
)
ˇˇ@ A
;
ˇˇA B
recordsTotal
ÅÅ 
=
ÅÅ %
StoredProcedureExecutor
ÅÅ 6
.
ÅÅ6 7
ExecuteScalarInt
ÅÅ7 G
(
ÅÅG H
_context
ÅÅH P
,
ÅÅP Q
$str
ÅÅR }
,
ÅÅ} ~
newÅÅ Ç
SqlParameterÅÅÉ è
[ÅÅè ê
]ÅÅê ë
{ÅÅë í
new
ÇÇ 
SqlParameter
ÇÇ (
(
ÇÇ( )
$str
ÇÇ) 1
,
ÇÇ1 2
NodId
ÇÇ3 8
)
ÇÇ8 9
,
ÇÇ9 :
}
ÉÉ 
)
ÉÉ 
;
ÉÉ 
if
ÖÖ 
(
ÖÖ 
list
ÖÖ 
==
ÖÖ 
null
ÖÖ  
)
ÖÖ  !
{
ÜÜ 
list
áá 
=
áá 
new
áá 
List
áá #
<
áá# $,
NoticeOfDisbursement_ViewModel
áá$ B
>
ááB C
(
ááC D
)
ááD E
;
ááE F
recordsTotal
àà  
=
àà! "
$num
àà# $
;
àà$ %
}
ââ 
return
ãã 
Json
ãã 
(
ãã 
new
ãã 
{
ãã  !
draw
ãã" &
=
ãã' (
draw
ãã) -
,
ãã- .
recordsFiltered
ãã/ >
=
ãã? @
recordsTotal
ããA M
,
ããM N
recordsTotal
ããO [
=
ãã\ ]
recordsTotal
ãã^ j
,
ããj k
data
ããl p
=
ããq r
list
ããs w
}
ããx y
)
ããy z
;
ããz {
}
åå 
catch
çç 
(
çç 
	Exception
çç 
Ex
çç 
)
çç  
{
éé 
throw
èè 
;
èè 
}
êê 
}
ëë 	
[
ìì 	
HttpPost
ìì	 
]
ìì 
public
îî 
IActionResult
îî !
LoadDataFileNodTemp
îî 0
(
îî0 1
string
îî1 7
randomstring
îî8 D
)
îîD E
{
ïï 	
if
ññ 
(
ññ 
!
ññ 
lastSession
ññ 
.
ññ 
Update
ññ #
(
ññ# $
)
ññ$ %
)
ññ% &
{
óó 
return
òò 
RedirectToAction
òò '
(
òò' (
$str
òò( /
,
òò/ 0
	GetConfig
òò1 :
.
òò: ;

AppSetting
òò; E
[
òòE F
$str
òòF n
]
òòn o
+
òòp q
$str
òòr y
,
òòy z
new
òò{ ~
{òò Ä
aòòÅ Ç
=òòÉ Ñ
trueòòÖ â
}òòä ã
)òòã å
;òòå ç
}
ôô 
var
öö 
location
öö 
=
öö 
new
öö 
Uri
öö "
(
öö" #
$"
öö# %
{
öö% &
Request
öö& -
.
öö- .
Scheme
öö. 4
}
öö4 5
$str
öö5 8
{
öö8 9
Request
öö9 @
.
öö@ A
Host
ööA E
}
ööE F
{
ööF G
Request
ööG N
.
ööN O
Path
ööO S
}
ööS T
"
ööT U
)
ööU V
;
ööV W
string
õõ 
Path
õõ 
=
õõ 
location
õõ "
.
õõ" #
AbsolutePath
õõ# /
.
õõ/ 0
Replace
õõ0 7
(
õõ7 8
this
õõ8 <
.
õõ< =
ControllerContext
õõ= N
.
õõN O
	RouteData
õõO X
.
õõX Y
Values
õõY _
[
õõ_ `
$str
õõ` h
]
õõh i
.
õõi j
ToString
õõj r
(
õõr s
)
õõs t
,
õõt u
$str
õõv }
)
õõ} ~
;
õõ~ 
if
úú 
(
úú 
!
úú 
accessSecurity
úú 
.
úú  
IsGetAccess
úú  +
(
úú+ ,
$str
úú, 0
+
úú1 2
Path
úú3 7
)
úú7 8
)
úú8 9
{
ùù 
return
ûû 
RedirectToAction
ûû '
(
ûû' (
$str
ûû( 3
,
ûû3 4
$str
ûû5 <
)
ûû< =
;
ûû= >
}
üü 
try
°° 
{
¢¢ 
var
££ 
dict
££ 
=
££ 
Request
££ "
.
££" #
Form
££# '
.
££' (
ToDictionary
££( 4
(
££4 5
x
££5 6
=>
££7 9
x
££: ;
.
££; <
Key
££< ?
,
££? @
x
££A B
=>
££C E
x
££F G
.
££G H
Value
££H M
.
££M N
ToString
££N V
(
££V W
)
££W X
)
££X Y
;
££Y Z
var
•• 
draw
•• 
=
•• 
dict
•• 
[
••  
$str
••  &
]
••& '
;
••' (
var
®® 
start
®® 
=
®® 
dict
®®  
[
®®  !
$str
®®! (
]
®®( )
;
®®) *
var
©© 
length
©© 
=
©© 
dict
©© !
[
©©! "
$str
©©" *
]
©©* +
;
©©+ ,
var
≠≠ 

pageNumber
≠≠ 
=
≠≠  
(
≠≠! "
int
≠≠" %
.
≠≠% &
Parse
≠≠& +
(
≠≠+ ,
start
≠≠, 1
)
≠≠1 2
/
≠≠3 4
int
≠≠5 8
.
≠≠8 9
Parse
≠≠9 >
(
≠≠> ?
length
≠≠? E
)
≠≠E F
)
≠≠F G
+
≠≠H I
$num
≠≠J K
;
≠≠K L
var
∞∞ 

sortColumn
∞∞ 
=
∞∞  
dict
∞∞! %
[
∞∞% &
$str
∞∞& 0
+
∞∞1 2
dict
∞∞3 7
[
∞∞7 8
$str
∞∞8 J
]
∞∞J K
+
∞∞L M
$str
∞∞N W
]
∞∞W X
;
∞∞X Y
var
±± 
sortColumnDir
±± !
=
±±" #
dict
±±$ (
[
±±( )
$str
±±) 8
]
±±8 9
;
±±9 :
int
¥¥ 
pageSize
¥¥ 
=
¥¥ 
length
¥¥ %
!=
¥¥& (
null
¥¥) -
?
¥¥. /
Convert
¥¥0 7
.
¥¥7 8
ToInt32
¥¥8 ?
(
¥¥? @
length
¥¥@ F
)
¥¥F G
:
¥¥H I
$num
¥¥J K
;
¥¥K L
int
µµ 
skip
µµ 
=
µµ 
start
µµ  
!=
µµ! #
null
µµ$ (
?
µµ) *
Convert
µµ+ 2
.
µµ2 3
ToInt32
µµ3 :
(
µµ: ;
start
µµ; @
)
µµ@ A
:
µµB C
$num
µµD E
;
µµE F
int
∂∂ 
recordsTotal
∂∂  
=
∂∂! "
$num
∂∂# $
;
∂∂$ %
List
∏∏ 
<
∏∏ 0
"NoticeOfDisbursementFile_ViewModel
∏∏ 7
>
∏∏7 8
list
∏∏9 =
=
∏∏> ?
new
∏∏@ C
List
∏∏D H
<
∏∏H I0
"NoticeOfDisbursementFile_ViewModel
∏∏I k
>
∏∏k l
(
∏∏l m
)
∏∏m n
;
∏∏n o
list
∫∫ 
=
∫∫ %
StoredProcedureExecutor
∫∫ .
.
∫∫. /
ExecuteSPList
∫∫/ <
<
∫∫< =0
"NoticeOfDisbursementFile_ViewModel
∫∫= _
>
∫∫_ `
(
∫∫` a
_context
∫∫a i
,
∫∫i j
$str∫∫k ó
,∫∫ó ò
new∫∫ô ú
SqlParameter∫∫ù ©
[∫∫© ™
]∫∫™ ´
{∫∫´ ¨
new
ªª 
SqlParameter
ªª (
(
ªª( )
$str
ªª) 8
,
ªª8 9
randomstring
ªª: F
)
ªªF G
,
ªªG H
new
ºº 
SqlParameter
ºº (
(
ºº( )
$str
ºº) 6
,
ºº6 7

sortColumn
ºº8 B
)
ººB C
,
ººC D
new
ΩΩ 
SqlParameter
ΩΩ (
(
ΩΩ( )
$str
ΩΩ) 9
,
ΩΩ9 :
sortColumnDir
ΩΩ; H
)
ΩΩH I
,
ΩΩI J
new
ææ 
SqlParameter
ææ (
(
ææ( )
$str
ææ) 6
,
ææ6 7

pageNumber
ææ8 B
)
ææB C
,
ææC D
new
øø 
SqlParameter
øø (
(
øø( )
$str
øø) 4
,
øø4 5
pageSize
øø6 >
)
øø> ?
}
øø? @
)
øø@ A
;
øøA B
recordsTotal
¡¡ 
=
¡¡ %
StoredProcedureExecutor
¡¡ 6
.
¡¡6 7
ExecuteScalarInt
¡¡7 G
(
¡¡G H
_context
¡¡H P
,
¡¡P Q
$str
¡¡R 
,¡¡ Ä
new¡¡Å Ñ
SqlParameter¡¡Ö ë
[¡¡ë í
]¡¡í ì
{¡¡ì î
new
¬¬ 
SqlParameter
¬¬ (
(
¬¬( )
$str
¬¬) 8
,
¬¬8 9
randomstring
¬¬: F
)
¬¬F G
,
¬¬G H
}
√√ 
)
√√ 
;
√√ 
if
≈≈ 
(
≈≈ 
list
≈≈ 
==
≈≈ 
null
≈≈  
)
≈≈  !
{
∆∆ 
list
«« 
=
«« 
new
«« 
List
«« #
<
««# $0
"NoticeOfDisbursementFile_ViewModel
««$ F
>
««F G
(
««G H
)
««H I
;
««I J
recordsTotal
»»  
=
»»! "
$num
»»# $
;
»»$ %
}
…… 
return
ÀÀ 
Json
ÀÀ 
(
ÀÀ 
new
ÀÀ 
{
ÀÀ  !
draw
ÀÀ" &
=
ÀÀ' (
draw
ÀÀ) -
,
ÀÀ- .
recordsFiltered
ÀÀ/ >
=
ÀÀ? @
recordsTotal
ÀÀA M
,
ÀÀM N
recordsTotal
ÀÀO [
=
ÀÀ\ ]
recordsTotal
ÀÀ^ j
,
ÀÀj k
data
ÀÀl p
=
ÀÀq r
list
ÀÀs w
}
ÀÀx y
)
ÀÀy z
;
ÀÀz {
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
Ex
ÕÕ 
)
ÕÕ  
{
ŒŒ 
throw
œœ 
;
œœ 
}
–– 
}
—— 	
[
““ 	
HttpPost
““	 
]
““ 
public
”” 
IActionResult
”” 
LoadDataFileNod
”” ,
(
””, -
string
””- 3
NodId
””4 9
)
””9 :
{
‘‘ 	
if
’’ 
(
’’ 
!
’’ 
lastSession
’’ 
.
’’ 
Update
’’ #
(
’’# $
)
’’$ %
)
’’% &
{
÷÷ 
return
◊◊ 
RedirectToAction
◊◊ '
(
◊◊' (
$str
◊◊( /
,
◊◊/ 0
	GetConfig
◊◊1 :
.
◊◊: ;

AppSetting
◊◊; E
[
◊◊E F
$str
◊◊F n
]
◊◊n o
+
◊◊p q
$str
◊◊r y
,
◊◊y z
new
◊◊{ ~
{◊◊ Ä
a◊◊Å Ç
=◊◊É Ñ
true◊◊Ö â
}◊◊ä ã
)◊◊ã å
;◊◊å ç
}
ÿÿ 
var
ŸŸ 
location
ŸŸ 
=
ŸŸ 
new
ŸŸ 
Uri
ŸŸ "
(
ŸŸ" #
$"
ŸŸ# %
{
ŸŸ% &
Request
ŸŸ& -
.
ŸŸ- .
Scheme
ŸŸ. 4
}
ŸŸ4 5
$str
ŸŸ5 8
{
ŸŸ8 9
Request
ŸŸ9 @
.
ŸŸ@ A
Host
ŸŸA E
}
ŸŸE F
{
ŸŸF G
Request
ŸŸG N
.
ŸŸN O
Path
ŸŸO S
}
ŸŸS T
"
ŸŸT U
)
ŸŸU V
;
ŸŸV W
string
⁄⁄ 
Path
⁄⁄ 
=
⁄⁄ 
location
⁄⁄ "
.
⁄⁄" #
AbsolutePath
⁄⁄# /
.
⁄⁄/ 0
Replace
⁄⁄0 7
(
⁄⁄7 8
this
⁄⁄8 <
.
⁄⁄< =
ControllerContext
⁄⁄= N
.
⁄⁄N O
	RouteData
⁄⁄O X
.
⁄⁄X Y
Values
⁄⁄Y _
[
⁄⁄_ `
$str
⁄⁄` h
]
⁄⁄h i
.
⁄⁄i j
ToString
⁄⁄j r
(
⁄⁄r s
)
⁄⁄s t
,
⁄⁄t u
$str
⁄⁄v }
)
⁄⁄} ~
;
⁄⁄~ 
if
€€ 
(
€€ 
!
€€ 
accessSecurity
€€ 
.
€€  
IsGetAccess
€€  +
(
€€+ ,
$str
€€, 0
+
€€1 2
Path
€€3 7
)
€€7 8
)
€€8 9
{
‹‹ 
return
›› 
RedirectToAction
›› '
(
››' (
$str
››( 3
,
››3 4
$str
››5 <
)
››< =
;
››= >
}
ﬁﬁ 
try
‡‡ 
{
·· 
var
‚‚ 
dict
‚‚ 
=
‚‚ 
Request
‚‚ "
.
‚‚" #
Form
‚‚# '
.
‚‚' (
ToDictionary
‚‚( 4
(
‚‚4 5
x
‚‚5 6
=>
‚‚7 9
x
‚‚: ;
.
‚‚; <
Key
‚‚< ?
,
‚‚? @
x
‚‚A B
=>
‚‚C E
x
‚‚F G
.
‚‚G H
Value
‚‚H M
.
‚‚M N
ToString
‚‚N V
(
‚‚V W
)
‚‚W X
)
‚‚X Y
;
‚‚Y Z
var
‰‰ 
draw
‰‰ 
=
‰‰ 
dict
‰‰ 
[
‰‰  
$str
‰‰  &
]
‰‰& '
;
‰‰' (
var
ÁÁ 
start
ÁÁ 
=
ÁÁ 
dict
ÁÁ  
[
ÁÁ  !
$str
ÁÁ! (
]
ÁÁ( )
;
ÁÁ) *
var
ËË 
length
ËË 
=
ËË 
dict
ËË !
[
ËË! "
$str
ËË" *
]
ËË* +
;
ËË+ ,
var
ÏÏ 

pageNumber
ÏÏ 
=
ÏÏ  
(
ÏÏ! "
int
ÏÏ" %
.
ÏÏ% &
Parse
ÏÏ& +
(
ÏÏ+ ,
start
ÏÏ, 1
)
ÏÏ1 2
/
ÏÏ3 4
int
ÏÏ5 8
.
ÏÏ8 9
Parse
ÏÏ9 >
(
ÏÏ> ?
length
ÏÏ? E
)
ÏÏE F
)
ÏÏF G
+
ÏÏH I
$num
ÏÏJ K
;
ÏÏK L
var
ÔÔ 

sortColumn
ÔÔ 
=
ÔÔ  
dict
ÔÔ! %
[
ÔÔ% &
$str
ÔÔ& 0
+
ÔÔ1 2
dict
ÔÔ3 7
[
ÔÔ7 8
$str
ÔÔ8 J
]
ÔÔJ K
+
ÔÔL M
$str
ÔÔN W
]
ÔÔW X
;
ÔÔX Y
var
 
sortColumnDir
 !
=
" #
dict
$ (
[
( )
$str
) 8
]
8 9
;
9 :
int
ÛÛ 
pageSize
ÛÛ 
=
ÛÛ 
length
ÛÛ %
!=
ÛÛ& (
null
ÛÛ) -
?
ÛÛ. /
Convert
ÛÛ0 7
.
ÛÛ7 8
ToInt32
ÛÛ8 ?
(
ÛÛ? @
length
ÛÛ@ F
)
ÛÛF G
:
ÛÛH I
$num
ÛÛJ K
;
ÛÛK L
int
ÙÙ 
skip
ÙÙ 
=
ÙÙ 
start
ÙÙ  
!=
ÙÙ! #
null
ÙÙ$ (
?
ÙÙ) *
Convert
ÙÙ+ 2
.
ÙÙ2 3
ToInt32
ÙÙ3 :
(
ÙÙ: ;
start
ÙÙ; @
)
ÙÙ@ A
:
ÙÙB C
$num
ÙÙD E
;
ÙÙE F
int
ıı 
recordsTotal
ıı  
=
ıı! "
$num
ıı# $
;
ıı$ %
List
˜˜ 
<
˜˜ 0
"NoticeOfDisbursementFile_ViewModel
˜˜ 7
>
˜˜7 8
list
˜˜9 =
=
˜˜> ?
new
˜˜@ C
List
˜˜D H
<
˜˜H I0
"NoticeOfDisbursementFile_ViewModel
˜˜I k
>
˜˜k l
(
˜˜l m
)
˜˜m n
;
˜˜n o
list
˘˘ 
=
˘˘ %
StoredProcedureExecutor
˘˘ .
.
˘˘. /
ExecuteSPList
˘˘/ <
<
˘˘< =0
"NoticeOfDisbursementFile_ViewModel
˘˘= _
>
˘˘_ `
(
˘˘` a
_context
˘˘a i
,
˘˘i j
$str˘˘k ì
,˘˘ì î
new˘˘ï ò
SqlParameter˘˘ô •
[˘˘• ¶
]˘˘¶ ß
{˘˘ß ®
new
˙˙ 
SqlParameter
˙˙ (
(
˙˙( )
$str
˙˙) 1
,
˙˙1 2
NodId
˙˙3 8
)
˙˙8 9
,
˙˙9 :
new
˚˚ 
SqlParameter
˚˚ (
(
˚˚( )
$str
˚˚) 6
,
˚˚6 7

sortColumn
˚˚8 B
)
˚˚B C
,
˚˚C D
new
¸¸ 
SqlParameter
¸¸ (
(
¸¸( )
$str
¸¸) 9
,
¸¸9 :
sortColumnDir
¸¸; H
)
¸¸H I
,
¸¸I J
new
˝˝ 
SqlParameter
˝˝ (
(
˝˝( )
$str
˝˝) 6
,
˝˝6 7

pageNumber
˝˝8 B
)
˝˝B C
,
˝˝C D
new
˛˛ 
SqlParameter
˛˛ (
(
˛˛( )
$str
˛˛) 4
,
˛˛4 5
pageSize
˛˛6 >
)
˛˛> ?
}
˛˛? @
)
˛˛@ A
;
˛˛A B
recordsTotal
ÄÄ 
=
ÄÄ %
StoredProcedureExecutor
ÄÄ 6
.
ÄÄ6 7
ExecuteScalarInt
ÄÄ7 G
(
ÄÄG H
_context
ÄÄH P
,
ÄÄP Q
$str
ÄÄR {
,
ÄÄ{ |
newÄÄ} Ä
SqlParameterÄÄÅ ç
[ÄÄç é
]ÄÄé è
{ÄÄè ê
new
ÅÅ 
SqlParameter
ÅÅ (
(
ÅÅ( )
$str
ÅÅ) 1
,
ÅÅ1 2
NodId
ÅÅ3 8
)
ÅÅ8 9
,
ÅÅ9 :
}
ÇÇ 
)
ÇÇ 
;
ÇÇ 
if
ÑÑ 
(
ÑÑ 
list
ÑÑ 
==
ÑÑ 
null
ÑÑ  
)
ÑÑ  !
{
ÖÖ 
list
ÜÜ 
=
ÜÜ 
new
ÜÜ 
List
ÜÜ #
<
ÜÜ# $0
"NoticeOfDisbursementFile_ViewModel
ÜÜ$ F
>
ÜÜF G
(
ÜÜG H
)
ÜÜH I
;
ÜÜI J
recordsTotal
áá  
=
áá! "
$num
áá# $
;
áá$ %
}
àà 
return
ää 
Json
ää 
(
ää 
new
ää 
{
ää  !
draw
ää" &
=
ää' (
draw
ää) -
,
ää- .
recordsFiltered
ää/ >
=
ää? @
recordsTotal
ääA M
,
ääM N
recordsTotal
ääO [
=
ää\ ]
recordsTotal
ää^ j
,
ääj k
data
ääl p
=
ääq r
list
ääs w
}
ääx y
)
ääy z
;
ääz {
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
Ex
åå 
)
åå  
{
çç 
throw
éé 
;
éé 
}
èè 
}
êê 	
public
îî 
ActionResult
îî 
Create
îî "
(
îî" #
)
îî# $
{
ïï 	
if
ññ 
(
ññ 
!
ññ 
lastSession
ññ 
.
ññ 
Update
ññ #
(
ññ# $
)
ññ$ %
)
ññ% &
{
óó 
return
òò 
RedirectToAction
òò '
(
òò' (
$str
òò( /
,
òò/ 0
	GetConfig
òò1 :
.
òò: ;

AppSetting
òò; E
[
òòE F
$str
òòF n
]
òòn o
+
òòp q
$str
òòr y
,
òòy z
new
òò{ ~
{òò Ä
aòòÅ Ç
=òòÉ Ñ
trueòòÖ â
}òòä ã
)òòã å
;òòå ç
}
ôô 
var
öö 
location
öö 
=
öö 
new
öö 
Uri
öö "
(
öö" #
$"
öö# %
{
öö% &
Request
öö& -
.
öö- .
Scheme
öö. 4
}
öö4 5
$str
öö5 8
{
öö8 9
Request
öö9 @
.
öö@ A
Host
ööA E
}
ööE F
{
ööF G
Request
ööG N
.
ööN O
Path
ööO S
}
ööS T
"
ööT U
)
ööU V
;
ööV W
string
õõ 
Path
õõ 
=
õõ 
location
õõ "
.
õõ" #
AbsolutePath
õõ# /
.
õõ/ 0
Replace
õõ0 7
(
õõ7 8
this
õõ8 <
.
õõ< =
ControllerContext
õõ= N
.
õõN O
	RouteData
õõO X
.
õõX Y
Values
õõY _
[
õõ_ `
$str
õõ` h
]
õõh i
.
õõi j
ToString
õõj r
(
õõr s
)
õõs t
,
õõt u
$str
õõv }
)
õõ} ~
;
õõ~ 
if
úú 
(
úú 
!
úú 
accessSecurity
úú 
.
úú  
IsGetAccess
úú  +
(
úú+ ,
$str
úú, 0
+
úú1 2
Path
úú3 7
)
úú7 8
)
úú8 9
{
ùù 
return
ûû 
RedirectToAction
ûû '
(
ûû' (
$str
ûû( 3
,
ûû3 4
$str
ûû5 <
)
ûû< =
;
ûû= >
}
üü 
ViewBag
†† 
.
†† 
Cur
†† 
=
†† 
new
†† 

SelectList
†† (
(
††( )
$str
††) +
,
††+ ,
$str
††- /
)
††/ 0
;
††0 1
return
¢¢ 
PartialView
¢¢ 
(
¢¢ 
$str
¢¢ (
)
¢¢( )
;
¢¢) *
}
££ 	
public
§§ 
ActionResult
§§ 

CreateBulk
§§ &
(
§§& '
)
§§' (
{
•• 	
if
¶¶ 
(
¶¶ 
!
¶¶ 
lastSession
¶¶ 
.
¶¶ 
Update
¶¶ #
(
¶¶# $
)
¶¶$ %
)
¶¶% &
{
ßß 
return
®® 
RedirectToAction
®® '
(
®®' (
$str
®®( /
,
®®/ 0
	GetConfig
®®1 :
.
®®: ;

AppSetting
®®; E
[
®®E F
$str
®®F n
]
®®n o
+
®®p q
$str
®®r y
,
®®y z
new
®®{ ~
{®® Ä
a®®Å Ç
=®®É Ñ
true®®Ö â
}®®ä ã
)®®ã å
;®®å ç
}
©© 
var
™™ 
location
™™ 
=
™™ 
new
™™ 
Uri
™™ "
(
™™" #
$"
™™# %
{
™™% &
Request
™™& -
.
™™- .
Scheme
™™. 4
}
™™4 5
$str
™™5 8
{
™™8 9
Request
™™9 @
.
™™@ A
Host
™™A E
}
™™E F
{
™™F G
Request
™™G N
.
™™N O
Path
™™O S
}
™™S T
"
™™T U
)
™™U V
;
™™V W
string
´´ 
Path
´´ 
=
´´ 
location
´´ "
.
´´" #
AbsolutePath
´´# /
.
´´/ 0
Replace
´´0 7
(
´´7 8
this
´´8 <
.
´´< =
ControllerContext
´´= N
.
´´N O
	RouteData
´´O X
.
´´X Y
Values
´´Y _
[
´´_ `
$str
´´` h
]
´´h i
.
´´i j
ToString
´´j r
(
´´r s
)
´´s t
,
´´t u
$str
´´v }
)
´´} ~
;
´´~ 
if
¨¨ 
(
¨¨ 
!
¨¨ 
accessSecurity
¨¨ 
.
¨¨  
IsGetAccess
¨¨  +
(
¨¨+ ,
$str
¨¨, 0
+
¨¨1 2
Path
¨¨3 7
)
¨¨7 8
)
¨¨8 9
{
≠≠ 
return
ÆÆ 
RedirectToAction
ÆÆ '
(
ÆÆ' (
$str
ÆÆ( 3
,
ÆÆ3 4
$str
ÆÆ5 <
)
ÆÆ< =
;
ÆÆ= >
}
ØØ 
return
∞∞ 
PartialView
∞∞ 
(
∞∞ 
$str
∞∞ ,
)
∞∞, -
;
∞∞- .
}
±± 	
public
≤≤ 
ActionResult
≤≤ 
CreateDetailNod
≤≤ +
(
≤≤+ ,
)
≤≤, -
{
≥≥ 	
if
¥¥ 
(
¥¥ 
!
¥¥ 
lastSession
¥¥ 
.
¥¥ 
Update
¥¥ #
(
¥¥# $
)
¥¥$ %
)
¥¥% &
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( /
,
∂∂/ 0
	GetConfig
∂∂1 :
.
∂∂: ;

AppSetting
∂∂; E
[
∂∂E F
$str
∂∂F n
]
∂∂n o
+
∂∂p q
$str
∂∂r y
,
∂∂y z
new
∂∂{ ~
{∂∂ Ä
a∂∂Å Ç
=∂∂É Ñ
true∂∂Ö â
}∂∂ä ã
)∂∂ã å
;∂∂å ç
}
∑∑ 
var
ππ 
location
ππ 
=
ππ 
new
ππ 
Uri
ππ "
(
ππ" #
$"
ππ# %
{
ππ% &
Request
ππ& -
.
ππ- .
Scheme
ππ. 4
}
ππ4 5
$str
ππ5 8
{
ππ8 9
Request
ππ9 @
.
ππ@ A
Host
ππA E
}
ππE F
{
ππF G
Request
ππG N
.
ππN O
Path
ππO S
}
ππS T
"
ππT U
)
ππU V
;
ππV W
string
∫∫ 
Path
∫∫ 
=
∫∫ 
location
∫∫ "
.
∫∫" #
AbsolutePath
∫∫# /
.
∫∫/ 0
Replace
∫∫0 7
(
∫∫7 8
this
∫∫8 <
.
∫∫< =
ControllerContext
∫∫= N
.
∫∫N O
	RouteData
∫∫O X
.
∫∫X Y
Values
∫∫Y _
[
∫∫_ `
$str
∫∫` h
]
∫∫h i
.
∫∫i j
ToString
∫∫j r
(
∫∫r s
)
∫∫s t
,
∫∫t u
$str
∫∫v }
)
∫∫} ~
;
∫∫~ 
if
ºº 
(
ºº 
!
ºº 
accessSecurity
ºº 
.
ºº  
IsGetAccess
ºº  +
(
ºº+ ,
$str
ºº, 0
+
ºº1 2
Path
ºº3 7
)
ºº7 8
)
ºº8 9
{
ΩΩ 
return
ææ 
RedirectToAction
ææ '
(
ææ' (
$str
ææ( 3
,
ææ3 4
$str
ææ5 <
)
ææ< =
;
ææ= >
}
øø 
ViewBag
¡¡ 
.
¡¡ 
CreditorRef
¡¡ 
=
¡¡  !
new
¡¡" %

SelectList
¡¡& 0
(
¡¡0 1
$str
¡¡1 3
,
¡¡3 4
$str
¡¡5 7
)
¡¡7 8
;
¡¡8 9
return
¬¬ 
PartialView
¬¬ 
(
¬¬ 
$str
¬¬ 1
)
¬¬1 2
;
¬¬2 3
}
√√ 	
public
ƒƒ 
ActionResult
ƒƒ 
CreateFileNod
ƒƒ )
(
ƒƒ) *
)
ƒƒ* +
{
≈≈ 	
if
∆∆ 
(
∆∆ 
!
∆∆ 
lastSession
∆∆ 
.
∆∆ 
Update
∆∆ #
(
∆∆# $
)
∆∆$ %
)
∆∆% &
{
«« 
return
»» 
RedirectToAction
»» '
(
»»' (
$str
»»( /
,
»»/ 0
	GetConfig
»»1 :
.
»»: ;

AppSetting
»»; E
[
»»E F
$str
»»F n
]
»»n o
+
»»p q
$str
»»r y
,
»»y z
new
»»{ ~
{»» Ä
a»»Å Ç
=»»É Ñ
true»»Ö â
}»»ä ã
)»»ã å
;»»å ç
}
…… 
var
ÀÀ 
location
ÀÀ 
=
ÀÀ 
new
ÀÀ 
Uri
ÀÀ "
(
ÀÀ" #
$"
ÀÀ# %
{
ÀÀ% &
Request
ÀÀ& -
.
ÀÀ- .
Scheme
ÀÀ. 4
}
ÀÀ4 5
$str
ÀÀ5 8
{
ÀÀ8 9
Request
ÀÀ9 @
.
ÀÀ@ A
Host
ÀÀA E
}
ÀÀE F
{
ÀÀF G
Request
ÀÀG N
.
ÀÀN O
Path
ÀÀO S
}
ÀÀS T
"
ÀÀT U
)
ÀÀU V
;
ÀÀV W
string
ÃÃ 
Path
ÃÃ 
=
ÃÃ 
location
ÃÃ "
.
ÃÃ" #
AbsolutePath
ÃÃ# /
.
ÃÃ/ 0
Replace
ÃÃ0 7
(
ÃÃ7 8
this
ÃÃ8 <
.
ÃÃ< =
ControllerContext
ÃÃ= N
.
ÃÃN O
	RouteData
ÃÃO X
.
ÃÃX Y
Values
ÃÃY _
[
ÃÃ_ `
$str
ÃÃ` h
]
ÃÃh i
.
ÃÃi j
ToString
ÃÃj r
(
ÃÃr s
)
ÃÃs t
,
ÃÃt u
$str
ÃÃv }
)
ÃÃ} ~
;
ÃÃ~ 
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
accessSecurity
ŒŒ 
.
ŒŒ  
IsGetAccess
ŒŒ  +
(
ŒŒ+ ,
$str
ŒŒ, 0
+
ŒŒ1 2
Path
ŒŒ3 7
)
ŒŒ7 8
)
ŒŒ8 9
{
œœ 
return
–– 
RedirectToAction
–– '
(
––' (
$str
––( 3
,
––3 4
$str
––5 <
)
––< =
;
––= >
}
—— 
return
”” 
PartialView
”” 
(
”” 
$str
”” /
)
””/ 0
;
””0 1
}
‘‘ 	
[
÷÷ 	&
ValidateAntiForgeryToken
÷÷	 !
]
÷÷! "
[
◊◊ 	
HttpPost
◊◊	 
]
◊◊ 
public
ÿÿ 
async
ÿÿ 
Task
ÿÿ 
<
ÿÿ 
ActionResult
ÿÿ &
>
ÿÿ& '
SubmitCreate
ÿÿ( 4
(
ÿÿ4 5,
NoticeOfDisbursement_ViewModel
ÿÿ5 S
data
ÿÿT X
,
ÿÿX Y
string
ÿÿZ `
randomString
ÿÿa m
)
ÿÿm n
{
ŸŸ 	
if
⁄⁄ 
(
⁄⁄ 
!
⁄⁄ 
lastSession
⁄⁄ 
.
⁄⁄ 
Update
⁄⁄ #
(
⁄⁄# $
)
⁄⁄$ %
)
⁄⁄% &
{
€€ 
return
‹‹ 
RedirectToAction
‹‹ '
(
‹‹' (
$str
‹‹( /
,
‹‹/ 0
	GetConfig
‹‹1 :
.
‹‹: ;

AppSetting
‹‹; E
[
‹‹E F
$str
‹‹F n
]
‹‹n o
+
‹‹p q
$str
‹‹r y
,
‹‹y z
new
‹‹{ ~
{‹‹ Ä
a‹‹Å Ç
=‹‹É Ñ
true‹‹Ö â
}‹‹ä ã
)‹‹ã å
;‹‹å ç
}
›› 
var
ﬁﬁ 
location
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
Uri
ﬁﬁ "
(
ﬁﬁ" #
$"
ﬁﬁ# %
{
ﬁﬁ% &
Request
ﬁﬁ& -
.
ﬁﬁ- .
Scheme
ﬁﬁ. 4
}
ﬁﬁ4 5
$str
ﬁﬁ5 8
{
ﬁﬁ8 9
Request
ﬁﬁ9 @
.
ﬁﬁ@ A
Host
ﬁﬁA E
}
ﬁﬁE F
{
ﬁﬁF G
Request
ﬁﬁG N
.
ﬁﬁN O
Path
ﬁﬁO S
}
ﬁﬁS T
"
ﬁﬁT U
)
ﬁﬁU V
;
ﬁﬁV W
string
ﬂﬂ 
Path
ﬂﬂ 
=
ﬂﬂ 
location
ﬂﬂ "
.
ﬂﬂ" #
AbsolutePath
ﬂﬂ# /
.
ﬂﬂ/ 0
Replace
ﬂﬂ0 7
(
ﬂﬂ7 8
this
ﬂﬂ8 <
.
ﬂﬂ< =
ControllerContext
ﬂﬂ= N
.
ﬂﬂN O
	RouteData
ﬂﬂO X
.
ﬂﬂX Y
Values
ﬂﬂY _
[
ﬂﬂ_ `
$str
ﬂﬂ` h
]
ﬂﬂh i
.
ﬂﬂi j
ToString
ﬂﬂj r
(
ﬂﬂr s
)
ﬂﬂs t
,
ﬂﬂt u
$str
ﬂﬂv }
)
ﬂﬂ} ~
;
ﬂﬂ~ 
if
‡‡ 
(
‡‡ 
!
‡‡ 
accessSecurity
‡‡ 
.
‡‡  
IsGetAccess
‡‡  +
(
‡‡+ ,
$str
‡‡, 0
+
‡‡1 2
Path
‡‡3 7
)
‡‡7 8
)
‡‡8 9
{
·· 
return
‚‚ 
RedirectToAction
‚‚ '
(
‚‚' (
$str
‚‚( 3
,
‚‚3 4
$str
‚‚5 <
)
‚‚< =
;
‚‚= >
}
„„ 
try
ÂÂ 
{
ÊÊ 
var
ÁÁ 
regex
ÁÁ 
=
ÁÁ 
await
ÁÁ !
RegexRequest
ÁÁ" .
.
ÁÁ. /
RegexValidation
ÁÁ/ >
(
ÁÁ> ?
data
ÁÁ? C
)
ÁÁC D
;
ÁÁD E
if
ËË 
(
ËË 
!
ËË 
regex
ËË 
)
ËË 
{
ÈÈ 
return
ÍÍ 
Content
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 1
)
ÍÍ1 2
;
ÍÍ2 3
}
ÎÎ %
TblNoticeOfDisbursement
ÏÏ '
	dataNodNo
ÏÏ( 1
=
ÏÏ2 3
_context
ÏÏ4 <
.
ÏÏ< =&
TblNoticeOfDisbursements
ÏÏ= U
.
ÏÏU V
Where
ÏÏV [
(
ÏÏ[ \
m
ÏÏ\ ]
=>
ÏÏ^ `
m
ÏÏa b
.
ÏÏb c
NodNo
ÏÏc h
==
ÏÏi k
data
ÏÏl p
.
ÏÏp q
NodNo
ÏÏq v
&&
ÏÏw y
m
ÏÏz {
.
ÏÏ{ |
	IsDeletedÏÏ| Ö
!=ÏÏÜ à
$numÏÏâ ä
)ÏÏä ã
.ÏÏã å
FirstOrDefaultÏÏå ö
(ÏÏö õ
)ÏÏõ ú
;ÏÏú ù
if
ÌÌ 
(
ÌÌ 
	dataNodNo
ÌÌ 
!=
ÌÌ  
null
ÌÌ! %
)
ÌÌ% &
{
ÓÓ 
return
ÔÔ 
Content
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# @
+
ÔÔA B
	dataNodNo
ÔÔC L
.
ÔÔL M
NodNo
ÔÔM R
)
ÔÔR S
;
ÔÔS T
}
 
using
ÚÚ 
(
ÚÚ 
TransactionScope
ÚÚ '
trx
ÚÚ( +
=
ÚÚ, -
new
ÚÚ. 1
TransactionScope
ÚÚ2 B
(
ÚÚB C
)
ÚÚC D
)
ÚÚD E
{
ÛÛ %
TblNoticeOfDisbursement
ÙÙ +
model
ÙÙ, 1
=
ÙÙ2 3
new
ÙÙ4 7%
TblNoticeOfDisbursement
ÙÙ8 O
(
ÙÙO P
)
ÙÙP Q
;
ÙÙQ R
model
ıı 
.
ıı 
NodNo
ıı 
=
ıı  !
data
ıı" &
.
ıı& '
NodNo
ıı' ,
;
ıı, -
model
ˆˆ 
.
ˆˆ 
NodDate
ˆˆ !
=
ˆˆ" #
data
ˆˆ$ (
.
ˆˆ( )
NodDate
ˆˆ) 0
;
ˆˆ0 1
model
˜˜ 
.
˜˜ 
Cur
˜˜ 
=
˜˜ 
_context
˜˜  (
.
˜˜( )
TblMasterLookups
˜˜) 9
.
˜˜9 :
Where
˜˜: ?
(
˜˜? @
m
˜˜@ A
=>
˜˜B D
m
˜˜E F
.
˜˜F G
Value
˜˜G L
==
˜˜M O
int
˜˜P S
.
˜˜S T
Parse
˜˜T Y
(
˜˜Y Z
data
˜˜Z ^
.
˜˜^ _
Cur
˜˜_ b
)
˜˜b c
&&
˜˜d f
m
˜˜g h
.
˜˜h i
Type
˜˜i m
==
˜˜n p
$str
˜˜q {
)
˜˜{ |
.
˜˜| }
Select˜˜} É
(˜˜É Ñ
m˜˜Ñ Ö
=>˜˜Ö á
m˜˜á à
.˜˜à â
Name˜˜â ç
)˜˜ç é
.˜˜é è
FirstOrDefault˜˜è ù
(˜˜ù û
)˜˜û ü
;˜˜ü †
model
¯¯ 
.
¯¯ 
	ValueDate
¯¯ #
=
¯¯$ %
data
¯¯& *
.
¯¯* +
	ValueDate
¯¯+ 4
;
¯¯4 5
model
˘˘ 
.
˘˘ 
Status
˘˘  
=
˘˘! "
$str
˘˘# ,
;
˘˘, -
model
˙˙ 
.
˙˙ 
CreatedById
˙˙ %
=
˙˙& '
int
˙˙( +
.
˙˙+ ,
Parse
˙˙, 1
(
˙˙1 2
HttpContext
˙˙2 =
.
˙˙= >
Session
˙˙> E
.
˙˙E F
	GetString
˙˙F O
(
˙˙O P
SessionConstan
˙˙P ^
.
˙˙^ _
Session_UserId
˙˙_ m
)
˙˙m n
)
˙˙n o
;
˙˙o p
model
˚˚ 
.
˚˚ 
CreatedTime
˚˚ %
=
˚˚& '
DateTime
˚˚( 0
.
˚˚0 1
Now
˚˚1 4
;
˚˚4 5
model
¸¸ 
.
¸¸ 
	IsDeleted
¸¸ #
=
¸¸$ %
$num
¸¸& '
;
¸¸' (
model
˝˝ 
.
˝˝ 
IsActive
˝˝ "
=
˝˝# $
$num
˝˝% &
;
˝˝& '
_context
˛˛ 
.
˛˛ &
TblNoticeOfDisbursements
˛˛ 5
.
˛˛5 6
Add
˛˛6 9
(
˛˛9 :
model
˛˛: ?
)
˛˛? @
;
˛˛@ A
_context
ˇˇ 
.
ˇˇ 
SaveChanges
ˇˇ (
(
ˇˇ( )
)
ˇˇ) *
;
ˇˇ* +
List
ÅÅ 
<
ÅÅ /
!TblNoticeOfDisbursementDetailTemp
ÅÅ :
>
ÅÅ: ;
nodDetailList
ÅÅ< I
=
ÅÅJ K
_context
ÅÅL T
.
ÅÅT U0
"TblNoticeOfDisbursementDetailTemps
ÅÅU w
.
ÅÅw x
Where
ÅÅx }
(
ÅÅ} ~
m
ÅÅ~ 
=>ÅÅÄ Ç
mÅÅÉ Ñ
.ÅÅÑ Ö
RandomStringÅÅÖ ë
==ÅÅí î
randomStringÅÅï °
&&ÅÅ¢ §
mÅÅ• ¶
.ÅÅ¶ ß
IsActiveÅÅß Ø
==ÅÅ∞ ≤
$numÅÅ≥ ¥
&&ÅÅµ ∑
mÅÅ∏ π
.ÅÅπ ∫
	IsDeletedÅÅ∫ √
==ÅÅƒ ∆
$numÅÅ« »
)ÅÅ» …
.ÅÅ…  
ToListÅÅ  –
(ÅÅ– —
)ÅÅ— “
;ÅÅ“ ”
if
ÇÇ 
(
ÇÇ 
nodDetailList
ÇÇ %
!=
ÇÇ& (
null
ÇÇ) -
)
ÇÇ- .
{
ÉÉ 
foreach
ÑÑ 
(
ÑÑ  !
var
ÑÑ! $
item
ÑÑ% )
in
ÑÑ* ,
nodDetailList
ÑÑ- :
)
ÑÑ: ;
{
ÖÖ +
TblNoticeOfDisbursementDetail
ÜÜ 9
	nodDetail
ÜÜ: C
=
ÜÜD E
new
ÜÜF I+
TblNoticeOfDisbursementDetail
ÜÜJ g
(
ÜÜg h
)
ÜÜh i
;
ÜÜi j
	nodDetail
áá %
.
áá% &
NodId
áá& +
=
áá, -
model
áá. 3
.
áá3 4
Id
áá4 6
;
áá6 7
	nodDetail
àà %
.
àà% &
CreditorRef
àà& 1
=
àà2 3
item
àà4 8
.
àà8 9
CreditorRef
àà9 D
;
ààD E
	nodDetail
ââ %
.
ââ% &
Amount
ââ& ,
=
ââ- .
item
ââ/ 3
.
ââ3 4
Amount
ââ4 :
;
ââ: ;
	nodDetail
ää %
.
ää% &
	AmountIdr
ää& /
=
ää0 1
item
ää2 6
.
ää6 7
	AmountIdr
ää7 @
;
ää@ A
	nodDetail
ãã %
.
ãã% &
CreatedTime
ãã& 1
=
ãã2 3
DateTime
ãã4 <
.
ãã< =
Now
ãã= @
;
ãã@ A
	nodDetail
åå %
.
åå% &
CreatedById
åå& 1
=
åå2 3
int
åå4 7
.
åå7 8
Parse
åå8 =
(
åå= >
HttpContext
åå> I
.
ååI J
Session
ååJ Q
.
ååQ R
	GetString
ååR [
(
åå[ \
SessionConstan
åå\ j
.
ååj k
Session_UserId
ååk y
)
ååy z
)
ååz {
;
åå{ |
	nodDetail
çç %
.
çç% &
IsActive
çç& .
=
çç/ 0
$num
çç1 2
;
çç2 3
	nodDetail
éé %
.
éé% &
	IsDeleted
éé& /
=
éé0 1
$num
éé2 3
;
éé3 4
_context
èè $
.
èè$ %,
TblNoticeOfDisbursementDetails
èè% C
.
èèC D
Add
èèD G
(
èèG H
	nodDetail
èèH Q
)
èèQ R
;
èèR S
}
êê 
_context
ëë  
.
ëë  !
SaveChanges
ëë! ,
(
ëë, -
)
ëë- .
;
ëë. /
}
íí 
List
îî 
<
îî "
TblFileUploadNodTemp
îî -
>
îî- .
nodFileList
îî/ :
=
îî; <
_context
îî= E
.
îîE F#
TblFileUploadNodTemps
îîF [
.
îî[ \
Where
îî\ a
(
îîa b
m
îîb c
=>
îîd f
m
îîg h
.
îîh i
RandomString
îîi u
==
îîv x
randomStringîîy Ö
&&îîÜ à
mîîâ ä
.îîä ã
IsActiveîîã ì
==îîî ñ
$numîîó ò
&&îîô õ
mîîú ù
.îîù û
	IsDeletedîîû ß
==îî® ™
$numîî´ ¨
)îî¨ ≠
.îî≠ Æ
ToListîîÆ ¥
(îî¥ µ
)îîµ ∂
;îî∂ ∑
if
ïï 
(
ïï 
nodFileList
ïï #
!=
ïï$ &
null
ïï' +
)
ïï+ ,
{
ññ 
foreach
óó 
(
óó  !
var
óó! $
item
óó% )
in
óó* ,
nodFileList
óó- 8
)
óó8 9
{
òò 
TblFileUploadNod
ôô ,
nodFile
ôô- 4
=
ôô5 6
new
ôô7 :
TblFileUploadNod
ôô; K
(
ôôK L
)
ôôL M
;
ôôM N
nodFile
öö #
.
öö# $
IdNod
öö$ )
=
öö* +
model
öö, 1
.
öö1 2
Id
öö2 4
;
öö4 5
nodFile
õõ #
.
õõ# $
FileName
õõ$ ,
=
õõ- .
item
õõ/ 3
.
õõ3 4
FileName
õõ4 <
;
õõ< =
nodFile
úú #
.
úú# $
FileSize
úú$ ,
=
úú- .
item
úú/ 3
.
úú3 4
FileSize
úú4 <
;
úú< =
nodFile
ùù #
.
ùù# $
FilePath
ùù$ ,
=
ùù- .
item
ùù/ 3
.
ùù3 4
FilePath
ùù4 <
;
ùù< =
nodFile
ûû #
.
ûû# $
FileExt
ûû$ +
=
ûû, -
item
ûû. 2
.
ûû2 3
FileExt
ûû3 :
;
ûû: ;
nodFile
üü #
.
üü# $

UploadTime
üü$ .
=
üü/ 0
DateTime
üü1 9
.
üü9 :
Now
üü: =
;
üü= >
nodFile
†† #
.
††# $

UploadById
††$ .
=
††/ 0
int
††1 4
.
††4 5
Parse
††5 :
(
††: ;
HttpContext
††; F
.
††F G
Session
††G N
.
††N O
	GetString
††O X
(
††X Y
SessionConstan
††Y g
.
††g h
Session_UserId
††h v
)
††v w
)
††w x
;
††x y
nodFile
°° #
.
°°# $
IsActive
°°$ ,
=
°°- .
$num
°°/ 0
;
°°0 1
nodFile
¢¢ #
.
¢¢# $
	IsDeleted
¢¢$ -
=
¢¢. /
$num
¢¢0 1
;
¢¢1 2
_context
££ $
.
££$ %
TblFileUploadNods
££% 6
.
££6 7
Add
££7 :
(
££: ;
nodFile
££; B
)
££B C
;
££C D
}
§§ 
_context
••  
.
••  !
SaveChanges
••! ,
(
••, -
)
••- .
;
••. /
}
¶¶ 
trx
®® 
.
®® 
Complete
®®  
(
®®  !
)
®®! "
;
®®" #
}
´´ 
return
≠≠ 
Content
≠≠ 
(
≠≠ 
$str
≠≠ !
)
≠≠! "
;
≠≠" #
}
ÆÆ 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
Ex
ØØ 
)
ØØ  
{
∞∞ 
return
±± 
Content
±± 
(
±± 
	GetConfig
±± (
.
±±( )

AppSetting
±±) 3
[
±±3 4
$str
±±4 M
]
±±M N
)
±±N O
;
±±O P
}
≤≤ 
}
≥≥ 	
[
µµ 	
HttpPost
µµ	 
]
µµ 
public
∂∂ 
async
∂∂ 
Task
∂∂ 
<
∂∂ 
ActionResult
∂∂ &
>
∂∂& '
SubmitExcelCreate
∂∂( 9
(
∂∂9 :,
NoticeOfDisbursement_ViewModel
∂∂: X
model
∂∂Y ^
)
∂∂^ _
{
∑∑ 	
if
∏∏ 
(
∏∏ 
!
∏∏ 
lastSession
∏∏ 
.
∏∏ 
Update
∏∏ #
(
∏∏# $
)
∏∏$ %
)
∏∏% &
{
ππ 
return
∫∫ 
RedirectToAction
∫∫ '
(
∫∫' (
$str
∫∫( /
,
∫∫/ 0
	GetConfig
∫∫1 :
.
∫∫: ;

AppSetting
∫∫; E
[
∫∫E F
$str
∫∫F n
]
∫∫n o
+
∫∫p q
$str
∫∫r y
,
∫∫y z
new
∫∫{ ~
{∫∫ Ä
a∫∫Å Ç
=∫∫É Ñ
true∫∫Ö â
}∫∫ä ã
)∫∫ã å
;∫∫å ç
}
ªª 
var
ºº 
location
ºº 
=
ºº 
new
ºº 
Uri
ºº "
(
ºº" #
$"
ºº# %
{
ºº% &
Request
ºº& -
.
ºº- .
Scheme
ºº. 4
}
ºº4 5
$str
ºº5 8
{
ºº8 9
Request
ºº9 @
.
ºº@ A
Host
ººA E
}
ººE F
{
ººF G
Request
ººG N
.
ººN O
Path
ººO S
}
ººS T
"
ººT U
)
ººU V
;
ººV W
string
ΩΩ 
Patha
ΩΩ 
=
ΩΩ 
location
ΩΩ #
.
ΩΩ# $
AbsolutePath
ΩΩ$ 0
.
ΩΩ0 1
Replace
ΩΩ1 8
(
ΩΩ8 9
this
ΩΩ9 =
.
ΩΩ= >
ControllerContext
ΩΩ> O
.
ΩΩO P
	RouteData
ΩΩP Y
.
ΩΩY Z
Values
ΩΩZ `
[
ΩΩ` a
$str
ΩΩa i
]
ΩΩi j
.
ΩΩj k
ToString
ΩΩk s
(
ΩΩs t
)
ΩΩt u
,
ΩΩu v
$str
ΩΩw ~
)
ΩΩ~ 
;ΩΩ Ä
if
ææ 
(
ææ 
!
ææ 
accessSecurity
ææ 
.
ææ  
IsGetAccess
ææ  +
(
ææ+ ,
$str
ææ, 0
+
ææ1 2
Patha
ææ3 8
)
ææ8 9
)
ææ9 :
{
øø 
return
¿¿ 
RedirectToAction
¿¿ '
(
¿¿' (
$str
¿¿( 3
,
¿¿3 4
$str
¿¿5 <
)
¿¿< =
;
¿¿= >
}
¡¡ 
try
√√ 
{
ƒƒ 
var
≈≈ 
regex
≈≈ 
=
≈≈ 
await
≈≈ !
RegexRequest
≈≈" .
.
≈≈. /
RegexValidation
≈≈/ >
(
≈≈> ?
model
≈≈? D
)
≈≈D E
;
≈≈E F
if
∆∆ 
(
∆∆ 
!
∆∆ 
regex
∆∆ 
)
∆∆ 
{
«« 
return
»» 
Content
»» "
(
»»" #
$str
»»# 1
)
»»1 2
;
»»2 3
}
…… 
var
ÀÀ 
	increment
ÀÀ 
=
ÀÀ 
$num
ÀÀ  !
;
ÀÀ! "
using
ÃÃ 
(
ÃÃ 
var
ÃÃ 
trx
ÃÃ 
=
ÃÃ  
new
ÃÃ! $
TransactionScope
ÃÃ% 5
(
ÃÃ5 6$
TransactionScopeOption
ÃÃ6 L
.
ÃÃL M
Required
ÃÃM U
,
ÃÃU V
new
ÃÃW Z 
TransactionOptions
ÃÃ[ m
{
ÕÕ 
Timeout
ŒŒ 
=
ŒŒ 
new
ŒŒ !
TimeSpan
ŒŒ" *
(
ŒŒ* +
$num
ŒŒ+ ,
,
ŒŒ, -
$num
ŒŒ. /
,
ŒŒ/ 0
$num
ŒŒ1 2
)
ŒŒ2 3
}
œœ 
,
œœ -
TransactionScopeAsyncFlowOption
œœ 2
.
œœ2 3
Enabled
œœ3 :
)
œœ: ;
)
œœ; <
{
–– 
if
““ 
(
““ 
model
““ 
.
““ 
File
““ "
==
““# %
null
““& *
)
““* +
{
”” 
return
‘‘ 
Content
‘‘ &
(
‘‘& '
$str
‘‘' F
)
‘‘F G
;
‘‘G H
}
’’ 
else
÷÷ 
{
÷÷ &
TblMasterSystemParameter
◊◊ 0!
ConfigAppsLocalPath
◊◊1 D
=
◊◊E F
_context
◊◊G O
.
◊◊O P'
TblMasterSystemParameters
◊◊P i
.
◊◊i j
Where
◊◊j o
(
◊◊o p
m
◊◊p q
=>
◊◊r t
m
◊◊u v
.
◊◊v w
Key
◊◊w z
==
◊◊{ }
$str◊◊~ ç
)◊◊ç é
.◊◊é è
FirstOrDefault◊◊è ù
(◊◊ù û
)◊◊û ü
;◊◊ü †
List
ŸŸ 
<
ŸŸ /
!TblNoticeOfDisbursementDetailTemp
ŸŸ >
>
ŸŸ> ?
list
ŸŸ@ D
=
ŸŸE F
_context
ŸŸG O
.
ŸŸO P0
"TblNoticeOfDisbursementDetailTemps
ŸŸP r
.
ŸŸr s
Where
ŸŸs x
(
ŸŸx y
m
ŸŸy z
=>
ŸŸ{ }
m
ŸŸ~ 
.ŸŸ Ä
RandomStringŸŸÄ å
==ŸŸç è
modelŸŸê ï
.ŸŸï ñ
RandomStringŸŸñ ¢
)ŸŸ¢ £
.ŸŸ£ §
ToListŸŸ§ ™
(ŸŸ™ ´
)ŸŸ´ ¨
;ŸŸ¨ ≠
if
⁄⁄ 
(
⁄⁄ 
list
⁄⁄  
.
⁄⁄  !
Count
⁄⁄! &
(
⁄⁄& '
)
⁄⁄' (
!=
⁄⁄) +
$num
⁄⁄, -
)
⁄⁄- .
{
€€ 
return
‹‹ "
Content
‹‹# *
(
‹‹* +
$str
‹‹+ B
)
‹‹B C
;
‹‹C D
}
›› 
var
ﬂﬂ 

RowErrorKe
ﬂﬂ &
=
ﬂﬂ' (
$num
ﬂﬂ) *
;
ﬂﬂ* +
string
‚‚ #
AllowedFileUploadType
‚‚ 4
=
‚‚5 6
$str
‚‚7 I
;
‚‚I J
decimal
„„ 
SizeFileNon
„„  +
=
„„, -
model
„„. 3
.
„„3 4
File
„„4 8
.
„„8 9
Length
„„9 ?
/
„„@ A
$num
„„B I
;
„„I J
string
‰‰ 
ExtNon
‰‰ %
=
‰‰& '
Path
‰‰( ,
.
‰‰, -
GetExtension
‰‰- 9
(
‰‰9 :
model
‰‰: ?
.
‰‰? @
File
‰‰@ D
.
‰‰D E
FileName
‰‰E M
)
‰‰M N
;
‰‰N O
if
ÁÁ 
(
ÁÁ 
!
ÁÁ #
AllowedFileUploadType
ÁÁ 2
.
ÁÁ2 3
Contains
ÁÁ3 ;
(
ÁÁ; <
ExtNon
ÁÁ< B
)
ÁÁB C
)
ÁÁC D
{
ËË 
return
ÈÈ "
Content
ÈÈ# *
(
ÈÈ* +
$str
ÈÈ+ C
)
ÈÈC D
;
ÈÈD E
}
ÍÍ 
if
ÒÒ 
(
ÒÒ 
SizeFileNon
ÒÒ '
<=
ÒÒ( *
$num
ÒÒ+ -
)
ÒÒ- .
{
ÚÚ 
string
ÛÛ "
sFileExtensionNon
ÛÛ# 4
=
ÛÛ5 6
Path
ÛÛ7 ;
.
ÛÛ; <
GetExtension
ÛÛ< H
(
ÛÛH I
model
ÛÛI N
.
ÛÛN O
File
ÛÛO S
.
ÛÛS T
FileName
ÛÛT \
)
ÛÛ\ ]
.
ÛÛ] ^
ToLower
ÛÛ^ e
(
ÛÛe f
)
ÛÛf g
;
ÛÛg h
ISheet
ÙÙ "
sheet
ÙÙ# (
;
ÙÙ( )
string
ıı "
fullPathNon
ıı# .
=
ıı/ 0
Path
ıı1 5
.
ıı5 6
Combine
ıı6 =
(
ıı= >
model
ıı> C
.
ııC D
File
ııD H
.
ııH I
FileName
ııI Q
)
ııQ R
;
ııR S
var
ˆˆ %
fileNameReplaceSpaceNon
ˆˆ  7
=
ˆˆ8 9
model
ˆˆ: ?
.
ˆˆ? @
File
ˆˆ@ D
.
ˆˆD E
FileName
ˆˆE M
.
ˆˆM N
Replace
ˆˆN U
(
ˆˆU V
$str
ˆˆV Y
,
ˆˆY Z
$str
ˆˆ[ ^
)
ˆˆ^ _
;
ˆˆ_ `
var
˜˜ 
path
˜˜  $
=
˜˜% &
Path
˜˜' +
.
˜˜+ ,
Combine
˜˜, 3
(
˜˜3 4!
ConfigAppsLocalPath
˜˜4 G
.
˜˜G H
Value
˜˜H M
,
˜˜M N%
fileNameReplaceSpaceNon
˜˜O f
)
˜˜f g
;
˜˜g h
using
¯¯ !
(
¯¯" #
var
¯¯# &
stream
¯¯' -
=
¯¯. /
new
¯¯0 3
MemoryStream
¯¯4 @
(
¯¯@ A
)
¯¯A B
)
¯¯B C
{
˘˘ 
model
˙˙  %
.
˙˙% &
File
˙˙& *
.
˙˙* +
CopyTo
˙˙+ 1
(
˙˙1 2
stream
˙˙2 8
)
˙˙8 9
;
˙˙9 :
stream
˚˚  &
.
˚˚& '
Position
˚˚' /
=
˚˚0 1
$num
˚˚2 3
;
˚˚3 4
if
¸¸  "
(
¸¸# $
sFileExtensionNon
¸¸$ 5
==
¸¸6 8
$str
¸¸9 ?
)
¸¸? @
{
˝˝  !
HSSFWorkbook
˛˛$ 0
hssfwb
˛˛1 7
=
˛˛8 9
new
˛˛: =
HSSFWorkbook
˛˛> J
(
˛˛J K
stream
˛˛K Q
)
˛˛Q R
;
˛˛R S
sheet
ˇˇ$ )
=
ˇˇ* +
hssfwb
ˇˇ, 2
.
ˇˇ2 3

GetSheetAt
ˇˇ3 =
(
ˇˇ= >
$num
ˇˇ> ?
)
ˇˇ? @
;
ˇˇ@ A
}
ÄÄ  !
else
ÅÅ  $
{
ÇÇ  !
XSSFWorkbook
ÉÉ$ 0
hssfwb
ÉÉ1 7
=
ÉÉ8 9
new
ÉÉ: =
XSSFWorkbook
ÉÉ> J
(
ÉÉJ K
stream
ÉÉK Q
)
ÉÉQ R
;
ÉÉR S
sheet
ÑÑ$ )
=
ÑÑ* +
hssfwb
ÑÑ, 2
.
ÑÑ2 3

GetSheetAt
ÑÑ3 =
(
ÑÑ= >
$num
ÑÑ> ?
)
ÑÑ? @
;
ÑÑ@ A
}
ÖÖ  !
}
ÜÜ 
using
ââ !
(
ââ" #
TransactionScope
ââ# 3
trx2
ââ4 8
=
ââ9 :
new
ââ; >
TransactionScope
ââ? O
(
ââO P$
TransactionScopeOption
ââP f
.
ââf g
Required
ââg o
,
ââo p
new
ââq t!
TransactionOptionsââu á
{
ää 
Timeout
ãã  '
=
ãã( )
new
ãã* -
TimeSpan
ãã. 6
(
ãã6 7
$num
ãã7 8
,
ãã8 9
$num
ãã: ;
,
ãã; <
$num
ãã= >
)
ãã> ?
}
åå 
,
åå -
TransactionScopeAsyncFlowOption
åå >
.
åå> ?
Enabled
åå? F
)
ååF G
)
ååG H
{
çç 
for
èè  #
(
èè$ %
int
èè% (
i
èè) *
=
èè+ ,
(
èè- .
sheet
èè. 3
.
èè3 4
FirstRowNum
èè4 ?
+
èè@ A
$num
èèB C
)
èèC D
;
èèD E
i
èèF G
<=
èèH J
sheet
èèK P
.
èèP Q

LastRowNum
èèQ [
;
èè[ \
i
èè] ^
++
èè^ `
)
èè` a
{
êê  !

RowErrorKe
ëë$ .
=
ëë/ 0
i
ëë1 2
;
ëë2 3
IRow
íí$ (
row
íí) ,
=
íí- .
sheet
íí/ 4
.
íí4 5
GetRow
íí5 ;
(
íí; <
i
íí< =
)
íí= >
;
íí> ?
if
ìì$ &
(
ìì' (
row
ìì( +
==
ìì, .
null
ìì/ 3
)
ìì3 4
continue
ìì5 =
;
ìì= >
if
îî$ &
(
îî' (
row
îî( +
.
îî+ ,
Cells
îî, 1
.
îî1 2
All
îî2 5
(
îî5 6
d
îî6 7
=>
îî8 :
d
îî; <
.
îî< =
CellType
îî= E
==
îîF H
CellType
îîI Q
.
îîQ R
Blank
îîR W
)
îîW X
)
îîX Y
continue
îîZ b
;
îîb c
var
ññ$ '
a
ññ( )
=
ññ* +
row
ññ, /
.
ññ/ 0
GetCell
ññ0 7
(
ññ7 8
$num
ññ8 9
)
ññ9 :
.
ññ: ;
ToString
ññ; C
(
ññC D
)
ññD E
;
ññE F
if
óó$ &
(
óó' (
row
óó( +
.
óó+ ,
GetCell
óó, 3
(
óó3 4
$num
óó4 5
)
óó5 6
.
óó6 7
ToString
óó7 ?
(
óó? @
)
óó@ A
!=
óóB D
$str
óóE G
)
óóG H
{
òò$ %
CultureInfo
ôô( 3
culture
ôô4 ;
=
ôô< =
new
ôô> A
CultureInfo
ôôB M
(
ôôM N
$str
ôôN U
)
ôôU V
;
ôôV W
var
õõ( +
NodNotempNod
õõ, 8
=
õõ9 :
row
õõ; >
.
õõ> ?
GetCell
õõ? F
(
õõF G
$num
õõG H
)
õõH I
.
õõI J
ToString
õõJ R
(
õõR S
)
õõS T
==
õõU W
$str
õõX Z
||
õõ[ ]
row
õõ^ a
.
õõa b
GetCell
õõb i
(
õõi j
$num
õõj k
)
õõk l
.
õõl m
ToString
õõm u
(
õõu v
)
õõv w
==
õõx z
null
õõ{ 
?õõÄ Å
$strõõÇ Ñ
:õõÖ Ü
rowõõá ä
.õõä ã
GetCellõõã í
(õõí ì
$numõõì î
)õõî ï
.õõï ñ
ToStringõõñ û
(õõû ü
)õõü †
;õõ† °
var
úú( +
NodNotempNodTemp
úú, <
=
úú= >
row
úú? B
.
úúB C
GetCell
úúC J
(
úúJ K
$num
úúK L
)
úúL M
.
úúM N
ToString
úúN V
(
úúV W
)
úúW X
==
úúY [
$str
úú\ ^
||
úú_ a
row
úúb e
.
úúe f
GetCell
úúf m
(
úúm n
$num
úún o
)
úúo p
.
úúp q
ToString
úúq y
(
úúy z
)
úúz {
==
úú| ~
nullúú É
?úúÑ Ö
$strúúÜ à
:úúâ ä
rowúúã é
.úúé è
GetCellúúè ñ
(úúñ ó
$numúúó ò
)úúò ô
.úúô ö
ToStringúúö ¢
(úú¢ £
)úú£ §
;úú§ •%
TblNoticeOfDisbursement
ûû( ?
ListTempNod
ûû@ K
=
ûûL M
_context
ûûN V
.
ûûV W&
TblNoticeOfDisbursements
ûûW o
.
ûûo p
Where
ûûp u
(
ûûu v
m
ûûv w
=>
ûûx z
m
ûû{ |
.
ûû| }
NodNoûû} Ç
==ûûÉ Ö
NodNotempNodûûÜ í
&&ûûì ï
mûûñ ó
.ûûó ò
	IsDeletedûûò °
==ûû¢ §
$numûû• ¶
)ûû¶ ß
.ûûß ®
FirstOrDefaultûû® ∂
(ûû∂ ∑
)ûû∑ ∏
;ûû∏ π+
TblNoticeOfDisbursementDetail
üü( E
ListTempNodDetail
üüF W
=
üüX Y
_context
üüZ b
.
üüb c-
TblNoticeOfDisbursementDetailsüüc Å
.üüÅ Ç
WhereüüÇ á
(üüá à
müüà â
=>üüä å
müüç é
.üüé è
CreditorRefüüè ö
==üüõ ù 
NodNotempNodTempüüû Æ
&&üüØ ±
müü≤ ≥
.üü≥ ¥
	IsDeletedüü¥ Ω
==üüæ ¿
$numüü¡ ¬
)üü¬ √
.üü√ ƒ
FirstOrDefaultüüƒ “
(üü“ ”
)üü” ‘
;üü‘ ’
if
°°( *
(
°°+ ,
ListTempNod
°°, 7
==
°°8 :
null
°°; ?
)
°°? @
{
¢¢( )%
TblNoticeOfDisbursement
££, C
ListTempNew
££D O
=
££P Q
new
££R U%
TblNoticeOfDisbursement
££V m
(
££m n
)
££n o
;
££o p
ListTempNew
§§, 7
.
§§7 8
NodNo
§§8 =
=
§§> ?
row
§§@ C
.
§§C D
GetCell
§§D K
(
§§K L
$num
§§L M
)
§§M N
.
§§N O
ToString
§§O W
(
§§W X
)
§§X Y
==
§§Z \
$str
§§] _
||
§§` b
row
§§c f
.
§§f g
GetCell
§§g n
(
§§n o
$num
§§o p
)
§§p q
.
§§q r
ToString
§§r z
(
§§z {
)
§§{ |
==
§§} 
null§§Ä Ñ
?§§Ö Ü
$str§§á â
:§§ä ã
row§§å è
.§§è ê
GetCell§§ê ó
(§§ó ò
$num§§ò ô
)§§ô ö
.§§ö õ
ToString§§õ £
(§§£ §
)§§§ •
;§§• ¶
ListTempNew
••, 7
.
••7 8
NodDate
••8 ?
=
••@ A
DateTime
••B J
.
••J K
Parse
••K P
(
••P Q
row
••Q T
.
••T U
GetCell
••U \
(
••\ ]
$num
••] ^
)
••^ _
.
••_ `
ToString
••` h
(
••h i
)
••i j
==
••k m
$str
••n p
||
••q s
row
••t w
.
••w x
GetCell
••x 
(•• Ä
$num••Ä Å
)••Å Ç
.••Ç É
ToString••É ã
(••ã å
)••å ç
==••é ê
null••ë ï
?••ñ ó
$str••ò ö
:••õ ú
row••ù †
.••† °
GetCell••° ®
(••® ©
$num••© ™
)••™ ´
.••´ ¨
ToString••¨ ¥
(••¥ µ
)••µ ∂
,••∂ ∑
culture••∏ ø
)••ø ¿
;••¿ ¡
ListTempNew
¶¶, 7
.
¶¶7 8
	ValueDate
¶¶8 A
=
¶¶B C
DateTime
¶¶D L
.
¶¶L M
Parse
¶¶M R
(
¶¶R S
row
¶¶S V
.
¶¶V W
GetCell
¶¶W ^
(
¶¶^ _
$num
¶¶_ `
)
¶¶` a
.
¶¶a b
ToString
¶¶b j
(
¶¶j k
)
¶¶k l
==
¶¶m o
$str
¶¶p r
||
¶¶s u
row
¶¶v y
.
¶¶y z
GetCell¶¶z Å
(¶¶Å Ç
$num¶¶Ç É
)¶¶É Ñ
.¶¶Ñ Ö
ToString¶¶Ö ç
(¶¶ç é
)¶¶é è
==¶¶ê í
null¶¶ì ó
?¶¶ò ô
$str¶¶ö ú
:¶¶ù û
row¶¶ü ¢
.¶¶¢ £
GetCell¶¶£ ™
(¶¶™ ´
$num¶¶´ ¨
)¶¶¨ ≠
.¶¶≠ Æ
ToString¶¶Æ ∂
(¶¶∂ ∑
)¶¶∑ ∏
,¶¶∏ π
culture¶¶∫ ¡
)¶¶¡ ¬
;¶¶¬ √
var
ßß, /
Currency
ßß0 8
=
ßß9 :
row
ßß; >
.
ßß> ?
GetCell
ßß? F
(
ßßF G
$num
ßßG H
)
ßßH I
.
ßßI J
ToString
ßßJ R
(
ßßR S
)
ßßS T
==
ßßU W
$str
ßßX Z
||
ßß[ ]
row
ßß^ a
.
ßßa b
GetCell
ßßb i
(
ßßi j
$num
ßßj k
)
ßßk l
.
ßßl m
ToString
ßßm u
(
ßßu v
)
ßßv w
==
ßßx z
null
ßß{ 
?ßßÄ Å
$strßßÇ Ñ
:ßßÖ Ü
rowßßá ä
.ßßä ã
GetCellßßã í
(ßßí ì
$numßßì î
)ßßî ï
.ßßï ñ
ToStringßßñ û
(ßßû ü
)ßßü †
;ßß† °
var
®®, /
CheckCurrency
®®0 =
=
®®> ?
_context
®®@ H
.
®®H I
TblMasterLookups
®®I Y
.
®®Y Z
Where
®®Z _
(
®®_ `
m
®®` a
=>
®®b d
m
®®e f
.
®®f g
Name
®®g k
==
®®l n
Currency
®®o w
&&
®®x z
m
®®{ |
.
®®| }
Type®®} Å
==®®Ç Ñ
$str®®Ö è
)®®è ê
.®®ê ë
Select®®ë ó
(®®ó ò
m®®ò ô
=>®®ö ú
m®®ù û
.®®û ü
Name®®ü £
)®®£ §
.®®§ •
FirstOrDefault®®• ≥
(®®≥ ¥
)®®¥ µ
;®®µ ∂
ListTempNew
©©, 7
.
©©7 8
Cur
©©8 ;
=
©©< =
CheckCurrency
©©> K
;
©©K L
ListTempNew
™™, 7
.
™™7 8
Status
™™8 >
=
™™? @
$str
™™A J
;
™™J K
ListTempNew
´´, 7
.
´´7 8
IsActive
´´8 @
=
´´A B
$num
´´C D
;
´´D E
ListTempNew
¨¨, 7
.
¨¨7 8
	IsDeleted
¨¨8 A
=
¨¨B C
$num
¨¨D E
;
¨¨E F
ListTempNew
≠≠, 7
.
≠≠7 8
CreatedById
≠≠8 C
=
≠≠D E
int
≠≠F I
.
≠≠I J
Parse
≠≠J O
(
≠≠O P
HttpContext
≠≠P [
.
≠≠[ \
Session
≠≠\ c
.
≠≠c d
	GetString
≠≠d m
(
≠≠m n
SessionConstan
≠≠n |
.
≠≠| }
Session_UserId≠≠} ã
)≠≠ã å
)≠≠å ç
;≠≠ç é
ListTempNew
ÆÆ, 7
.
ÆÆ7 8
CreatedTime
ÆÆ8 C
=
ÆÆD E
DateTime
ÆÆF N
.
ÆÆN O
Now
ÆÆO R
;
ÆÆR S
_context
ØØ, 4
.
ØØ4 5&
TblNoticeOfDisbursements
ØØ5 M
.
ØØM N
Add
ØØN Q
(
ØØQ R
ListTempNew
ØØR ]
)
ØØ] ^
;
ØØ^ _
_context
∞∞, 4
.
∞∞4 5
SaveChanges
∞∞5 @
(
∞∞@ A
)
∞∞A B
;
∞∞B C
if
≤≤, .
(
≤≤/ 0
ListTempNodDetail
≤≤0 A
==
≤≤B D
null
≤≤E I
)
≤≤I J
{
≥≥, -+
TblNoticeOfDisbursementDetail
¥¥0 M
ListTempNewDetail
¥¥N _
=
¥¥` a
new
¥¥b e,
TblNoticeOfDisbursementDetail¥¥f É
(¥¥É Ñ
)¥¥Ñ Ö
;¥¥Ö Ü
ListTempNewDetail
µµ0 A
.
µµA B
NodId
µµB G
=
µµH I
ListTempNew
µµJ U
.
µµU V
Id
µµV X
;
µµX Y
ListTempNewDetail
∂∂0 A
.
∂∂A B
CreditorRef
∂∂B M
=
∂∂N O
row
∂∂P S
.
∂∂S T
GetCell
∂∂T [
(
∂∂[ \
$num
∂∂\ ]
)
∂∂] ^
.
∂∂^ _
ToString
∂∂_ g
(
∂∂g h
)
∂∂h i
==
∂∂j l
$str
∂∂m o
||
∂∂p r
row
∂∂s v
.
∂∂v w
GetCell
∂∂w ~
(
∂∂~ 
$num∂∂ Ä
)∂∂Ä Å
.∂∂Å Ç
ToString∂∂Ç ä
(∂∂ä ã
)∂∂ã å
==∂∂ç è
null∂∂ê î
?∂∂ï ñ
$str∂∂ó ô
:∂∂ö õ
row∂∂ú ü
.∂∂ü †
GetCell∂∂† ß
(∂∂ß ®
$num∂∂® ©
)∂∂© ™
.∂∂™ ´
ToString∂∂´ ≥
(∂∂≥ ¥
)∂∂¥ µ
;∂∂µ ∂
ListTempNewDetail
∑∑0 A
.
∑∑A B
Amount
∑∑B H
=
∑∑I J
decimal
∑∑K R
.
∑∑R S
Parse
∑∑S X
(
∑∑X Y
row
∑∑Y \
.
∑∑\ ]
GetCell
∑∑] d
(
∑∑d e
$num
∑∑e f
)
∑∑f g
.
∑∑g h
ToString
∑∑h p
(
∑∑p q
)
∑∑q r
==
∑∑s u
$str
∑∑v x
||
∑∑y {
row
∑∑| 
.∑∑ Ä
GetCell∑∑Ä á
(∑∑á à
$num∑∑à â
)∑∑â ä
.∑∑ä ã
ToString∑∑ã ì
(∑∑ì î
)∑∑î ï
==∑∑ñ ò
$str∑∑ô ú
?∑∑ù û
$str∑∑ü °
:∑∑¢ £
row∑∑§ ß
.∑∑ß ®
GetCell∑∑® Ø
(∑∑Ø ∞
$num∑∑∞ ±
)∑∑± ≤
.∑∑≤ ≥
ToString∑∑≥ ª
(∑∑ª º
)∑∑º Ω
)∑∑Ω æ
;∑∑æ ø
ListTempNewDetail
∏∏0 A
.
∏∏A B
	AmountIdr
∏∏B K
=
∏∏L M
decimal
∏∏N U
.
∏∏U V
Parse
∏∏V [
(
∏∏[ \
row
∏∏\ _
.
∏∏_ `
GetCell
∏∏` g
(
∏∏g h
$num
∏∏h i
)
∏∏i j
.
∏∏j k
ToString
∏∏k s
(
∏∏s t
)
∏∏t u
==
∏∏v x
$str
∏∏y {
||
∏∏| ~
row∏∏ Ç
.∏∏Ç É
GetCell∏∏É ä
(∏∏ä ã
$num∏∏ã å
)∏∏å ç
.∏∏ç é
ToString∏∏é ñ
(∏∏ñ ó
)∏∏ó ò
==∏∏ô õ
$str∏∏ú ü
?∏∏† °
$str∏∏¢ §
:∏∏• ¶
row∏∏ß ™
.∏∏™ ´
GetCell∏∏´ ≤
(∏∏≤ ≥
$num∏∏≥ ¥
)∏∏¥ µ
.∏∏µ ∂
ToString∏∏∂ æ
(∏∏æ ø
)∏∏ø ¿
)∏∏¿ ¡
;∏∏¡ ¬
ListTempNewDetail
ππ0 A
.
ππA B
IsActive
ππB J
=
ππK L
$num
ππM N
;
ππN O
ListTempNewDetail
∫∫0 A
.
∫∫A B
	IsDeleted
∫∫B K
=
∫∫L M
$num
∫∫N O
;
∫∫O P
ListTempNewDetail
ªª0 A
.
ªªA B
CreatedById
ªªB M
=
ªªN O
int
ªªP S
.
ªªS T
Parse
ªªT Y
(
ªªY Z
HttpContext
ªªZ e
.
ªªe f
Session
ªªf m
.
ªªm n
	GetString
ªªn w
(
ªªw x
SessionConstanªªx Ü
.ªªÜ á
Session_UserIdªªá ï
)ªªï ñ
)ªªñ ó
;ªªó ò
ListTempNewDetail
ºº0 A
.
ººA B
CreatedTime
ººB M
=
ººN O
DateTime
ººP X
.
ººX Y
Now
ººY \
;
ºº\ ]
bool
ΩΩ0 4
CheckCreRef
ΩΩ5 @
=
ΩΩA B
CheckCreditorRef
ΩΩC S
(
ΩΩS T
row
ΩΩT W
.
ΩΩW X
GetCell
ΩΩX _
(
ΩΩ_ `
$num
ΩΩ` a
)
ΩΩa b
.
ΩΩb c
ToString
ΩΩc k
(
ΩΩk l
)
ΩΩl m
==
ΩΩn p
$str
ΩΩq s
||
ΩΩt v
row
ΩΩw z
.
ΩΩz {
GetCellΩΩ{ Ç
(ΩΩÇ É
$numΩΩÉ Ñ
)ΩΩÑ Ö
.ΩΩÖ Ü
ToStringΩΩÜ é
(ΩΩé è
)ΩΩè ê
==ΩΩë ì
nullΩΩî ò
?ΩΩô ö
$strΩΩõ ù
:ΩΩû ü
rowΩΩ† £
.ΩΩ£ §
GetCellΩΩ§ ´
(ΩΩ´ ¨
$numΩΩ¨ ≠
)ΩΩ≠ Æ
.ΩΩÆ Ø
ToStringΩΩØ ∑
(ΩΩ∑ ∏
)ΩΩ∏ π
)ΩΩπ ∫
;ΩΩ∫ ª
if
ææ0 2
(
ææ2 3
CheckCreRef
ææ3 >
)
ææ> ?
{
øø0 1
_context
¿¿4 <
.
¿¿< =,
TblNoticeOfDisbursementDetails
¿¿= [
.
¿¿[ \
Add
¿¿\ _
(
¿¿_ `
ListTempNewDetail
¿¿` q
)
¿¿q r
;
¿¿r s
}
¡¡0 1
}
¬¬, -
else
√√, 0
{
ƒƒ, -
ListTempNodDetail
≈≈0 A
.
≈≈A B
NodId
≈≈B G
=
≈≈H I
ListTempNew
≈≈J U
.
≈≈U V
Id
≈≈V X
;
≈≈X Y
ListTempNodDetail
∆∆0 A
.
∆∆A B
CreditorRef
∆∆B M
=
∆∆N O
row
∆∆P S
.
∆∆S T
GetCell
∆∆T [
(
∆∆[ \
$num
∆∆\ ]
)
∆∆] ^
.
∆∆^ _
ToString
∆∆_ g
(
∆∆g h
)
∆∆h i
==
∆∆j l
$str
∆∆m o
||
∆∆p r
row
∆∆s v
.
∆∆v w
GetCell
∆∆w ~
(
∆∆~ 
$num∆∆ Ä
)∆∆Ä Å
.∆∆Å Ç
ToString∆∆Ç ä
(∆∆ä ã
)∆∆ã å
==∆∆ç è
null∆∆ê î
?∆∆ï ñ
$str∆∆ó ô
:∆∆ö õ
row∆∆ú ü
.∆∆ü †
GetCell∆∆† ß
(∆∆ß ®
$num∆∆® ©
)∆∆© ™
.∆∆™ ´
ToString∆∆´ ≥
(∆∆≥ ¥
)∆∆¥ µ
;∆∆µ ∂
ListTempNodDetail
««0 A
.
««A B
Amount
««B H
=
««I J
decimal
««K R
.
««R S
Parse
««S X
(
««X Y
row
««Y \
.
««\ ]
GetCell
««] d
(
««d e
$num
««e f
)
««f g
.
««g h
ToString
««h p
(
««p q
)
««q r
==
««s u
$str
««v x
||
««y {
row
««| 
.«« Ä
GetCell««Ä á
(««á à
$num««à â
)««â ä
.««ä ã
ToString««ã ì
(««ì î
)««î ï
==««ñ ò
$str««ô ú
?««ù û
$str««ü °
:««¢ £
row««§ ß
.««ß ®
GetCell««® Ø
(««Ø ∞
$num««∞ ±
)««± ≤
.««≤ ≥
ToString««≥ ª
(««ª º
)««º Ω
)««Ω æ
;««æ ø
ListTempNodDetail
»»0 A
.
»»A B
	AmountIdr
»»B K
=
»»L M
decimal
»»N U
.
»»U V
Parse
»»V [
(
»»[ \
row
»»\ _
.
»»_ `
GetCell
»»` g
(
»»g h
$num
»»h i
)
»»i j
.
»»j k
ToString
»»k s
(
»»s t
)
»»t u
==
»»v x
$str
»»y {
||
»»| ~
row»» Ç
.»»Ç É
GetCell»»É ä
(»»ä ã
$num»»ã å
)»»å ç
.»»ç é
ToString»»é ñ
(»»ñ ó
)»»ó ò
==»»ô õ
$str»»ú ü
?»»† °
$str»»¢ §
:»»• ¶
row»»ß ™
.»»™ ´
GetCell»»´ ≤
(»»≤ ≥
$num»»≥ ¥
)»»¥ µ
.»»µ ∂
ToString»»∂ æ
(»»æ ø
)»»ø ¿
)»»¿ ¡
;»»¡ ¬
ListTempNodDetail
……0 A
.
……A B
IsActive
……B J
=
……K L
$num
……M N
;
……N O
ListTempNodDetail
  0 A
.
  A B
	IsDeleted
  B K
=
  L M
$num
  N O
;
  O P
ListTempNodDetail
ÀÀ0 A
.
ÀÀA B
CreatedById
ÀÀB M
=
ÀÀN O
int
ÀÀP S
.
ÀÀS T
Parse
ÀÀT Y
(
ÀÀY Z
HttpContext
ÀÀZ e
.
ÀÀe f
Session
ÀÀf m
.
ÀÀm n
	GetString
ÀÀn w
(
ÀÀw x
SessionConstanÀÀx Ü
.ÀÀÜ á
Session_UserIdÀÀá ï
)ÀÀï ñ
)ÀÀñ ó
;ÀÀó ò
ListTempNodDetail
ÃÃ0 A
.
ÃÃA B
CreatedTime
ÃÃB M
=
ÃÃN O
DateTime
ÃÃP X
.
ÃÃX Y
Now
ÃÃY \
;
ÃÃ\ ]
bool
ÕÕ0 4
CheckCreRef
ÕÕ5 @
=
ÕÕA B
CheckCreditorRef
ÕÕC S
(
ÕÕS T
row
ÕÕT W
.
ÕÕW X
GetCell
ÕÕX _
(
ÕÕ_ `
$num
ÕÕ` a
)
ÕÕa b
.
ÕÕb c
ToString
ÕÕc k
(
ÕÕk l
)
ÕÕl m
==
ÕÕn p
$str
ÕÕq s
||
ÕÕt v
row
ÕÕw z
.
ÕÕz {
GetCellÕÕ{ Ç
(ÕÕÇ É
$numÕÕÉ Ñ
)ÕÕÑ Ö
.ÕÕÖ Ü
ToStringÕÕÜ é
(ÕÕé è
)ÕÕè ê
==ÕÕë ì
nullÕÕî ò
?ÕÕô ö
$strÕÕõ ù
:ÕÕû ü
rowÕÕ† £
.ÕÕ£ §
GetCellÕÕ§ ´
(ÕÕ´ ¨
$numÕÕ¨ ≠
)ÕÕ≠ Æ
.ÕÕÆ Ø
ToStringÕÕØ ∑
(ÕÕ∑ ∏
)ÕÕ∏ π
)ÕÕπ ∫
;ÕÕ∫ ª
if
ŒŒ0 2
(
ŒŒ3 4
CheckCreRef
ŒŒ4 ?
)
ŒŒ? @
{
œœ0 1
_context
––4 <
.
––< =,
TblNoticeOfDisbursementDetails
––= [
.
––[ \
Add
––\ _
(
––_ `
ListTempNodDetail
––` q
)
––q r
;
––r s
}
——0 1
}
““, -
_context
””, 4
.
””4 5
SaveChanges
””5 @
(
””@ A
)
””A B
;
””B C
}
’’( )
else
÷÷( ,
if
÷÷- /
(
÷÷/ 0
ListTempNod
÷÷0 ;
!=
÷÷< >
null
÷÷? C
&&
÷÷D F
ListTempNod
÷÷G R
.
÷÷R S
Status
÷÷S Y
!=
÷÷Z \
$str
÷÷] g
)
÷÷g h
{
◊◊( )
ListTempNod
ÿÿ, 7
.
ÿÿ7 8
NodNo
ÿÿ8 =
=
ÿÿ> ?
row
ÿÿ@ C
.
ÿÿC D
GetCell
ÿÿD K
(
ÿÿK L
$num
ÿÿL M
)
ÿÿM N
.
ÿÿN O
ToString
ÿÿO W
(
ÿÿW X
)
ÿÿX Y
==
ÿÿZ \
$str
ÿÿ] _
||
ÿÿ` b
row
ÿÿc f
.
ÿÿf g
GetCell
ÿÿg n
(
ÿÿn o
$num
ÿÿo p
)
ÿÿp q
.
ÿÿq r
ToString
ÿÿr z
(
ÿÿz {
)
ÿÿ{ |
==
ÿÿ} 
nullÿÿÄ Ñ
?ÿÿÖ Ü
$strÿÿá â
:ÿÿä ã
rowÿÿå è
.ÿÿè ê
GetCellÿÿê ó
(ÿÿó ò
$numÿÿò ô
)ÿÿô ö
.ÿÿö õ
ToStringÿÿõ £
(ÿÿ£ §
)ÿÿ§ •
;ÿÿ• ¶
ListTempNod
ŸŸ, 7
.
ŸŸ7 8
NodDate
ŸŸ8 ?
=
ŸŸ@ A
DateTime
ŸŸB J
.
ŸŸJ K
Parse
ŸŸK P
(
ŸŸP Q
row
ŸŸQ T
.
ŸŸT U
GetCell
ŸŸU \
(
ŸŸ\ ]
$num
ŸŸ] ^
)
ŸŸ^ _
.
ŸŸ_ `
ToString
ŸŸ` h
(
ŸŸh i
)
ŸŸi j
==
ŸŸk m
$str
ŸŸn p
||
ŸŸq s
row
ŸŸt w
.
ŸŸw x
GetCell
ŸŸx 
(ŸŸ Ä
$numŸŸÄ Å
)ŸŸÅ Ç
.ŸŸÇ É
ToStringŸŸÉ ã
(ŸŸã å
)ŸŸå ç
==ŸŸé ê
nullŸŸë ï
?ŸŸñ ó
$strŸŸò ö
:ŸŸõ ú
rowŸŸù †
.ŸŸ† °
GetCellŸŸ° ®
(ŸŸ® ©
$numŸŸ© ™
)ŸŸ™ ´
.ŸŸ´ ¨
ToStringŸŸ¨ ¥
(ŸŸ¥ µ
)ŸŸµ ∂
,ŸŸ∂ ∑
cultureŸŸ∏ ø
)ŸŸø ¿
;ŸŸ¿ ¡
ListTempNod
⁄⁄, 7
.
⁄⁄7 8
	ValueDate
⁄⁄8 A
=
⁄⁄B C
DateTime
⁄⁄D L
.
⁄⁄L M
Parse
⁄⁄M R
(
⁄⁄R S
row
⁄⁄S V
.
⁄⁄V W
GetCell
⁄⁄W ^
(
⁄⁄^ _
$num
⁄⁄_ `
)
⁄⁄` a
.
⁄⁄a b
ToString
⁄⁄b j
(
⁄⁄j k
)
⁄⁄k l
==
⁄⁄m o
$str
⁄⁄p r
||
⁄⁄s u
row
⁄⁄v y
.
⁄⁄y z
GetCell⁄⁄z Å
(⁄⁄Å Ç
$num⁄⁄Ç É
)⁄⁄É Ñ
.⁄⁄Ñ Ö
ToString⁄⁄Ö ç
(⁄⁄ç é
)⁄⁄é è
==⁄⁄ê í
null⁄⁄ì ó
?⁄⁄ò ô
$str⁄⁄ö ú
:⁄⁄ù û
row⁄⁄ü ¢
.⁄⁄¢ £
GetCell⁄⁄£ ™
(⁄⁄™ ´
$num⁄⁄´ ¨
)⁄⁄¨ ≠
.⁄⁄≠ Æ
ToString⁄⁄Æ ∂
(⁄⁄∂ ∑
)⁄⁄∑ ∏
,⁄⁄∏ π
culture⁄⁄∫ ¡
)⁄⁄¡ ¬
;⁄⁄¬ √
var
€€, /
Currency
€€0 8
=
€€9 :
row
€€; >
.
€€> ?
GetCell
€€? F
(
€€F G
$num
€€G H
)
€€H I
.
€€I J
ToString
€€J R
(
€€R S
)
€€S T
==
€€U W
$str
€€X Z
||
€€[ ]
row
€€^ a
.
€€a b
GetCell
€€b i
(
€€i j
$num
€€j k
)
€€k l
.
€€l m
ToString
€€m u
(
€€u v
)
€€v w
==
€€x z
null
€€{ 
?€€Ä Å
$str€€Ç Ñ
:€€Ö Ü
row€€á ä
.€€ä ã
GetCell€€ã í
(€€í ì
$num€€ì î
)€€î ï
.€€ï ñ
ToString€€ñ û
(€€û ü
)€€ü †
;€€† °
var
‹‹, /
CheckCurrency
‹‹0 =
=
‹‹> ?
_context
‹‹@ H
.
‹‹H I
TblMasterLookups
‹‹I Y
.
‹‹Y Z
Where
‹‹Z _
(
‹‹_ `
m
‹‹` a
=>
‹‹b d
m
‹‹e f
.
‹‹f g
Name
‹‹g k
==
‹‹l n
Currency
‹‹o w
&&
‹‹x z
m
‹‹{ |
.
‹‹| }
Type‹‹} Å
==‹‹Ç Ñ
$str‹‹Ö è
)‹‹è ê
.‹‹ê ë
Select‹‹ë ó
(‹‹ó ò
m‹‹ò ô
=>‹‹ö ú
m‹‹ù û
.‹‹û ü
Name‹‹ü £
)‹‹£ §
.‹‹§ •
FirstOrDefault‹‹• ≥
(‹‹≥ ¥
)‹‹¥ µ
;‹‹µ ∂
ListTempNod
››, 7
.
››7 8
Cur
››8 ;
=
››< =
CheckCurrency
››> K
;
››K L
ListTempNod
ﬁﬁ, 7
.
ﬁﬁ7 8
IsActive
ﬁﬁ8 @
=
ﬁﬁA B
$num
ﬁﬁC D
;
ﬁﬁD E
ListTempNod
ﬂﬂ, 7
.
ﬂﬂ7 8
	IsDeleted
ﬂﬂ8 A
=
ﬂﬂB C
$num
ﬂﬂD E
;
ﬂﬂE F
ListTempNod
‡‡, 7
.
‡‡7 8
CreatedById
‡‡8 C
=
‡‡D E
int
‡‡F I
.
‡‡I J
Parse
‡‡J O
(
‡‡O P
HttpContext
‡‡P [
.
‡‡[ \
Session
‡‡\ c
.
‡‡c d
	GetString
‡‡d m
(
‡‡m n
SessionConstan
‡‡n |
.
‡‡| }
Session_UserId‡‡} ã
)‡‡ã å
)‡‡å ç
;‡‡ç é
ListTempNod
··, 7
.
··7 8
CreatedTime
··8 C
=
··D E
DateTime
··F N
.
··N O
Now
··O R
;
··R S
_context
‚‚, 4
.
‚‚4 5
Entry
‚‚5 :
(
‚‚: ;
ListTempNod
‚‚; F
)
‚‚F G
.
‚‚G H
State
‚‚H M
=
‚‚N O
EntityState
‚‚P [
.
‚‚[ \
Modified
‚‚\ d
;
‚‚d e
if
‰‰, .
(
‰‰/ 0
ListTempNodDetail
‰‰0 A
==
‰‰B D
null
‰‰E I
)
‰‰I J
{
ÂÂ, -+
TblNoticeOfDisbursementDetail
ÊÊ0 M
ListTempNewDetail
ÊÊN _
=
ÊÊ` a
new
ÊÊb e,
TblNoticeOfDisbursementDetailÊÊf É
(ÊÊÉ Ñ
)ÊÊÑ Ö
;ÊÊÖ Ü
ListTempNewDetail
ÁÁ0 A
.
ÁÁA B
NodId
ÁÁB G
=
ÁÁH I
ListTempNod
ÁÁJ U
.
ÁÁU V
Id
ÁÁV X
;
ÁÁX Y
ListTempNewDetail
ËË0 A
.
ËËA B
CreditorRef
ËËB M
=
ËËN O
row
ËËP S
.
ËËS T
GetCell
ËËT [
(
ËË[ \
$num
ËË\ ]
)
ËË] ^
.
ËË^ _
ToString
ËË_ g
(
ËËg h
)
ËËh i
==
ËËj l
$str
ËËm o
||
ËËp r
row
ËËs v
.
ËËv w
GetCell
ËËw ~
(
ËË~ 
$numËË Ä
)ËËÄ Å
.ËËÅ Ç
ToStringËËÇ ä
(ËËä ã
)ËËã å
==ËËç è
nullËËê î
?ËËï ñ
$strËËó ô
:ËËö õ
rowËËú ü
.ËËü †
GetCellËË† ß
(ËËß ®
$numËË® ©
)ËË© ™
.ËË™ ´
ToStringËË´ ≥
(ËË≥ ¥
)ËË¥ µ
;ËËµ ∂
ListTempNewDetail
ÈÈ0 A
.
ÈÈA B
Amount
ÈÈB H
=
ÈÈI J
decimal
ÈÈK R
.
ÈÈR S
Parse
ÈÈS X
(
ÈÈX Y
row
ÈÈY \
.
ÈÈ\ ]
GetCell
ÈÈ] d
(
ÈÈd e
$num
ÈÈe f
)
ÈÈf g
.
ÈÈg h
ToString
ÈÈh p
(
ÈÈp q
)
ÈÈq r
==
ÈÈs u
$str
ÈÈv x
||
ÈÈy {
row
ÈÈ| 
.ÈÈ Ä
GetCellÈÈÄ á
(ÈÈá à
$numÈÈà â
)ÈÈâ ä
.ÈÈä ã
ToStringÈÈã ì
(ÈÈì î
)ÈÈî ï
==ÈÈñ ò
$strÈÈô ú
?ÈÈù û
$strÈÈü °
:ÈÈ¢ £
rowÈÈ§ ß
.ÈÈß ®
GetCellÈÈ® Ø
(ÈÈØ ∞
$numÈÈ∞ ±
)ÈÈ± ≤
.ÈÈ≤ ≥
ToStringÈÈ≥ ª
(ÈÈª º
)ÈÈº Ω
)ÈÈΩ æ
;ÈÈæ ø
ListTempNewDetail
ÍÍ0 A
.
ÍÍA B
	AmountIdr
ÍÍB K
=
ÍÍL M
decimal
ÍÍN U
.
ÍÍU V
Parse
ÍÍV [
(
ÍÍ[ \
row
ÍÍ\ _
.
ÍÍ_ `
GetCell
ÍÍ` g
(
ÍÍg h
$num
ÍÍh i
)
ÍÍi j
.
ÍÍj k
ToString
ÍÍk s
(
ÍÍs t
)
ÍÍt u
==
ÍÍv x
$str
ÍÍy {
||
ÍÍ| ~
rowÍÍ Ç
.ÍÍÇ É
GetCellÍÍÉ ä
(ÍÍä ã
$numÍÍã å
)ÍÍå ç
.ÍÍç é
ToStringÍÍé ñ
(ÍÍñ ó
)ÍÍó ò
==ÍÍô õ
$strÍÍú ü
?ÍÍ† °
$strÍÍ¢ §
:ÍÍ• ¶
rowÍÍß ™
.ÍÍ™ ´
GetCellÍÍ´ ≤
(ÍÍ≤ ≥
$numÍÍ≥ ¥
)ÍÍ¥ µ
.ÍÍµ ∂
ToStringÍÍ∂ æ
(ÍÍæ ø
)ÍÍø ¿
)ÍÍ¿ ¡
;ÍÍ¡ ¬
ListTempNewDetail
ÎÎ0 A
.
ÎÎA B
IsActive
ÎÎB J
=
ÎÎK L
$num
ÎÎM N
;
ÎÎN O
ListTempNewDetail
ÏÏ0 A
.
ÏÏA B
	IsDeleted
ÏÏB K
=
ÏÏL M
$num
ÏÏN O
;
ÏÏO P
ListTempNewDetail
ÌÌ0 A
.
ÌÌA B
CreatedById
ÌÌB M
=
ÌÌN O
int
ÌÌP S
.
ÌÌS T
Parse
ÌÌT Y
(
ÌÌY Z
HttpContext
ÌÌZ e
.
ÌÌe f
Session
ÌÌf m
.
ÌÌm n
	GetString
ÌÌn w
(
ÌÌw x
SessionConstanÌÌx Ü
.ÌÌÜ á
Session_UserIdÌÌá ï
)ÌÌï ñ
)ÌÌñ ó
;ÌÌó ò
ListTempNewDetail
ÓÓ0 A
.
ÓÓA B
CreatedTime
ÓÓB M
=
ÓÓN O
DateTime
ÓÓP X
.
ÓÓX Y
Now
ÓÓY \
;
ÓÓ\ ]
bool
ÔÔ0 4
CheckCreRef
ÔÔ5 @
=
ÔÔA B
CheckCreditorRef
ÔÔC S
(
ÔÔS T
row
ÔÔT W
.
ÔÔW X
GetCell
ÔÔX _
(
ÔÔ_ `
$num
ÔÔ` a
)
ÔÔa b
.
ÔÔb c
ToString
ÔÔc k
(
ÔÔk l
)
ÔÔl m
==
ÔÔn p
$str
ÔÔq s
||
ÔÔt v
row
ÔÔw z
.
ÔÔz {
GetCellÔÔ{ Ç
(ÔÔÇ É
$numÔÔÉ Ñ
)ÔÔÑ Ö
.ÔÔÖ Ü
ToStringÔÔÜ é
(ÔÔé è
)ÔÔè ê
==ÔÔë ì
nullÔÔî ò
?ÔÔô ö
$strÔÔõ ù
:ÔÔû ü
rowÔÔ† £
.ÔÔ£ §
GetCellÔÔ§ ´
(ÔÔ´ ¨
$numÔÔ¨ ≠
)ÔÔ≠ Æ
.ÔÔÆ Ø
ToStringÔÔØ ∑
(ÔÔ∑ ∏
)ÔÔ∏ π
)ÔÔπ ∫
;ÔÔ∫ ª
if
0 2
(
3 4
CheckCreRef
4 ?
)
? @
{
ÒÒ0 1
_context
ÚÚ4 <
.
ÚÚ< =,
TblNoticeOfDisbursementDetails
ÚÚ= [
.
ÚÚ[ \
Add
ÚÚ\ _
(
ÚÚ_ `
ListTempNewDetail
ÚÚ` q
)
ÚÚq r
;
ÚÚr s
}
ÛÛ0 1
}
ÙÙ, -
else
ıı, 0
{
ˆˆ, -
ListTempNodDetail
˜˜0 A
.
˜˜A B
NodId
˜˜B G
=
˜˜H I
ListTempNod
˜˜J U
.
˜˜U V
Id
˜˜V X
;
˜˜X Y
ListTempNodDetail
¯¯0 A
.
¯¯A B
CreditorRef
¯¯B M
=
¯¯N O
row
¯¯P S
.
¯¯S T
GetCell
¯¯T [
(
¯¯[ \
$num
¯¯\ ]
)
¯¯] ^
.
¯¯^ _
ToString
¯¯_ g
(
¯¯g h
)
¯¯h i
==
¯¯j l
$str
¯¯m o
||
¯¯p r
row
¯¯s v
.
¯¯v w
GetCell
¯¯w ~
(
¯¯~ 
$num¯¯ Ä
)¯¯Ä Å
.¯¯Å Ç
ToString¯¯Ç ä
(¯¯ä ã
)¯¯ã å
==¯¯ç è
null¯¯ê î
?¯¯ï ñ
$str¯¯ó ô
:¯¯ö õ
row¯¯ú ü
.¯¯ü †
GetCell¯¯† ß
(¯¯ß ®
$num¯¯® ©
)¯¯© ™
.¯¯™ ´
ToString¯¯´ ≥
(¯¯≥ ¥
)¯¯¥ µ
;¯¯µ ∂
ListTempNodDetail
˘˘0 A
.
˘˘A B
Amount
˘˘B H
=
˘˘I J
decimal
˘˘K R
.
˘˘R S
Parse
˘˘S X
(
˘˘X Y
row
˘˘Y \
.
˘˘\ ]
GetCell
˘˘] d
(
˘˘d e
$num
˘˘e f
)
˘˘f g
.
˘˘g h
ToString
˘˘h p
(
˘˘p q
)
˘˘q r
==
˘˘s u
$str
˘˘v x
||
˘˘y {
row
˘˘| 
.˘˘ Ä
GetCell˘˘Ä á
(˘˘á à
$num˘˘à â
)˘˘â ä
.˘˘ä ã
ToString˘˘ã ì
(˘˘ì î
)˘˘î ï
==˘˘ñ ò
null˘˘ô ù
?˘˘û ü
$str˘˘† ¢
:˘˘£ §
row˘˘• ®
.˘˘® ©
GetCell˘˘© ∞
(˘˘∞ ±
$num˘˘± ≤
)˘˘≤ ≥
.˘˘≥ ¥
ToString˘˘¥ º
(˘˘º Ω
)˘˘Ω æ
)˘˘æ ø
;˘˘ø ¿
ListTempNodDetail
˙˙0 A
.
˙˙A B
	AmountIdr
˙˙B K
=
˙˙L M
decimal
˙˙N U
.
˙˙U V
Parse
˙˙V [
(
˙˙[ \
row
˙˙\ _
.
˙˙_ `
GetCell
˙˙` g
(
˙˙g h
$num
˙˙h i
)
˙˙i j
.
˙˙j k
ToString
˙˙k s
(
˙˙s t
)
˙˙t u
==
˙˙v x
$str
˙˙y {
||
˙˙| ~
row˙˙ Ç
.˙˙Ç É
GetCell˙˙É ä
(˙˙ä ã
$num˙˙ã å
)˙˙å ç
.˙˙ç é
ToString˙˙é ñ
(˙˙ñ ó
)˙˙ó ò
==˙˙ô õ
null˙˙ú †
?˙˙° ¢
$str˙˙£ •
:˙˙¶ ß
row˙˙® ´
.˙˙´ ¨
GetCell˙˙¨ ≥
(˙˙≥ ¥
$num˙˙¥ µ
)˙˙µ ∂
.˙˙∂ ∑
ToString˙˙∑ ø
(˙˙ø ¿
)˙˙¿ ¡
)˙˙¡ ¬
;˙˙¬ √
ListTempNodDetail
˚˚0 A
.
˚˚A B
IsActive
˚˚B J
=
˚˚K L
$num
˚˚M N
;
˚˚N O
ListTempNodDetail
¸¸0 A
.
¸¸A B
	IsDeleted
¸¸B K
=
¸¸L M
$num
¸¸N O
;
¸¸O P
ListTempNodDetail
˝˝0 A
.
˝˝A B
CreatedById
˝˝B M
=
˝˝N O
int
˝˝P S
.
˝˝S T
Parse
˝˝T Y
(
˝˝Y Z
HttpContext
˝˝Z e
.
˝˝e f
Session
˝˝f m
.
˝˝m n
	GetString
˝˝n w
(
˝˝w x
SessionConstan˝˝x Ü
.˝˝Ü á
Session_UserId˝˝á ï
)˝˝ï ñ
)˝˝ñ ó
;˝˝ó ò
ListTempNodDetail
˛˛0 A
.
˛˛A B
CreatedTime
˛˛B M
=
˛˛N O
DateTime
˛˛P X
.
˛˛X Y
Now
˛˛Y \
;
˛˛\ ]
bool
ˇˇ0 4
CheckCreRef
ˇˇ5 @
=
ˇˇA B
CheckCreditorRef
ˇˇC S
(
ˇˇS T
row
ˇˇT W
.
ˇˇW X
GetCell
ˇˇX _
(
ˇˇ_ `
$num
ˇˇ` a
)
ˇˇa b
.
ˇˇb c
ToString
ˇˇc k
(
ˇˇk l
)
ˇˇl m
==
ˇˇn p
$str
ˇˇq s
||
ˇˇt v
row
ˇˇw z
.
ˇˇz {
GetCellˇˇ{ Ç
(ˇˇÇ É
$numˇˇÉ Ñ
)ˇˇÑ Ö
.ˇˇÖ Ü
ToStringˇˇÜ é
(ˇˇé è
)ˇˇè ê
==ˇˇë ì
nullˇˇî ò
?ˇˇô ö
$strˇˇõ ù
:ˇˇû ü
rowˇˇ† £
.ˇˇ£ §
GetCellˇˇ§ ´
(ˇˇ´ ¨
$numˇˇ¨ ≠
)ˇˇ≠ Æ
.ˇˇÆ Ø
ToStringˇˇØ ∑
(ˇˇ∑ ∏
)ˇˇ∏ π
)ˇˇπ ∫
;ˇˇ∫ ª
if
ÄÄ0 2
(
ÄÄ3 4
CheckCreRef
ÄÄ4 ?
)
ÄÄ? @
{
ÅÅ0 1
_context
ÇÇ4 <
.
ÇÇ< =
Entry
ÇÇ= B
(
ÇÇB C
ListTempNodDetail
ÇÇC T
)
ÇÇT U
.
ÇÇU V
State
ÇÇV [
=
ÇÇ\ ]
EntityState
ÇÇ^ i
.
ÇÇi j
Modified
ÇÇj r
;
ÇÇr s
}
ÉÉ0 1
}
ÑÑ, -
_context
ÜÜ, 4
.
ÜÜ4 5
SaveChanges
ÜÜ5 @
(
ÜÜ@ A
)
ÜÜA B
;
ÜÜB C
}
áá( )
}
àà$ %
}
ââ  !
trx2
ää  $
.
ää$ %
Complete
ää% -
(
ää- .
)
ää. /
;
ää/ 0
}
ãã 
trx
åå 
.
åå  
Complete
åå  (
(
åå( )
)
åå) *
;
åå* +
return
çç "
Content
çç# *
(
çç* +
$str
çç+ -
)
çç- .
;
çç. /
}
éé 
else
èè 
{
êê 
return
ëë "
Content
ëë# *
(
ëë* +
$str
ëë+ :
)
ëë: ;
;
ëë; <
}
íí 
}
ìì 
}
ïï 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
Ex
óó 
)
óó  
{
òò 
return
ôô 
Content
ôô 
(
ôô 
	GetConfig
ôô (
.
ôô( )

AppSetting
ôô) 3
[
ôô3 4
$str
ôô4 M
]
ôôM N
)
ôôN O
;
ôôO P
}
öö 
}
õõ 	
[
ùù 	&
ValidateAntiForgeryToken
ùù	 !
]
ùù! "
[
ûû 	
HttpPost
ûû	 
]
ûû 
public
üü 
ActionResult
üü '
SubmitCreateDetailNodTemp
üü 5
(
üü5 6,
NoticeOfDisbursement_ViewModel
üü6 T
data
üüU Y
,
üüY Z
string
üü[ a
uniq
üüb f
)
üüf g
{
†† 	
if
°° 
(
°° 
!
°° 
lastSession
°° 
.
°° 
Update
°° #
(
°°# $
)
°°$ %
)
°°% &
{
¢¢ 
return
££ 
RedirectToAction
££ '
(
££' (
$str
££( /
,
££/ 0
	GetConfig
££1 :
.
££: ;

AppSetting
££; E
[
££E F
$str
££F n
]
££n o
+
££p q
$str
££r y
,
££y z
new
££{ ~
{££ Ä
a££Å Ç
=££É Ñ
true££Ö â
}££ä ã
)££ã å
;££å ç
}
§§ 
var
¶¶ 
location
¶¶ 
=
¶¶ 
new
¶¶ 
Uri
¶¶ "
(
¶¶" #
$"
¶¶# %
{
¶¶% &
Request
¶¶& -
.
¶¶- .
Scheme
¶¶. 4
}
¶¶4 5
$str
¶¶5 8
{
¶¶8 9
Request
¶¶9 @
.
¶¶@ A
Host
¶¶A E
}
¶¶E F
{
¶¶F G
Request
¶¶G N
.
¶¶N O
Path
¶¶O S
}
¶¶S T
"
¶¶T U
)
¶¶U V
;
¶¶V W
string
ßß 
Path
ßß 
=
ßß 
location
ßß "
.
ßß" #
AbsolutePath
ßß# /
.
ßß/ 0
Replace
ßß0 7
(
ßß7 8
this
ßß8 <
.
ßß< =
ControllerContext
ßß= N
.
ßßN O
	RouteData
ßßO X
.
ßßX Y
Values
ßßY _
[
ßß_ `
$str
ßß` h
]
ßßh i
.
ßßi j
ToString
ßßj r
(
ßßr s
)
ßßs t
,
ßßt u
$str
ßßv }
)
ßß} ~
;
ßß~ 
if
©© 
(
©© 
!
©© 
accessSecurity
©© 
.
©©  
IsGetAccess
©©  +
(
©©+ ,
$str
©©, 0
+
©©1 2
Path
©©3 7
)
©©7 8
)
©©8 9
{
™™ 
return
´´ 
RedirectToAction
´´ '
(
´´' (
$str
´´( 3
,
´´3 4
$str
´´5 <
)
´´< =
;
´´= >
}
¨¨ 
try
ÆÆ 
{
ØØ 
using
∂∂ 
(
∂∂ 
TransactionScope
∂∂ '
trx
∂∂( +
=
∂∂, -
new
∂∂. 1
TransactionScope
∂∂2 B
(
∂∂B C
)
∂∂C D
)
∂∂D E
{
∑∑ /
!TblNoticeOfDisbursementDetailTemp
∏∏ 5
model
∏∏6 ;
=
∏∏< =
new
∏∏> A/
!TblNoticeOfDisbursementDetailTemp
∏∏B c
(
∏∏c d
)
∏∏d e
;
∏∏e f
model
ππ 
.
ππ 
CreditorRef
ππ %
=
ππ& '
data
ππ( ,
.
ππ, -
CreditorRef
ππ- 8
;
ππ8 9
model
∫∫ 
.
∫∫ 
Amount
∫∫  
=
∫∫! "
decimal
∫∫# *
.
∫∫* +
Parse
∫∫+ 0
(
∫∫0 1
data
∫∫1 5
.
∫∫5 6
Amount
∫∫6 <
.
∫∫< =
Replace
∫∫= D
(
∫∫D E
$str
∫∫E H
,
∫∫H I
$str
∫∫J L
)
∫∫L M
)
∫∫M N
;
∫∫N O
model
ªª 
.
ªª 
	AmountIdr
ªª #
=
ªª$ %
decimal
ªª& -
.
ªª- .
Parse
ªª. 3
(
ªª3 4
data
ªª4 8
.
ªª8 9
	AmountIDR
ªª9 B
.
ªªB C
Replace
ªªC J
(
ªªJ K
$str
ªªK N
,
ªªN O
$str
ªªP R
)
ªªR S
)
ªªS T
;
ªªT U
model
ºº 
.
ºº 
IsActive
ºº "
=
ºº# $
$num
ºº% &
;
ºº& '
model
ΩΩ 
.
ΩΩ 
	IsDeleted
ΩΩ #
=
ΩΩ$ %
$num
ΩΩ& '
;
ΩΩ' (
model
ææ 
.
ææ 
RandomString
ææ &
=
ææ' (
uniq
ææ) -
;
ææ- .
_context
¿¿ 
.
¿¿ 0
"TblNoticeOfDisbursementDetailTemps
¿¿ ?
.
¿¿? @
Add
¿¿@ C
(
¿¿C D
model
¿¿D I
)
¿¿I J
;
¿¿J K
_context
¡¡ 
.
¡¡ 
SaveChanges
¡¡ (
(
¡¡( )
)
¡¡) *
;
¡¡* +
trx
ƒƒ 
.
ƒƒ 
Complete
ƒƒ  
(
ƒƒ  !
)
ƒƒ! "
;
ƒƒ" #
}
≈≈ 
return
«« 
Content
«« 
(
«« 
$str
«« !
)
««! "
;
««" #
}
   
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÃÃ 
return
ÕÕ 
Content
ÕÕ 
(
ÕÕ 
	GetConfig
ÕÕ (
.
ÕÕ( )

AppSetting
ÕÕ) 3
[
ÕÕ3 4
$str
ÕÕ4 O
]
ÕÕO P
)
ÕÕP Q
;
ÕÕQ R
}
ŒŒ 
}
œœ 	
[
—— 	&
ValidateAntiForgeryToken
——	 !
]
——! "
[
““ 	
HttpPost
““	 
]
““ 
public
”” 
ActionResult
”” #
SubmitCreateDetailNod
”” 1
(
””1 2,
NoticeOfDisbursement_ViewModel
””2 P
data
””Q U
,
””U V
string
””W ]
uniq
””^ b
)
””b c
{
‘‘ 	
if
’’ 
(
’’ 
!
’’ 
lastSession
’’ 
.
’’ 
Update
’’ #
(
’’# $
)
’’$ %
)
’’% &
{
÷÷ 
return
◊◊ 
RedirectToAction
◊◊ '
(
◊◊' (
$str
◊◊( /
,
◊◊/ 0
	GetConfig
◊◊1 :
.
◊◊: ;

AppSetting
◊◊; E
[
◊◊E F
$str
◊◊F n
]
◊◊n o
+
◊◊p q
$str
◊◊r y
,
◊◊y z
new
◊◊{ ~
{◊◊ Ä
a◊◊Å Ç
=◊◊É Ñ
true◊◊Ö â
}◊◊ä ã
)◊◊ã å
;◊◊å ç
}
ÿÿ 
var
⁄⁄ 
location
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
Uri
⁄⁄ "
(
⁄⁄" #
$"
⁄⁄# %
{
⁄⁄% &
Request
⁄⁄& -
.
⁄⁄- .
Scheme
⁄⁄. 4
}
⁄⁄4 5
$str
⁄⁄5 8
{
⁄⁄8 9
Request
⁄⁄9 @
.
⁄⁄@ A
Host
⁄⁄A E
}
⁄⁄E F
{
⁄⁄F G
Request
⁄⁄G N
.
⁄⁄N O
Path
⁄⁄O S
}
⁄⁄S T
"
⁄⁄T U
)
⁄⁄U V
;
⁄⁄V W
string
€€ 
Path
€€ 
=
€€ 
location
€€ "
.
€€" #
AbsolutePath
€€# /
.
€€/ 0
Replace
€€0 7
(
€€7 8
this
€€8 <
.
€€< =
ControllerContext
€€= N
.
€€N O
	RouteData
€€O X
.
€€X Y
Values
€€Y _
[
€€_ `
$str
€€` h
]
€€h i
.
€€i j
ToString
€€j r
(
€€r s
)
€€s t
,
€€t u
$str
€€v }
)
€€} ~
;
€€~ 
if
›› 
(
›› 
!
›› 
accessSecurity
›› 
.
››  
IsGetAccess
››  +
(
››+ ,
$str
››, 0
+
››1 2
Path
››3 7
)
››7 8
)
››8 9
{
ﬁﬁ 
return
ﬂﬂ 
RedirectToAction
ﬂﬂ '
(
ﬂﬂ' (
$str
ﬂﬂ( 3
,
ﬂﬂ3 4
$str
ﬂﬂ5 <
)
ﬂﬂ< =
;
ﬂﬂ= >
}
‡‡ 
try
‚‚ 
{
„„ %
TblNoticeOfDisbursement
ÍÍ '

dataAssign
ÍÍ( 2
=
ÍÍ3 4
_context
ÍÍ5 =
.
ÍÍ= >&
TblNoticeOfDisbursements
ÍÍ> V
.
ÍÍV W
Where
ÍÍW \
(
ÍÍ\ ]
m
ÍÍ] ^
=>
ÍÍ_ a
m
ÍÍb c
.
ÍÍc d
Id
ÍÍd f
==
ÍÍg i
int
ÍÍj m
.
ÍÍm n
Parse
ÍÍn s
(
ÍÍs t
uniq
ÍÍt x
)
ÍÍx y
&&
ÍÍz |
m
ÍÍ} ~
.
ÍÍ~ 
	IsDeletedÍÍ à
==ÍÍâ ã
$numÍÍå ç
)ÍÍç é
.ÍÍé è
FirstOrDefaultÍÍè ù
(ÍÍù û
)ÍÍû ü
;ÍÍü †
if
ÏÏ 
(
ÏÏ 

dataAssign
ÏÏ 
.
ÏÏ 
IdNodFromApi
ÏÏ +
!=
ÏÏ, .
null
ÏÏ/ 3
)
ÏÏ3 4
{
ÌÌ 
var
ÓÓ "
jsonParseReturnCheck
ÓÓ ,
=
ÓÓ- .
JsonConvert
ÓÓ/ :
.
ÓÓ: ;
DeserializeObject
ÓÓ; L
<
ÓÓL M!
ResultStatusDataInt
ÓÓM `
<
ÓÓ` a!
ResultStatusDataNod
ÓÓa t
>
ÓÓt u
>
ÓÓu v
(
ÓÓv w
$str
ÓÓw y
)
ÓÓy z
;
ÓÓz {
var
ÔÔ 
urlCheck
ÔÔ  
=
ÔÔ! "
	GetConfig
ÔÔ# ,
.
ÔÔ, -

AppSetting
ÔÔ- 7
[
ÔÔ7 8
$str
ÔÔ8 I
]
ÔÔI J
+
ÔÔK L
	GetConfig
ÔÔM V
.
ÔÔV W

AppSetting
ÔÔW a
[
ÔÔa b
$str
ÔÔb {
]
ÔÔ{ |
+
ÔÔ} ~

dataAssignÔÔ â
.ÔÔâ ä
IdNodFromApiÔÔä ñ
;ÔÔñ ó
(
 
bool
 
resultApiCheck
 (
,
( )
string
* 0
resultCheck
1 <
)
< =
=
> ?
RequestToAPI
@ L
.
L M!
GetJsonStringWebApi
M `
(
` a
urlCheck
a i
,
i j
null
k o
)
o p
;
p q
if
ÒÒ 
(
ÒÒ 
resultApiCheck
ÒÒ &
&&
ÒÒ' )
!
ÒÒ* +
string
ÒÒ+ 1
.
ÒÒ1 2
IsNullOrEmpty
ÒÒ2 ?
(
ÒÒ? @
resultCheck
ÒÒ@ K
)
ÒÒK L
)
ÒÒL M
{
ÚÚ "
jsonParseReturnCheck
ÛÛ ,
=
ÛÛ- .
JsonConvert
ÛÛ/ :
.
ÛÛ: ;
DeserializeObject
ÛÛ; L
<
ÛÛL M!
ResultStatusDataInt
ÛÛM `
<
ÛÛ` a!
ResultStatusDataNod
ÛÛa t
>
ÛÛt u
>
ÛÛu v
(
ÛÛv w
resultCheckÛÛw Ç
)ÛÛÇ É
;ÛÛÉ Ñ
if
ÙÙ 
(
ÙÙ "
jsonParseReturnCheck
ÙÙ 0
.
ÙÙ0 1

StatusCode
ÙÙ1 ;
==
ÙÙ< >
$num
ÙÙ? B
||
ÙÙC E"
jsonParseReturnCheck
ÙÙF Z
.
ÙÙZ [

StatusCode
ÙÙ[ e
==
ÙÙf h
$num
ÙÙi l
)
ÙÙl m
{
ıı 
if
ˆˆ 
(
ˆˆ  "
jsonParseReturnCheck
ˆˆ  4
.
ˆˆ4 5
Data
ˆˆ5 9
.
ˆˆ9 :
Status
ˆˆ: @
==
ˆˆA C
$str
ˆˆD P
)
ˆˆP Q
{
˜˜ 
using
¯¯  %
(
¯¯& '
TransactionScope
¯¯' 7
trx
¯¯8 ;
=
¯¯< =
new
¯¯> A
TransactionScope
¯¯B R
(
¯¯R S
)
¯¯S T
)
¯¯T U
{
˘˘  !+
TblNoticeOfDisbursementDetail
˙˙$ A
model
˙˙B G
=
˙˙H I
new
˙˙J M+
TblNoticeOfDisbursementDetail
˙˙N k
(
˙˙k l
)
˙˙l m
;
˙˙m n
model
˚˚$ )
.
˚˚) *
NodId
˚˚* /
=
˚˚0 1
int
˚˚2 5
.
˚˚5 6
Parse
˚˚6 ;
(
˚˚; <
uniq
˚˚< @
)
˚˚@ A
;
˚˚A B
model
¸¸$ )
.
¸¸) *
CreditorRef
¸¸* 5
=
¸¸6 7
data
¸¸8 <
.
¸¸< =
CreditorRef
¸¸= H
;
¸¸H I
model
˝˝$ )
.
˝˝) *
Amount
˝˝* 0
=
˝˝1 2
decimal
˝˝3 :
.
˝˝: ;
Parse
˝˝; @
(
˝˝@ A
data
˝˝A E
.
˝˝E F
Amount
˝˝F L
.
˝˝L M
Replace
˝˝M T
(
˝˝T U
$str
˝˝U X
,
˝˝X Y
$str
˝˝Z \
)
˝˝\ ]
)
˝˝] ^
;
˝˝^ _
model
˛˛$ )
.
˛˛) *
	AmountIdr
˛˛* 3
=
˛˛4 5
decimal
˛˛6 =
.
˛˛= >
Parse
˛˛> C
(
˛˛C D
data
˛˛D H
.
˛˛H I
	AmountIDR
˛˛I R
.
˛˛R S
Replace
˛˛S Z
(
˛˛Z [
$str
˛˛[ ^
,
˛˛^ _
$str
˛˛` b
)
˛˛b c
)
˛˛c d
;
˛˛d e
model
ˇˇ$ )
.
ˇˇ) *
CreatedTime
ˇˇ* 5
=
ˇˇ6 7
DateTime
ˇˇ8 @
.
ˇˇ@ A
Now
ˇˇA D
;
ˇˇD E
model
ÄÄ$ )
.
ÄÄ) *
CreatedById
ÄÄ* 5
=
ÄÄ6 7
int
ÄÄ8 ;
.
ÄÄ; <
Parse
ÄÄ< A
(
ÄÄA B
HttpContext
ÄÄB M
.
ÄÄM N
Session
ÄÄN U
.
ÄÄU V
	GetString
ÄÄV _
(
ÄÄ_ `
SessionConstan
ÄÄ` n
.
ÄÄn o
Session_UserId
ÄÄo }
)
ÄÄ} ~
)
ÄÄ~ 
;ÄÄ Ä
model
ÅÅ$ )
.
ÅÅ) *
IsActive
ÅÅ* 2
=
ÅÅ3 4
$num
ÅÅ5 6
;
ÅÅ6 7
model
ÇÇ$ )
.
ÇÇ) *
	IsDeleted
ÇÇ* 3
=
ÇÇ4 5
$num
ÇÇ6 7
;
ÇÇ7 8
_context
ÉÉ$ ,
.
ÉÉ, -,
TblNoticeOfDisbursementDetails
ÉÉ- K
.
ÉÉK L
Add
ÉÉL O
(
ÉÉO P
model
ÉÉP U
)
ÉÉU V
;
ÉÉV W
_context
ÑÑ$ ,
.
ÑÑ, -
SaveChanges
ÑÑ- 8
(
ÑÑ8 9
)
ÑÑ9 :
;
ÑÑ: ;
trx
ÖÖ$ '
.
ÖÖ' (
Complete
ÖÖ( 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ  !
}
áá 
else
àà  
{
ââ 

dataAssign
ää  *
.
ää* +
Status
ää+ 1
=
ää2 3"
jsonParseReturnCheck
ää4 H
.
ääH I
Data
ääI M
.
ääM N
Status
ääN T
;
ääT U

dataAssign
ãã  *
.
ãã* +
LastSentDate
ãã+ 7
=
ãã8 9
DateTime
ãã: B
.
ããB C
Now
ããC F
;
ããF G
_context
åå  (
.
åå( )
Entry
åå) .
(
åå. /

dataAssign
åå/ 9
)
åå9 :
.
åå: ;
State
åå; @
=
ååA B
EntityState
ååC N
.
ååN O
Modified
ååO W
;
ååW X
_context
çç  (
.
çç( )
SaveChanges
çç) 4
(
çç4 5
)
çç5 6
;
çç6 7
return
èè  &
Content
èè' .
(
èè. /
$str
èè/ D
)
èèD E
;
èèE F
}
êê 
}
ëë 
else
íí 
{
íí 
return
ìì "
Content
ìì# *
(
ìì* +
	GetConfig
ìì+ 4
.
ìì4 5

AppSetting
ìì5 ?
[
ìì? @
$str
ìì@ [
]
ìì[ \
)
ìì\ ]
;
ìì] ^
}
îî 
}
ïï 
}
ññ 
else
óó 
{
óó 
using
òò 
(
òò 
TransactionScope
òò +
trx
òò, /
=
òò0 1
new
òò2 5
TransactionScope
òò6 F
(
òòF G
)
òòG H
)
òòH I
{
ôô +
TblNoticeOfDisbursementDetail
öö 5
model
öö6 ;
=
öö< =
new
öö> A+
TblNoticeOfDisbursementDetail
ööB _
(
öö_ `
)
öö` a
;
ööa b
model
õõ 
.
õõ 
NodId
õõ #
=
õõ$ %
int
õõ& )
.
õõ) *
Parse
õõ* /
(
õõ/ 0
uniq
õõ0 4
)
õõ4 5
;
õõ5 6
model
úú 
.
úú 
CreditorRefId
úú +
=
úú, -
data
úú. 2
.
úú2 3
CreditorRefId
úú3 @
;
úú@ A
model
ùù 
.
ùù 
CreditorRef
ùù )
=
ùù* +
data
ùù, 0
.
ùù0 1
CreditorRef
ùù1 <
;
ùù< =
model
ûû 
.
ûû 
Amount
ûû $
=
ûû% &
decimal
ûû' .
.
ûû. /
Parse
ûû/ 4
(
ûû4 5
data
ûû5 9
.
ûû9 :
Amount
ûû: @
.
ûû@ A
Replace
ûûA H
(
ûûH I
$str
ûûI L
,
ûûL M
$str
ûûN P
)
ûûP Q
)
ûûQ R
;
ûûR S
model
üü 
.
üü 
	AmountIdr
üü '
=
üü( )
decimal
üü* 1
.
üü1 2
Parse
üü2 7
(
üü7 8
data
üü8 <
.
üü< =
	AmountIDR
üü= F
.
üüF G
Replace
üüG N
(
üüN O
$str
üüO R
,
üüR S
$str
üüT V
)
üüV W
)
üüW X
;
üüX Y
model
†† 
.
†† 
CreatedTime
†† )
=
††* +
DateTime
††, 4
.
††4 5
Now
††5 8
;
††8 9
model
°° 
.
°° 
CreatedById
°° )
=
°°* +
int
°°, /
.
°°/ 0
Parse
°°0 5
(
°°5 6
HttpContext
°°6 A
.
°°A B
Session
°°B I
.
°°I J
	GetString
°°J S
(
°°S T
SessionConstan
°°T b
.
°°b c
Session_UserId
°°c q
)
°°q r
)
°°r s
;
°°s t
model
¢¢ 
.
¢¢ 
IsActive
¢¢ &
=
¢¢' (
$num
¢¢) *
;
¢¢* +
model
££ 
.
££ 
	IsDeleted
££ '
=
££( )
$num
££* +
;
££+ ,
_context
§§  
.
§§  !,
TblNoticeOfDisbursementDetails
§§! ?
.
§§? @
Add
§§@ C
(
§§C D
model
§§D I
)
§§I J
;
§§J K
_context
••  
.
••  !
SaveChanges
••! ,
(
••, -
)
••- .
;
••. /
trx
¶¶ 
.
¶¶ 
Complete
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
ßß 
}
®® 
return
©© 
Content
©© 
(
©© 
$str
©© !
)
©©! "
;
©©" #
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
¨¨ 
return
≠≠ 
Content
≠≠ 
(
≠≠ 
	GetConfig
≠≠ (
.
≠≠( )

AppSetting
≠≠) 3
[
≠≠3 4
$str
≠≠4 O
]
≠≠O P
)
≠≠P Q
;
≠≠Q R
}
ÆÆ 
}
ØØ 	
[
±± 	
HttpPost
±±	 
]
±± 
public
≤≤ 
ActionResult
≤≤ %
SubmitCreateFileNodTemp
≤≤ 3
(
≤≤3 46
(NoticeOfDisbursementFileUpload_ViewModel
≤≤4 \
data
≤≤] a
)
≤≤a b
{
≥≥ 	
if
¥¥ 
(
¥¥ 
!
¥¥ 
lastSession
¥¥ 
.
¥¥ 
Update
¥¥ #
(
¥¥# $
)
¥¥$ %
)
¥¥% &
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( /
,
∂∂/ 0
$str
∂∂1 8
,
∂∂8 9
new
∂∂: =
{
∂∂> ?
a
∂∂@ A
=
∂∂B C
true
∂∂D H
}
∂∂I J
)
∂∂J K
;
∂∂K L
}
∑∑ 
var
ππ 
location
ππ 
=
ππ 
new
ππ 
Uri
ππ "
(
ππ" #
$"
ππ# %
{
ππ% &
Request
ππ& -
.
ππ- .
Scheme
ππ. 4
}
ππ4 5
$str
ππ5 8
{
ππ8 9
Request
ππ9 @
.
ππ@ A
Host
ππA E
}
ππE F
{
ππF G
Request
ππG N
.
ππN O
Path
ππO S
}
ππS T
"
ππT U
)
ππU V
;
ππV W
string
∫∫ 
Patha
∫∫ 
=
∫∫ 
location
∫∫ #
.
∫∫# $
AbsolutePath
∫∫$ 0
.
∫∫0 1
Replace
∫∫1 8
(
∫∫8 9
this
∫∫9 =
.
∫∫= >
ControllerContext
∫∫> O
.
∫∫O P
	RouteData
∫∫P Y
.
∫∫Y Z
Values
∫∫Z `
[
∫∫` a
$str
∫∫a i
]
∫∫i j
.
∫∫j k
ToString
∫∫k s
(
∫∫s t
)
∫∫t u
,
∫∫u v
$str
∫∫w ~
)
∫∫~ 
;∫∫ Ä
if
ºº 
(
ºº 
!
ºº 
accessSecurity
ºº 
.
ºº  
IsGetAccess
ºº  +
(
ºº+ ,
$str
ºº, 0
+
ºº1 2
Patha
ºº3 8
)
ºº8 9
)
ºº9 :
{
ΩΩ 
return
ææ 
RedirectToAction
ææ '
(
ææ' (
$str
ææ( 3
,
ææ3 4
$str
ææ5 <
)
ææ< =
;
ææ= >
}
øø 
try
¡¡ 
{
¬¬ 
var
ƒƒ 
FilePath
ƒƒ 
=
ƒƒ 
_context
ƒƒ '
.
ƒƒ' ('
TblMasterSystemParameters
ƒƒ( A
.
ƒƒA B
Where
ƒƒB G
(
ƒƒG H
m
ƒƒH I
=>
ƒƒI K
m
ƒƒK L
.
ƒƒL M
Key
ƒƒM P
==
ƒƒQ S
$str
ƒƒT c
)
ƒƒc d
.
ƒƒd e
Select
ƒƒe k
(
ƒƒk l
m
ƒƒl m
=>
ƒƒm o
m
ƒƒo p
.
ƒƒp q
Value
ƒƒq v
)
ƒƒv w
.
ƒƒw x
FirstOrDefaultƒƒx Ü
(ƒƒÜ á
)ƒƒá à
;ƒƒà â
if
≈≈ 
(
≈≈ 
data
≈≈ 
.
≈≈ 
File
≈≈ 
==
≈≈  
null
≈≈! %
)
≈≈% &
{
∆∆ 
return
«« 
Content
«« "
(
««" #
$str
««# B
)
««B C
;
««C D
}
»» 
string
   
FileNameNoExt
   $
=
  % &
Path
  ' +
.
  + ,)
GetFileNameWithoutExtension
  , G
(
  G H
data
  H L
.
  L M
File
  M Q
.
  Q R
FileName
  R Z
)
  Z [
;
  [ \
string
ÀÀ 
Ext
ÀÀ 
=
ÀÀ 
Path
ÀÀ !
.
ÀÀ! "
GetExtension
ÀÀ" .
(
ÀÀ. /
data
ÀÀ/ 3
.
ÀÀ3 4
File
ÀÀ4 8
.
ÀÀ8 9
FileName
ÀÀ9 A
)
ÀÀA B
;
ÀÀB C
string
ÃÃ 
FullName
ÃÃ 
=
ÃÃ  !
FileNameNoExt
ÃÃ" /
+
ÃÃ0 1
$str
ÃÃ2 5
+
ÃÃ6 7
DateTime
ÃÃ8 @
.
ÃÃ@ A
Now
ÃÃA D
.
ÃÃD E
ToString
ÃÃE M
(
ÃÃM N
$str
ÃÃN ^
)
ÃÃ^ _
+
ÃÃ` a
Ext
ÃÃb e
;
ÃÃe f
string
ÕÕ 
FullPath
ÕÕ 
=
ÕÕ  !
FilePath
ÕÕ" *
+
ÕÕ+ ,
FullName
ÕÕ- 5
;
ÕÕ5 6
string
œœ 
[
œœ 
]
œœ 
allowedExtensions
œœ *
=
œœ+ ,
{
œœ- .
$str
œœ/ 6
,
œœ6 7
$str
œœ8 >
,
œœ> ?
$str
œœ@ F
,
œœF G
$str
œœH O
,
œœO P
$str
œœQ W
}
œœX Y
;
œœY Z
if
–– 
(
–– 
!
–– 
allowedExtensions
–– &
.
––& '
Contains
––' /
(
––/ 0
Ext
––0 3
)
––3 4
)
––4 5
{
—— 
return
““ 
Content
““ "
(
““" #
$str
““# ;
)
““; <
;
““< =
}
”” 
using
’’ 
(
’’ 
TransactionScope
’’ '
trx
’’( +
=
’’, -
new
’’. 1
TransactionScope
’’2 B
(
’’B C
)
’’C D
)
’’D E
{
÷÷ 
try
◊◊ 
{
ÿÿ "
TblFileUploadNodTemp
ŸŸ ,
model
ŸŸ- 2
=
ŸŸ3 4
new
ŸŸ5 8"
TblFileUploadNodTemp
ŸŸ9 M
(
ŸŸM N
)
ŸŸN O
;
ŸŸO P
model
⁄⁄ 
.
⁄⁄ 
FileName
⁄⁄ &
=
⁄⁄' (
FullName
⁄⁄) 1
;
⁄⁄1 2
model
€€ 
.
€€ 
FileSize
€€ &
=
€€' (
Convert
€€) 0
.
€€0 1
ToInt32
€€1 8
(
€€8 9
data
€€9 =
.
€€= >
File
€€> B
.
€€B C
Length
€€C I
)
€€I J
;
€€J K
model
‹‹ 
.
‹‹ 
FilePath
‹‹ &
=
‹‹' (
FullPath
‹‹) 1
;
‹‹1 2
model
›› 
.
›› 
FileExt
›› %
=
››& '
Ext
››( +
;
››+ ,
model
ﬁﬁ 
.
ﬁﬁ 

UploadTime
ﬁﬁ (
=
ﬁﬁ) *
DateTime
ﬁﬁ+ 3
.
ﬁﬁ3 4
Now
ﬁﬁ4 7
;
ﬁﬁ7 8
model
ﬂﬂ 
.
ﬂﬂ 

UploadById
ﬂﬂ (
=
ﬂﬂ) *
int
ﬂﬂ+ .
.
ﬂﬂ. /
Parse
ﬂﬂ/ 4
(
ﬂﬂ4 5
HttpContext
ﬂﬂ5 @
.
ﬂﬂ@ A
Session
ﬂﬂA H
.
ﬂﬂH I
	GetString
ﬂﬂI R
(
ﬂﬂR S
SessionConstan
ﬂﬂS a
.
ﬂﬂa b
Session_UserId
ﬂﬂb p
)
ﬂﬂp q
)
ﬂﬂq r
;
ﬂﬂr s
model
‡‡ 
.
‡‡ 
IsActive
‡‡ &
=
‡‡' (
$num
‡‡) *
;
‡‡* +
model
·· 
.
·· 
	IsDeleted
·· '
=
··( )
$num
··* +
;
··+ ,
model
‚‚ 
.
‚‚ 
RandomString
‚‚ *
=
‚‚+ ,
data
‚‚- 1
.
‚‚1 2
uniq
‚‚2 6
;
‚‚6 7
_context
„„  
.
„„  !#
TblFileUploadNodTemps
„„! 6
.
„„6 7
Add
„„7 :
(
„„: ;
model
„„; @
)
„„@ A
;
„„A B
_context
‰‰  
.
‰‰  !
SaveChanges
‰‰! ,
(
‰‰, -
)
‰‰- .
;
‰‰. /
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
	Directory
ÁÁ &
.
ÁÁ& '
Exists
ÁÁ' -
(
ÁÁ- .
FilePath
ÁÁ. 6
)
ÁÁ6 7
)
ÁÁ7 8
{
ËË 
	Directory
ÈÈ %
.
ÈÈ% &
CreateDirectory
ÈÈ& 5
(
ÈÈ5 6
FilePath
ÈÈ6 >
)
ÈÈ> ?
;
ÈÈ? @
}
ÍÍ 
using
ÏÏ 
(
ÏÏ 

FileStream
ÏÏ )

fileStream
ÏÏ* 4
=
ÏÏ5 6
new
ÏÏ7 :

FileStream
ÏÏ; E
(
ÏÏE F
FullPath
ÏÏF N
,
ÏÏN O
FileMode
ÏÏP X
.
ÏÏX Y
Create
ÏÏY _
)
ÏÏ_ `
)
ÏÏ` a
{
ÌÌ 
data
ÔÔ  
.
ÔÔ  !
File
ÔÔ! %
.
ÔÔ% &
CopyTo
ÔÔ& ,
(
ÔÔ, -

fileStream
ÔÔ- 7
)
ÔÔ7 8
;
ÔÔ8 9
}
 
trx
ÚÚ 
.
ÚÚ 
Complete
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ $
ex
ÙÙ% '
)
ÙÙ' (
{
ıı 
throw
ˆˆ 
;
ˆˆ 
}
˜˜ 
}
¯¯ 
return
˙˙ 
Content
˙˙ 
(
˙˙ 
$str
˙˙ !
)
˙˙! "
;
˙˙" #
}
˚˚ 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
˝˝ 
return
˛˛ 
Content
˛˛ 
(
˛˛ 
	GetConfig
˛˛ (
.
˛˛( )

AppSetting
˛˛) 3
[
˛˛3 4
$str
˛˛4 O
]
˛˛O P
)
˛˛P Q
;
˛˛Q R
}
ˇˇ 
}
ÄÄ 	
[
ÇÇ 	
HttpPost
ÇÇ	 
]
ÇÇ 
public
ÉÉ 
ActionResult
ÉÉ !
SubmitCreateFileNod
ÉÉ /
(
ÉÉ/ 0,
NoticeOfDisbursement_ViewModel
ÉÉ0 N
data
ÉÉO S
,
ÉÉS T
string
ÉÉU [
uniq
ÉÉ\ `
)
ÉÉ` a
{
ÑÑ 	
if
ÖÖ 
(
ÖÖ 
!
ÖÖ 
lastSession
ÖÖ 
.
ÖÖ 
Update
ÖÖ #
(
ÖÖ# $
)
ÖÖ$ %
)
ÖÖ% &
{
ÜÜ 
return
áá 
RedirectToAction
áá '
(
áá' (
$str
áá( /
,
áá/ 0
	GetConfig
áá1 :
.
áá: ;

AppSetting
áá; E
[
ááE F
$str
ááF n
]
áán o
+
ááp q
$str
áár y
,
ááy z
new
áá{ ~
{áá Ä
aááÅ Ç
=ááÉ Ñ
trueááÖ â
}ááä ã
)ááã å
;ááå ç
}
àà 
var
ää 
location
ää 
=
ää 
new
ää 
Uri
ää "
(
ää" #
$"
ää# %
{
ää% &
Request
ää& -
.
ää- .
Scheme
ää. 4
}
ää4 5
$str
ää5 8
{
ää8 9
Request
ää9 @
.
ää@ A
Host
ääA E
}
ääE F
{
ääF G
Request
ääG N
.
ääN O
Path
ääO S
}
ääS T
"
ääT U
)
ääU V
;
ääV W
string
ãã 
Patha
ãã 
=
ãã 
location
ãã #
.
ãã# $
AbsolutePath
ãã$ 0
.
ãã0 1
Replace
ãã1 8
(
ãã8 9
this
ãã9 =
.
ãã= >
ControllerContext
ãã> O
.
ããO P
	RouteData
ããP Y
.
ããY Z
Values
ããZ `
[
ãã` a
$str
ããa i
]
ããi j
.
ããj k
ToString
ããk s
(
ããs t
)
ããt u
,
ããu v
$str
ããw ~
)
ãã~ 
;ãã Ä
if
çç 
(
çç 
!
çç 
accessSecurity
çç 
.
çç  
IsGetAccess
çç  +
(
çç+ ,
$str
çç, 0
+
çç1 2
Patha
çç3 8
)
çç8 9
)
çç9 :
{
éé 
return
èè 
RedirectToAction
èè '
(
èè' (
$str
èè( 3
,
èè3 4
$str
èè5 <
)
èè< =
;
èè= >
}
êê 
try
íí 
{
ìì %
TblNoticeOfDisbursement
îî '

dataAssign
îî( 2
=
îî3 4
_context
îî5 =
.
îî= >&
TblNoticeOfDisbursements
îî> V
.
îîV W
Where
îîW \
(
îî\ ]
m
îî] ^
=>
îî_ a
m
îîb c
.
îîc d
Id
îîd f
==
îîg i
int
îîj m
.
îîm n
Parse
îîn s
(
îîs t
uniq
îît x
)
îîx y
&&
îîz |
m
îî} ~
.
îî~ 
	IsDeletedîî à
==îîâ ã
$numîîå ç
)îîç é
.îîé è
FirstOrDefaultîîè ù
(îîù û
)îîû ü
;îîü †
if
ññ 
(
ññ 

dataAssign
ññ 
.
ññ 
IdNodFromApi
ññ +
!=
ññ, .
null
ññ/ 3
)
ññ3 4
{
óó 
var
òò "
jsonParseReturnCheck
òò ,
=
òò- .
JsonConvert
òò/ :
.
òò: ;
DeserializeObject
òò; L
<
òòL M!
ResultStatusDataInt
òòM `
<
òò` a!
ResultStatusDataNod
òòa t
>
òòt u
>
òòu v
(
òòv w
$str
òòw y
)
òòy z
;
òòz {
var
ôô 
urlCheck
ôô  
=
ôô! "
	GetConfig
ôô# ,
.
ôô, -

AppSetting
ôô- 7
[
ôô7 8
$str
ôô8 I
]
ôôI J
+
ôôK L
	GetConfig
ôôM V
.
ôôV W

AppSetting
ôôW a
[
ôôa b
$str
ôôb {
]
ôô{ |
+
ôô} ~

dataAssignôô â
.ôôâ ä
IdNodFromApiôôä ñ
;ôôñ ó
(
öö 
bool
öö 
resultApiCheck
öö (
,
öö( )
string
öö* 0
resultCheck
öö1 <
)
öö< =
=
öö> ?
RequestToAPI
öö@ L
.
ööL M!
GetJsonStringWebApi
ööM `
(
öö` a
urlCheck
ööa i
,
ööi j
null
öök o
)
ööo p
;
ööp q
if
õõ 
(
õõ 
resultApiCheck
õõ &
&&
õõ' )
!
õõ* +
string
õõ+ 1
.
õõ1 2
IsNullOrEmpty
õõ2 ?
(
õõ? @
resultCheck
õõ@ K
)
õõK L
)
õõL M
{
úú "
jsonParseReturnCheck
ùù ,
=
ùù- .
JsonConvert
ùù/ :
.
ùù: ;
DeserializeObject
ùù; L
<
ùùL M!
ResultStatusDataInt
ùùM `
<
ùù` a!
ResultStatusDataNod
ùùa t
>
ùùt u
>
ùùu v
(
ùùv w
resultCheckùùw Ç
)ùùÇ É
;ùùÉ Ñ
if
ûû 
(
ûû "
jsonParseReturnCheck
ûû 0
.
ûû0 1

StatusCode
ûû1 ;
==
ûû< >
$num
ûû? B
||
ûûC E"
jsonParseReturnCheck
ûûF Z
.
ûûZ [

StatusCode
ûû[ e
==
ûûf h
$num
ûûi l
)
ûûl m
{
üü 
if
†† 
(
††  "
jsonParseReturnCheck
††  4
.
††4 5
Data
††5 9
.
††9 :
Status
††: @
==
††A C
$str
††D P
)
††P Q
{
°° 
var
¢¢  #
FilePath
¢¢$ ,
=
¢¢- .
_context
¢¢/ 7
.
¢¢7 8'
TblMasterSystemParameters
¢¢8 Q
.
¢¢Q R
Where
¢¢R W
(
¢¢W X
m
¢¢X Y
=>
¢¢Z \
m
¢¢] ^
.
¢¢^ _
Key
¢¢_ b
==
¢¢c e
$str
¢¢f u
)
¢¢u v
.
¢¢v w
Select
¢¢w }
(
¢¢} ~
m
¢¢~ 
=>¢¢Ä Ç
m¢¢É Ñ
.¢¢Ñ Ö
Value¢¢Ö ä
)¢¢ä ã
.¢¢ã å
FirstOrDefault¢¢å ö
(¢¢ö õ
)¢¢õ ú
;¢¢ú ù
if
££  "
(
££# $
data
££$ (
.
££( )
File
££) -
==
££. 0
null
££1 5
)
££5 6
{
§§  !
return
••$ *
Content
••+ 2
(
••2 3
$str
••3 R
)
••R S
;
••S T
}
¶¶  !
string
®®  &
FileNameNoExt
®®' 4
=
®®5 6
Path
®®7 ;
.
®®; <)
GetFileNameWithoutExtension
®®< W
(
®®W X
data
®®X \
.
®®\ ]
File
®®] a
.
®®a b
FileName
®®b j
)
®®j k
;
®®k l
string
©©  &
Ext
©©' *
=
©©+ ,
Path
©©- 1
.
©©1 2
GetExtension
©©2 >
(
©©> ?
data
©©? C
.
©©C D
File
©©D H
.
©©H I
FileName
©©I Q
)
©©Q R
;
©©R S
string
™™  &
FullName
™™' /
=
™™0 1
FileNameNoExt
™™2 ?
+
™™@ A
$str
™™B E
+
™™F G
DateTime
™™H P
.
™™P Q
Now
™™Q T
.
™™T U
ToString
™™U ]
(
™™] ^
$str
™™^ n
)
™™n o
+
™™p q
Ext
™™r u
;
™™u v
string
´´  &
FullPath
´´' /
=
´´0 1
FilePath
´´2 :
+
´´; <
FullName
´´= E
;
´´E F
string
≠≠  &
[
≠≠& '
]
≠≠' (
allowedExtensions
≠≠) :
=
≠≠; <
{
≠≠= >
$str
≠≠? F
,
≠≠F G
$str
≠≠H N
,
≠≠N O
$str
≠≠P V
,
≠≠V W
$str
≠≠X _
,
≠≠_ `
$str
≠≠a g
}
≠≠h i
;
≠≠i j
if
ÆÆ  "
(
ÆÆ# $
!
ÆÆ$ %
allowedExtensions
ÆÆ% 6
.
ÆÆ6 7
Contains
ÆÆ7 ?
(
ÆÆ? @
Ext
ÆÆ@ C
)
ÆÆC D
)
ÆÆD E
{
ØØ  !
return
∞∞$ *
Content
∞∞+ 2
(
∞∞2 3
$str
∞∞3 K
)
∞∞K L
;
∞∞L M
}
±±  !
using
≥≥  %
(
≥≥& '
TransactionScope
≥≥' 7
trx
≥≥8 ;
=
≥≥< =
new
≥≥> A
TransactionScope
≥≥B R
(
≥≥R S
)
≥≥S T
)
≥≥T U
{
¥¥  !
try
µµ$ '
{
∂∂$ %
TblFileUploadNod
∑∑( 8
model
∑∑9 >
=
∑∑? @
new
∑∑A D
TblFileUploadNod
∑∑E U
(
∑∑U V
)
∑∑V W
;
∑∑W X
model
∏∏( -
.
∏∏- .
IdNod
∏∏. 3
=
∏∏4 5
int
∏∏6 9
.
∏∏9 :
Parse
∏∏: ?
(
∏∏? @
uniq
∏∏@ D
)
∏∏D E
;
∏∏E F
model
ππ( -
.
ππ- .
FileName
ππ. 6
=
ππ7 8
FullName
ππ9 A
;
ππA B
model
∫∫( -
.
∫∫- .
FileSize
∫∫. 6
=
∫∫7 8
Convert
∫∫9 @
.
∫∫@ A
ToInt32
∫∫A H
(
∫∫H I
data
∫∫I M
.
∫∫M N
File
∫∫N R
.
∫∫R S
Length
∫∫S Y
)
∫∫Y Z
;
∫∫Z [
model
ªª( -
.
ªª- .
FilePath
ªª. 6
=
ªª7 8
FullPath
ªª9 A
;
ªªA B
model
ºº( -
.
ºº- .
FileExt
ºº. 5
=
ºº6 7
Ext
ºº8 ;
;
ºº; <
model
ΩΩ( -
.
ΩΩ- .

UploadTime
ΩΩ. 8
=
ΩΩ9 :
DateTime
ΩΩ; C
.
ΩΩC D
Now
ΩΩD G
;
ΩΩG H
model
ææ( -
.
ææ- .

UploadById
ææ. 8
=
ææ9 :
int
ææ; >
.
ææ> ?
Parse
ææ? D
(
ææD E
HttpContext
ææE P
.
ææP Q
Session
ææQ X
.
ææX Y
	GetString
ææY b
(
ææb c
SessionConstan
ææc q
.
ææq r
Session_UserIdæær Ä
)ææÄ Å
)ææÅ Ç
;ææÇ É
model
øø( -
.
øø- .
IsActive
øø. 6
=
øø7 8
$num
øø9 :
;
øø: ;
model
¿¿( -
.
¿¿- .
	IsDeleted
¿¿. 7
=
¿¿8 9
$num
¿¿: ;
;
¿¿; <
_context
¡¡( 0
.
¡¡0 1
TblFileUploadNods
¡¡1 B
.
¡¡B C
Add
¡¡C F
(
¡¡F G
model
¡¡G L
)
¡¡L M
;
¡¡M N
_context
¬¬( 0
.
¬¬0 1
SaveChanges
¬¬1 <
(
¬¬< =
)
¬¬= >
;
¬¬> ?
if
≈≈( *
(
≈≈+ ,
!
≈≈, -
	Directory
≈≈- 6
.
≈≈6 7
Exists
≈≈7 =
(
≈≈= >
FilePath
≈≈> F
)
≈≈F G
)
≈≈G H
{
∆∆( )
	Directory
««, 5
.
««5 6
CreateDirectory
««6 E
(
««E F
FilePath
««F N
)
««N O
;
««O P
}
»»( )
using
  ( -
(
  . /

FileStream
  / 9

fileStream
  : D
=
  E F
new
  G J

FileStream
  K U
(
  U V
FullPath
  V ^
,
  ^ _
FileMode
  ` h
.
  h i
Create
  i o
)
  o p
)
  p q
{
ÀÀ( )
data
ÕÕ, 0
.
ÕÕ0 1
File
ÕÕ1 5
.
ÕÕ5 6
CopyTo
ÕÕ6 <
(
ÕÕ< =

fileStream
ÕÕ= G
)
ÕÕG H
;
ÕÕH I
}
ŒŒ( )
trx
––( +
.
––+ ,
Complete
––, 4
(
––4 5
)
––5 6
;
––6 7
}
——$ %
catch
““$ )
(
““* +
	Exception
““+ 4
ex
““5 7
)
““7 8
{
””$ %
throw
‘‘( -
;
‘‘- .
}
’’$ %
}
÷÷  !
}
◊◊ 
else
ÿÿ  
{
ŸŸ 
var
⁄⁄  #
FilePath
⁄⁄$ ,
=
⁄⁄- .
_context
⁄⁄/ 7
.
⁄⁄7 8'
TblMasterSystemParameters
⁄⁄8 Q
.
⁄⁄Q R
Where
⁄⁄R W
(
⁄⁄W X
m
⁄⁄X Y
=>
⁄⁄Z \
m
⁄⁄] ^
.
⁄⁄^ _
Key
⁄⁄_ b
==
⁄⁄c e
$str
⁄⁄f u
)
⁄⁄u v
.
⁄⁄v w
Select
⁄⁄w }
(
⁄⁄} ~
m
⁄⁄~ 
=>⁄⁄Ä Ç
m⁄⁄É Ñ
.⁄⁄Ñ Ö
Value⁄⁄Ö ä
)⁄⁄ä ã
.⁄⁄ã å
FirstOrDefault⁄⁄å ö
(⁄⁄ö õ
)⁄⁄õ ú
;⁄⁄ú ù
if
€€  "
(
€€# $
data
€€$ (
.
€€( )
File
€€) -
==
€€. 0
null
€€1 5
)
€€5 6
{
‹‹  !
return
››$ *
Content
››+ 2
(
››2 3
$str
››3 R
)
››R S
;
››S T
}
ﬁﬁ  !
string
‡‡  &
FileNameNoExt
‡‡' 4
=
‡‡5 6
Path
‡‡7 ;
.
‡‡; <)
GetFileNameWithoutExtension
‡‡< W
(
‡‡W X
data
‡‡X \
.
‡‡\ ]
File
‡‡] a
.
‡‡a b
FileName
‡‡b j
)
‡‡j k
;
‡‡k l
string
··  &
Ext
··' *
=
··+ ,
Path
··- 1
.
··1 2
GetExtension
··2 >
(
··> ?
data
··? C
.
··C D
File
··D H
.
··H I
FileName
··I Q
)
··Q R
;
··R S
string
‚‚  &
FullName
‚‚' /
=
‚‚0 1
FileNameNoExt
‚‚2 ?
+
‚‚@ A
$str
‚‚B E
+
‚‚F G
DateTime
‚‚H P
.
‚‚P Q
Now
‚‚Q T
.
‚‚T U
ToString
‚‚U ]
(
‚‚] ^
$str
‚‚^ n
)
‚‚n o
+
‚‚p q
Ext
‚‚r u
;
‚‚u v
string
„„  &
FullPath
„„' /
=
„„0 1
FilePath
„„2 :
+
„„; <
FullName
„„= E
;
„„E F
string
ÂÂ  &
[
ÂÂ& '
]
ÂÂ' (
allowedExtensions
ÂÂ) :
=
ÂÂ; <
{
ÂÂ= >
$str
ÂÂ? F
,
ÂÂF G
$str
ÂÂH N
,
ÂÂN O
$str
ÂÂP V
,
ÂÂV W
$str
ÂÂX _
,
ÂÂ_ `
$str
ÂÂa g
}
ÂÂh i
;
ÂÂi j
if
ÊÊ  "
(
ÊÊ# $
!
ÊÊ$ %
allowedExtensions
ÊÊ% 6
.
ÊÊ6 7
Contains
ÊÊ7 ?
(
ÊÊ? @
Ext
ÊÊ@ C
)
ÊÊC D
)
ÊÊD E
{
ÁÁ  !
return
ËË$ *
Content
ËË+ 2
(
ËË2 3
$str
ËË3 K
)
ËËK L
;
ËËL M
}
ÈÈ  !
if
ÎÎ  "
(
ÎÎ# $
!
ÎÎ$ %
	Directory
ÎÎ% .
.
ÎÎ. /
Exists
ÎÎ/ 5
(
ÎÎ5 6
FilePath
ÎÎ6 >
)
ÎÎ> ?
)
ÎÎ? @
{
ÏÏ  !
	Directory
ÌÌ$ -
.
ÌÌ- .
CreateDirectory
ÌÌ. =
(
ÌÌ= >
FilePath
ÌÌ> F
)
ÌÌF G
;
ÌÌG H
}
ÓÓ  !
using
  %
(
& '

FileStream
' 1

fileStream
2 <
=
= >
new
? B

FileStream
C M
(
M N
FullPath
N V
,
V W
FileMode
X `
.
` a
Create
a g
)
g h
)
h i
{
ÒÒ  !
data
ÛÛ$ (
.
ÛÛ( )
File
ÛÛ) -
.
ÛÛ- .
CopyTo
ÛÛ. 4
(
ÛÛ4 5

fileStream
ÛÛ5 ?
)
ÛÛ? @
;
ÛÛ@ A
}
ÙÙ  !
byte
ˆˆ  $
[
ˆˆ$ %
]
ˆˆ% &
	fileBytes
ˆˆ' 0
=
ˆˆ1 2
System
ˆˆ3 9
.
ˆˆ9 :
IO
ˆˆ: <
.
ˆˆ< =
File
ˆˆ= A
.
ˆˆA B
ReadAllBytes
ˆˆB N
(
ˆˆN O
FullPath
ˆˆO W
)
ˆˆW X
;
ˆˆX Y
string
˘˘  &
base64String
˘˘' 3
=
˘˘4 5
Convert
˘˘6 =
.
˘˘= >
ToBase64String
˘˘> L
(
˘˘L M
	fileBytes
˘˘M V
)
˘˘V W
;
˘˘W X
var
¸¸  #)
jsonParseReturnUploadBase64
¸¸$ ?
=
¸¸@ A
JsonConvert
¸¸B M
.
¸¸M N
DeserializeObject
¸¸N _
<
¸¸_ `!
ResultStatusDataInt
¸¸` s
<
¸¸s t"
ResultStatusDataNod¸¸t á
>¸¸á à
>¸¸à â
(¸¸â ä
$str¸¸ä å
)¸¸å ç
;¸¸ç é
var
˝˝  #
urlUploadBase64
˝˝$ 3
=
˝˝4 5
	GetConfig
˝˝6 ?
.
˝˝? @

AppSetting
˝˝@ J
[
˝˝J K
$str
˝˝K \
]
˝˝\ ]
+
˝˝^ _
	GetConfig
˝˝` i
.
˝˝i j

AppSetting
˝˝j t
[
˝˝t u
$str˝˝u è
]˝˝è ê
+˝˝ë í

dataAssign˝˝ì ù
.˝˝ù û
IdNodFromApi˝˝û ™
;˝˝™ ´
(
˛˛  !
bool
˛˛! %#
resultApiUploadBase64
˛˛& ;
,
˛˛; <
string
˛˛= C 
resultUploadBase64
˛˛D V
)
˛˛V W
=
˛˛X Y
RequestToAPI
˛˛Z f
.
˛˛f g!
PostRequestToWebApi
˛˛g z
(
˛˛z {
urlUploadBase64˛˛{ ä
,˛˛ä ã
new˛˛å è
{
ˇˇ  !
FileName
Ä	Ä	$ ,
=
Ä	Ä	- .
FullName
Ä	Ä	/ 7
,
Ä	Ä	7 8
FileContent
Å	Å	$ /
=
Å	Å	0 1
base64String
Å	Å	2 >
,
Å	Å	> ?
}
Ç	Ç	  !
,
Ç	Ç	! "
null
Ç	Ç	# '
)
Ç	Ç	' (
;
Ç	Ç	( )
if
É	É	  "
(
É	É	# $#
resultApiUploadBase64
É	É	$ 9
&&
É	É	: <
!
É	É	= >
string
É	É	> D
.
É	É	D E
IsNullOrEmpty
É	É	E R
(
É	É	R S 
resultUploadBase64
É	É	S e
)
É	É	e f
)
É	É	f g
{
Ñ	Ñ	  !)
jsonParseReturnUploadBase64
Ö	Ö	$ ?
=
Ö	Ö	@ A
JsonConvert
Ö	Ö	B M
.
Ö	Ö	M N
DeserializeObject
Ö	Ö	N _
<
Ö	Ö	_ `!
ResultStatusDataInt
Ö	Ö	` s
<
Ö	Ö	s t"
ResultStatusDataNodÖ	Ö	t á
>Ö	Ö	á à
>Ö	Ö	à â
(Ö	Ö	â ä"
resultUploadBase64Ö	Ö	ä ú
)Ö	Ö	ú ù
;Ö	Ö	ù û
if
Ü	Ü	$ &
(
Ü	Ü	' ()
jsonParseReturnUploadBase64
Ü	Ü	( C
.
Ü	Ü	C D

StatusCode
Ü	Ü	D N
==
Ü	Ü	O Q
$num
Ü	Ü	R U
||
Ü	Ü	V X)
jsonParseReturnUploadBase64
Ü	Ü	Y t
.
Ü	Ü	t u

StatusCode
Ü	Ü	u 
==Ü	Ü	Ä Ç
$numÜ	Ü	É Ü
)Ü	Ü	Ü á
{
á	á	$ %
using
à	à	( -
(
à	à	. /
TransactionScope
à	à	/ ?
trx
à	à	@ C
=
à	à	D E
new
à	à	F I
TransactionScope
à	à	J Z
(
à	à	Z [
)
à	à	[ \
)
à	à	\ ]
{
â	â	( )
try
ä	ä	, /
{
ã	ã	, -
TblFileUploadNod
å	å	0 @
model
å	å	A F
=
å	å	G H
new
å	å	I L
TblFileUploadNod
å	å	M ]
(
å	å	] ^
)
å	å	^ _
;
å	å	_ `
model
ç	ç	0 5
.
ç	ç	5 6
IdNod
ç	ç	6 ;
=
ç	ç	< =
int
ç	ç	> A
.
ç	ç	A B
Parse
ç	ç	B G
(
ç	ç	G H
uniq
ç	ç	H L
)
ç	ç	L M
;
ç	ç	M N
model
é	é	0 5
.
é	é	5 6
IdFileFromApi
é	é	6 C
=
é	é	D E)
jsonParseReturnUploadBase64
é	é	F a
.
é	é	a b
Data
é	é	b f
.
é	é	f g
Key
é	é	g j
;
é	é	j k
model
è	è	0 5
.
è	è	5 6
FileName
è	è	6 >
=
è	è	? @
FullName
è	è	A I
;
è	è	I J
model
ê	ê	0 5
.
ê	ê	5 6
FileSize
ê	ê	6 >
=
ê	ê	? @
Convert
ê	ê	A H
.
ê	ê	H I
ToInt32
ê	ê	I P
(
ê	ê	P Q
data
ê	ê	Q U
.
ê	ê	U V
File
ê	ê	V Z
.
ê	ê	Z [
Length
ê	ê	[ a
)
ê	ê	a b
;
ê	ê	b c
model
ë	ë	0 5
.
ë	ë	5 6
FilePath
ë	ë	6 >
=
ë	ë	? @
FullPath
ë	ë	A I
;
ë	ë	I J
model
í	í	0 5
.
í	í	5 6
FileExt
í	í	6 =
=
í	í	> ?
Ext
í	í	@ C
;
í	í	C D
model
ì	ì	0 5
.
ì	ì	5 6

UploadTime
ì	ì	6 @
=
ì	ì	A B
DateTime
ì	ì	C K
.
ì	ì	K L
Now
ì	ì	L O
;
ì	ì	O P
model
î	î	0 5
.
î	î	5 6

UploadById
î	î	6 @
=
î	î	A B
int
î	î	C F
.
î	î	F G
Parse
î	î	G L
(
î	î	L M
HttpContext
î	î	M X
.
î	î	X Y
Session
î	î	Y `
.
î	î	` a
	GetString
î	î	a j
(
î	î	j k
SessionConstan
î	î	k y
.
î	î	y z
Session_UserIdî	î	z à
)î	î	à â
)î	î	â ä
;î	î	ä ã
model
ï	ï	0 5
.
ï	ï	5 6
IsActive
ï	ï	6 >
=
ï	ï	? @
$num
ï	ï	A B
;
ï	ï	B C
model
ñ	ñ	0 5
.
ñ	ñ	5 6
	IsDeleted
ñ	ñ	6 ?
=
ñ	ñ	@ A
$num
ñ	ñ	B C
;
ñ	ñ	C D
_context
ó	ó	0 8
.
ó	ó	8 9
TblFileUploadNods
ó	ó	9 J
.
ó	ó	J K
Add
ó	ó	K N
(
ó	ó	N O
model
ó	ó	O T
)
ó	ó	T U
;
ó	ó	U V
_context
ò	ò	0 8
.
ò	ò	8 9
SaveChanges
ò	ò	9 D
(
ò	ò	D E
)
ò	ò	E F
;
ò	ò	F G
trx
ö	ö	0 3
.
ö	ö	3 4
Complete
ö	ö	4 <
(
ö	ö	< =
)
ö	ö	= >
;
ö	ö	> ?
}
õ	õ	, -
catch
ú	ú	, 1
(
ú	ú	2 3
	Exception
ú	ú	3 <
ex
ú	ú	= ?
)
ú	ú	? @
{
ù	ù	, -
throw
û	û	0 5
;
û	û	5 6
}
ü	ü	, -
}
†	†	( )
}
°	°	$ %
}
¢	¢	  !
}
“	“	 
}
”	”	 
else
‘	‘	 
{
’	’	 
return
÷	÷	 "
Content
÷	÷	# *
(
÷	÷	* +
	GetConfig
÷	÷	+ 4
.
÷	÷	4 5

AppSetting
÷	÷	5 ?
[
÷	÷	? @
$str
÷	÷	@ [
]
÷	÷	[ \
)
÷	÷	\ ]
;
÷	÷	] ^
}
◊	◊	 
}
ÿ	ÿ	 
}
Ÿ	Ÿ	 
else
⁄	⁄	 
{
€	€	 
var
‹	‹	 
FilePath
‹	‹	  
=
‹	‹	! "
_context
‹	‹	# +
.
‹	‹	+ ,'
TblMasterSystemParameters
‹	‹	, E
.
‹	‹	E F
Where
‹	‹	F K
(
‹	‹	K L
m
‹	‹	L M
=>
‹	‹	N P
m
‹	‹	Q R
.
‹	‹	R S
Key
‹	‹	S V
==
‹	‹	W Y
$str
‹	‹	Z i
)
‹	‹	i j
.
‹	‹	j k
Select
‹	‹	k q
(
‹	‹	q r
m
‹	‹	r s
=>
‹	‹	t v
m
‹	‹	w x
.
‹	‹	x y
Value
‹	‹	y ~
)
‹	‹	~ 
.‹	‹	 Ä
FirstOrDefault‹	‹	Ä é
(‹	‹	é è
)‹	‹	è ê
;‹	‹	ê ë
if
›	›	 
(
›	›	 
data
›	›	 
.
›	›	 
File
›	›	 !
==
›	›	" $
null
›	›	% )
)
›	›	) *
{
ﬁ	ﬁ	 
return
ﬂ	ﬂ	 
Content
ﬂ	ﬂ	 &
(
ﬂ	ﬂ	& '
$str
ﬂ	ﬂ	' F
)
ﬂ	ﬂ	F G
;
ﬂ	ﬂ	G H
}
‡	‡	 
string
‚	‚	 
FileNameNoExt
‚	‚	 (
=
‚	‚	) *
Path
‚	‚	+ /
.
‚	‚	/ 0)
GetFileNameWithoutExtension
‚	‚	0 K
(
‚	‚	K L
data
‚	‚	L P
.
‚	‚	P Q
File
‚	‚	Q U
.
‚	‚	U V
FileName
‚	‚	V ^
)
‚	‚	^ _
;
‚	‚	_ `
string
„	„	 
Ext
„	„	 
=
„	„	  
Path
„	„	! %
.
„	„	% &
GetExtension
„	„	& 2
(
„	„	2 3
data
„	„	3 7
.
„	„	7 8
File
„	„	8 <
.
„	„	< =
FileName
„	„	= E
)
„	„	E F
;
„	„	F G
string
‰	‰	 
FullName
‰	‰	 #
=
‰	‰	$ %
FileNameNoExt
‰	‰	& 3
+
‰	‰	4 5
$str
‰	‰	6 9
+
‰	‰	: ;
DateTime
‰	‰	< D
.
‰	‰	D E
Now
‰	‰	E H
.
‰	‰	H I
ToString
‰	‰	I Q
(
‰	‰	Q R
$str
‰	‰	R b
)
‰	‰	b c
+
‰	‰	d e
Ext
‰	‰	f i
;
‰	‰	i j
string
Â	Â	 
FullPath
Â	Â	 #
=
Â	Â	$ %
FilePath
Â	Â	& .
+
Â	Â	/ 0
FullName
Â	Â	1 9
;
Â	Â	9 :
using
Á	Á	 
(
Á	Á	 
TransactionScope
Á	Á	 +
trx
Á	Á	, /
=
Á	Á	0 1
new
Á	Á	2 5
TransactionScope
Á	Á	6 F
(
Á	Á	F G
)
Á	Á	G H
)
Á	Á	H I
{
Ë	Ë	 
try
È	È	 
{
Í	Í	 
TblFileUploadNod
Î	Î	 ,
model
Î	Î	- 2
=
Î	Î	3 4
new
Î	Î	5 8
TblFileUploadNod
Î	Î	9 I
(
Î	Î	I J
)
Î	Î	J K
;
Î	Î	K L
model
Ï	Ï	 !
.
Ï	Ï	! "
IdNod
Ï	Ï	" '
=
Ï	Ï	( )
int
Ï	Ï	* -
.
Ï	Ï	- .
Parse
Ï	Ï	. 3
(
Ï	Ï	3 4
uniq
Ï	Ï	4 8
)
Ï	Ï	8 9
;
Ï	Ï	9 :
model
Ì	Ì	 !
.
Ì	Ì	! "
FileName
Ì	Ì	" *
=
Ì	Ì	+ ,
FullName
Ì	Ì	- 5
;
Ì	Ì	5 6
model
Ó	Ó	 !
.
Ó	Ó	! "
FileSize
Ó	Ó	" *
=
Ó	Ó	+ ,
Convert
Ó	Ó	- 4
.
Ó	Ó	4 5
ToInt32
Ó	Ó	5 <
(
Ó	Ó	< =
data
Ó	Ó	= A
.
Ó	Ó	A B
File
Ó	Ó	B F
.
Ó	Ó	F G
Length
Ó	Ó	G M
)
Ó	Ó	M N
;
Ó	Ó	N O
model
Ô	Ô	 !
.
Ô	Ô	! "
FilePath
Ô	Ô	" *
=
Ô	Ô	+ ,
FullPath
Ô	Ô	- 5
;
Ô	Ô	5 6
model
		 !
.
		! "
FileExt
		" )
=
		* +
Ext
		, /
;
		/ 0
model
Ò	Ò	 !
.
Ò	Ò	! "

UploadTime
Ò	Ò	" ,
=
Ò	Ò	- .
DateTime
Ò	Ò	/ 7
.
Ò	Ò	7 8
Now
Ò	Ò	8 ;
;
Ò	Ò	; <
model
Ú	Ú	 !
.
Ú	Ú	! "

UploadById
Ú	Ú	" ,
=
Ú	Ú	- .
int
Ú	Ú	/ 2
.
Ú	Ú	2 3
Parse
Ú	Ú	3 8
(
Ú	Ú	8 9
HttpContext
Ú	Ú	9 D
.
Ú	Ú	D E
Session
Ú	Ú	E L
.
Ú	Ú	L M
	GetString
Ú	Ú	M V
(
Ú	Ú	V W
SessionConstan
Ú	Ú	W e
.
Ú	Ú	e f
Session_UserId
Ú	Ú	f t
)
Ú	Ú	t u
)
Ú	Ú	u v
;
Ú	Ú	v w
model
Û	Û	 !
.
Û	Û	! "
IsActive
Û	Û	" *
=
Û	Û	+ ,
$num
Û	Û	- .
;
Û	Û	. /
model
Ù	Ù	 !
.
Ù	Ù	! "
	IsDeleted
Ù	Ù	" +
=
Ù	Ù	, -
$num
Ù	Ù	. /
;
Ù	Ù	/ 0
_context
ı	ı	 $
.
ı	ı	$ %
TblFileUploadNods
ı	ı	% 6
.
ı	ı	6 7
Add
ı	ı	7 :
(
ı	ı	: ;
model
ı	ı	; @
)
ı	ı	@ A
;
ı	ı	A B
_context
ˆ	ˆ	 $
.
ˆ	ˆ	$ %
SaveChanges
ˆ	ˆ	% 0
(
ˆ	ˆ	0 1
)
ˆ	ˆ	1 2
;
ˆ	ˆ	2 3
if
˘	˘	 
(
˘	˘	  
!
˘	˘	  !
	Directory
˘	˘	! *
.
˘	˘	* +
Exists
˘	˘	+ 1
(
˘	˘	1 2
FilePath
˘	˘	2 :
)
˘	˘	: ;
)
˘	˘	; <
{
˙	˙	 
	Directory
˚	˚	  )
.
˚	˚	) *
CreateDirectory
˚	˚	* 9
(
˚	˚	9 :
FilePath
˚	˚	: B
)
˚	˚	B C
;
˚	˚	C D
}
¸	¸	 
using
˛	˛	 !
(
˛	˛	" #

FileStream
˛	˛	# -

fileStream
˛	˛	. 8
=
˛	˛	9 :
new
˛	˛	; >

FileStream
˛	˛	? I
(
˛	˛	I J
FullPath
˛	˛	J R
,
˛	˛	R S
FileMode
˛	˛	T \
.
˛	˛	\ ]
Create
˛	˛	] c
)
˛	˛	c d
)
˛	˛	d e
{
ˇ	ˇ	 
data
Å
Å
  $
.
Å
Å
$ %
File
Å
Å
% )
.
Å
Å
) *
CopyTo
Å
Å
* 0
(
Å
Å
0 1

fileStream
Å
Å
1 ;
)
Å
Å
; <
;
Å
Å
< =
}
Ç
Ç
 
trx
Ñ
Ñ
 
.
Ñ
Ñ
  
Complete
Ñ
Ñ
  (
(
Ñ
Ñ
( )
)
Ñ
Ñ
) *
;
Ñ
Ñ
* +
}
Ö
Ö
 
catch
Ü
Ü
 
(
Ü
Ü
 
	Exception
Ü
Ü
 (
ex
Ü
Ü
) +
)
Ü
Ü
+ ,
{
á
á
 
throw
à
à
 !
;
à
à
! "
}
â
â
 
}
ä
ä
 
}
ã
ã
 
return
å
å
 
Content
å
å
 
(
å
å
 
$str
å
å
 !
)
å
å
! "
;
å
å
" #
}
é
é
 
catch
è
è
 
(
è
è
 
	Exception
è
è
 
ex
è
è
 
)
è
è
  
{
ê
ê
 
return
ë
ë
 
Content
ë
ë
 
(
ë
ë
 
	GetConfig
ë
ë
 (
.
ë
ë
( )

AppSetting
ë
ë
) 3
[
ë
ë
3 4
$str
ë
ë
4 O
]
ë
ë
O P
)
ë
ë
P Q
;
ë
ë
Q R
}
í
í
 
}
ì
ì
 	
public
ó
ó
 
ActionResult
ó
ó
 
Edit
ó
ó
  
(
ó
ó
  !
int
ó
ó
! $
id
ó
ó
% '
)
ó
ó
' (
{
ò
ò
 	
if
ô
ô
 
(
ô
ô
 
!
ô
ô
 
lastSession
ô
ô
 
.
ô
ô
 
Update
ô
ô
 #
(
ô
ô
# $
)
ô
ô
$ %
)
ô
ô
% &
{
ö
ö
 
return
õ
õ
 
RedirectToAction
õ
õ
 '
(
õ
õ
' (
$str
õ
õ
( /
,
õ
õ
/ 0
	GetConfig
õ
õ
1 :
.
õ
õ
: ;

AppSetting
õ
õ
; E
[
õ
õ
E F
$str
õ
õ
F n
]
õ
õ
n o
+
õ
õ
p q
$str
õ
õ
r y
,
õ
õ
y z
new
õ
õ
{ ~
{õ
õ
 Ä
aõ
õ
Å Ç
=õ
õ
É Ñ
trueõ
õ
Ö â
}õ
õ
ä ã
)õ
õ
ã å
;õ
õ
å ç
}
ú
ú
 
var
ù
ù
 
location
ù
ù
 
=
ù
ù
 
new
ù
ù
 
Uri
ù
ù
 "
(
ù
ù
" #
$"
ù
ù
# %
{
ù
ù
% &
Request
ù
ù
& -
.
ù
ù
- .
Scheme
ù
ù
. 4
}
ù
ù
4 5
$str
ù
ù
5 8
{
ù
ù
8 9
Request
ù
ù
9 @
.
ù
ù
@ A
Host
ù
ù
A E
}
ù
ù
E F
{
ù
ù
F G
Request
ù
ù
G N
.
ù
ù
N O
Path
ù
ù
O S
}
ù
ù
S T
"
ù
ù
T U
)
ù
ù
U V
;
ù
ù
V W
string
û
û
 
Path
û
û
 
=
û
û
 
location
û
û
 "
.
û
û
" #
AbsolutePath
û
û
# /
.
û
û
/ 0
Replace
û
û
0 7
(
û
û
7 8
this
û
û
8 <
.
û
û
< =
ControllerContext
û
û
= N
.
û
û
N O
	RouteData
û
û
O X
.
û
û
X Y
Values
û
û
Y _
[
û
û
_ `
$str
û
û
` h
]
û
û
h i
.
û
û
i j
ToString
û
û
j r
(
û
û
r s
)
û
û
s t
,
û
û
t u
$str
û
û
v }
)
û
û
} ~
;
û
û
~ 
if
ü
ü
 
(
ü
ü
 
!
ü
ü
 
accessSecurity
ü
ü
 
.
ü
ü
  
IsGetAccess
ü
ü
  +
(
ü
ü
+ ,
$str
ü
ü
, 0
+
ü
ü
1 2
Path
ü
ü
3 7
)
ü
ü
7 8
)
ü
ü
8 9
{
†
†
 
return
°
°
 
RedirectToAction
°
°
 '
(
°
°
' (
$str
°
°
( 3
,
°
°
3 4
$str
°
°
5 <
)
°
°
< =
;
°
°
= >
}
¢
¢
 
try
•
•
 
{
¶
¶
 %
TblNoticeOfDisbursement
ß
ß
 '
nod
ß
ß
( +
=
ß
ß
, -
_context
ß
ß
. 6
.
ß
ß
6 7&
TblNoticeOfDisbursements
ß
ß
7 O
.
ß
ß
O P
Where
ß
ß
P U
(
ß
ß
U V
m
ß
ß
V W
=>
ß
ß
X Z
m
ß
ß
[ \
.
ß
ß
\ ]
Id
ß
ß
] _
==
ß
ß
` b
id
ß
ß
c e
)
ß
ß
e f
.
ß
ß
f g
FirstOrDefault
ß
ß
g u
(
ß
ß
u v
)
ß
ß
v w
;
ß
ß
w x
var
©
©
 
data
©
©
 
=
©
©
 
new
©
©
 ,
NoticeOfDisbursement_ViewModel
©
©
 =
{
™
™
 
Id
´
´
 
=
´
´
 
nod
´
´
 
.
´
´
 
Id
´
´
 
,
´
´
  
NodNo
¨
¨
 
=
¨
¨
 
nod
¨
¨
 
.
¨
¨
  
NodNo
¨
¨
  %
,
¨
¨
% &
Cur
≠
≠
 
=
≠
≠
 
_context
≠
≠
 "
.
≠
≠
" #
TblMasterLookups
≠
≠
# 3
.
≠
≠
3 4
Where
≠
≠
4 9
(
≠
≠
9 :
m
≠
≠
: ;
=>
≠
≠
< >
m
≠
≠
? @
.
≠
≠
@ A
Name
≠
≠
A E
==
≠
≠
F H
nod
≠
≠
I L
.
≠
≠
L M
Cur
≠
≠
M P
&&
≠
≠
Q S
m
≠
≠
T U
.
≠
≠
U V
Type
≠
≠
V Z
==
≠
≠
[ ]
$str
≠
≠
^ h
)
≠
≠
h i
.
≠
≠
i j
Select
≠
≠
j p
(
≠
≠
p q
m
≠
≠
q r
=>
≠
≠
s u
m
≠
≠
v w
.
≠
≠
w x
Value
≠
≠
x }
)
≠
≠
} ~
.
≠
≠
~ 
FirstOrDefault≠
≠
 ç
(≠
≠
ç é
)≠
≠
é è
.≠
≠
è ê
ToString≠
≠
ê ò
(≠
≠
ò ô
)≠
≠
ô ö
,≠
≠
ö õ
NodDate
Æ
Æ
 
=
Æ
Æ
 
nod
Æ
Æ
 !
.
Æ
Æ
! "
NodDate
Æ
Æ
" )
,
Æ
Æ
) *
	ValueDate
Ø
Ø
 
=
Ø
Ø
 
nod
Ø
Ø
  #
.
Ø
Ø
# $
	ValueDate
Ø
Ø
$ -
,
Ø
Ø
- .
Beneficiary
∞
∞
 
=
∞
∞
  !
nod
∞
∞
" %
.
∞
∞
% &
Beneficiary
∞
∞
& 1
,
∞
∞
1 2
IsActive
±
±
 
=
±
±
 
nod
±
±
 "
.
±
±
" #
IsActive
±
±
# +
,
±
±
+ ,
}
≤
≤
 
;
≤
≤
 
if
¥
¥
 
(
¥
¥
 
data
¥
¥
 
.
¥
¥
 
Cur
¥
¥
 
!=
¥
¥
 
null
¥
¥
  $
&&
¥
¥
% '
data
¥
¥
( ,
.
¥
¥
, -
Cur
¥
¥
- 0
!=
¥
¥
1 3
$str
¥
¥
4 6
)
¥
¥
6 7
{
µ
µ
 
ViewBag
∂
∂
 
.
∂
∂
 
Cur
∂
∂
 
=
∂
∂
  !
new
∂
∂
" %

SelectList
∂
∂
& 0
(
∂
∂
0 1
Utility
∂
∂
1 8
.
∂
∂
8 9"
SelectDataLookupById
∂
∂
9 M
(
∂
∂
M N
int
∂
∂
N Q
.
∂
∂
Q R
Parse
∂
∂
R W
(
∂
∂
W X
data
∂
∂
X \
.
∂
∂
\ ]
Cur
∂
∂
] `
)
∂
∂
` a
,
∂
∂
a b
$str
∂
∂
c m
,
∂
∂
m n
_context
∂
∂
o w
)
∂
∂
w x
,
∂
∂
x y
$str
∂
∂
z ~
,
∂
∂
~ 
$str∂
∂
Ä Ü
,∂
∂
Ü á
data∂
∂
à å
.∂
∂
å ç
Cur∂
∂
ç ê
)∂
∂
ê ë
;∂
∂
ë í
}
∑
∑
 
else
∏
∏
 
{
π
π
 
ViewBag
∫
∫
 
.
∫
∫
 
Cur
∫
∫
 
=
∫
∫
  !
new
∫
∫
" %

SelectList
∫
∫
& 0
(
∫
∫
0 1
$str
∫
∫
1 3
,
∫
∫
3 4
$str
∫
∫
5 7
)
∫
∫
7 8
;
∫
∫
8 9
}
ª
ª
 
return
Ω
Ω
 
PartialView
Ω
Ω
 "
(
Ω
Ω
" #
$str
Ω
Ω
# *
,
Ω
Ω
* +
data
Ω
Ω
, 0
)
Ω
Ω
0 1
;
Ω
Ω
1 2
}
æ
æ
 
catch
ø
ø
 
(
ø
ø
 
	Exception
ø
ø
 
ex
ø
ø
 
)
ø
ø
  
{
¿
¿
 
var
¡
¡
 
data
¡
¡
 
=
¡
¡
 
new
¡
¡
 ,
NoticeOfDisbursement_ViewModel
¡
¡
 =
(
¡
¡
= >
)
¡
¡
> ?
;
¡
¡
? @
return
√
√
 
PartialView
√
√
 "
(
√
√
" #
$str
√
√
# *
,
√
√
* +
data
√
√
, 0
)
√
√
0 1
;
√
√
1 2
}
ƒ
ƒ
 
}
≈
≈
 	
[
«
«
 	&
ValidateAntiForgeryToken
«
«
	 !
]
«
«
! "
[
»
»
 	
HttpPost
»
»
	 
]
»
»
 
public
…
…
 
async
…
…
 
Task
…
…
 
<
…
…
 
ActionResult
…
…
 &
>
…
…
& '

SubmitEdit
…
…
( 2
(
…
…
2 3'
NoDHeaderDetail_ViewModel
…
…
3 L
model
…
…
M R
)
…
…
R S
{
 
 
 	
if
À
À
 
(
À
À
 
!
À
À
 
lastSession
À
À
 
.
À
À
 
Update
À
À
 #
(
À
À
# $
)
À
À
$ %
)
À
À
% &
{
Ã
Ã
 
return
Õ
Õ
 
RedirectToAction
Õ
Õ
 '
(
Õ
Õ
' (
$str
Õ
Õ
( /
,
Õ
Õ
/ 0
	GetConfig
Õ
Õ
1 :
.
Õ
Õ
: ;

AppSetting
Õ
Õ
; E
[
Õ
Õ
E F
$str
Õ
Õ
F n
]
Õ
Õ
n o
+
Õ
Õ
p q
$str
Õ
Õ
r y
,
Õ
Õ
y z
new
Õ
Õ
{ ~
{Õ
Õ
 Ä
aÕ
Õ
Å Ç
=Õ
Õ
É Ñ
trueÕ
Õ
Ö â
}Õ
Õ
ä ã
)Õ
Õ
ã å
;Õ
Õ
å ç
}
Œ
Œ
 
var
œ
œ
 
location
œ
œ
 
=
œ
œ
 
new
œ
œ
 
Uri
œ
œ
 "
(
œ
œ
" #
$"
œ
œ
# %
{
œ
œ
% &
Request
œ
œ
& -
.
œ
œ
- .
Scheme
œ
œ
. 4
}
œ
œ
4 5
$str
œ
œ
5 8
{
œ
œ
8 9
Request
œ
œ
9 @
.
œ
œ
@ A
Host
œ
œ
A E
}
œ
œ
E F
{
œ
œ
F G
Request
œ
œ
G N
.
œ
œ
N O
Path
œ
œ
O S
}
œ
œ
S T
"
œ
œ
T U
)
œ
œ
U V
;
œ
œ
V W
string
–
–
 
Path
–
–
 
=
–
–
 
location
–
–
 "
.
–
–
" #
AbsolutePath
–
–
# /
.
–
–
/ 0
Replace
–
–
0 7
(
–
–
7 8
this
–
–
8 <
.
–
–
< =
ControllerContext
–
–
= N
.
–
–
N O
	RouteData
–
–
O X
.
–
–
X Y
Values
–
–
Y _
[
–
–
_ `
$str
–
–
` h
]
–
–
h i
.
–
–
i j
ToString
–
–
j r
(
–
–
r s
)
–
–
s t
,
–
–
t u
$str
–
–
v }
)
–
–
} ~
;
–
–
~ 
if
—
—
 
(
—
—
 
!
—
—
 
accessSecurity
—
—
 
.
—
—
  
IsGetAccess
—
—
  +
(
—
—
+ ,
$str
—
—
, 0
+
—
—
1 2
Path
—
—
3 7
)
—
—
7 8
)
—
—
8 9
{
“
“
 
return
”
”
 
RedirectToAction
”
”
 '
(
”
”
' (
$str
”
”
( 3
,
”
”
3 4
$str
”
”
5 <
)
”
”
< =
;
”
”
= >
}
‘
‘
 
try
÷
÷
 
{
◊
◊
 
var
ÿ
ÿ
 
regex
ÿ
ÿ
 
=
ÿ
ÿ
 
await
ÿ
ÿ
 !
RegexRequest
ÿ
ÿ
" .
.
ÿ
ÿ
. /
RegexValidation
ÿ
ÿ
/ >
(
ÿ
ÿ
> ?
model
ÿ
ÿ
? D
)
ÿ
ÿ
D E
;
ÿ
ÿ
E F
if
Ÿ
Ÿ
 
(
Ÿ
Ÿ
 
!
Ÿ
Ÿ
 
regex
Ÿ
Ÿ
 
)
Ÿ
Ÿ
 
{
⁄
⁄
 
return
€
€
 
Content
€
€
 "
(
€
€
" #
$str
€
€
# 1
)
€
€
1 2
;
€
€
2 3
}
‹
‹
 
using
ﬁ
ﬁ
 
(
ﬁ
ﬁ
 
TransactionScope
ﬁ
ﬁ
 '
trx
ﬁ
ﬁ
( +
=
ﬁ
ﬁ
, -
new
ﬁ
ﬁ
. 1
TransactionScope
ﬁ
ﬁ
2 B
(
ﬁ
ﬁ
B C
)
ﬁ
ﬁ
C D
)
ﬁ
ﬁ
D E
{
ﬂ
ﬂ
 %
TblNoticeOfDisbursement
‡
‡
 +
data
‡
‡
, 0
=
‡
‡
1 2
_context
‡
‡
3 ;
.
‡
‡
; <&
TblNoticeOfDisbursements
‡
‡
< T
.
‡
‡
T U
Where
‡
‡
U Z
(
‡
‡
Z [
m
‡
‡
[ \
=>
‡
‡
] _
m
‡
‡
` a
.
‡
‡
a b
Id
‡
‡
b d
==
‡
‡
e g
model
‡
‡
h m
.
‡
‡
m n
Id
‡
‡
n p
)
‡
‡
p q
.
‡
‡
q r
FirstOrDefault‡
‡
r Ä
(‡
‡
Ä Å
)‡
‡
Å Ç
;‡
‡
Ç É
if
·
·
 
(
·
·
 
data
·
·
 
.
·
·
 
NodNo
·
·
 "
!=
·
·
# %
model
·
·
& +
.
·
·
+ ,
NodNo
·
·
, 1
)
·
·
1 2
{
‚
‚
 %
TblNoticeOfDisbursement
„
„
 /
	dataNodNo
„
„
0 9
=
„
„
: ;
_context
„
„
< D
.
„
„
D E&
TblNoticeOfDisbursements
„
„
E ]
.
„
„
] ^
Where
„
„
^ c
(
„
„
c d
m
„
„
d e
=>
„
„
f h
m
„
„
i j
.
„
„
j k
NodNo
„
„
k p
==
„
„
q s
model
„
„
t y
.
„
„
y z
NodNo
„
„
z 
&&„
„
Ä Ç
m„
„
É Ñ
.„
„
Ñ Ö
	IsDeleted„
„
Ö é
!=„
„
è ë
$num„
„
í ì
)„
„
ì î
.„
„
î ï
FirstOrDefault„
„
ï £
(„
„
£ §
)„
„
§ •
;„
„
• ¶
if
‰
‰
 
(
‰
‰
 
	dataNodNo
‰
‰
 %
!=
‰
‰
& (
null
‰
‰
) -
)
‰
‰
- .
{
Â
Â
 
return
Ê
Ê
 "
Content
Ê
Ê
# *
(
Ê
Ê
* +
$str
Ê
Ê
+ G
+
Ê
Ê
H I
	dataNodNo
Ê
Ê
J S
.
Ê
Ê
S T
NodNo
Ê
Ê
T Y
)
Ê
Ê
Y Z
;
Ê
Ê
Z [
}
Á
Á
 
}
Ë
Ë
 
if
Í
Í
 
(
Í
Í
 
data
Í
Í
 
.
Í
Í
 
IdNodFromApi
Í
Í
 )
!=
Í
Í
* ,
null
Í
Í
- 1
)
Í
Í
1 2
{
Î
Î
 
var
Ï
Ï
 "
jsonParseReturnCheck
Ï
Ï
 0
=
Ï
Ï
1 2
JsonConvert
Ï
Ï
3 >
.
Ï
Ï
> ?
DeserializeObject
Ï
Ï
? P
<
Ï
Ï
P Q!
ResultStatusDataInt
Ï
Ï
Q d
<
Ï
Ï
d e!
ResultStatusDataNod
Ï
Ï
e x
>
Ï
Ï
x y
>
Ï
Ï
y z
(
Ï
Ï
z {
$str
Ï
Ï
{ }
)
Ï
Ï
} ~
;
Ï
Ï
~ 
var
Ì
Ì
 
urlCheck
Ì
Ì
 $
=
Ì
Ì
% &
	GetConfig
Ì
Ì
' 0
.
Ì
Ì
0 1

AppSetting
Ì
Ì
1 ;
[
Ì
Ì
; <
$str
Ì
Ì
< M
]
Ì
Ì
M N
+
Ì
Ì
O P
	GetConfig
Ì
Ì
Q Z
.
Ì
Ì
Z [

AppSetting
Ì
Ì
[ e
[
Ì
Ì
e f
$str
Ì
Ì
f 
]Ì
Ì
 Ä
+Ì
Ì
Å Ç
dataÌ
Ì
É á
.Ì
Ì
á à
IdNodFromApiÌ
Ì
à î
;Ì
Ì
î ï
(
Ó
Ó
 
bool
Ó
Ó
 
resultApiCheck
Ó
Ó
 ,
,
Ó
Ó
, -
string
Ó
Ó
. 4
resultCheck
Ó
Ó
5 @
)
Ó
Ó
@ A
=
Ó
Ó
B C
RequestToAPI
Ó
Ó
D P
.
Ó
Ó
P Q!
GetJsonStringWebApi
Ó
Ó
Q d
(
Ó
Ó
d e
urlCheck
Ó
Ó
e m
,
Ó
Ó
m n
null
Ó
Ó
o s
)
Ó
Ó
s t
;
Ó
Ó
t u
if
Ô
Ô
 
(
Ô
Ô
 
resultApiCheck
Ô
Ô
 *
&&
Ô
Ô
+ -
!
Ô
Ô
. /
string
Ô
Ô
/ 5
.
Ô
Ô
5 6
IsNullOrEmpty
Ô
Ô
6 C
(
Ô
Ô
C D
resultCheck
Ô
Ô
D O
)
Ô
Ô
O P
)
Ô
Ô
P Q
{


 "
jsonParseReturnCheck
Ò
Ò
 0
=
Ò
Ò
1 2
JsonConvert
Ò
Ò
3 >
.
Ò
Ò
> ?
DeserializeObject
Ò
Ò
? P
<
Ò
Ò
P Q!
ResultStatusDataInt
Ò
Ò
Q d
<
Ò
Ò
d e!
ResultStatusDataNod
Ò
Ò
e x
>
Ò
Ò
x y
>
Ò
Ò
y z
(
Ò
Ò
z {
resultCheckÒ
Ò
{ Ü
)Ò
Ò
Ü á
;Ò
Ò
á à
if
Ú
Ú
 
(
Ú
Ú
  "
jsonParseReturnCheck
Ú
Ú
  4
.
Ú
Ú
4 5

StatusCode
Ú
Ú
5 ?
==
Ú
Ú
@ B
$num
Ú
Ú
C F
||
Ú
Ú
G I"
jsonParseReturnCheck
Ú
Ú
J ^
.
Ú
Ú
^ _

StatusCode
Ú
Ú
_ i
==
Ú
Ú
j l
$num
Ú
Ú
m p
)
Ú
Ú
p q
{
Û
Û
 
if
Ù
Ù
  "
(
Ù
Ù
# $"
jsonParseReturnCheck
Ù
Ù
$ 8
.
Ù
Ù
8 9
Data
Ù
Ù
9 =
.
Ù
Ù
= >
Status
Ù
Ù
> D
==
Ù
Ù
E G
$str
Ù
Ù
H R
)
Ù
Ù
R S
{
ı
ı
  !
data
ˆ
ˆ
$ (
.
ˆ
ˆ
( )
Status
ˆ
ˆ
) /
=
ˆ
ˆ
0 1"
jsonParseReturnCheck
ˆ
ˆ
2 F
.
ˆ
ˆ
F G
Data
ˆ
ˆ
G K
.
ˆ
ˆ
K L
Status
ˆ
ˆ
L R
;
ˆ
ˆ
R S
_context
˜
˜
$ ,
.
˜
˜
, -
Entry
˜
˜
- 2
(
˜
˜
2 3
data
˜
˜
3 7
)
˜
˜
7 8
.
˜
˜
8 9
State
˜
˜
9 >
=
˜
˜
? @
EntityState
˜
˜
A L
.
˜
˜
L M
Modified
˜
˜
M U
;
˜
˜
U V
_context
¯
¯
$ ,
.
¯
¯
, -
SaveChanges
¯
¯
- 8
(
¯
¯
8 9
)
¯
¯
9 :
;
¯
¯
: ;
trx
˘
˘
$ '
.
˘
˘
' (
Complete
˘
˘
( 0
(
˘
˘
0 1
)
˘
˘
1 2
;
˘
˘
2 3
return
˚
˚
$ *
Content
˚
˚
+ 2
(
˚
˚
2 3
$str
˚
˚
3 H
)
˚
˚
H I
;
˚
˚
I J
}
¸
¸
  !
else
˝
˝
  $
{
˛
˛
  !
data
ˇ
ˇ
$ (
.
ˇ
ˇ
( )
NodNo
ˇ
ˇ
) .
=
ˇ
ˇ
/ 0
model
ˇ
ˇ
1 6
.
ˇ
ˇ
6 7
NodNo
ˇ
ˇ
7 <
;
ˇ
ˇ
< =
data
ÄÄ$ (
.
ÄÄ( )
NodDate
ÄÄ) 0
=
ÄÄ1 2
DateTime
ÄÄ3 ;
.
ÄÄ; <
Parse
ÄÄ< A
(
ÄÄA B
model
ÄÄB G
.
ÄÄG H
NodDate
ÄÄH O
.
ÄÄO P
ToString
ÄÄP X
(
ÄÄX Y
)
ÄÄY Z
)
ÄÄZ [
;
ÄÄ[ \
data
ÅÅ$ (
.
ÅÅ( )
	ValueDate
ÅÅ) 2
=
ÅÅ3 4
model
ÅÅ5 :
.
ÅÅ: ;
	ValueDate
ÅÅ; D
;
ÅÅD E
data
ÇÇ$ (
.
ÇÇ( )
Cur
ÇÇ) ,
=
ÇÇ- .
_context
ÇÇ/ 7
.
ÇÇ7 8
TblMasterLookups
ÇÇ8 H
.
ÇÇH I
Where
ÇÇI N
(
ÇÇN O
m
ÇÇO P
=>
ÇÇQ S
m
ÇÇT U
.
ÇÇU V
Value
ÇÇV [
==
ÇÇ\ ^
int
ÇÇ_ b
.
ÇÇb c
Parse
ÇÇc h
(
ÇÇh i
model
ÇÇi n
.
ÇÇn o
Cur
ÇÇo r
)
ÇÇr s
&&
ÇÇt v
m
ÇÇw x
.
ÇÇx y
Type
ÇÇy }
==ÇÇ~ Ä
$strÇÇÅ ã
)ÇÇã å
.ÇÇå ç
SelectÇÇç ì
(ÇÇì î
mÇÇî ï
=>ÇÇñ ò
mÇÇô ö
.ÇÇö õ
NameÇÇõ ü
)ÇÇü †
.ÇÇ† °
FirstOrDefaultÇÇ° Ø
(ÇÇØ ∞
)ÇÇ∞ ±
;ÇÇ± ≤
data
ÉÉ$ (
.
ÉÉ( )
Beneficiary
ÉÉ) 4
=
ÉÉ5 6
model
ÉÉ7 <
.
ÉÉ< =
Beneficiary
ÉÉ= H
;
ÉÉH I
data
ÑÑ$ (
.
ÑÑ( )
IsActive
ÑÑ) 1
=
ÑÑ2 3
model
ÑÑ4 9
.
ÑÑ9 :
IsActive
ÑÑ: B
=
ÑÑC D
$num
ÑÑE F
;
ÑÑF G
data
ÖÖ$ (
.
ÖÖ( )
UpdatedById
ÖÖ) 4
=
ÖÖ5 6
int
ÖÖ7 :
.
ÖÖ: ;
Parse
ÖÖ; @
(
ÖÖ@ A
HttpContext
ÖÖA L
.
ÖÖL M
Session
ÖÖM T
.
ÖÖT U
	GetString
ÖÖU ^
(
ÖÖ^ _
SessionConstan
ÖÖ_ m
.
ÖÖm n
Session_UserId
ÖÖn |
)
ÖÖ| }
)
ÖÖ} ~
;
ÖÖ~ 
data
ÜÜ$ (
.
ÜÜ( )
UpdatedTime
ÜÜ) 4
=
ÜÜ5 6
DateTime
ÜÜ7 ?
.
ÜÜ? @
Now
ÜÜ@ C
;
ÜÜC D
_context
áá$ ,
.
áá, -
Entry
áá- 2
(
áá2 3
data
áá3 7
)
áá7 8
.
áá8 9
State
áá9 >
=
áá? @
EntityState
ááA L
.
ááL M
Modified
ááM U
;
ááU V
_context
àà$ ,
.
àà, -
SaveChanges
àà- 8
(
àà8 9
)
àà9 :
;
àà: ;
}
ââ  !
}
ää 
else
ãã  
{
åå 
return
çç  &
Content
çç' .
(
çç. /
	GetConfig
çç/ 8
.
çç8 9

AppSetting
çç9 C
[
ççC D
$str
ççD _
]
çç_ `
)
çç` a
;
çça b
}
éé 
}
èè 
}
íí 
else
ìì 
{
ìì 
data
îî 
.
îî 
NodNo
îî "
=
îî# $
model
îî% *
.
îî* +
NodNo
îî+ 0
;
îî0 1
data
ïï 
.
ïï 
NodDate
ïï $
=
ïï% &
DateTime
ïï' /
.
ïï/ 0
Parse
ïï0 5
(
ïï5 6
model
ïï6 ;
.
ïï; <
NodDate
ïï< C
.
ïïC D
ToString
ïïD L
(
ïïL M
)
ïïM N
)
ïïN O
;
ïïO P
data
ññ 
.
ññ 
	ValueDate
ññ &
=
ññ' (
model
ññ) .
.
ññ. /
	ValueDate
ññ/ 8
;
ññ8 9
data
óó 
.
óó 
Cur
óó  
=
óó! "
_context
óó# +
.
óó+ ,
TblMasterLookups
óó, <
.
óó< =
Where
óó= B
(
óóB C
m
óóC D
=>
óóE G
m
óóH I
.
óóI J
Value
óóJ O
==
óóP R
int
óóS V
.
óóV W
Parse
óóW \
(
óó\ ]
model
óó] b
.
óób c
Cur
óóc f
)
óóf g
&&
óóh j
m
óók l
.
óól m
Type
óóm q
==
óór t
$str
óóu 
)óó Ä
.óóÄ Å
SelectóóÅ á
(óóá à
móóà â
=>óóä å
móóç é
.óóé è
Nameóóè ì
)óóì î
.óóî ï
FirstOrDefaultóóï £
(óó£ §
)óó§ •
;óó• ¶
data
òò 
.
òò 
Beneficiary
òò (
=
òò) *
model
òò+ 0
.
òò0 1
Beneficiary
òò1 <
;
òò< =
data
ôô 
.
ôô 
IsActive
ôô %
=
ôô& '
model
ôô( -
.
ôô- .
IsActive
ôô. 6
=
ôô7 8
$num
ôô9 :
;
ôô: ;
data
öö 
.
öö 
UpdatedById
öö (
=
öö) *
int
öö+ .
.
öö. /
Parse
öö/ 4
(
öö4 5
HttpContext
öö5 @
.
öö@ A
Session
ööA H
.
ööH I
	GetString
ööI R
(
ööR S
SessionConstan
ööS a
.
ööa b
Session_UserId
ööb p
)
ööp q
)
ööq r
;
öör s
data
õõ 
.
õõ 
UpdatedTime
õõ (
=
õõ) *
DateTime
õõ+ 3
.
õõ3 4
Now
õõ4 7
;
õõ7 8
_context
úú  
.
úú  !
Entry
úú! &
(
úú& '
data
úú' +
)
úú+ ,
.
úú, -
State
úú- 2
=
úú3 4
EntityState
úú5 @
.
úú@ A
Modified
úúA I
;
úúI J
_context
ùù  
.
ùù  !
SaveChanges
ùù! ,
(
ùù, -
)
ùù- .
;
ùù. /
}
ûû 
trx
†† 
.
†† 
Complete
††  
(
††  !
)
††! "
;
††" #
}
°° 
return
¢¢ 
Content
¢¢ 
(
¢¢ 
$str
¢¢ !
)
¢¢! "
;
¢¢" #
}
§§ 
catch
•• 
{
¶¶ 
return
ßß 
Content
ßß 
(
ßß 
	GetConfig
ßß (
.
ßß( )

AppSetting
ßß) 3
[
ßß3 4
$str
ßß4 M
]
ßßM N
)
ßßN O
;
ßßO P
}
®® 
}
©© 	
public
≠≠ 
ActionResult
≠≠ 
EditView
≠≠ $
(
≠≠$ %
int
≠≠% (
id
≠≠) +
)
≠≠+ ,
{
ÆÆ 	
if
ØØ 
(
ØØ 
!
ØØ 
lastSession
ØØ 
.
ØØ 
Update
ØØ #
(
ØØ# $
)
ØØ$ %
)
ØØ% &
{
∞∞ 
return
±± 
RedirectToAction
±± '
(
±±' (
$str
±±( /
,
±±/ 0
	GetConfig
±±1 :
.
±±: ;

AppSetting
±±; E
[
±±E F
$str
±±F n
]
±±n o
+
±±p q
$str
±±r y
,
±±y z
new
±±{ ~
{±± Ä
a±±Å Ç
=±±É Ñ
true±±Ö â
}±±ä ã
)±±ã å
;±±å ç
}
≤≤ 
var
≥≥ 
location
≥≥ 
=
≥≥ 
new
≥≥ 
Uri
≥≥ "
(
≥≥" #
$"
≥≥# %
{
≥≥% &
Request
≥≥& -
.
≥≥- .
Scheme
≥≥. 4
}
≥≥4 5
$str
≥≥5 8
{
≥≥8 9
Request
≥≥9 @
.
≥≥@ A
Host
≥≥A E
}
≥≥E F
{
≥≥F G
Request
≥≥G N
.
≥≥N O
Path
≥≥O S
}
≥≥S T
"
≥≥T U
)
≥≥U V
;
≥≥V W
string
¥¥ 
Path
¥¥ 
=
¥¥ 
location
¥¥ "
.
¥¥" #
AbsolutePath
¥¥# /
.
¥¥/ 0
Replace
¥¥0 7
(
¥¥7 8
this
¥¥8 <
.
¥¥< =
ControllerContext
¥¥= N
.
¥¥N O
	RouteData
¥¥O X
.
¥¥X Y
Values
¥¥Y _
[
¥¥_ `
$str
¥¥` h
]
¥¥h i
.
¥¥i j
ToString
¥¥j r
(
¥¥r s
)
¥¥s t
,
¥¥t u
$str
¥¥v }
)
¥¥} ~
;
¥¥~ 
if
µµ 
(
µµ 
!
µµ 
accessSecurity
µµ 
.
µµ  
IsGetAccess
µµ  +
(
µµ+ ,
$str
µµ, 0
+
µµ1 2
Path
µµ3 7
)
µµ7 8
)
µµ8 9
{
∂∂ 
return
∑∑ 
RedirectToAction
∑∑ '
(
∑∑' (
$str
∑∑( 3
,
∑∑3 4
$str
∑∑5 <
)
∑∑< =
;
∑∑= >
}
∏∏ 
try
∫∫ 
{
ªª %
TblNoticeOfDisbursement
ºº '
nod
ºº( +
=
ºº, -
_context
ºº. 6
.
ºº6 7&
TblNoticeOfDisbursements
ºº7 O
.
ººO P
Where
ººP U
(
ººU V
m
ººV W
=>
ººX Z
m
ºº[ \
.
ºº\ ]
Id
ºº] _
==
ºº` b
id
ººc e
)
ººe f
.
ººf g
FirstOrDefault
ººg u
(
ººu v
)
ººv w
;
ººw x
var
ææ 
data
ææ 
=
ææ 
new
ææ ,
NoticeOfDisbursement_ViewModel
ææ =
{
øø 
Id
¿¿ 
=
¿¿ 
nod
¿¿ 
.
¿¿ 
Id
¿¿ 
,
¿¿  
NodNo
¡¡ 
=
¡¡ 
nod
¡¡ 
.
¡¡  
NodNo
¡¡  %
,
¡¡% &
Cur
¬¬ 
=
¬¬ 
_context
¬¬ "
.
¬¬" #
TblMasterLookups
¬¬# 3
.
¬¬3 4
Where
¬¬4 9
(
¬¬9 :
m
¬¬: ;
=>
¬¬< >
m
¬¬? @
.
¬¬@ A
Name
¬¬A E
==
¬¬F H
nod
¬¬I L
.
¬¬L M
Cur
¬¬M P
&&
¬¬Q S
m
¬¬T U
.
¬¬U V
Type
¬¬V Z
==
¬¬[ ]
$str
¬¬^ h
)
¬¬h i
.
¬¬i j
Select
¬¬j p
(
¬¬p q
m
¬¬q r
=>
¬¬s u
m
¬¬v w
.
¬¬w x
Value
¬¬x }
)
¬¬} ~
.
¬¬~ 
FirstOrDefault¬¬ ç
(¬¬ç é
)¬¬é è
.¬¬è ê
ToString¬¬ê ò
(¬¬ò ô
)¬¬ô ö
,¬¬ö õ
NodDate
√√ 
=
√√ 
nod
√√ !
.
√√! "
NodDate
√√" )
,
√√) *
	ValueDate
ƒƒ 
=
ƒƒ 
nod
ƒƒ  #
.
ƒƒ# $
	ValueDate
ƒƒ$ -
,
ƒƒ- .
Beneficiary
≈≈ 
=
≈≈  !
nod
≈≈" %
.
≈≈% &
Beneficiary
≈≈& 1
,
≈≈1 2
IsActive
∆∆ 
=
∆∆ 
nod
∆∆ "
.
∆∆" #
IsActive
∆∆# +
,
∆∆+ ,
}
«« 
;
«« 
if
…… 
(
…… 
data
…… 
.
…… 
Cur
…… 
!=
…… 
null
……  $
&&
……% '
data
……( ,
.
……, -
Cur
……- 0
!=
……1 3
$str
……4 6
)
……6 7
{
   
ViewBag
ÀÀ 
.
ÀÀ 
Cur
ÀÀ 
=
ÀÀ  !
new
ÀÀ" %

SelectList
ÀÀ& 0
(
ÀÀ0 1
Utility
ÀÀ1 8
.
ÀÀ8 9"
SelectDataLookupById
ÀÀ9 M
(
ÀÀM N
int
ÀÀN Q
.
ÀÀQ R
Parse
ÀÀR W
(
ÀÀW X
data
ÀÀX \
.
ÀÀ\ ]
Cur
ÀÀ] `
)
ÀÀ` a
,
ÀÀa b
$str
ÀÀc m
,
ÀÀm n
_context
ÀÀo w
)
ÀÀw x
,
ÀÀx y
$str
ÀÀz ~
,
ÀÀ~ 
$strÀÀÄ Ü
,ÀÀÜ á
dataÀÀà å
.ÀÀå ç
CurÀÀç ê
)ÀÀê ë
;ÀÀë í
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
ViewBag
œœ 
.
œœ 
Cur
œœ 
=
œœ  !
new
œœ" %

SelectList
œœ& 0
(
œœ0 1
$str
œœ1 3
,
œœ3 4
$str
œœ5 7
)
œœ7 8
;
œœ8 9
}
–– 
return
““ 
PartialView
““ "
(
““" #
$str
““# .
,
““. /
data
““0 4
)
““4 5
;
““5 6
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
var
÷÷ 
data
÷÷ 
=
÷÷ 
new
÷÷ ,
NoticeOfDisbursement_ViewModel
÷÷ =
(
÷÷= >
)
÷÷> ?
;
÷÷? @
return
ÿÿ 
PartialView
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# .
,
ÿÿ. /
data
ÿÿ0 4
)
ÿÿ4 5
;
ÿÿ5 6
}
ŸŸ 
}
⁄⁄ 	
public
ﬁﬁ 
ActionResult
ﬁﬁ 
View
ﬁﬁ  
(
ﬁﬁ  !
int
ﬁﬁ! $
id
ﬁﬁ% '
)
ﬁﬁ' (
{
ﬂﬂ 	
if
‡‡ 
(
‡‡ 
!
‡‡ 
lastSession
‡‡ 
.
‡‡ 
Update
‡‡ #
(
‡‡# $
)
‡‡$ %
)
‡‡% &
{
·· 
return
‚‚ 
RedirectToAction
‚‚ '
(
‚‚' (
$str
‚‚( /
,
‚‚/ 0
	GetConfig
‚‚1 :
.
‚‚: ;

AppSetting
‚‚; E
[
‚‚E F
$str
‚‚F n
]
‚‚n o
+
‚‚p q
$str
‚‚r y
,
‚‚y z
new
‚‚{ ~
{‚‚ Ä
a‚‚Å Ç
=‚‚É Ñ
true‚‚Ö â
}‚‚ä ã
)‚‚ã å
;‚‚å ç
}
„„ 
var
‰‰ 
location
‰‰ 
=
‰‰ 
new
‰‰ 
Uri
‰‰ "
(
‰‰" #
$"
‰‰# %
{
‰‰% &
Request
‰‰& -
.
‰‰- .
Scheme
‰‰. 4
}
‰‰4 5
$str
‰‰5 8
{
‰‰8 9
Request
‰‰9 @
.
‰‰@ A
Host
‰‰A E
}
‰‰E F
{
‰‰F G
Request
‰‰G N
.
‰‰N O
Path
‰‰O S
}
‰‰S T
"
‰‰T U
)
‰‰U V
;
‰‰V W
string
ÂÂ 
Path
ÂÂ 
=
ÂÂ 
location
ÂÂ "
.
ÂÂ" #
AbsolutePath
ÂÂ# /
.
ÂÂ/ 0
Replace
ÂÂ0 7
(
ÂÂ7 8
this
ÂÂ8 <
.
ÂÂ< =
ControllerContext
ÂÂ= N
.
ÂÂN O
	RouteData
ÂÂO X
.
ÂÂX Y
Values
ÂÂY _
[
ÂÂ_ `
$str
ÂÂ` h
]
ÂÂh i
.
ÂÂi j
ToString
ÂÂj r
(
ÂÂr s
)
ÂÂs t
,
ÂÂt u
$str
ÂÂv }
)
ÂÂ} ~
;
ÂÂ~ 
if
ÊÊ 
(
ÊÊ 
!
ÊÊ 
accessSecurity
ÊÊ 
.
ÊÊ  
IsGetAccess
ÊÊ  +
(
ÊÊ+ ,
$str
ÊÊ, 0
+
ÊÊ1 2
Path
ÊÊ3 7
)
ÊÊ7 8
)
ÊÊ8 9
{
ÁÁ 
return
ËË 
RedirectToAction
ËË '
(
ËË' (
$str
ËË( 3
,
ËË3 4
$str
ËË5 <
)
ËË< =
;
ËË= >
}
ÈÈ 
try
ÎÎ 
{
ÏÏ %
TblNoticeOfDisbursement
ÌÌ '
nod
ÌÌ( +
=
ÌÌ, -
_context
ÌÌ. 6
.
ÌÌ6 7&
TblNoticeOfDisbursements
ÌÌ7 O
.
ÌÌO P
Where
ÌÌP U
(
ÌÌU V
m
ÌÌV W
=>
ÌÌX Z
m
ÌÌ[ \
.
ÌÌ\ ]
Id
ÌÌ] _
==
ÌÌ` b
id
ÌÌc e
)
ÌÌe f
.
ÌÌf g
FirstOrDefault
ÌÌg u
(
ÌÌu v
)
ÌÌv w
;
ÌÌw x
var
ÔÔ 
data
ÔÔ 
=
ÔÔ 
new
ÔÔ ,
NoticeOfDisbursement_ViewModel
ÔÔ =
{
 
Id
ÒÒ 
=
ÒÒ 
nod
ÒÒ 
.
ÒÒ 
Id
ÒÒ 
,
ÒÒ  
NodNo
ÚÚ 
=
ÚÚ 
nod
ÚÚ 
.
ÚÚ  
NodNo
ÚÚ  %
,
ÚÚ% &
Cur
ÛÛ 
=
ÛÛ 
_context
ÛÛ "
.
ÛÛ" #
TblMasterLookups
ÛÛ# 3
.
ÛÛ3 4
Where
ÛÛ4 9
(
ÛÛ9 :
m
ÛÛ: ;
=>
ÛÛ< >
m
ÛÛ? @
.
ÛÛ@ A
Name
ÛÛA E
==
ÛÛF H
nod
ÛÛI L
.
ÛÛL M
Cur
ÛÛM P
&&
ÛÛQ S
m
ÛÛT U
.
ÛÛU V
Type
ÛÛV Z
==
ÛÛ[ ]
$str
ÛÛ^ h
)
ÛÛh i
.
ÛÛi j
Select
ÛÛj p
(
ÛÛp q
m
ÛÛq r
=>
ÛÛs u
m
ÛÛv w
.
ÛÛw x
Value
ÛÛx }
)
ÛÛ} ~
.
ÛÛ~ 
FirstOrDefaultÛÛ ç
(ÛÛç é
)ÛÛé è
.ÛÛè ê
ToStringÛÛê ò
(ÛÛò ô
)ÛÛô ö
,ÛÛö õ
NodDate
ÙÙ 
=
ÙÙ 
nod
ÙÙ !
.
ÙÙ! "
NodDate
ÙÙ" )
,
ÙÙ) *
	ValueDate
ıı 
=
ıı 
nod
ıı  #
.
ıı# $
	ValueDate
ıı$ -
,
ıı- .
Beneficiary
ˆˆ 
=
ˆˆ  !
nod
ˆˆ" %
.
ˆˆ% &
Beneficiary
ˆˆ& 1
,
ˆˆ1 2
IsActive
˜˜ 
=
˜˜ 
nod
˜˜ "
.
˜˜" #
IsActive
˜˜# +
,
˜˜+ ,
}
¯¯ 
;
¯¯ 
if
˙˙ 
(
˙˙ 
data
˙˙ 
.
˙˙ 
Cur
˙˙ 
!=
˙˙ 
null
˙˙  $
&&
˙˙% '
data
˙˙( ,
.
˙˙, -
Cur
˙˙- 0
!=
˙˙1 3
$str
˙˙4 6
)
˙˙6 7
{
˚˚ 
ViewBag
¸¸ 
.
¸¸ 
Cur
¸¸ 
=
¸¸  !
new
¸¸" %

SelectList
¸¸& 0
(
¸¸0 1
Utility
¸¸1 8
.
¸¸8 9"
SelectDataLookupById
¸¸9 M
(
¸¸M N
int
¸¸N Q
.
¸¸Q R
Parse
¸¸R W
(
¸¸W X
data
¸¸X \
.
¸¸\ ]
Cur
¸¸] `
)
¸¸` a
,
¸¸a b
$str
¸¸c m
,
¸¸m n
_context
¸¸o w
)
¸¸w x
,
¸¸x y
$str
¸¸z ~
,
¸¸~ 
$str¸¸Ä Ü
,¸¸Ü á
data¸¸à å
.¸¸å ç
Cur¸¸ç ê
)¸¸ê ë
;¸¸ë í
}
˝˝ 
else
˛˛ 
{
ˇˇ 
ViewBag
ÄÄ 
.
ÄÄ 
Cur
ÄÄ 
=
ÄÄ  !
new
ÄÄ" %

SelectList
ÄÄ& 0
(
ÄÄ0 1
$str
ÄÄ1 3
,
ÄÄ3 4
$str
ÄÄ5 7
)
ÄÄ7 8
;
ÄÄ8 9
}
ÅÅ 
return
ÉÉ 
PartialView
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# *
,
ÉÉ* +
data
ÉÉ, 0
)
ÉÉ0 1
;
ÉÉ1 2
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
ÜÜ 
var
áá 
data
áá 
=
áá 
new
áá ,
NoticeOfDisbursement_ViewModel
áá =
(
áá= >
)
áá> ?
;
áá? @
return
ââ 
PartialView
ââ "
(
ââ" #
$str
ââ# *
,
ââ* +
data
ââ, 0
)
ââ0 1
;
ââ1 2
}
ää 
}
ãã 	
public
èè 
ActionResult
èè 
Delete
èè "
(
èè" #
string
èè# )
Ids
èè* -
)
èè- .
{
êê 	
if
ëë 
(
ëë 
!
ëë 
lastSession
ëë 
.
ëë 
Update
ëë #
(
ëë# $
)
ëë$ %
)
ëë% &
{
íí 
return
ìì 
RedirectToAction
ìì '
(
ìì' (
$str
ìì( /
,
ìì/ 0
	GetConfig
ìì1 :
.
ìì: ;

AppSetting
ìì; E
[
ììE F
$str
ììF n
]
ììn o
+
ììp q
$str
ììr y
,
ììy z
new
ìì{ ~
{ìì Ä
aììÅ Ç
=ììÉ Ñ
trueììÖ â
}ììä ã
)ììã å
;ììå ç
}
îî 
var
ïï 
location
ïï 
=
ïï 
new
ïï 
Uri
ïï "
(
ïï" #
$"
ïï# %
{
ïï% &
Request
ïï& -
.
ïï- .
Scheme
ïï. 4
}
ïï4 5
$str
ïï5 8
{
ïï8 9
Request
ïï9 @
.
ïï@ A
Host
ïïA E
}
ïïE F
{
ïïF G
Request
ïïG N
.
ïïN O
Path
ïïO S
}
ïïS T
"
ïïT U
)
ïïU V
;
ïïV W
string
ññ 
Path
ññ 
=
ññ 
location
ññ "
.
ññ" #
AbsolutePath
ññ# /
.
ññ/ 0
Replace
ññ0 7
(
ññ7 8
this
ññ8 <
.
ññ< =
ControllerContext
ññ= N
.
ññN O
	RouteData
ññO X
.
ññX Y
Values
ññY _
[
ññ_ `
$str
ññ` h
]
ññh i
.
ññi j
ToString
ññj r
(
ññr s
)
ññs t
,
ññt u
$str
ññv }
)
ññ} ~
;
ññ~ 
if
óó 
(
óó 
!
óó 
accessSecurity
óó 
.
óó  
IsGetAccess
óó  +
(
óó+ ,
$str
óó, 0
+
óó1 2
Path
óó3 7
)
óó7 8
)
óó8 9
{
òò 
return
ôô 
RedirectToAction
ôô '
(
ôô' (
$str
ôô( 3
,
ôô3 4
$str
ôô5 <
)
ôô< =
;
ôô= >
}
öö 
try
úú 
{
ùù 
long
ûû 
[
ûû 
]
ûû 
confirmedDeleteId
ûû (
=
ûû) *
Ids
ûû+ .
.
ûû. /
Split
ûû/ 4
(
ûû4 5
$char
ûû5 8
)
ûû8 9
.
ûû9 :
Select
ûû: @
(
ûû@ A
long
ûûA E
.
ûûE F
Parse
ûûF K
)
ûûK L
.
ûûL M
ToArray
ûûM T
(
ûûT U
)
ûûU V
;
ûûV W
List
†† 
<
†† %
TblNoticeOfDisbursement
†† ,
>
††, -

Transaksis
††. 8
=
††9 :
_context
††; C
.
††C D&
TblNoticeOfDisbursements
††D \
.
††\ ]
Where
††] b
(
††b c
x
††c d
=>
††e g
confirmedDeleteId
††h y
.
††y z
Contains††z Ç
(††Ç É
x††É Ñ
.††Ñ Ö
Id††Ö á
)††á à
)††à â
.††â ä
ToList††ä ê
(††ê ë
)††ë í
;††í ì
for
°° 
(
°° 
int
°° 
i
°° 
=
°° 
$num
°° 
;
°° 
i
°°  !
<
°°" #
confirmedDeleteId
°°$ 5
.
°°5 6
Length
°°6 <
;
°°< =
i
°°> ?
++
°°? A
)
°°A B
{
¢¢ 
if
££ 
(
££ 

Transaksis
££ "
[
££" #
i
££# $
]
££$ %
.
££% &
IdNodFromApi
££& 2
!=
££3 5
null
££6 :
)
££: ;
{
§§ 
var
•• "
jsonParseReturnCheck
•• 0
=
••1 2
JsonConvert
••3 >
.
••> ?
DeserializeObject
••? P
<
••P Q!
ResultStatusDataInt
••Q d
<
••d e!
ResultStatusDataNod
••e x
>
••x y
>
••y z
(
••z {
$str
••{ }
)
••} ~
;
••~ 
var
¶¶ 
urlCheck
¶¶ $
=
¶¶% &
	GetConfig
¶¶' 0
.
¶¶0 1

AppSetting
¶¶1 ;
[
¶¶; <
$str
¶¶< M
]
¶¶M N
+
¶¶O P
	GetConfig
¶¶Q Z
.
¶¶Z [

AppSetting
¶¶[ e
[
¶¶e f
$str
¶¶f 
]¶¶ Ä
+¶¶Å Ç

Transaksis¶¶É ç
[¶¶ç é
i¶¶é è
]¶¶è ê
.¶¶ê ë
IdNodFromApi¶¶ë ù
;¶¶ù û
(
ßß 
bool
ßß 
resultApiCheck
ßß ,
,
ßß, -
string
ßß. 4
resultCheck
ßß5 @
)
ßß@ A
=
ßßB C
RequestToAPI
ßßD P
.
ßßP Q!
GetJsonStringWebApi
ßßQ d
(
ßßd e
urlCheck
ßße m
,
ßßm n
null
ßßo s
)
ßßs t
;
ßßt u
if
®® 
(
®® 
resultApiCheck
®® *
&&
®®+ -
!
®®. /
string
®®/ 5
.
®®5 6
IsNullOrEmpty
®®6 C
(
®®C D
resultCheck
®®D O
)
®®O P
)
®®P Q
{
©© "
jsonParseReturnCheck
™™ 0
=
™™1 2
JsonConvert
™™3 >
.
™™> ?
DeserializeObject
™™? P
<
™™P Q!
ResultStatusDataInt
™™Q d
<
™™d e!
ResultStatusDataNod
™™e x
>
™™x y
>
™™y z
(
™™z {
resultCheck™™{ Ü
)™™Ü á
;™™á à
if
´´ 
(
´´  "
jsonParseReturnCheck
´´  4
.
´´4 5

StatusCode
´´5 ?
==
´´@ B
$num
´´C F
||
´´G I"
jsonParseReturnCheck
´´J ^
.
´´^ _

StatusCode
´´_ i
==
´´j l
$num
´´m p
)
´´p q
{
¨¨ 
if
≠≠  "
(
≠≠# $"
jsonParseReturnCheck
≠≠$ 8
.
≠≠8 9
Data
≠≠9 =
.
≠≠= >
Status
≠≠> D
==
≠≠E G
$str
≠≠H T
)
≠≠T U
{
ÆÆ  !
var
ØØ$ '#
jsonParseReturnDelete
ØØ( =
=
ØØ> ?
JsonConvert
ØØ@ K
.
ØØK L
DeserializeObject
ØØL ]
<
ØØ] ^!
ResultStatusDataInt
ØØ^ q
<
ØØq r"
ResultStatusDataNodØØr Ö
>ØØÖ Ü
>ØØÜ á
(ØØá à
$strØØà ä
)ØØä ã
;ØØã å
var
∞∞$ '
	urlDelete
∞∞( 1
=
∞∞2 3
	GetConfig
∞∞4 =
.
∞∞= >

AppSetting
∞∞> H
[
∞∞H I
$str
∞∞I Z
]
∞∞Z [
+
∞∞\ ]
	GetConfig
∞∞^ g
.
∞∞g h

AppSetting
∞∞h r
[
∞∞r s
$str∞∞s á
]∞∞á à
+∞∞â ä

Transaksis∞∞ã ï
[∞∞ï ñ
i∞∞ñ ó
]∞∞ó ò
.∞∞ò ô
IdNodFromApi∞∞ô •
;∞∞• ¶
(
±±$ %
bool
±±% )
resultApiDelete
±±* 9
,
±±9 :
string
±±; A
resultDelete
±±B N
)
±±N O
=
±±P Q
RequestToAPI
±±R ^
.
±±^ _#
DeleteRequestToWebApi
±±_ t
(
±±t u
	urlDelete
±±u ~
,
±±~ 
null±±Ä Ñ
)±±Ñ Ö
;±±Ö Ü
if
≤≤$ &
(
≤≤' (
resultApiDelete
≤≤( 7
&&
≤≤8 :
!
≤≤; <
string
≤≤< B
.
≤≤B C
IsNullOrEmpty
≤≤C P
(
≤≤P Q
resultDelete
≤≤Q ]
)
≤≤] ^
)
≤≤^ _
{
≥≥$ %#
jsonParseReturnDelete
¥¥( =
=
¥¥> ?
JsonConvert
¥¥@ K
.
¥¥K L
DeserializeObject
¥¥L ]
<
¥¥] ^!
ResultStatusDataInt
¥¥^ q
<
¥¥q r"
ResultStatusDataNod¥¥r Ö
>¥¥Ö Ü
>¥¥Ü á
(¥¥á à
resultDelete¥¥à î
)¥¥î ï
;¥¥ï ñ
if
µµ( *
(
µµ+ ,#
jsonParseReturnDelete
µµ, A
.
µµA B

StatusCode
µµB L
==
µµM O
$num
µµP S
||
µµT V#
jsonParseReturnDelete
µµW l
.
µµl m

StatusCode
µµm w
==
µµx z
$num
µµ{ ~
)
µµ~ 
{
∂∂( )%
TblNoticeOfDisbursement
∑∑, C
data
∑∑D H
=
∑∑I J
_context
∑∑K S
.
∑∑S T&
TblNoticeOfDisbursements
∑∑T l
.
∑∑l m
Find
∑∑m q
(
∑∑q r

Transaksis
∑∑r |
[
∑∑| }
i
∑∑} ~
]
∑∑~ 
.∑∑ Ä
Id∑∑Ä Ç
)∑∑Ç É
;∑∑É Ñ
data
∏∏, 0
.
∏∏0 1
	IsDeleted
∏∏1 :
=
∏∏; <
$num
∏∏= >
;
∏∏> ?
_context
ππ, 4
.
ππ4 5
Entry
ππ5 :
(
ππ: ;
data
ππ; ?
)
ππ? @
.
ππ@ A
State
ππA F
=
ππG H
EntityState
ππI T
.
ππT U
Modified
ππU ]
;
ππ] ^
_context
∫∫, 4
.
∫∫4 5
SaveChanges
∫∫5 @
(
∫∫@ A
)
∫∫A B
;
∫∫B C
}
ªª( )
}
ºº$ %
}
ΩΩ  !
else
ææ  $
{
øø  !%
TblNoticeOfDisbursement
¿¿$ ;
data
¿¿< @
=
¿¿A B
_context
¿¿C K
.
¿¿K L&
TblNoticeOfDisbursements
¿¿L d
.
¿¿d e
Find
¿¿e i
(
¿¿i j

Transaksis
¿¿j t
[
¿¿t u
i
¿¿u v
]
¿¿v w
.
¿¿w x
Id
¿¿x z
)
¿¿z {
;
¿¿{ |
data
¡¡$ (
.
¡¡( )
Status
¡¡) /
=
¡¡0 1"
jsonParseReturnCheck
¡¡2 F
.
¡¡F G
Data
¡¡G K
.
¡¡K L
Status
¡¡L R
;
¡¡R S
_context
¬¬$ ,
.
¬¬, -
Entry
¬¬- 2
(
¬¬2 3
data
¬¬3 7
)
¬¬7 8
.
¬¬8 9
State
¬¬9 >
=
¬¬? @
EntityState
¬¬A L
.
¬¬L M
Modified
¬¬M U
;
¬¬U V
_context
√√$ ,
.
√√, -
SaveChanges
√√- 8
(
√√8 9
)
√√9 :
;
√√: ;
return
≈≈$ *
Content
≈≈+ 2
(
≈≈2 3
$str
≈≈3 H
)
≈≈H I
;
≈≈I J
}
∆∆  !
}
«« 
else
»»  
{
…… 
return
    &
Content
  ' .
(
  . /
	GetConfig
  / 8
.
  8 9

AppSetting
  9 C
[
  C D
$str
  D _
]
  _ `
)
  ` a
;
  a b
}
ÀÀ 
}
ÃÃ 
}
œœ 
else
–– 
{
—— %
TblNoticeOfDisbursement
““ /
data
““0 4
=
““5 6
_context
““7 ?
.
““? @&
TblNoticeOfDisbursements
““@ X
.
““X Y
Find
““Y ]
(
““] ^

Transaksis
““^ h
[
““h i
i
““i j
]
““j k
.
““k l
Id
““l n
)
““n o
;
““o p
data
”” 
.
”” 
	IsDeleted
”” &
=
””' (
$num
””) *
;
””* +
_context
‘‘  
.
‘‘  !
Entry
‘‘! &
(
‘‘& '
data
‘‘' +
)
‘‘+ ,
.
‘‘, -
State
‘‘- 2
=
‘‘3 4
EntityState
‘‘5 @
.
‘‘@ A
Modified
‘‘A I
;
‘‘I J
_context
’’  
.
’’  !
SaveChanges
’’! ,
(
’’, -
)
’’- .
;
’’. /
}
÷÷ 
}
◊◊ 
return
ÿÿ 
Content
ÿÿ 
(
ÿÿ 
$str
ÿÿ !
)
ÿÿ! "
;
ÿÿ" #
}
ŸŸ 
catch
⁄⁄ 
{
€€ 
return
‹‹ 
Content
‹‹ 
(
‹‹ 
$str
‹‹ &
)
‹‹& '
;
‹‹' (
}
›› 
}
ﬁﬁ 	
public
ﬂﬂ 
ActionResult
ﬂﬂ !
DeleteDetailNodTemp
ﬂﬂ /
(
ﬂﬂ/ 0
string
ﬂﬂ0 6
Ids
ﬂﬂ7 :
)
ﬂﬂ: ;
{
‡‡ 	
if
·· 
(
·· 
!
·· 
lastSession
·· 
.
·· 
Update
·· #
(
··# $
)
··$ %
)
··% &
{
‚‚ 
return
„„ 
RedirectToAction
„„ '
(
„„' (
$str
„„( /
,
„„/ 0
	GetConfig
„„1 :
.
„„: ;

AppSetting
„„; E
[
„„E F
$str
„„F n
]
„„n o
+
„„p q
$str
„„r y
,
„„y z
new
„„{ ~
{„„ Ä
a„„Å Ç
=„„É Ñ
true„„Ö â
}„„ä ã
)„„ã å
;„„å ç
}
‰‰ 
var
ÂÂ 
location
ÂÂ 
=
ÂÂ 
new
ÂÂ 
Uri
ÂÂ "
(
ÂÂ" #
$"
ÂÂ# %
{
ÂÂ% &
Request
ÂÂ& -
.
ÂÂ- .
Scheme
ÂÂ. 4
}
ÂÂ4 5
$str
ÂÂ5 8
{
ÂÂ8 9
Request
ÂÂ9 @
.
ÂÂ@ A
Host
ÂÂA E
}
ÂÂE F
{
ÂÂF G
Request
ÂÂG N
.
ÂÂN O
Path
ÂÂO S
}
ÂÂS T
"
ÂÂT U
)
ÂÂU V
;
ÂÂV W
string
ÊÊ 
Path
ÊÊ 
=
ÊÊ 
location
ÊÊ "
.
ÊÊ" #
AbsolutePath
ÊÊ# /
.
ÊÊ/ 0
Replace
ÊÊ0 7
(
ÊÊ7 8
this
ÊÊ8 <
.
ÊÊ< =
ControllerContext
ÊÊ= N
.
ÊÊN O
	RouteData
ÊÊO X
.
ÊÊX Y
Values
ÊÊY _
[
ÊÊ_ `
$str
ÊÊ` h
]
ÊÊh i
.
ÊÊi j
ToString
ÊÊj r
(
ÊÊr s
)
ÊÊs t
,
ÊÊt u
$str
ÊÊv }
)
ÊÊ} ~
;
ÊÊ~ 
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
accessSecurity
ÁÁ 
.
ÁÁ  
IsGetAccess
ÁÁ  +
(
ÁÁ+ ,
$str
ÁÁ, 0
+
ÁÁ1 2
Path
ÁÁ3 7
)
ÁÁ7 8
)
ÁÁ8 9
{
ËË 
return
ÈÈ 
RedirectToAction
ÈÈ '
(
ÈÈ' (
$str
ÈÈ( 3
,
ÈÈ3 4
$str
ÈÈ5 <
)
ÈÈ< =
;
ÈÈ= >
}
ÍÍ 
try
ÏÏ 
{
ÌÌ 
long
ÓÓ 
[
ÓÓ 
]
ÓÓ 
confirmedDeleteId
ÓÓ (
=
ÓÓ) *
Ids
ÓÓ+ .
.
ÓÓ. /
Split
ÓÓ/ 4
(
ÓÓ4 5
$char
ÓÓ5 8
)
ÓÓ8 9
.
ÓÓ9 :
Select
ÓÓ: @
(
ÓÓ@ A
long
ÓÓA E
.
ÓÓE F
Parse
ÓÓF K
)
ÓÓK L
.
ÓÓL M
ToArray
ÓÓM T
(
ÓÓT U
)
ÓÓU V
;
ÓÓV W
List
 
<
 /
!TblNoticeOfDisbursementDetailTemp
 6
>
6 7

Transaksis
8 B
=
C D
_context
E M
.
M N0
"TblNoticeOfDisbursementDetailTemps
N p
.
p q
Where
q v
(
v w
x
w x
=>
y { 
confirmedDeleteId| ç
.ç é
Containsé ñ
(ñ ó
xó ò
.ò ô
Idô õ
)õ ú
)ú ù
.ù û
ToListû §
(§ •
)• ¶
;¶ ß
for
ÒÒ 
(
ÒÒ 
int
ÒÒ 
i
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
;
ÒÒ 
i
ÒÒ  !
<
ÒÒ" #
confirmedDeleteId
ÒÒ$ 5
.
ÒÒ5 6
Length
ÒÒ6 <
;
ÒÒ< =
i
ÒÒ> ?
++
ÒÒ? A
)
ÒÒA B
{
ÚÚ /
!TblNoticeOfDisbursementDetailTemp
ÛÛ 5
data
ÛÛ6 :
=
ÛÛ; <
_context
ÛÛ= E
.
ÛÛE F0
"TblNoticeOfDisbursementDetailTemps
ÛÛF h
.
ÛÛh i
Find
ÛÛi m
(
ÛÛm n

Transaksis
ÛÛn x
[
ÛÛx y
i
ÛÛy z
]
ÛÛz {
.
ÛÛ{ |
Id
ÛÛ| ~
)
ÛÛ~ 
;ÛÛ Ä
data
ÙÙ 
.
ÙÙ 
	IsDeleted
ÙÙ "
=
ÙÙ# $
$num
ÙÙ% &
;
ÙÙ& '
_context
ıı 
.
ıı 
Entry
ıı "
(
ıı" #
data
ıı# '
)
ıı' (
.
ıı( )
State
ıı) .
=
ıı/ 0
EntityState
ıı1 <
.
ıı< =
Modified
ıı= E
;
ııE F
_context
ˆˆ 
.
ˆˆ 
SaveChanges
ˆˆ (
(
ˆˆ( )
)
ˆˆ) *
;
ˆˆ* +
}
˜˜ 
return
¯¯ 
Content
¯¯ 
(
¯¯ 
$str
¯¯ !
)
¯¯! "
;
¯¯" #
}
˘˘ 
catch
˙˙ 
{
˚˚ 
return
¸¸ 
Content
¸¸ 
(
¸¸ 
$str
¸¸ &
)
¸¸& '
;
¸¸' (
}
˝˝ 
}
˛˛ 	
public
ˇˇ 
ActionResult
ˇˇ 
DeleteDetailNod
ˇˇ +
(
ˇˇ+ ,
string
ˇˇ, 2
Ids
ˇˇ3 6
)
ˇˇ6 7
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
lastSession
ÅÅ 
.
ÅÅ 
Update
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
)
ÅÅ% &
{
ÇÇ 
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( /
,
ÉÉ/ 0
	GetConfig
ÉÉ1 :
.
ÉÉ: ;

AppSetting
ÉÉ; E
[
ÉÉE F
$str
ÉÉF n
]
ÉÉn o
+
ÉÉp q
$str
ÉÉr y
,
ÉÉy z
new
ÉÉ{ ~
{ÉÉ Ä
aÉÉÅ Ç
=ÉÉÉ Ñ
trueÉÉÖ â
}ÉÉä ã
)ÉÉã å
;ÉÉå ç
}
ÑÑ 
var
ÖÖ 
location
ÖÖ 
=
ÖÖ 
new
ÖÖ 
Uri
ÖÖ "
(
ÖÖ" #
$"
ÖÖ# %
{
ÖÖ% &
Request
ÖÖ& -
.
ÖÖ- .
Scheme
ÖÖ. 4
}
ÖÖ4 5
$str
ÖÖ5 8
{
ÖÖ8 9
Request
ÖÖ9 @
.
ÖÖ@ A
Host
ÖÖA E
}
ÖÖE F
{
ÖÖF G
Request
ÖÖG N
.
ÖÖN O
Path
ÖÖO S
}
ÖÖS T
"
ÖÖT U
)
ÖÖU V
;
ÖÖV W
string
ÜÜ 
Path
ÜÜ 
=
ÜÜ 
location
ÜÜ "
.
ÜÜ" #
AbsolutePath
ÜÜ# /
.
ÜÜ/ 0
Replace
ÜÜ0 7
(
ÜÜ7 8
this
ÜÜ8 <
.
ÜÜ< =
ControllerContext
ÜÜ= N
.
ÜÜN O
	RouteData
ÜÜO X
.
ÜÜX Y
Values
ÜÜY _
[
ÜÜ_ `
$str
ÜÜ` h
]
ÜÜh i
.
ÜÜi j
ToString
ÜÜj r
(
ÜÜr s
)
ÜÜs t
,
ÜÜt u
$str
ÜÜv }
)
ÜÜ} ~
;
ÜÜ~ 
if
áá 
(
áá 
!
áá 
accessSecurity
áá 
.
áá  
IsGetAccess
áá  +
(
áá+ ,
$str
áá, 0
+
áá1 2
Path
áá3 7
)
áá7 8
)
áá8 9
{
àà 
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( 3
,
ââ3 4
$str
ââ5 <
)
ââ< =
;
ââ= >
}
ää 
try
åå 
{
çç 
long
éé 
[
éé 
]
éé 
confirmedDeleteId
éé (
=
éé) *
Ids
éé+ .
.
éé. /
Split
éé/ 4
(
éé4 5
$char
éé5 8
)
éé8 9
.
éé9 :
Select
éé: @
(
éé@ A
long
ééA E
.
ééE F
Parse
ééF K
)
ééK L
.
ééL M
ToArray
ééM T
(
ééT U
)
ééU V
;
ééV W
List
êê 
<
êê +
TblNoticeOfDisbursementDetail
êê 2
>
êê2 3

Transaksis
êê4 >
=
êê? @
_context
êêA I
.
êêI J,
TblNoticeOfDisbursementDetails
êêJ h
.
êêh i
Where
êêi n
(
êên o
x
êêo p
=>
êêq s 
confirmedDeleteIdêêt Ö
.êêÖ Ü
ContainsêêÜ é
(êêé è
xêêè ê
.êêê ë
Idêêë ì
)êêì î
)êêî ï
.êêï ñ
ToListêêñ ú
(êêú ù
)êêù û
;êêû ü
for
ëë 
(
ëë 
int
ëë 
i
ëë 
=
ëë 
$num
ëë 
;
ëë 
i
ëë  !
<
ëë" #
confirmedDeleteId
ëë$ 5
.
ëë5 6
Length
ëë6 <
;
ëë< =
i
ëë> ?
++
ëë? A
)
ëëA B
{
íí 
if
ìì 
(
ìì 

Transaksis
ìì "
[
ìì" #
i
ìì# $
]
ìì$ %
.
ìì% & 
IdNodDetailFromApi
ìì& 8
!=
ìì9 ;
null
ìì< @
)
ìì@ A
{
îî %
TblNoticeOfDisbursement
ïï /
checkParent
ïï0 ;
=
ïï< =
_context
ïï> F
.
ïïF G&
TblNoticeOfDisbursements
ïïG _
.
ïï_ `
Where
ïï` e
(
ïïe f
x
ïïf g
=>
ïïh j
x
ïïk l
.
ïïl m
Id
ïïm o
==
ïïp r

Transaksis
ïïs }
[
ïï} ~
i
ïï~ 
]ïï Ä
.ïïÄ Å
NodIdïïÅ Ü
)ïïÜ á
.ïïá à
FirstOrDefaultïïà ñ
(ïïñ ó
)ïïó ò
;ïïò ô
var
óó "
jsonParseReturnCheck
óó 0
=
óó1 2
JsonConvert
óó3 >
.
óó> ?
DeserializeObject
óó? P
<
óóP Q!
ResultStatusDataInt
óóQ d
<
óód e!
ResultStatusDataNod
óóe x
>
óóx y
>
óóy z
(
óóz {
$str
óó{ }
)
óó} ~
;
óó~ 
var
òò 
urlCheck
òò $
=
òò% &
	GetConfig
òò' 0
.
òò0 1

AppSetting
òò1 ;
[
òò; <
$str
òò< M
]
òòM N
+
òòO P
	GetConfig
òòQ Z
.
òòZ [

AppSetting
òò[ e
[
òòe f
$str
òòf 
]òò Ä
+òòÅ Ç
checkParentòòÉ é
.òòé è
IdNodFromApiòòè õ
;òòõ ú
(
ôô 
bool
ôô 
resultApiCheck
ôô ,
,
ôô, -
string
ôô. 4
resultCheck
ôô5 @
)
ôô@ A
=
ôôB C
RequestToAPI
ôôD P
.
ôôP Q!
GetJsonStringWebApi
ôôQ d
(
ôôd e
urlCheck
ôôe m
,
ôôm n
null
ôôo s
)
ôôs t
;
ôôt u
if
öö 
(
öö 
resultApiCheck
öö *
&&
öö+ -
!
öö. /
string
öö/ 5
.
öö5 6
IsNullOrEmpty
öö6 C
(
ööC D
resultCheck
ööD O
)
ööO P
)
ööP Q
{
õõ "
jsonParseReturnCheck
úú 0
=
úú1 2
JsonConvert
úú3 >
.
úú> ?
DeserializeObject
úú? P
<
úúP Q!
ResultStatusDataInt
úúQ d
<
úúd e!
ResultStatusDataNod
úúe x
>
úúx y
>
úúy z
(
úúz {
resultCheckúú{ Ü
)úúÜ á
;úúá à
if
ùù 
(
ùù  "
jsonParseReturnCheck
ùù  4
.
ùù4 5

StatusCode
ùù5 ?
==
ùù@ B
$num
ùùC F
||
ùùG I"
jsonParseReturnCheck
ùùJ ^
.
ùù^ _

StatusCode
ùù_ i
==
ùùj l
$num
ùùm p
)
ùùp q
{
ûû 
if
üü  "
(
üü# $"
jsonParseReturnCheck
üü$ 8
.
üü8 9
Data
üü9 =
.
üü= >
Status
üü> D
==
üüE G
$str
üüH T
)
üüT U
{
††  !
var
°°$ '#
jsonParseReturnDelete
°°( =
=
°°> ?
JsonConvert
°°@ K
.
°°K L
DeserializeObject
°°L ]
<
°°] ^!
ResultStatusDataInt
°°^ q
<
°°q r"
ResultStatusDataNod°°r Ö
>°°Ö Ü
>°°Ü á
(°°á à
$str°°à ä
)°°ä ã
;°°ã å
var
¢¢$ '
	urlDelete
¢¢( 1
=
¢¢2 3
	GetConfig
¢¢4 =
.
¢¢= >

AppSetting
¢¢> H
[
¢¢H I
$str
¢¢I Z
]
¢¢Z [
+
¢¢\ ]
	GetConfig
¢¢^ g
.
¢¢g h

AppSetting
¢¢h r
[
¢¢r s
$str¢¢s ç
]¢¢ç é
+¢¢è ê

Transaksis¢¢ë õ
[¢¢õ ú
i¢¢ú ù
]¢¢ù û
.¢¢û ü"
IdNodDetailFromApi¢¢ü ±
;¢¢± ≤
(
££$ %
bool
££% )
resultApiDelete
££* 9
,
££9 :
string
££; A
resultDelete
££B N
)
££N O
=
££P Q
RequestToAPI
££R ^
.
££^ _#
DeleteRequestToWebApi
££_ t
(
££t u
	urlDelete
££u ~
,
££~ 
null££Ä Ñ
)££Ñ Ö
;££Ö Ü
if
§§$ &
(
§§' (
resultApiDelete
§§( 7
&&
§§8 :
!
§§; <
string
§§< B
.
§§B C
IsNullOrEmpty
§§C P
(
§§P Q
resultDelete
§§Q ]
)
§§] ^
)
§§^ _
{
••$ %#
jsonParseReturnDelete
¶¶( =
=
¶¶> ?
JsonConvert
¶¶@ K
.
¶¶K L
DeserializeObject
¶¶L ]
<
¶¶] ^!
ResultStatusDataInt
¶¶^ q
<
¶¶q r"
ResultStatusDataNod¶¶r Ö
>¶¶Ö Ü
>¶¶Ü á
(¶¶á à
resultDelete¶¶à î
)¶¶î ï
;¶¶ï ñ
if
ßß( *
(
ßß+ ,#
jsonParseReturnDelete
ßß, A
.
ßßA B

StatusCode
ßßB L
==
ßßM O
$num
ßßP S
||
ßßT V#
jsonParseReturnDelete
ßßW l
.
ßßl m

StatusCode
ßßm w
==
ßßx z
$num
ßß{ ~
)
ßß~ 
{
®®( )+
TblNoticeOfDisbursementDetail
©©, I
data
©©J N
=
©©O P
_context
©©Q Y
.
©©Y Z,
TblNoticeOfDisbursementDetails
©©Z x
.
©©x y
Find
©©y }
(
©©} ~

Transaksis©©~ à
[©©à â
i©©â ä
]©©ä ã
.©©ã å
Id©©å é
)©©é è
;©©è ê
data
™™, 0
.
™™0 1
IsActive
™™1 9
=
™™: ;
$num
™™< =
;
™™= >
data
´´, 0
.
´´0 1
	IsDeleted
´´1 :
=
´´; <
$num
´´= >
;
´´> ?
_context
¨¨, 4
.
¨¨4 5
Entry
¨¨5 :
(
¨¨: ;
data
¨¨; ?
)
¨¨? @
.
¨¨@ A
State
¨¨A F
=
¨¨G H
EntityState
¨¨I T
.
¨¨T U
Modified
¨¨U ]
;
¨¨] ^
_context
≠≠, 4
.
≠≠4 5
SaveChanges
≠≠5 @
(
≠≠@ A
)
≠≠A B
;
≠≠B C
}
ÆÆ( )
}
ØØ$ %
}
∞∞  !
else
±±  $
{
≤≤  !%
TblNoticeOfDisbursement
≥≥$ ;
data
≥≥< @
=
≥≥A B
_context
≥≥C K
.
≥≥K L&
TblNoticeOfDisbursements
≥≥L d
.
≥≥d e
Find
≥≥e i
(
≥≥i j
checkParent
≥≥j u
.
≥≥u v
IdNodFromApi≥≥v Ç
)≥≥Ç É
;≥≥É Ñ
data
¥¥$ (
.
¥¥( )
Status
¥¥) /
=
¥¥0 1"
jsonParseReturnCheck
¥¥2 F
.
¥¥F G
Data
¥¥G K
.
¥¥K L
Status
¥¥L R
;
¥¥R S
_context
µµ$ ,
.
µµ, -
Entry
µµ- 2
(
µµ2 3
data
µµ3 7
)
µµ7 8
.
µµ8 9
State
µµ9 >
=
µµ? @
EntityState
µµA L
.
µµL M
Modified
µµM U
;
µµU V
_context
∂∂$ ,
.
∂∂, -
SaveChanges
∂∂- 8
(
∂∂8 9
)
∂∂9 :
;
∂∂: ;
return
∏∏$ *
Content
∏∏+ 2
(
∏∏2 3
$str
∏∏3 H
)
∏∏H I
;
∏∏I J
}
ππ  !
}
∫∫ 
else
ªª  
{
ºº 
return
ΩΩ  &
Content
ΩΩ' .
(
ΩΩ. /
	GetConfig
ΩΩ/ 8
.
ΩΩ8 9

AppSetting
ΩΩ9 C
[
ΩΩC D
$str
ΩΩD _
]
ΩΩ_ `
)
ΩΩ` a
;
ΩΩa b
}
ææ 
}
øø 
}
¿¿ 
else
¡¡ 
{
¬¬ +
TblNoticeOfDisbursementDetail
√√ 5
data
√√6 :
=
√√; <
_context
√√= E
.
√√E F,
TblNoticeOfDisbursementDetails
√√F d
.
√√d e
Find
√√e i
(
√√i j

Transaksis
√√j t
[
√√t u
i
√√u v
]
√√v w
.
√√w x
Id
√√x z
)
√√z {
;
√√{ |
data
ƒƒ 
.
ƒƒ 
	IsDeleted
ƒƒ &
=
ƒƒ' (
$num
ƒƒ) *
;
ƒƒ* +
_context
≈≈  
.
≈≈  !
Entry
≈≈! &
(
≈≈& '
data
≈≈' +
)
≈≈+ ,
.
≈≈, -
State
≈≈- 2
=
≈≈3 4
EntityState
≈≈5 @
.
≈≈@ A
Modified
≈≈A I
;
≈≈I J
_context
∆∆  
.
∆∆  !
SaveChanges
∆∆! ,
(
∆∆, -
)
∆∆- .
;
∆∆. /
}
«« 
}
»» 
return
…… 
Content
…… 
(
…… 
$str
…… !
)
……! "
;
……" #
}
   
catch
ÀÀ 
{
ÃÃ 
return
ÕÕ 
Content
ÕÕ 
(
ÕÕ 
$str
ÕÕ &
)
ÕÕ& '
;
ÕÕ' (
}
ŒŒ 
}
œœ 	
public
–– 
ActionResult
–– 
DeleteFileNodTemp
–– -
(
––- .
string
––. 4
Ids
––5 8
)
––8 9
{
—— 	
if
““ 
(
““ 
!
““ 
lastSession
““ 
.
““ 
Update
““ #
(
““# $
)
““$ %
)
““% &
{
”” 
return
‘‘ 
RedirectToAction
‘‘ '
(
‘‘' (
$str
‘‘( /
,
‘‘/ 0
	GetConfig
‘‘1 :
.
‘‘: ;

AppSetting
‘‘; E
[
‘‘E F
$str
‘‘F n
]
‘‘n o
+
‘‘p q
$str
‘‘r y
,
‘‘y z
new
‘‘{ ~
{‘‘ Ä
a‘‘Å Ç
=‘‘É Ñ
true‘‘Ö â
}‘‘ä ã
)‘‘ã å
;‘‘å ç
}
’’ 
var
÷÷ 
location
÷÷ 
=
÷÷ 
new
÷÷ 
Uri
÷÷ "
(
÷÷" #
$"
÷÷# %
{
÷÷% &
Request
÷÷& -
.
÷÷- .
Scheme
÷÷. 4
}
÷÷4 5
$str
÷÷5 8
{
÷÷8 9
Request
÷÷9 @
.
÷÷@ A
Host
÷÷A E
}
÷÷E F
{
÷÷F G
Request
÷÷G N
.
÷÷N O
Path
÷÷O S
}
÷÷S T
"
÷÷T U
)
÷÷U V
;
÷÷V W
string
◊◊ 
Path
◊◊ 
=
◊◊ 
location
◊◊ "
.
◊◊" #
AbsolutePath
◊◊# /
.
◊◊/ 0
Replace
◊◊0 7
(
◊◊7 8
this
◊◊8 <
.
◊◊< =
ControllerContext
◊◊= N
.
◊◊N O
	RouteData
◊◊O X
.
◊◊X Y
Values
◊◊Y _
[
◊◊_ `
$str
◊◊` h
]
◊◊h i
.
◊◊i j
ToString
◊◊j r
(
◊◊r s
)
◊◊s t
,
◊◊t u
$str
◊◊v }
)
◊◊} ~
;
◊◊~ 
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
accessSecurity
ÿÿ 
.
ÿÿ  
IsGetAccess
ÿÿ  +
(
ÿÿ+ ,
$str
ÿÿ, 0
+
ÿÿ1 2
Path
ÿÿ3 7
)
ÿÿ7 8
)
ÿÿ8 9
{
ŸŸ 
return
⁄⁄ 
RedirectToAction
⁄⁄ '
(
⁄⁄' (
$str
⁄⁄( 3
,
⁄⁄3 4
$str
⁄⁄5 <
)
⁄⁄< =
;
⁄⁄= >
}
€€ 
try
›› 
{
ﬁﬁ 
long
ﬂﬂ 
[
ﬂﬂ 
]
ﬂﬂ 
confirmedDeleteId
ﬂﬂ (
=
ﬂﬂ) *
Ids
ﬂﬂ+ .
.
ﬂﬂ. /
Split
ﬂﬂ/ 4
(
ﬂﬂ4 5
$char
ﬂﬂ5 8
)
ﬂﬂ8 9
.
ﬂﬂ9 :
Select
ﬂﬂ: @
(
ﬂﬂ@ A
long
ﬂﬂA E
.
ﬂﬂE F
Parse
ﬂﬂF K
)
ﬂﬂK L
.
ﬂﬂL M
ToArray
ﬂﬂM T
(
ﬂﬂT U
)
ﬂﬂU V
;
ﬂﬂV W
List
·· 
<
·· "
TblFileUploadNodTemp
·· )
>
··) *

Transaksis
··+ 5
=
··6 7
_context
··8 @
.
··@ A#
TblFileUploadNodTemps
··A V
.
··V W
Where
··W \
(
··\ ]
x
··] ^
=>
··_ a
confirmedDeleteId
··b s
.
··s t
Contains
··t |
(
··| }
x
··} ~
.
··~ 
Id·· Å
)··Å Ç
)··Ç É
.··É Ñ
ToList··Ñ ä
(··ä ã
)··ã å
;··å ç
for
‚‚ 
(
‚‚ 
int
‚‚ 
i
‚‚ 
=
‚‚ 
$num
‚‚ 
;
‚‚ 
i
‚‚  !
<
‚‚" #
confirmedDeleteId
‚‚$ 5
.
‚‚5 6
Length
‚‚6 <
;
‚‚< =
i
‚‚> ?
++
‚‚? A
)
‚‚A B
{
„„ "
TblFileUploadNodTemp
‰‰ (
data
‰‰) -
=
‰‰. /
_context
‰‰0 8
.
‰‰8 9#
TblFileUploadNodTemps
‰‰9 N
.
‰‰N O
Find
‰‰O S
(
‰‰S T

Transaksis
‰‰T ^
[
‰‰^ _
i
‰‰_ `
]
‰‰` a
.
‰‰a b
Id
‰‰b d
)
‰‰d e
;
‰‰e f
data
ÂÂ 
.
ÂÂ 
	IsDeleted
ÂÂ "
=
ÂÂ# $
$num
ÂÂ% &
;
ÂÂ& '
if
ÊÊ 
(
ÊÊ 
System
ÊÊ 
.
ÊÊ 
IO
ÊÊ !
.
ÊÊ! "
File
ÊÊ" &
.
ÊÊ& '
Exists
ÊÊ' -
(
ÊÊ- .

Transaksis
ÊÊ. 8
[
ÊÊ8 9
i
ÊÊ9 :
]
ÊÊ: ;
.
ÊÊ; <
FilePath
ÊÊ< D
)
ÊÊD E
)
ÊÊE F
{
ÁÁ 
System
ËË 
.
ËË 
IO
ËË !
.
ËË! "
File
ËË" &
.
ËË& '
Delete
ËË' -
(
ËË- .

Transaksis
ËË. 8
[
ËË8 9
i
ËË9 :
]
ËË: ;
.
ËË; <
FilePath
ËË< D
)
ËËD E
;
ËËE F
}
ÈÈ 
_context
ÍÍ 
.
ÍÍ 
RemoveRange
ÍÍ (
(
ÍÍ( )
data
ÍÍ) -
)
ÍÍ- .
;
ÍÍ. /
_context
ÎÎ 
.
ÎÎ 
SaveChanges
ÎÎ (
(
ÎÎ( )
)
ÎÎ) *
;
ÎÎ* +
}
ÏÏ 
return
ÌÌ 
Content
ÌÌ 
(
ÌÌ 
$str
ÌÌ !
)
ÌÌ! "
;
ÌÌ" #
}
ÓÓ 
catch
ÔÔ 
{
 
return
ÒÒ 
Content
ÒÒ 
(
ÒÒ 
$str
ÒÒ &
)
ÒÒ& '
;
ÒÒ' (
}
ÚÚ 
}
ÛÛ 	
public
ÙÙ 
ActionResult
ÙÙ 
DeleteFileNod
ÙÙ )
(
ÙÙ) *
string
ÙÙ* 0
Ids
ÙÙ1 4
)
ÙÙ4 5
{
ıı 	
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
lastSession
ˆˆ 
.
ˆˆ 
Update
ˆˆ #
(
ˆˆ# $
)
ˆˆ$ %
)
ˆˆ% &
{
˜˜ 
return
¯¯ 
RedirectToAction
¯¯ '
(
¯¯' (
$str
¯¯( /
,
¯¯/ 0
	GetConfig
¯¯1 :
.
¯¯: ;

AppSetting
¯¯; E
[
¯¯E F
$str
¯¯F n
]
¯¯n o
+
¯¯p q
$str
¯¯r y
,
¯¯y z
new
¯¯{ ~
{¯¯ Ä
a¯¯Å Ç
=¯¯É Ñ
true¯¯Ö â
}¯¯ä ã
)¯¯ã å
;¯¯å ç
}
˘˘ 
var
˙˙ 
location
˙˙ 
=
˙˙ 
new
˙˙ 
Uri
˙˙ "
(
˙˙" #
$"
˙˙# %
{
˙˙% &
Request
˙˙& -
.
˙˙- .
Scheme
˙˙. 4
}
˙˙4 5
$str
˙˙5 8
{
˙˙8 9
Request
˙˙9 @
.
˙˙@ A
Host
˙˙A E
}
˙˙E F
{
˙˙F G
Request
˙˙G N
.
˙˙N O
Path
˙˙O S
}
˙˙S T
"
˙˙T U
)
˙˙U V
;
˙˙V W
string
˚˚ 
Path
˚˚ 
=
˚˚ 
location
˚˚ "
.
˚˚" #
AbsolutePath
˚˚# /
.
˚˚/ 0
Replace
˚˚0 7
(
˚˚7 8
this
˚˚8 <
.
˚˚< =
ControllerContext
˚˚= N
.
˚˚N O
	RouteData
˚˚O X
.
˚˚X Y
Values
˚˚Y _
[
˚˚_ `
$str
˚˚` h
]
˚˚h i
.
˚˚i j
ToString
˚˚j r
(
˚˚r s
)
˚˚s t
,
˚˚t u
$str
˚˚v }
)
˚˚} ~
;
˚˚~ 
if
¸¸ 
(
¸¸ 
!
¸¸ 
accessSecurity
¸¸ 
.
¸¸  
IsGetAccess
¸¸  +
(
¸¸+ ,
$str
¸¸, 0
+
¸¸1 2
Path
¸¸3 7
)
¸¸7 8
)
¸¸8 9
{
˝˝ 
return
˛˛ 
RedirectToAction
˛˛ '
(
˛˛' (
$str
˛˛( 3
,
˛˛3 4
$str
˛˛5 <
)
˛˛< =
;
˛˛= >
}
ˇˇ 
try
ÅÅ 
{
ÇÇ 
long
ÉÉ 
[
ÉÉ 
]
ÉÉ 
confirmedDeleteId
ÉÉ (
=
ÉÉ) *
Ids
ÉÉ+ .
.
ÉÉ. /
Split
ÉÉ/ 4
(
ÉÉ4 5
$char
ÉÉ5 8
)
ÉÉ8 9
.
ÉÉ9 :
Select
ÉÉ: @
(
ÉÉ@ A
long
ÉÉA E
.
ÉÉE F
Parse
ÉÉF K
)
ÉÉK L
.
ÉÉL M
ToArray
ÉÉM T
(
ÉÉT U
)
ÉÉU V
;
ÉÉV W
List
ÖÖ 
<
ÖÖ 
TblFileUploadNod
ÖÖ %
>
ÖÖ% &

Transaksis
ÖÖ' 1
=
ÖÖ2 3
_context
ÖÖ4 <
.
ÖÖ< =
TblFileUploadNods
ÖÖ= N
.
ÖÖN O
Where
ÖÖO T
(
ÖÖT U
x
ÖÖU V
=>
ÖÖW Y
confirmedDeleteId
ÖÖZ k
.
ÖÖk l
Contains
ÖÖl t
(
ÖÖt u
x
ÖÖu v
.
ÖÖv w
Id
ÖÖw y
)
ÖÖy z
)
ÖÖz {
.
ÖÖ{ |
ToListÖÖ| Ç
(ÖÖÇ É
)ÖÖÉ Ñ
;ÖÖÑ Ö
for
ÜÜ 
(
ÜÜ 
int
ÜÜ 
i
ÜÜ 
=
ÜÜ 
$num
ÜÜ 
;
ÜÜ 
i
ÜÜ  !
<
ÜÜ" #
confirmedDeleteId
ÜÜ$ 5
.
ÜÜ5 6
Length
ÜÜ6 <
;
ÜÜ< =
i
ÜÜ> ?
++
ÜÜ? A
)
ÜÜA B
{
áá 
if
àà 
(
àà 

Transaksis
àà "
[
àà" #
i
àà# $
]
àà$ %
.
àà% &
IdFileFromApi
àà& 3
!=
àà4 6
null
àà7 ;
)
àà; <
{
ââ %
TblNoticeOfDisbursement
ää /
checkParent
ää0 ;
=
ää< =
_context
ää> F
.
ääF G&
TblNoticeOfDisbursements
ääG _
.
ää_ `
Where
ää` e
(
ääe f
x
ääf g
=>
ääh j
x
ääk l
.
ääl m
Id
ääm o
==
ääp r

Transaksis
ääs }
[
ää} ~
i
ää~ 
]ää Ä
.ääÄ Å
IdNodääÅ Ü
)ääÜ á
.ääá à
FirstOrDefaultääà ñ
(ääñ ó
)ääó ò
;ääò ô
var
åå "
jsonParseReturnCheck
åå 0
=
åå1 2
JsonConvert
åå3 >
.
åå> ?
DeserializeObject
åå? P
<
ååP Q!
ResultStatusDataInt
ååQ d
<
ååd e!
ResultStatusDataNod
ååe x
>
ååx y
>
ååy z
(
ååz {
$str
åå{ }
)
åå} ~
;
åå~ 
var
çç 
urlCheck
çç $
=
çç% &
	GetConfig
çç' 0
.
çç0 1

AppSetting
çç1 ;
[
çç; <
$str
çç< M
]
ççM N
+
ççO P
	GetConfig
ççQ Z
.
ççZ [

AppSetting
çç[ e
[
ççe f
$str
ççf 
]çç Ä
+ççÅ Ç
checkParentççÉ é
.ççé è
IdNodFromApiççè õ
;ççõ ú
(
éé 
bool
éé 
resultApiCheck
éé ,
,
éé, -
string
éé. 4
resultCheck
éé5 @
)
éé@ A
=
ééB C
RequestToAPI
ééD P
.
ééP Q!
GetJsonStringWebApi
ééQ d
(
ééd e
urlCheck
éée m
,
éém n
null
ééo s
)
éés t
;
éét u
if
èè 
(
èè 
resultApiCheck
èè *
&&
èè+ -
!
èè. /
string
èè/ 5
.
èè5 6
IsNullOrEmpty
èè6 C
(
èèC D
resultCheck
èèD O
)
èèO P
)
èèP Q
{
êê "
jsonParseReturnCheck
ëë 0
=
ëë1 2
JsonConvert
ëë3 >
.
ëë> ?
DeserializeObject
ëë? P
<
ëëP Q!
ResultStatusDataInt
ëëQ d
<
ëëd e!
ResultStatusDataNod
ëëe x
>
ëëx y
>
ëëy z
(
ëëz {
resultCheckëë{ Ü
)ëëÜ á
;ëëá à
if
íí 
(
íí  "
jsonParseReturnCheck
íí  4
.
íí4 5

StatusCode
íí5 ?
==
íí@ B
$num
ííC F
||
ííG I"
jsonParseReturnCheck
ííJ ^
.
íí^ _

StatusCode
íí_ i
==
ííj l
$num
íím p
)
ííp q
{
ìì 
if
îî  "
(
îî# $"
jsonParseReturnCheck
îî$ 8
.
îî8 9
Data
îî9 =
.
îî= >
Status
îî> D
==
îîE G
$str
îîH T
)
îîT U
{
ïï  !
var
ññ$ '#
jsonParseReturnDelete
ññ( =
=
ññ> ?
JsonConvert
ññ@ K
.
ññK L
DeserializeObject
ññL ]
<
ññ] ^!
ResultStatusDataInt
ññ^ q
<
ññq r"
ResultStatusDataNodññr Ö
>ññÖ Ü
>ññÜ á
(ññá à
$strññà ä
)ññä ã
;ññã å
var
óó$ '
	urlDelete
óó( 1
=
óó2 3
	GetConfig
óó4 =
.
óó= >

AppSetting
óó> H
[
óóH I
$str
óóI Z
]
óóZ [
+
óó\ ]
	GetConfig
óó^ g
.
óóg h

AppSetting
óóh r
[
óór s
$stróós à
]óóà â
+óóä ã

Transaksisóóå ñ
[óóñ ó
ióóó ò
]óóò ô
.óóô ö
IdFileFromApióóö ß
;óóß ®
(
òò$ %
bool
òò% )
resultApiDelete
òò* 9
,
òò9 :
string
òò; A
resultDelete
òòB N
)
òòN O
=
òòP Q
RequestToAPI
òòR ^
.
òò^ _#
DeleteRequestToWebApi
òò_ t
(
òòt u
	urlDelete
òòu ~
,
òò~ 
nullòòÄ Ñ
)òòÑ Ö
;òòÖ Ü
if
ôô$ &
(
ôô' (
resultApiDelete
ôô( 7
&&
ôô8 :
!
ôô; <
string
ôô< B
.
ôôB C
IsNullOrEmpty
ôôC P
(
ôôP Q
resultDelete
ôôQ ]
)
ôô] ^
)
ôô^ _
{
öö$ %#
jsonParseReturnDelete
õõ( =
=
õõ> ?
JsonConvert
õõ@ K
.
õõK L
DeserializeObject
õõL ]
<
õõ] ^!
ResultStatusDataInt
õõ^ q
<
õõq r"
ResultStatusDataNodõõr Ö
>õõÖ Ü
>õõÜ á
(õõá à
resultDeleteõõà î
)õõî ï
;õõï ñ
if
úú( *
(
úú+ ,#
jsonParseReturnDelete
úú, A
.
úúA B

StatusCode
úúB L
==
úúM O
$num
úúP S
||
úúT V#
jsonParseReturnDelete
úúW l
.
úúl m

StatusCode
úúm w
==
úúx z
$num
úú{ ~
)
úú~ 
{
ùù( )
TblFileUploadNod
ûû, <
data
ûû= A
=
ûûB C
_context
ûûD L
.
ûûL M
TblFileUploadNods
ûûM ^
.
ûû^ _
Find
ûû_ c
(
ûûc d

Transaksis
ûûd n
[
ûûn o
i
ûûo p
]
ûûp q
.
ûûq r
Id
ûûr t
)
ûût u
;
ûûu v
data
üü, 0
.
üü0 1
IsActive
üü1 9
=
üü: ;
$num
üü< =
;
üü= >
data
††, 0
.
††0 1
	IsDeleted
††1 :
=
††; <
$num
††= >
;
††> ?
if
°°, .
(
°°/ 0
System
°°0 6
.
°°6 7
IO
°°7 9
.
°°9 :
File
°°: >
.
°°> ?
Exists
°°? E
(
°°E F

Transaksis
°°F P
[
°°P Q
i
°°Q R
]
°°R S
.
°°S T
FilePath
°°T \
)
°°\ ]
)
°°] ^
{
¢¢, -
System
££0 6
.
££6 7
IO
££7 9
.
££9 :
File
££: >
.
££> ?
Delete
££? E
(
££E F

Transaksis
££F P
[
££P Q
i
££Q R
]
££R S
.
££S T
FilePath
££T \
)
££\ ]
;
££] ^
}
§§, -
_context
••, 4
.
••4 5
Entry
••5 :
(
••: ;
data
••; ?
)
••? @
.
••@ A
State
••A F
=
••G H
EntityState
••I T
.
••T U
Modified
••U ]
;
••] ^
_context
¶¶, 4
.
¶¶4 5
SaveChanges
¶¶5 @
(
¶¶@ A
)
¶¶A B
;
¶¶B C
}
ßß( )
}
®®$ %
if
™™$ &
(
™™' (
resultApiDelete
™™( 7
)
™™7 8
{
´´$ %
TblFileUploadNod
¨¨( 8
data
¨¨9 =
=
¨¨> ?
_context
¨¨@ H
.
¨¨H I
TblFileUploadNods
¨¨I Z
.
¨¨Z [
Find
¨¨[ _
(
¨¨_ `

Transaksis
¨¨` j
[
¨¨j k
i
¨¨k l
]
¨¨l m
.
¨¨m n
Id
¨¨n p
)
¨¨p q
;
¨¨q r
data
≠≠( ,
.
≠≠, -
IsActive
≠≠- 5
=
≠≠6 7
$num
≠≠8 9
;
≠≠9 :
data
ÆÆ( ,
.
ÆÆ, -
	IsDeleted
ÆÆ- 6
=
ÆÆ7 8
$num
ÆÆ9 :
;
ÆÆ: ;
if
ØØ( *
(
ØØ+ ,
System
ØØ, 2
.
ØØ2 3
IO
ØØ3 5
.
ØØ5 6
File
ØØ6 :
.
ØØ: ;
Exists
ØØ; A
(
ØØA B

Transaksis
ØØB L
[
ØØL M
i
ØØM N
]
ØØN O
.
ØØO P
FilePath
ØØP X
)
ØØX Y
)
ØØY Z
{
∞∞( )
System
±±, 2
.
±±2 3
IO
±±3 5
.
±±5 6
File
±±6 :
.
±±: ;
Delete
±±; A
(
±±A B

Transaksis
±±B L
[
±±L M
i
±±M N
]
±±N O
.
±±O P
FilePath
±±P X
)
±±X Y
;
±±Y Z
}
≤≤( )
_context
≥≥( 0
.
≥≥0 1
Entry
≥≥1 6
(
≥≥6 7
data
≥≥7 ;
)
≥≥; <
.
≥≥< =
State
≥≥= B
=
≥≥C D
EntityState
≥≥E P
.
≥≥P Q
Modified
≥≥Q Y
;
≥≥Y Z
_context
¥¥( 0
.
¥¥0 1
SaveChanges
¥¥1 <
(
¥¥< =
)
¥¥= >
;
¥¥> ?
}
µµ$ %
}
∂∂  !
else
∑∑  $
{
∏∏  !
var
ππ$ '#
jsonParseReturnDelete
ππ( =
=
ππ> ?
JsonConvert
ππ@ K
.
ππK L
DeserializeObject
ππL ]
<
ππ] ^!
ResultStatusDataInt
ππ^ q
<
ππq r"
ResultStatusDataNodππr Ö
>ππÖ Ü
>ππÜ á
(ππá à
$strππà ä
)ππä ã
;ππã å
var
∫∫$ '
	urlDelete
∫∫( 1
=
∫∫2 3
	GetConfig
∫∫4 =
.
∫∫= >

AppSetting
∫∫> H
[
∫∫H I
$str
∫∫I Z
]
∫∫Z [
+
∫∫\ ]
	GetConfig
∫∫^ g
.
∫∫g h

AppSetting
∫∫h r
[
∫∫r s
$str∫∫s à
]∫∫à â
+∫∫ä ã

Transaksis∫∫å ñ
[∫∫ñ ó
i∫∫ó ò
]∫∫ò ô
.∫∫ô ö
IdFileFromApi∫∫ö ß
;∫∫ß ®
(
ªª$ %
bool
ªª% )
resultApiDelete
ªª* 9
,
ªª9 :
string
ªª; A
resultDelete
ªªB N
)
ªªN O
=
ªªP Q
RequestToAPI
ªªR ^
.
ªª^ _#
DeleteRequestToWebApi
ªª_ t
(
ªªt u
	urlDelete
ªªu ~
,
ªª~ 
nullªªÄ Ñ
)ªªÑ Ö
;ªªÖ Ü
if
ºº$ &
(
ºº' (
resultApiDelete
ºº( 7
&&
ºº8 :
!
ºº; <
string
ºº< B
.
ººB C
IsNullOrEmpty
ººC P
(
ººP Q
resultDelete
ººQ ]
)
ºº] ^
)
ºº^ _
{
ΩΩ$ %#
jsonParseReturnDelete
ææ( =
=
ææ> ?
JsonConvert
ææ@ K
.
ææK L
DeserializeObject
ææL ]
<
ææ] ^!
ResultStatusDataInt
ææ^ q
<
ææq r"
ResultStatusDataNodæær Ö
>ææÖ Ü
>ææÜ á
(ææá à
resultDeleteææà î
)ææî ï
;ææï ñ
if
øø( *
(
øø+ ,#
jsonParseReturnDelete
øø, A
.
øøA B

StatusCode
øøB L
==
øøM O
$num
øøP S
||
øøT V#
jsonParseReturnDelete
øøW l
.
øøl m

StatusCode
øøm w
==
øøx z
$num
øø{ ~
)
øø~ 
{
¿¿( )
TblFileUploadNod
¡¡, <
data
¡¡= A
=
¡¡B C
_context
¡¡D L
.
¡¡L M
TblFileUploadNods
¡¡M ^
.
¡¡^ _
Find
¡¡_ c
(
¡¡c d

Transaksis
¡¡d n
[
¡¡n o
i
¡¡o p
]
¡¡p q
.
¡¡q r
Id
¡¡r t
)
¡¡t u
;
¡¡u v
data
¬¬, 0
.
¬¬0 1
IsActive
¬¬1 9
=
¬¬: ;
$num
¬¬< =
;
¬¬= >
data
√√, 0
.
√√0 1
	IsDeleted
√√1 :
=
√√; <
$num
√√= >
;
√√> ?
if
ƒƒ, .
(
ƒƒ/ 0
System
ƒƒ0 6
.
ƒƒ6 7
IO
ƒƒ7 9
.
ƒƒ9 :
File
ƒƒ: >
.
ƒƒ> ?
Exists
ƒƒ? E
(
ƒƒE F

Transaksis
ƒƒF P
[
ƒƒP Q
i
ƒƒQ R
]
ƒƒR S
.
ƒƒS T
FilePath
ƒƒT \
)
ƒƒ\ ]
)
ƒƒ] ^
{
≈≈, -
System
∆∆0 6
.
∆∆6 7
IO
∆∆7 9
.
∆∆9 :
File
∆∆: >
.
∆∆> ?
Delete
∆∆? E
(
∆∆E F

Transaksis
∆∆F P
[
∆∆P Q
i
∆∆Q R
]
∆∆R S
.
∆∆S T
FilePath
∆∆T \
)
∆∆\ ]
;
∆∆] ^
}
««, -
_context
»», 4
.
»»4 5
Entry
»»5 :
(
»»: ;
data
»»; ?
)
»»? @
.
»»@ A
State
»»A F
=
»»G H
EntityState
»»I T
.
»»T U
Modified
»»U ]
;
»»] ^
_context
……, 4
.
……4 5
SaveChanges
……5 @
(
……@ A
)
……A B
;
……B C
}
  ( )
}
ÀÀ$ %
if
ÕÕ$ &
(
ÕÕ' (
resultApiDelete
ÕÕ( 7
)
ÕÕ7 8
{
ŒŒ$ %
TblFileUploadNod
œœ( 8
data
œœ9 =
=
œœ> ?
_context
œœ@ H
.
œœH I
TblFileUploadNods
œœI Z
.
œœZ [
Find
œœ[ _
(
œœ_ `

Transaksis
œœ` j
[
œœj k
i
œœk l
]
œœl m
.
œœm n
Id
œœn p
)
œœp q
;
œœq r
data
––( ,
.
––, -
IsActive
––- 5
=
––6 7
$num
––8 9
;
––9 :
data
——( ,
.
——, -
	IsDeleted
——- 6
=
——7 8
$num
——9 :
;
——: ;
if
““( *
(
““+ ,
System
““, 2
.
““2 3
IO
““3 5
.
““5 6
File
““6 :
.
““: ;
Exists
““; A
(
““A B

Transaksis
““B L
[
““L M
i
““M N
]
““N O
.
““O P
FilePath
““P X
)
““X Y
)
““Y Z
{
””( )
System
‘‘, 2
.
‘‘2 3
IO
‘‘3 5
.
‘‘5 6
File
‘‘6 :
.
‘‘: ;
Delete
‘‘; A
(
‘‘A B

Transaksis
‘‘B L
[
‘‘L M
i
‘‘M N
]
‘‘N O
.
‘‘O P
FilePath
‘‘P X
)
‘‘X Y
;
‘‘Y Z
}
’’( )
_context
÷÷( 0
.
÷÷0 1
Entry
÷÷1 6
(
÷÷6 7
data
÷÷7 ;
)
÷÷; <
.
÷÷< =
State
÷÷= B
=
÷÷C D
EntityState
÷÷E P
.
÷÷P Q
Modified
÷÷Q Y
;
÷÷Y Z
_context
◊◊( 0
.
◊◊0 1
SaveChanges
◊◊1 <
(
◊◊< =
)
◊◊= >
;
◊◊> ?
}
ÿÿ$ %
}
‡‡  !
}
·· 
else
‚‚  
{
„„ 
return
‰‰  &
Content
‰‰' .
(
‰‰. /
	GetConfig
‰‰/ 8
.
‰‰8 9

AppSetting
‰‰9 C
[
‰‰C D
$str
‰‰D _
]
‰‰_ `
)
‰‰` a
;
‰‰a b
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 
else
ËË 
{
ÈÈ 
TblFileUploadNod
ÍÍ (
data
ÍÍ) -
=
ÍÍ. /
_context
ÍÍ0 8
.
ÍÍ8 9
TblFileUploadNods
ÍÍ9 J
.
ÍÍJ K
Find
ÍÍK O
(
ÍÍO P

Transaksis
ÍÍP Z
[
ÍÍZ [
i
ÍÍ[ \
]
ÍÍ\ ]
.
ÍÍ] ^
Id
ÍÍ^ `
)
ÍÍ` a
;
ÍÍa b
data
ÎÎ 
.
ÎÎ 
	IsDeleted
ÎÎ &
=
ÎÎ' (
$num
ÎÎ) *
;
ÎÎ* +
if
ÏÏ 
(
ÏÏ 
System
ÏÏ "
.
ÏÏ" #
IO
ÏÏ# %
.
ÏÏ% &
File
ÏÏ& *
.
ÏÏ* +
Exists
ÏÏ+ 1
(
ÏÏ1 2

Transaksis
ÏÏ2 <
[
ÏÏ< =
i
ÏÏ= >
]
ÏÏ> ?
.
ÏÏ? @
FilePath
ÏÏ@ H
)
ÏÏH I
)
ÏÏI J
{
ÌÌ 
System
ÓÓ "
.
ÓÓ" #
IO
ÓÓ# %
.
ÓÓ% &
File
ÓÓ& *
.
ÓÓ* +
Delete
ÓÓ+ 1
(
ÓÓ1 2

Transaksis
ÓÓ2 <
[
ÓÓ< =
i
ÓÓ= >
]
ÓÓ> ?
.
ÓÓ? @
FilePath
ÓÓ@ H
)
ÓÓH I
;
ÓÓI J
}
ÔÔ 
_context
  
.
  !
Entry
! &
(
& '
data
' +
)
+ ,
.
, -
State
- 2
=
3 4
EntityState
5 @
.
@ A
Modified
A I
;
I J
_context
ÒÒ  
.
ÒÒ  !
SaveChanges
ÒÒ! ,
(
ÒÒ, -
)
ÒÒ- .
;
ÒÒ. /
}
ÚÚ 
}
ÛÛ 
return
ÙÙ 
Content
ÙÙ 
(
ÙÙ 
$str
ÙÙ !
)
ÙÙ! "
;
ÙÙ" #
}
ıı 
catch
ˆˆ 
{
˜˜ 
return
¯¯ 
Content
¯¯ 
(
¯¯ 
$str
¯¯ &
)
¯¯& '
;
¯¯' (
}
˘˘ 
}
˙˙ 	
[
ˇˇ 	
HttpPost
ˇˇ	 
]
ˇˇ 
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
IActionResult
ÄÄ '
>
ÄÄ' (

SendToDeva
ÄÄ) 3
(
ÄÄ3 4
string
ÄÄ4 :
Ids
ÄÄ; >
)
ÄÄ> ?
{
ÅÅ 	
if
ÇÇ 
(
ÇÇ 
!
ÇÇ 
lastSession
ÇÇ 
.
ÇÇ 
Update
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
)
ÇÇ% &
{
ÉÉ 
return
ÑÑ 
RedirectToAction
ÑÑ '
(
ÑÑ' (
$str
ÑÑ( /
,
ÑÑ/ 0
	GetConfig
ÑÑ1 :
.
ÑÑ: ;

AppSetting
ÑÑ; E
[
ÑÑE F
$str
ÑÑF n
]
ÑÑn o
+
ÑÑp q
$str
ÑÑr y
,
ÑÑy z
new
ÑÑ{ ~
{ÑÑ Ä
aÑÑÅ Ç
=ÑÑÉ Ñ
trueÑÑÖ â
}ÑÑä ã
)ÑÑã å
;ÑÑå ç
}
ÖÖ 
var
ÜÜ 
location
ÜÜ 
=
ÜÜ 
new
ÜÜ 
Uri
ÜÜ "
(
ÜÜ" #
$"
ÜÜ# %
{
ÜÜ% &
Request
ÜÜ& -
.
ÜÜ- .
Scheme
ÜÜ. 4
}
ÜÜ4 5
$str
ÜÜ5 8
{
ÜÜ8 9
Request
ÜÜ9 @
.
ÜÜ@ A
Host
ÜÜA E
}
ÜÜE F
{
ÜÜF G
Request
ÜÜG N
.
ÜÜN O
Path
ÜÜO S
}
ÜÜS T
"
ÜÜT U
)
ÜÜU V
;
ÜÜV W
string
áá 
path
áá 
=
áá 
location
áá "
.
áá" #
AbsolutePath
áá# /
.
áá/ 0
Replace
áá0 7
(
áá7 8
this
áá8 <
.
áá< =
ControllerContext
áá= N
.
ááN O
	RouteData
ááO X
.
ááX Y
Values
ááY _
[
áá_ `
$str
áá` h
]
ááh i
.
áái j
ToString
ááj r
(
áár s
)
áás t
,
áát u
$str
ááv }
)
áá} ~
;
áá~ 
if
àà 
(
àà 
!
àà 
accessSecurity
àà 
.
àà  
IsGetAccess
àà  +
(
àà+ ,
$str
àà, 0
+
àà1 2
path
àà3 7
)
àà7 8
)
àà8 9
{
ââ 
return
ää 
RedirectToAction
ää '
(
ää' (
$str
ää( 3
,
ää3 4
$str
ää5 <
)
ää< =
;
ää= >
}
ãã 
try
çç 
{
éé 
var
èè 
regex
èè 
=
èè 
await
èè !
RegexRequest
èè" .
.
èè. /
RegexValidation
èè/ >
(
èè> ?
Ids
èè? B
)
èèB C
;
èèC D
if
êê 
(
êê 
!
êê 
regex
êê 
)
êê 
{
ëë 
return
íí 
Content
íí "
(
íí" #
$str
íí# 1
)
íí1 2
;
íí2 3
}
ìì 
var
ïï 
send
ïï 
=
ïï 
new
ïï 

SendToDeva
ïï )
(
ïï) *

_converter
ïï* 4
)
ïï4 5
;
ïï5 6
Task
ññ 
.
ññ 
Run
ññ 
(
ññ 
(
ññ 
)
ññ 
=>
ññ 
send
ññ #
.
ññ# $
SendToDevaNod
ññ$ 1
(
ññ1 2
Ids
ññ2 5
)
ññ5 6
)
ññ6 7
;
ññ7 8
return
óó 
Content
óó 
(
óó 
$str
óó s
)
óós t
;
óót u
}
òò 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
öö 
return
õõ 
Content
õõ 
(
õõ 
$str
õõ 9
)
õõ9 :
;
õõ: ;
}
úú 
}
ùù 	
[
†† 	
HttpPost
††	 
]
†† 
public
°° 
async
°° 
Task
°° 
<
°° 
ActionResult
°° &
>
°°& '
SendToDevaOld
°°( 5
(
°°5 6
string
°°6 <
Ids
°°= @
)
°°@ A
{
¢¢ 	
if
££ 
(
££ 
!
££ 
lastSession
££ 
.
££ 
Update
££ #
(
££# $
)
££$ %
)
££% &
{
§§ 
return
•• 
RedirectToAction
•• '
(
••' (
$str
••( /
,
••/ 0
	GetConfig
••1 :
.
••: ;

AppSetting
••; E
[
••E F
$str
••F n
]
••n o
+
••p q
$str
••r y
,
••y z
new
••{ ~
{•• Ä
a••Å Ç
=••É Ñ
true••Ö â
}••ä ã
)••ã å
;••å ç
}
¶¶ 
var
ßß 
location
ßß 
=
ßß 
new
ßß 
Uri
ßß "
(
ßß" #
$"
ßß# %
{
ßß% &
Request
ßß& -
.
ßß- .
Scheme
ßß. 4
}
ßß4 5
$str
ßß5 8
{
ßß8 9
Request
ßß9 @
.
ßß@ A
Host
ßßA E
}
ßßE F
{
ßßF G
Request
ßßG N
.
ßßN O
Path
ßßO S
}
ßßS T
"
ßßT U
)
ßßU V
;
ßßV W
string
®® 
Patha
®® 
=
®® 
location
®® #
.
®®# $
AbsolutePath
®®$ 0
.
®®0 1
Replace
®®1 8
(
®®8 9
this
®®9 =
.
®®= >
ControllerContext
®®> O
.
®®O P
	RouteData
®®P Y
.
®®Y Z
Values
®®Z `
[
®®` a
$str
®®a i
]
®®i j
.
®®j k
ToString
®®k s
(
®®s t
)
®®t u
,
®®u v
$str
®®w ~
)
®®~ 
;®® Ä
if
©© 
(
©© 
!
©© 
accessSecurity
©© 
.
©©  
IsGetAccess
©©  +
(
©©+ ,
$str
©©, 0
+
©©1 2
Patha
©©3 8
)
©©8 9
)
©©9 :
{
™™ 
return
´´ 
RedirectToAction
´´ '
(
´´' (
$str
´´( 3
,
´´3 4
$str
´´5 <
)
´´< =
;
´´= >
}
¨¨ 
try
ÆÆ 
{
ØØ 
string
∞∞ 
[
∞∞ 
]
∞∞ 
ArrayIds
∞∞ !
=
∞∞" #
Ids
∞∞$ '
.
∞∞' (
Split
∞∞( -
(
∞∞- .
$char
∞∞. 1
)
∞∞1 2
;
∞∞2 3
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
item
≤≤ !
in
≤≤" $
ArrayIds
≤≤% -
)
≤≤- .
{
≥≥ %
TblNoticeOfDisbursement
¥¥ +

dataAssign
¥¥, 6
=
¥¥7 8
_context
¥¥9 A
.
¥¥A B&
TblNoticeOfDisbursements
¥¥B Z
.
¥¥Z [
Where
¥¥[ `
(
¥¥` a
m
¥¥a b
=>
¥¥c e
m
¥¥f g
.
¥¥g h
Id
¥¥h j
==
¥¥k m
int
¥¥n q
.
¥¥q r
Parse
¥¥r w
(
¥¥w x
item
¥¥x |
)
¥¥| }
&&¥¥~ Ä
m¥¥Å Ç
.¥¥Ç É
	IsDeleted¥¥É å
==¥¥ç è
$num¥¥ê ë
)¥¥ë í
.¥¥í ì
FirstOrDefault¥¥ì °
(¥¥° ¢
)¥¥¢ £
;¥¥£ §2
$NoticeOfDisbursementToAPI_ViewModels
∂∂ 8
model
∂∂9 >
=
∂∂? @
new
∂∂A D2
$NoticeOfDisbursementToAPI_ViewModels
∂∂E i
(
∂∂i j
)
∂∂j k
;
∂∂k l
model
∑∑ 
.
∑∑ 
NodNo
∑∑ 
=
∑∑  !

dataAssign
∑∑" ,
.
∑∑, -
NodNo
∑∑- 2
;
∑∑2 3
model
∏∏ 
.
∏∏ 
NodDate
∏∏ !
=
∏∏" #

dataAssign
∏∏$ .
.
∏∏. /
NodDate
∏∏/ 6
;
∏∏6 7
model
ππ 
.
ππ 
	ValueDate
ππ #
=
ππ$ %

dataAssign
ππ& 0
.
ππ0 1
	ValueDate
ππ1 :
;
ππ: ;
model
∫∫ 
.
∫∫ 
Cur
∫∫ 
=
∫∫ 

dataAssign
∫∫  *
.
∫∫* +
Cur
∫∫+ .
;
∫∫. /
model
ªª 
.
ªª 
	NodDetail
ªª #
=
ªª$ %
_context
ªª& .
.
ªª. /,
TblNoticeOfDisbursementDetails
ªª/ M
.
ªªM N
Where
ªªN S
(
ªªS T
m
ªªT U
=>
ªªV X
m
ªªY Z
.
ªªZ [
NodId
ªª[ `
==
ªªa c
int
ªªd g
.
ªªg h
Parse
ªªh m
(
ªªm n
item
ªªn r
)
ªªr s
&&
ªªt v
m
ªªw x
.
ªªx y
	IsDeletedªªy Ç
==ªªÉ Ö
$numªªÜ á
)ªªá à
.ªªà â
ToListªªâ è
(ªªè ê
)ªªê ë
;ªªë í
if
ææ 
(
ææ 

dataAssign
ææ "
.
ææ" #
IdNodFromApi
ææ# /
!=
ææ0 2
null
ææ3 7
)
ææ7 8
{
øø 
var
¿¿ "
jsonParseReturnCheck
¿¿ 0
=
¿¿1 2
JsonConvert
¿¿3 >
.
¿¿> ?
DeserializeObject
¿¿? P
<
¿¿P Q!
ResultStatusDataInt
¿¿Q d
<
¿¿d e!
ResultStatusDataNod
¿¿e x
>
¿¿x y
>
¿¿y z
(
¿¿z {
$str
¿¿{ }
)
¿¿} ~
;
¿¿~ 
var
¡¡ 
urlCheck
¡¡ $
=
¡¡% &
	GetConfig
¡¡' 0
.
¡¡0 1

AppSetting
¡¡1 ;
[
¡¡; <
$str
¡¡< M
]
¡¡M N
+
¡¡O P
	GetConfig
¡¡Q Z
.
¡¡Z [

AppSetting
¡¡[ e
[
¡¡e f
$str
¡¡f 
]¡¡ Ä
+¡¡Å Ç

dataAssign¡¡É ç
.¡¡ç é
IdNodFromApi¡¡é ö
;¡¡ö õ
(
¬¬ 
bool
¬¬ 
resultApiCheck
¬¬ ,
,
¬¬, -
string
¬¬. 4
resultCheck
¬¬5 @
)
¬¬@ A
=
¬¬B C
RequestToAPI
¬¬D P
.
¬¬P Q!
GetJsonStringWebApi
¬¬Q d
(
¬¬d e
urlCheck
¬¬e m
,
¬¬m n
null
¬¬o s
)
¬¬s t
;
¬¬t u
if
√√ 
(
√√ 
resultApiCheck
√√ *
&&
√√+ -
!
√√. /
string
√√/ 5
.
√√5 6
IsNullOrEmpty
√√6 C
(
√√C D
resultCheck
√√D O
)
√√O P
)
√√P Q
{
ƒƒ "
jsonParseReturnCheck
≈≈ 0
=
≈≈1 2
JsonConvert
≈≈3 >
.
≈≈> ?
DeserializeObject
≈≈? P
<
≈≈P Q!
ResultStatusDataInt
≈≈Q d
<
≈≈d e!
ResultStatusDataNod
≈≈e x
>
≈≈x y
>
≈≈y z
(
≈≈z {
resultCheck≈≈{ Ü
)≈≈Ü á
;≈≈á à
if
∆∆ 
(
∆∆  "
jsonParseReturnCheck
∆∆  4
.
∆∆4 5

StatusCode
∆∆5 ?
==
∆∆@ B
$num
∆∆C F
||
∆∆G I"
jsonParseReturnCheck
∆∆J ^
.
∆∆^ _

StatusCode
∆∆_ i
==
∆∆j l
$num
∆∆m p
)
∆∆p q
{
«« 
if
»»  "
(
»»# $"
jsonParseReturnCheck
»»$ 8
.
»»8 9
Data
»»9 =
.
»»= >
Status
»»> D
==
»»E G
$str
»»H T
)
»»T U
{
……  !
List
ÀÀ$ (
<
ÀÀ( )+
TblNoticeOfDisbursementDetail
ÀÀ) F
>
ÀÀF G
dataAssignDetail
ÀÀH X
=
ÀÀY Z
_context
ÀÀ[ c
.
ÀÀc d-
TblNoticeOfDisbursementDetailsÀÀd Ç
.ÀÀÇ É
WhereÀÀÉ à
(ÀÀà â
mÀÀâ ä
=>ÀÀã ç
mÀÀé è
.ÀÀè ê
NodIdÀÀê ï
==ÀÀñ ò
intÀÀô ú
.ÀÀú ù
ParseÀÀù ¢
(ÀÀ¢ £
itemÀÀ£ ß
)ÀÀß ®
&&ÀÀ© ´
mÀÀ¨ ≠
.ÀÀ≠ Æ
	IsDeletedÀÀÆ ∑
==ÀÀ∏ ∫
$numÀÀª º
)ÀÀº Ω
.ÀÀΩ æ
ToListÀÀæ ƒ
(ÀÀƒ ≈
)ÀÀ≈ ∆
;ÀÀ∆ «
List
ÃÃ$ (
<
ÃÃ( )+
TblNoticeOfDisbursementDetail
ÃÃ) F
>
ÃÃF G%
dataAssignDetailDeleted
ÃÃH _
=
ÃÃ` a
_context
ÃÃb j
.
ÃÃj k-
TblNoticeOfDisbursementDetailsÃÃk â
.ÃÃâ ä
WhereÃÃä è
(ÃÃè ê
mÃÃê ë
=>ÃÃí î
mÃÃï ñ
.ÃÃñ ó
NodIdÃÃó ú
==ÃÃù ü
intÃÃ† £
.ÃÃ£ §
ParseÃÃ§ ©
(ÃÃ© ™
itemÃÃ™ Æ
)ÃÃÆ Ø
&&ÃÃ∞ ≤
mÃÃ≥ ¥
.ÃÃ¥ µ"
IdNodDetailFromApiÃÃµ «
!=ÃÃ»  
nullÃÃÀ œ
&&ÃÃ– “
mÃÃ” ‘
.ÃÃ‘ ’
	IsDeletedÃÃ’ ﬁ
==ÃÃﬂ ·
$numÃÃ‚ „
&&ÃÃ‰ Ê
mÃÃÁ Ë
.ÃÃË È
IsActiveÃÃÈ Ò
==ÃÃÚ Ù
$numÃÃı ˆ
)ÃÃˆ ˜
.ÃÃ˜ ¯
ToListÃÃ¯ ˛
(ÃÃ˛ ˇ
)ÃÃˇ Ä
;ÃÃÄ Å
foreach
ŒŒ$ +
(
ŒŒ, -
var
ŒŒ- 0
itemDetailDelete
ŒŒ1 A
in
ŒŒB D%
dataAssignDetailDeleted
ŒŒE \
)
ŒŒ\ ]
{
œœ$ %
if
––( *
(
––+ ,
itemDetailDelete
––, <
.
––< = 
IdNodDetailFromApi
––= O
!=
––P R
null
––S W
)
––W X
{
——( )
var
““, /)
jsonParseReturnUpdateDetail
““0 K
=
““L M
JsonConvert
““N Y
.
““Y Z
DeserializeObject
““Z k
<
““k l!
ResultStatusDataInt
““l 
<““ Ä#
ResultStatusDataNod““Ä ì
>““ì î
>““î ï
(““ï ñ
$str““ñ ò
)““ò ô
;““ô ö
var
””, /
urlUpdateDetail
””0 ?
=
””@ A
	GetConfig
””B K
.
””K L

AppSetting
””L V
[
””V W
$str
””W h
]
””h i
+
””j k
	GetConfig
””l u
.
””u v

AppSetting””v Ä
[””Ä Å
$str””Å õ
]””õ ú
+””ù û 
itemDetailDelete””ü Ø
.””Ø ∞"
IdNodDetailFromApi””∞ ¬
;””¬ √
(
‘‘, -
bool
‘‘- 1#
resultApiUpdateDetail
‘‘2 G
,
‘‘G H
string
‘‘I O 
resultUpdateDetail
‘‘P b
)
‘‘b c
=
‘‘d e
RequestToAPI
‘‘f r
.
‘‘r s$
DeleteRequestToWebApi‘‘s à
(‘‘à â
urlUpdateDetail‘‘â ò
,‘‘ò ô
null‘‘ö û
)‘‘û ü
;‘‘ü †
if
’’, .
(
’’/ 0#
resultApiUpdateDetail
’’0 E
&&
’’F H
!
’’I J
string
’’J P
.
’’P Q
IsNullOrEmpty
’’Q ^
(
’’^ _ 
resultUpdateDetail
’’_ q
)
’’q r
)
’’r s
{
÷÷, -)
jsonParseReturnUpdateDetail
◊◊0 K
=
◊◊L M
JsonConvert
◊◊N Y
.
◊◊Y Z
DeserializeObject
◊◊Z k
<
◊◊k l!
ResultStatusDataInt
◊◊l 
<◊◊ Ä#
ResultStatusDataNod◊◊Ä ì
>◊◊ì î
>◊◊î ï
(◊◊ï ñ"
resultUpdateDetail◊◊ñ ®
)◊◊® ©
;◊◊© ™
if
ÿÿ0 2
(
ÿÿ3 4)
jsonParseReturnUpdateDetail
ÿÿ4 O
.
ÿÿO P

StatusCode
ÿÿP Z
==
ÿÿ[ ]
$num
ÿÿ^ a
||
ÿÿb d*
jsonParseReturnUpdateDetailÿÿe Ä
.ÿÿÄ Å

StatusCodeÿÿÅ ã
==ÿÿå é
$numÿÿè í
)ÿÿí ì
{
ŸŸ0 1
itemDetailDelete
⁄⁄4 D
.
⁄⁄D E
IsActive
⁄⁄E M
=
⁄⁄N O
$num
⁄⁄P Q
;
⁄⁄Q R
itemDetailDelete
€€4 D
.
€€D E
	IsDeleted
€€E N
=
€€O P
$num
€€Q R
;
€€R S
_context
‹‹4 <
.
‹‹< =
Entry
‹‹= B
(
‹‹B C
itemDetailDelete
‹‹C S
)
‹‹S T
.
‹‹T U
State
‹‹U Z
=
‹‹[ \
EntityState
‹‹] h
.
‹‹h i
Modified
‹‹i q
;
‹‹q r
_context
››4 <
.
››< =
SaveChanges
››= H
(
››H I
)
››I J
;
››J K
}
ﬁﬁ0 1
}
ﬂﬂ, -
}
‡‡( )
}
··$ %
foreach
„„$ +
(
„„, -
var
„„- 0

itemDetail
„„1 ;
in
„„< >
dataAssignDetail
„„? O
)
„„O P
{
‰‰$ %
if
ÊÊ( *
(
ÊÊ+ ,

itemDetail
ÊÊ, 6
.
ÊÊ6 7 
IdNodDetailFromApi
ÊÊ7 I
!=
ÊÊJ L
null
ÊÊM Q
)
ÊÊQ R
{
ÁÁ( )
var
ËË, /)
jsonParseReturnUpdateDetail
ËË0 K
=
ËËL M
JsonConvert
ËËN Y
.
ËËY Z
DeserializeObject
ËËZ k
<
ËËk l!
ResultStatusDataInt
ËËl 
<ËË Ä#
ResultStatusDataNodËËÄ ì
>ËËì î
>ËËî ï
(ËËï ñ
$strËËñ ò
)ËËò ô
;ËËô ö
var
ÈÈ, /
urlUpdateDetail
ÈÈ0 ?
=
ÈÈ@ A
	GetConfig
ÈÈB K
.
ÈÈK L

AppSetting
ÈÈL V
[
ÈÈV W
$str
ÈÈW h
]
ÈÈh i
+
ÈÈj k
	GetConfig
ÈÈl u
.
ÈÈu v

AppSettingÈÈv Ä
[ÈÈÄ Å
$strÈÈÅ õ
]ÈÈõ ú
+ÈÈù û

itemDetailÈÈü ©
.ÈÈ© ™"
IdNodDetailFromApiÈÈ™ º
;ÈÈº Ω
(
ÍÍ, -
bool
ÍÍ- 1#
resultApiUpdateDetail
ÍÍ2 G
,
ÍÍG H
string
ÍÍI O 
resultUpdateDetail
ÍÍP b
)
ÍÍb c
=
ÍÍd e
RequestToAPI
ÍÍf r
.
ÍÍr s!
PutRequestToWebApiÍÍs Ö
(ÍÍÖ Ü
urlUpdateDetailÍÍÜ ï
,ÍÍï ñ
newÍÍó ö
{
ÎÎ, -
NodId
ÏÏ0 5
=
ÏÏ6 7

dataAssign
ÏÏ8 B
.
ÏÏB C
IdNodFromApi
ÏÏC O
,
ÏÏO P
CreditorRef
ÌÌ0 ;
=
ÌÌ< =

itemDetail
ÌÌ> H
.
ÌÌH I
CreditorRef
ÌÌI T
,
ÌÌT U
Amount
ÓÓ0 6
=
ÓÓ7 8

itemDetail
ÓÓ9 C
.
ÓÓC D
Amount
ÓÓD J
,
ÓÓJ K
	AmountIDR
ÔÔ0 9
=
ÔÔ: ;

itemDetail
ÔÔ< F
.
ÔÔF G
	AmountIdr
ÔÔG P
}
, -
,
- .
null
/ 3
)
3 4
;
4 5
if
ÒÒ, .
(
ÒÒ/ 0#
resultApiUpdateDetail
ÒÒ0 E
&&
ÒÒF H
!
ÒÒI J
string
ÒÒJ P
.
ÒÒP Q
IsNullOrEmpty
ÒÒQ ^
(
ÒÒ^ _ 
resultUpdateDetail
ÒÒ_ q
)
ÒÒq r
)
ÒÒr s
{
ÚÚ, -)
jsonParseReturnUpdateDetail
ÛÛ0 K
=
ÛÛL M
JsonConvert
ÛÛN Y
.
ÛÛY Z
DeserializeObject
ÛÛZ k
<
ÛÛk l!
ResultStatusDataInt
ÛÛl 
<ÛÛ Ä#
ResultStatusDataNodÛÛÄ ì
>ÛÛì î
>ÛÛî ï
(ÛÛï ñ"
resultUpdateDetailÛÛñ ®
)ÛÛ® ©
;ÛÛ© ™
if
ÙÙ0 2
(
ÙÙ3 4)
jsonParseReturnUpdateDetail
ÙÙ4 O
.
ÙÙO P

StatusCode
ÙÙP Z
==
ÙÙ[ ]
$num
ÙÙ^ a
||
ÙÙb d*
jsonParseReturnUpdateDetailÙÙe Ä
.ÙÙÄ Å

StatusCodeÙÙÅ ã
==ÙÙå é
$numÙÙè í
)ÙÙí ì
{
ıı0 1

itemDetail
ˆˆ4 >
.
ˆˆ> ? 
IdNodDetailFromApi
ˆˆ? Q
=
ˆˆR S)
jsonParseReturnUpdateDetail
ˆˆT o
.
ˆˆo p
Data
ˆˆp t
.
ˆˆt u
Id
ˆˆu w
;
ˆˆw x
_context
˜˜4 <
.
˜˜< =
Entry
˜˜= B
(
˜˜B C

itemDetail
˜˜C M
)
˜˜M N
.
˜˜N O
State
˜˜O T
=
˜˜U V
EntityState
˜˜W b
.
˜˜b c
Modified
˜˜c k
;
˜˜k l
_context
¯¯4 <
.
¯¯< =
SaveChanges
¯¯= H
(
¯¯H I
)
¯¯I J
;
¯¯J K
}
˘˘0 1
}
˙˙, -
}
˝˝( )
else
˛˛( ,
{
ˇˇ( )
var
ÄÄ, /&
jsonParseReturnAddDetail
ÄÄ0 H
=
ÄÄI J
JsonConvert
ÄÄK V
.
ÄÄV W
DeserializeObject
ÄÄW h
<
ÄÄh i!
ResultStatusDataInt
ÄÄi |
<
ÄÄ| }"
ResultStatusDataNodÄÄ} ê
>ÄÄê ë
>ÄÄë í
(ÄÄí ì
$strÄÄì ï
)ÄÄï ñ
;ÄÄñ ó
var
ÅÅ, /
urlAddDetail
ÅÅ0 <
=
ÅÅ= >
	GetConfig
ÅÅ? H
.
ÅÅH I

AppSetting
ÅÅI S
[
ÅÅS T
$str
ÅÅT e
]
ÅÅe f
+
ÅÅg h
	GetConfig
ÅÅi r
.
ÅÅr s

AppSetting
ÅÅs }
[
ÅÅ} ~
$strÅÅ~ ï
]ÅÅï ñ
;ÅÅñ ó
(
ÇÇ, -
bool
ÇÇ- 1 
resultApiAddDetail
ÇÇ2 D
,
ÇÇD E
string
ÇÇF L
resultAddDetail
ÇÇM \
)
ÇÇ\ ]
=
ÇÇ^ _
RequestToAPI
ÇÇ` l
.
ÇÇl m"
PostRequestToWebApiÇÇm Ä
(ÇÇÄ Å
urlAddDetailÇÇÅ ç
,ÇÇç é
newÇÇè í
{
ÉÉ, -
NodId
ÑÑ0 5
=
ÑÑ6 7

dataAssign
ÑÑ8 B
.
ÑÑB C
IdNodFromApi
ÑÑC O
,
ÑÑO P
CreditorRef
ÖÖ0 ;
=
ÖÖ< =

itemDetail
ÖÖ> H
.
ÖÖH I
CreditorRef
ÖÖI T
,
ÖÖT U
Amount
ÜÜ0 6
=
ÜÜ7 8

itemDetail
ÜÜ9 C
.
ÜÜC D
Amount
ÜÜD J
,
ÜÜJ K
	AmountIDR
áá0 9
=
áá: ;

itemDetail
áá< F
.
ááF G
	AmountIdr
ááG P
}
àà, -
,
àà- .
null
àà/ 3
)
àà3 4
;
àà4 5
if
ââ, .
(
ââ/ 0 
resultApiAddDetail
ââ0 B
&&
ââC E
!
ââF G
string
ââG M
.
ââM N
IsNullOrEmpty
ââN [
(
ââ[ \
resultAddDetail
ââ\ k
)
ââk l
)
ââl m
{
ää, -&
jsonParseReturnAddDetail
ãã0 H
=
ããI J
JsonConvert
ããK V
.
ããV W
DeserializeObject
ããW h
<
ããh i!
ResultStatusDataInt
ããi |
<
ãã| }"
ResultStatusDataNodãã} ê
>ããê ë
>ããë í
(ããí ì
resultAddDetailããì ¢
)ãã¢ £
;ãã£ §
if
åå0 2
(
åå3 4&
jsonParseReturnAddDetail
åå4 L
.
ååL M

StatusCode
ååM W
==
ååX Z
$num
åå[ ^
||
åå_ a&
jsonParseReturnAddDetail
ååb z
.
ååz {

StatusCodeåå{ Ö
==ååÜ à
$numååâ å
)ååå ç
{
çç0 1

itemDetail
éé4 >
.
éé> ? 
IdNodDetailFromApi
éé? Q
=
ééR S&
jsonParseReturnAddDetail
ééT l
.
éél m
Data
éém q
.
ééq r
Id
éér t
;
éét u
_context
èè4 <
.
èè< =
Entry
èè= B
(
èèB C

itemDetail
èèC M
)
èèM N
.
èèN O
State
èèO T
=
èèU V
EntityState
èèW b
.
èèb c
Modified
èèc k
;
èèk l
_context
êê4 <
.
êê< =
SaveChanges
êê= H
(
êêH I
)
êêI J
;
êêJ K
}
ëë0 1
}
ôô, -
}
öö( )
}
õõ$ %
List
ûû$ (
<
ûû( )
TblFileUploadNod
ûû) 9
>
ûû9 :
dataAssignFile
ûû; I
=
ûûJ K
_context
ûûL T
.
ûûT U
TblFileUploadNods
ûûU f
.
ûûf g
Where
ûûg l
(
ûûl m
m
ûûm n
=>
ûûo q
m
ûûr s
.
ûûs t
IdNod
ûût y
==
ûûz |
intûû} Ä
.ûûÄ Å
ParseûûÅ Ü
(ûûÜ á
itemûûá ã
)ûûã å
&&ûûç è
mûûê ë
.ûûë í
	IsDeletedûûí õ
==ûûú û
$numûûü †
)ûû† °
.ûû° ¢
ToListûû¢ ®
(ûû® ©
)ûû© ™
;ûû™ ´
List
üü$ (
<
üü( )
TblFileUploadNod
üü) 9
>
üü9 :#
dataAssignFileDeleted
üü; P
=
üüQ R
_context
üüS [
.
üü[ \
TblFileUploadNods
üü\ m
.
üüm n
Where
üün s
(
üüs t
m
üüt u
=>
üüv x
m
üüy z
.
üüz {
IdNodüü{ Ä
==üüÅ É
intüüÑ á
.üüá à
Parseüüà ç
(üüç é
itemüüé í
)üüí ì
&&üüî ñ
müüó ò
.üüò ô
IdFileFromApiüüô ¶
!=üüß ©
nullüü™ Æ
&&üüØ ±
müü≤ ≥
.üü≥ ¥
	IsDeletedüü¥ Ω
==üüæ ¿
$numüü¡ ¬
&&üü√ ≈
müü∆ «
.üü« »
IsActiveüü» –
==üü— ”
$numüü‘ ’
)üü’ ÷
.üü÷ ◊
ToListüü◊ ›
(üü› ﬁ
)üüﬁ ﬂ
;üüﬂ ‡
foreach
°°$ +
(
°°, -
var
°°- 0
itemFileDelete
°°1 ?
in
°°@ B#
dataAssignFileDeleted
°°C X
)
°°X Y
{
¢¢$ %
if
££( *
(
££+ ,
itemFileDelete
££, :
.
££: ;
IdFileFromApi
££; H
!=
££I K
null
££L P
)
££P Q
{
§§( )
var
••, /'
jsonParseReturnUpdateFile
••0 I
=
••J K
JsonConvert
••L W
.
••W X
DeserializeObject
••X i
<
••i j!
ResultStatusDataInt
••j }
<
••} ~"
ResultStatusDataNod••~ ë
>••ë í
>••í ì
(••ì î
$str••î ñ
)••ñ ó
;••ó ò
var
¶¶, /
urlUpdateFile
¶¶0 =
=
¶¶> ?
	GetConfig
¶¶@ I
.
¶¶I J

AppSetting
¶¶J T
[
¶¶T U
$str
¶¶U f
]
¶¶f g
+
¶¶h i
	GetConfig
¶¶j s
.
¶¶s t

AppSetting
¶¶t ~
[
¶¶~ 
$str¶¶ î
]¶¶î ï
+¶¶ñ ó
itemFileDelete¶¶ò ¶
.¶¶¶ ß
IdFileFromApi¶¶ß ¥
;¶¶¥ µ
(
ßß, -
bool
ßß- 1!
resultApiUpdateFile
ßß2 E
,
ßßE F
string
ßßG M
resultUpdateFile
ßßN ^
)
ßß^ _
=
ßß` a
RequestToAPI
ßßb n
.
ßßn o$
DeleteRequestToWebApißßo Ñ
(ßßÑ Ö
urlUpdateFileßßÖ í
,ßßí ì
nullßßî ò
)ßßò ô
;ßßô ö
if
®®, .
(
®®/ 0!
resultApiUpdateFile
®®0 C
&&
®®D F
!
®®G H
string
®®H N
.
®®N O
IsNullOrEmpty
®®O \
(
®®\ ]
resultUpdateFile
®®] m
)
®®m n
)
®®n o
{
©©, -'
jsonParseReturnUpdateFile
™™0 I
=
™™J K
JsonConvert
™™L W
.
™™W X
DeserializeObject
™™X i
<
™™i j!
ResultStatusDataInt
™™j }
<
™™} ~"
ResultStatusDataNod™™~ ë
>™™ë í
>™™í ì
(™™ì î 
resultUpdateFile™™î §
)™™§ •
;™™• ¶
if
´´0 2
(
´´3 4'
jsonParseReturnUpdateFile
´´4 M
.
´´M N

StatusCode
´´N X
==
´´Y [
$num
´´\ _
||
´´` b'
jsonParseReturnUpdateFile
´´c |
.
´´| }

StatusCode´´} á
==´´à ä
$num´´ã é
)´´é è
{
¨¨0 1
itemFileDelete
≠≠4 B
.
≠≠B C
IsActive
≠≠C K
=
≠≠L M
$num
≠≠N O
;
≠≠O P
itemFileDelete
ÆÆ4 B
.
ÆÆB C
	IsDeleted
ÆÆC L
=
ÆÆM N
$num
ÆÆO P
;
ÆÆP Q
_context
ØØ4 <
.
ØØ< =
Entry
ØØ= B
(
ØØB C
itemFileDelete
ØØC Q
)
ØØQ R
.
ØØR S
State
ØØS X
=
ØØY Z
EntityState
ØØ[ f
.
ØØf g
Modified
ØØg o
;
ØØo p
_context
∞∞4 <
.
∞∞< =
SaveChanges
∞∞= H
(
∞∞H I
)
∞∞I J
;
∞∞J K
}
±±0 1
}
≤≤, -
if
≥≥, .
(
≥≥/ 0!
resultApiUpdateFile
≥≥0 C
)
≥≥C D
{
¥¥, -
itemFileDelete
µµ0 >
.
µµ> ?
IsActive
µµ? G
=
µµH I
$num
µµJ K
;
µµK L
itemFileDelete
∂∂0 >
.
∂∂> ?
	IsDeleted
∂∂? H
=
∂∂I J
$num
∂∂K L
;
∂∂L M
_context
∑∑0 8
.
∑∑8 9
Entry
∑∑9 >
(
∑∑> ?
itemFileDelete
∑∑? M
)
∑∑M N
.
∑∑N O
State
∑∑O T
=
∑∑U V
EntityState
∑∑W b
.
∑∑b c
Modified
∑∑c k
;
∑∑k l
_context
∏∏0 8
.
∏∏8 9
SaveChanges
∏∏9 D
(
∏∏D E
)
∏∏E F
;
∏∏F G
}
ππ, -
}
∫∫( )
}
ªª$ %
foreach
ΩΩ$ +
(
ΩΩ, -
var
ΩΩ- 0
itemFile
ΩΩ1 9
in
ΩΩ: <
dataAssignFile
ΩΩ= K
)
ΩΩK L
{
ææ$ %
var
øø( +
data
øø, 0
=
øø1 2
new
øø3 6
object
øø7 =
(
øø= >
)
øø> ?
;
øø? @
var
¿¿( +
check
¿¿, 1
=
¿¿2 3
await
¿¿4 9
_context
¿¿: B
.
¿¿B C
TblFileUploadNods
¿¿C T
.
¿¿T U
Where
¿¿U Z
(
¿¿Z [
x
¿¿[ \
=>
¿¿] _
x
¿¿` a
.
¿¿a b
Id
¿¿b d
==
¿¿e g
itemFile
¿¿h p
.
¿¿p q
Id
¿¿q s
)
¿¿s t
.
¿¿t u"
FirstOrDefaultAsync¿¿u à
(¿¿à â
)¿¿â ä
;¿¿ä ã
if
¡¡( *
(
¡¡+ ,
System
¡¡, 2
.
¡¡2 3
IO
¡¡3 5
.
¡¡5 6
File
¡¡6 :
.
¡¡: ;
Exists
¡¡; A
(
¡¡A B
check
¡¡B G
.
¡¡G H
FilePath
¡¡H P
)
¡¡P Q
)
¡¡Q R
{
¬¬( )
byte
√√, 0
[
√√0 1
]
√√1 2
	fileBytes
√√3 <
=
√√= >
System
√√? E
.
√√E F
IO
√√F H
.
√√H I
File
√√I M
.
√√M N
ReadAllBytes
√√N Z
(
√√Z [
check
√√[ `
.
√√` a
FilePath
√√a i
)
√√i j
;
√√j k
string
∆∆, 2
base64String
∆∆3 ?
=
∆∆@ A
Convert
∆∆B I
.
∆∆I J
ToBase64String
∆∆J X
(
∆∆X Y
	fileBytes
∆∆Y b
)
∆∆b c
;
∆∆c d
var
»», /)
jsonParseReturnUploadBase64
»»0 K
=
»»L M
JsonConvert
»»N Y
.
»»Y Z
DeserializeObject
»»Z k
<
»»k l!
ResultStatusDataInt
»»l 
<»» Ä#
ResultStatusDataNod»»Ä ì
>»»ì î
>»»î ï
(»»ï ñ
$str»»ñ ò
)»»ò ô
;»»ô ö
var
……, /
urlUploadBase64
……0 ?
=
……@ A
	GetConfig
……B K
.
……K L

AppSetting
……L V
[
……V W
$str
……W h
]
……h i
+
……j k
	GetConfig
……l u
.
……u v

AppSetting……v Ä
[……Ä Å
$str……Å õ
]……õ ú
+……ù û

dataAssign……ü ©
.……© ™
IdNodFromApi……™ ∂
;……∂ ∑
(
  , -
bool
  - 1#
resultApiUploadBase64
  2 G
,
  G H
string
  I O 
resultUploadBase64
  P b
)
  b c
=
  d e
RequestToAPI
  f r
.
  r s"
PostRequestToWebApi  s Ü
(  Ü á
urlUploadBase64  á ñ
,  ñ ó
new  ò õ
{
ÀÀ, -
FileName
ÃÃ0 8
=
ÃÃ9 :
itemFile
ÃÃ; C
.
ÃÃC D
FileName
ÃÃD L
,
ÃÃL M
FileContent
ÕÕ0 ;
=
ÕÕ< =
base64String
ÕÕ> J
,
ÕÕJ K
}
ŒŒ, -
,
ŒŒ- .
null
ŒŒ/ 3
)
ŒŒ3 4
;
ŒŒ4 5
if
œœ, .
(
œœ/ 0#
resultApiUploadBase64
œœ0 E
&&
œœF H
!
œœI J
string
œœJ P
.
œœP Q
IsNullOrEmpty
œœQ ^
(
œœ^ _ 
resultUploadBase64
œœ_ q
)
œœq r
)
œœr s
{
––, -)
jsonParseReturnUploadBase64
——0 K
=
——L M
JsonConvert
——N Y
.
——Y Z
DeserializeObject
——Z k
<
——k l!
ResultStatusDataInt
——l 
<—— Ä#
ResultStatusDataNod——Ä ì
>——ì î
>——î ï
(——ï ñ"
resultUploadBase64——ñ ®
)——® ©
;——© ™
if
““0 2
(
““3 4)
jsonParseReturnUploadBase64
““4 O
.
““O P

StatusCode
““P Z
==
““[ ]
$num
““^ a
||
““b d*
jsonParseReturnUploadBase64““e Ä
.““Ä Å

StatusCode““Å ã
==““å é
$num““è í
)““í ì
{
””0 1
itemFile
‘‘4 <
.
‘‘< =
IdFileFromApi
‘‘= J
=
‘‘K L)
jsonParseReturnUploadBase64
‘‘M h
.
‘‘h i
Data
‘‘i m
.
‘‘m n
Key
‘‘n q
;
‘‘q r
_context
’’4 <
.
’’< =
Entry
’’= B
(
’’B C
itemFile
’’C K
)
’’K L
.
’’L M
State
’’M R
=
’’S T
EntityState
’’U `
.
’’` a
Modified
’’a i
;
’’i j
_context
÷÷4 <
.
÷÷< =
SaveChanges
÷÷= H
(
÷÷H I
)
÷÷I J
;
÷÷J K
}
◊◊0 1
}
ÿÿ, -
}
ŸŸ( )
}
⁄⁄$ %
var
ﬁﬁ$ '#
jsonParseReturnUpdate
ﬁﬁ( =
=
ﬁﬁ> ?
JsonConvert
ﬁﬁ@ K
.
ﬁﬁK L
DeserializeObject
ﬁﬁL ]
<
ﬁﬁ] ^!
ResultStatusDataInt
ﬁﬁ^ q
<
ﬁﬁq r"
ResultStatusDataNodﬁﬁr Ö
>ﬁﬁÖ Ü
>ﬁﬁÜ á
(ﬁﬁá à
$strﬁﬁà ä
)ﬁﬁä ã
;ﬁﬁã å
var
ﬂﬂ$ '
	urlUpdate
ﬂﬂ( 1
=
ﬂﬂ2 3
	GetConfig
ﬂﬂ4 =
.
ﬂﬂ= >

AppSetting
ﬂﬂ> H
[
ﬂﬂH I
$str
ﬂﬂI Z
]
ﬂﬂZ [
+
ﬂﬂ\ ]
	GetConfig
ﬂﬂ^ g
.
ﬂﬂg h

AppSetting
ﬂﬂh r
[
ﬂﬂr s
$strﬂﬂs á
]ﬂﬂá à
+ﬂﬂâ ä

dataAssignﬂﬂã ï
.ﬂﬂï ñ
IdNodFromApiﬂﬂñ ¢
;ﬂﬂ¢ £
(
‡‡$ %
bool
‡‡% )
resultApiUpdate
‡‡* 9
,
‡‡9 :
string
‡‡; A
resultUpdate
‡‡B N
)
‡‡N O
=
‡‡P Q
RequestToAPI
‡‡R ^
.
‡‡^ _ 
PutRequestToWebApi
‡‡_ q
(
‡‡q r
	urlUpdate
‡‡r {
,
‡‡{ |
model‡‡} Ç
,‡‡Ç É
null‡‡Ñ à
)‡‡à â
;‡‡â ä
if
··$ &
(
··' (
resultApiUpdate
··( 7
&&
··8 :
!
··; <
string
··< B
.
··B C
IsNullOrEmpty
··C P
(
··P Q
resultUpdate
··Q ]
)
··] ^
)
··^ _
{
‚‚$ %#
jsonParseReturnUpdate
„„( =
=
„„> ?
JsonConvert
„„@ K
.
„„K L
DeserializeObject
„„L ]
<
„„] ^!
ResultStatusDataInt
„„^ q
<
„„q r"
ResultStatusDataNod„„r Ö
>„„Ö Ü
>„„Ü á
(„„á à
resultUpdate„„à î
)„„î ï
;„„ï ñ
if
‰‰( *
(
‰‰+ ,#
jsonParseReturnUpdate
‰‰, A
.
‰‰A B

StatusCode
‰‰B L
==
‰‰M O
$num
‰‰P S
||
‰‰T V#
jsonParseReturnUpdate
‰‰W l
.
‰‰l m

StatusCode
‰‰m w
==
‰‰x z
$num
‰‰{ ~
)
‰‰~ 
{
ÂÂ( )

dataAssign
ÊÊ, 6
.
ÊÊ6 7
Status
ÊÊ7 =
=
ÊÊ> ?#
jsonParseReturnUpdate
ÊÊ@ U
.
ÊÊU V
Data
ÊÊV Z
.
ÊÊZ [
Status
ÊÊ[ a
;
ÊÊa b

dataAssign
ÁÁ, 6
.
ÁÁ6 7
LastSentDate
ÁÁ7 C
=
ÁÁD E
DateTime
ÁÁF N
.
ÁÁN O
Now
ÁÁO R
;
ÁÁR S
_context
ËË, 4
.
ËË4 5
Entry
ËË5 :
(
ËË: ;

dataAssign
ËË; E
)
ËËE F
.
ËËF G
State
ËËG L
=
ËËM N
EntityState
ËËO Z
.
ËËZ [
Modified
ËË[ c
;
ËËc d
_context
ÈÈ, 4
.
ÈÈ4 5
SaveChanges
ÈÈ5 @
(
ÈÈ@ A
)
ÈÈA B
;
ÈÈB C
}
ÍÍ( )
}
ÎÎ$ %
}
ÏÏ  !
else
ÌÌ  $
{
ÓÓ  !

dataAssign
ÔÔ$ .
.
ÔÔ. /
Status
ÔÔ/ 5
=
ÔÔ6 7"
jsonParseReturnCheck
ÔÔ8 L
.
ÔÔL M
Data
ÔÔM Q
.
ÔÔQ R
Status
ÔÔR X
;
ÔÔX Y

dataAssign
$ .
.
. /
LastSentDate
/ ;
=
< =
DateTime
> F
.
F G
Now
G J
;
J K
_context
ÒÒ$ ,
.
ÒÒ, -
Entry
ÒÒ- 2
(
ÒÒ2 3

dataAssign
ÒÒ3 =
)
ÒÒ= >
.
ÒÒ> ?
State
ÒÒ? D
=
ÒÒE F
EntityState
ÒÒG R
.
ÒÒR S
Modified
ÒÒS [
;
ÒÒ[ \
_context
ÚÚ$ ,
.
ÚÚ, -
SaveChanges
ÚÚ- 8
(
ÚÚ8 9
)
ÚÚ9 :
;
ÚÚ: ;
}
ÛÛ  !
}
ÙÙ 
}
ıı 
}
ˆˆ 
else
˜˜ 
{
¯¯ 
var
˘˘  
jsonParseReturnAdd
˘˘ .
=
˘˘/ 0
JsonConvert
˘˘1 <
.
˘˘< =
DeserializeObject
˘˘= N
<
˘˘N O!
ResultStatusDataInt
˘˘O b
<
˘˘b c!
ResultStatusDataNod
˘˘c v
>
˘˘v w
>
˘˘w x
(
˘˘x y
$str
˘˘y {
)
˘˘{ |
;
˘˘| }
var
˙˙ 
urlAdd
˙˙ "
=
˙˙# $
	GetConfig
˙˙% .
.
˙˙. /

AppSetting
˙˙/ 9
[
˙˙9 :
$str
˙˙: K
]
˙˙K L
+
˙˙M N
	GetConfig
˙˙O X
.
˙˙X Y

AppSetting
˙˙Y c
[
˙˙c d
$str
˙˙d u
]
˙˙u v
;
˙˙v w
(
˚˚ 
bool
˚˚ 
resultApiAdd
˚˚ *
,
˚˚* +
string
˚˚, 2
	resultAdd
˚˚3 <
)
˚˚< =
=
˚˚> ?
RequestToAPI
˚˚@ L
.
˚˚L M!
PostRequestToWebApi
˚˚M `
(
˚˚` a
urlAdd
˚˚a g
,
˚˚g h
model
˚˚i n
,
˚˚n o
null
˚˚p t
)
˚˚t u
;
˚˚u v
if
¸¸ 
(
¸¸ 
resultApiAdd
¸¸ (
&&
¸¸) +
!
¸¸, -
string
¸¸- 3
.
¸¸3 4
IsNullOrEmpty
¸¸4 A
(
¸¸A B
	resultAdd
¸¸B K
)
¸¸K L
)
¸¸L M
{
˝˝  
jsonParseReturnAdd
˛˛ .
=
˛˛/ 0
JsonConvert
˛˛1 <
.
˛˛< =
DeserializeObject
˛˛= N
<
˛˛N O!
ResultStatusDataInt
˛˛O b
<
˛˛b c!
ResultStatusDataNod
˛˛c v
>
˛˛v w
>
˛˛w x
(
˛˛x y
	resultAdd˛˛y Ç
)˛˛Ç É
;˛˛É Ñ
if
ˇˇ 
(
ˇˇ   
jsonParseReturnAdd
ˇˇ  2
.
ˇˇ2 3

StatusCode
ˇˇ3 =
==
ˇˇ> @
$num
ˇˇA D
||
ˇˇE G 
jsonParseReturnAdd
ˇˇH Z
.
ˇˇZ [

StatusCode
ˇˇ[ e
==
ˇˇf h
$num
ˇˇi l
)
ˇˇl m
{
ÄÄ 

dataAssign
ÅÅ  *
.
ÅÅ* +
IdNodFromApi
ÅÅ+ 7
=
ÅÅ8 9 
jsonParseReturnAdd
ÅÅ: L
.
ÅÅL M
Data
ÅÅM Q
.
ÅÅQ R
Id
ÅÅR T
;
ÅÅT U

dataAssign
ÇÇ  *
.
ÇÇ* +
Status
ÇÇ+ 1
=
ÇÇ2 3 
jsonParseReturnAdd
ÇÇ4 F
.
ÇÇF G
Data
ÇÇG K
.
ÇÇK L
Status
ÇÇL R
;
ÇÇR S

dataAssign
ÉÉ  *
.
ÉÉ* +
LastSentDate
ÉÉ+ 7
=
ÉÉ8 9
DateTime
ÉÉ: B
.
ÉÉB C
Now
ÉÉC F
;
ÉÉF G
_context
ÑÑ  (
.
ÑÑ( )
Entry
ÑÑ) .
(
ÑÑ. /

dataAssign
ÑÑ/ 9
)
ÑÑ9 :
.
ÑÑ: ;
State
ÑÑ; @
=
ÑÑA B
EntityState
ÑÑC N
.
ÑÑN O
Modified
ÑÑO W
;
ÑÑW X
_context
ÖÖ  (
.
ÖÖ( )
SaveChanges
ÖÖ) 4
(
ÖÖ4 5
)
ÖÖ5 6
;
ÖÖ6 7
List
àà  $
<
àà$ %+
TblNoticeOfDisbursementDetail
àà% B
>
ààB C
dataAssignDetail
ààD T
=
ààU V
_context
ààW _
.
àà_ `,
TblNoticeOfDisbursementDetails
àà` ~
.
àà~ 
Whereàà Ñ
(ààÑ Ö
mààÖ Ü
=>ààá â
mààä ã
.ààã å
NodIdààå ë
==ààí î
intààï ò
.ààò ô
Parseààô û
(ààû ü
itemààü £
)àà£ §
&&àà• ß
màà® ©
.àà© ™
	IsDeletedàà™ ≥
==àà¥ ∂
$numàà∑ ∏
)àà∏ π
.ààπ ∫
ToListàà∫ ¿
(àà¿ ¡
)àà¡ ¬
;àà¬ √
foreach
ââ  '
(
ââ( )
var
ââ) ,

itemDetail
ââ- 7
in
ââ8 :
dataAssignDetail
ââ; K
)
ââK L
{
ää  !
var
åå$ '&
jsonParseReturnAddDetail
åå( @
=
ååA B
JsonConvert
ååC N
.
ååN O
DeserializeObject
ååO `
<
åå` a!
ResultStatusDataInt
ååa t
<
ååt u"
ResultStatusDataNodååu à
>ååà â
>ååâ ä
(ååä ã
$strååã ç
)ååç é
;ååé è
var
çç$ '
urlAddDetail
çç( 4
=
çç5 6
	GetConfig
çç7 @
.
çç@ A

AppSetting
ççA K
[
ççK L
$str
ççL ]
]
çç] ^
+
çç_ `
	GetConfig
çça j
.
ççj k

AppSetting
ççk u
[
ççu v
$strççv ç
]ççç é
;ççé è
(
éé$ %
bool
éé% ) 
resultApiAddDetail
éé* <
,
éé< =
string
éé> D
resultAddDetail
ééE T
)
ééT U
=
ééV W
RequestToAPI
ééX d
.
ééd e!
PostRequestToWebApi
éée x
(
ééx y
urlAddDetailééy Ö
,ééÖ Ü
newééá ä
{
èè$ %
NodId
êê( -
=
êê. / 
jsonParseReturnAdd
êê0 B
.
êêB C
Data
êêC G
.
êêG H
Id
êêH J
,
êêJ K
CreditorRef
ëë( 3
=
ëë4 5

itemDetail
ëë6 @
.
ëë@ A
CreditorRef
ëëA L
,
ëëL M
Amount
íí( .
=
íí/ 0

itemDetail
íí1 ;
.
íí; <
Amount
íí< B
,
ííB C
	AmountIDR
ìì( 1
=
ìì2 3

itemDetail
ìì4 >
.
ìì> ?
	AmountIdr
ìì? H
}
îî$ %
,
îî% &
null
îî' +
)
îî+ ,
;
îî, -
if
ïï$ &
(
ïï' ( 
resultApiAddDetail
ïï( :
&&
ïï; =
!
ïï> ?
string
ïï? E
.
ïïE F
IsNullOrEmpty
ïïF S
(
ïïS T
resultAddDetail
ïïT c
)
ïïc d
)
ïïd e
{
ññ$ %&
jsonParseReturnAddDetail
óó( @
=
óóA B
JsonConvert
óóC N
.
óóN O
DeserializeObject
óóO `
<
óó` a!
ResultStatusDataInt
óóa t
<
óót u"
ResultStatusDataNodóóu à
>óóà â
>óóâ ä
(óóä ã
resultAddDetailóóã ö
)óóö õ
;óóõ ú
if
òò( *
(
òò+ ,&
jsonParseReturnAddDetail
òò, D
.
òòD E

StatusCode
òòE O
==
òòP R
$num
òòS V
||
òòW Y&
jsonParseReturnAddDetail
òòZ r
.
òòr s

StatusCode
òòs }
==òò~ Ä
$numòòÅ Ñ
)òòÑ Ö
{
ôô( )

itemDetail
öö, 6
.
öö6 7 
IdNodDetailFromApi
öö7 I
=
ööJ K&
jsonParseReturnAddDetail
ööL d
.
ööd e
Data
ööe i
.
ööi j
Id
ööj l
;
ööl m
_context
õõ, 4
.
õõ4 5
Entry
õõ5 :
(
õõ: ;

itemDetail
õõ; E
)
õõE F
.
õõF G
State
õõG L
=
õõM N
EntityState
õõO Z
.
õõZ [
Modified
õõ[ c
;
õõc d
_context
úú, 4
.
úú4 5
SaveChanges
úú5 @
(
úú@ A
)
úúA B
;
úúB C
}
ùù( )
else
ûû( ,
{
üü( )

itemDetail
††, 6
.
††6 7
	IsDeleted
††7 @
=
††A B
$num
††C D
;
††D E
_context
°°, 4
.
°°4 5
Entry
°°5 :
(
°°: ;

itemDetail
°°; E
)
°°E F
.
°°F G
State
°°G L
=
°°M N
EntityState
°°O Z
.
°°Z [
Modified
°°[ c
;
°°c d
_context
¢¢, 4
.
¢¢4 5
SaveChanges
¢¢5 @
(
¢¢@ A
)
¢¢A B
;
¢¢B C
}
££( )
}
§§$ %
}
••  !
List
®®  $
<
®®$ %
TblFileUploadNod
®®% 5
>
®®5 6
dataAssignFile
®®7 E
=
®®F G
_context
®®H P
.
®®P Q
TblFileUploadNods
®®Q b
.
®®b c
Where
®®c h
(
®®h i
m
®®i j
=>
®®k m
m
®®n o
.
®®o p
IdNod
®®p u
==
®®v x
int
®®y |
.
®®| }
Parse®®} Ç
(®®Ç É
item®®É á
)®®á à
&&®®â ã
m®®å ç
.®®ç é
	IsDeleted®®é ó
==®®ò ö
$num®®õ ú
)®®ú ù
.®®ù û
ToList®®û §
(®®§ •
)®®• ¶
;®®¶ ß
foreach
©©  '
(
©©( )
var
©©) ,
itemFile
©©- 5
in
©©6 8
dataAssignFile
©©9 G
)
©©G H
{
™™  !
var
´´$ '
data
´´( ,
=
´´- .
new
´´/ 2
object
´´3 9
(
´´9 :
)
´´: ;
;
´´; <
var
¨¨$ '
check
¨¨( -
=
¨¨. /
await
¨¨0 5
_context
¨¨6 >
.
¨¨> ?
TblFileUploadNods
¨¨? P
.
¨¨P Q
Where
¨¨Q V
(
¨¨V W
x
¨¨W X
=>
¨¨Y [
x
¨¨\ ]
.
¨¨] ^
Id
¨¨^ `
==
¨¨a c
itemFile
¨¨d l
.
¨¨l m
Id
¨¨m o
)
¨¨o p
.
¨¨p q"
FirstOrDefaultAsync¨¨q Ñ
(¨¨Ñ Ö
)¨¨Ö Ü
;¨¨Ü á
if
≠≠$ &
(
≠≠' (
System
≠≠( .
.
≠≠. /
IO
≠≠/ 1
.
≠≠1 2
File
≠≠2 6
.
≠≠6 7
Exists
≠≠7 =
(
≠≠= >
check
≠≠> C
.
≠≠C D
FilePath
≠≠D L
)
≠≠L M
)
≠≠M N
{
ÆÆ$ %
byte
ØØ( ,
[
ØØ, -
]
ØØ- .
	fileBytes
ØØ/ 8
=
ØØ9 :
System
ØØ; A
.
ØØA B
IO
ØØB D
.
ØØD E
File
ØØE I
.
ØØI J
ReadAllBytes
ØØJ V
(
ØØV W
check
ØØW \
.
ØØ\ ]
FilePath
ØØ] e
)
ØØe f
;
ØØf g
string
≤≤( .
base64String
≤≤/ ;
=
≤≤< =
Convert
≤≤> E
.
≤≤E F
ToBase64String
≤≤F T
(
≤≤T U
	fileBytes
≤≤U ^
)
≤≤^ _
;
≤≤_ `
var
µµ( +)
jsonParseReturnUploadBase64
µµ, G
=
µµH I
JsonConvert
µµJ U
.
µµU V
DeserializeObject
µµV g
<
µµg h!
ResultStatusDataInt
µµh {
<
µµ{ |"
ResultStatusDataNodµµ| è
>µµè ê
>µµê ë
(µµë í
$strµµí î
)µµî ï
;µµï ñ
var
∂∂( +
urlUploadBase64
∂∂, ;
=
∂∂< =
	GetConfig
∂∂> G
.
∂∂G H

AppSetting
∂∂H R
[
∂∂R S
$str
∂∂S d
]
∂∂d e
+
∂∂f g
	GetConfig
∂∂h q
.
∂∂q r

AppSetting
∂∂r |
[
∂∂| }
$str∂∂} ó
]∂∂ó ò
+∂∂ô ö"
jsonParseReturnAdd∂∂õ ≠
.∂∂≠ Æ
Data∂∂Æ ≤
.∂∂≤ ≥
Id∂∂≥ µ
;∂∂µ ∂
(
∑∑( )
bool
∑∑) -#
resultApiUploadBase64
∑∑. C
,
∑∑C D
string
∑∑E K 
resultUploadBase64
∑∑L ^
)
∑∑^ _
=
∑∑` a
RequestToAPI
∑∑b n
.
∑∑n o"
PostRequestToWebApi∑∑o Ç
(∑∑Ç É
urlUploadBase64∑∑É í
,∑∑í ì
new∑∑î ó
{
∏∏( )
FileName
ππ, 4
=
ππ5 6
itemFile
ππ7 ?
.
ππ? @
FileName
ππ@ H
,
ππH I
FileContent
∫∫, 7
=
∫∫8 9
base64String
∫∫: F
,
∫∫F G
}
ªª( )
,
ªª) *
null
ªª+ /
)
ªª/ 0
;
ªª0 1
if
ºº( *
(
ºº+ ,#
resultApiUploadBase64
ºº, A
&&
ººB D
!
ººE F
string
ººF L
.
ººL M
IsNullOrEmpty
ººM Z
(
ººZ [ 
resultUploadBase64
ºº[ m
)
ººm n
)
ººn o
{
ΩΩ( ))
jsonParseReturnUploadBase64
ææ, G
=
ææH I
JsonConvert
ææJ U
.
ææU V
DeserializeObject
ææV g
<
ææg h!
ResultStatusDataInt
ææh {
<
ææ{ |"
ResultStatusDataNodææ| è
>ææè ê
>ææê ë
(ææë í"
resultUploadBase64ææí §
)ææ§ •
;ææ• ¶
if
øø, .
(
øø/ 0)
jsonParseReturnUploadBase64
øø0 K
.
øøK L

StatusCode
øøL V
==
øøW Y
$num
øøZ ]
||
øø^ `)
jsonParseReturnUploadBase64
øøa |
.
øø| }

StatusCodeøø} á
==øøà ä
$numøøã é
)øøé è
{
¿¿, -
itemFile
¡¡0 8
.
¡¡8 9
IdFileFromApi
¡¡9 F
=
¡¡G H)
jsonParseReturnUploadBase64
¡¡I d
.
¡¡d e
Data
¡¡e i
.
¡¡i j
Key
¡¡j m
;
¡¡m n
_context
¬¬0 8
.
¬¬8 9
Entry
¬¬9 >
(
¬¬> ?
itemFile
¬¬? G
)
¬¬G H
.
¬¬H I
State
¬¬I N
=
¬¬O P
EntityState
¬¬Q \
.
¬¬\ ]
Modified
¬¬] e
;
¬¬e f
_context
√√0 8
.
√√8 9
SaveChanges
√√9 D
(
√√D E
)
√√E F
;
√√F G
}
ƒƒ, -
}
≈≈( )
}
ÏÏ$ %
}
ÌÌ  !
}
ÓÓ 
}
ÔÔ 
}
 
}
ÒÒ 
return
ÚÚ 
Content
ÚÚ 
(
ÚÚ 
$str
ÚÚ !
)
ÚÚ! "
;
ÚÚ" #
}
ÛÛ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ıı 
return
ˆˆ 
Content
ˆˆ 
(
ˆˆ 
$str
ˆˆ 4
)
ˆˆ4 5
;
ˆˆ5 6
}
˜˜ 
}
¯¯ 	
[
¸¸ 	
HttpPost
¸¸	 
]
¸¸ 
public
˝˝ 
async
˝˝ 
Task
˝˝ 
CheckToDeva
˝˝ %
(
˝˝% &
)
˝˝& '
{
˛˛ 	
try
ˇˇ 
{
ÄÄ 
List
ÅÅ 
<
ÅÅ %
TblNoticeOfDisbursement
ÅÅ ,
>
ÅÅ, -
data
ÅÅ. 2
=
ÅÅ3 4
_context
ÅÅ5 =
.
ÅÅ= >&
TblNoticeOfDisbursements
ÅÅ> V
.
ÅÅV W
Where
ÅÅW \
(
ÅÅ\ ]
m
ÅÅ] ^
=>
ÅÅ_ a
m
ÅÅb c
.
ÅÅc d
Status
ÅÅd j
==
ÅÅk m
$str
ÅÅn z
)
ÅÅz {
.
ÅÅ{ |
ToListÅÅ| Ç
(ÅÅÇ É
)ÅÅÉ Ñ
;ÅÅÑ Ö
List
ÉÉ 
<
ÉÉ 
string
ÉÉ 
>
ÉÉ 
dataId
ÉÉ #
=
ÉÉ$ %
_context
ÉÉ& .
.
ÉÉ. /&
TblNoticeOfDisbursements
ÉÉ/ G
.
ÉÉG H
Where
ÉÉH M
(
ÉÉM N
m
ÉÉN O
=>
ÉÉP R
m
ÉÉS T
.
ÉÉT U
Status
ÉÉU [
==
ÉÉ\ ^
$str
ÉÉ_ k
)
ÉÉk l
.
ÉÉl m
Select
ÉÉm s
(
ÉÉs t
m
ÉÉt u
=>
ÉÉv x
m
ÉÉy z
.
ÉÉz {
IdNodFromApiÉÉ{ á
)ÉÉá à
.ÉÉà â
ToListÉÉâ è
(ÉÉè ê
)ÉÉê ë
;ÉÉë í
string
ÖÖ 
formattedData
ÖÖ $
=
ÖÖ% &
$"
ÖÖ' )
$str
ÖÖ) +
{
ÖÖ+ ,
string
ÖÖ, 2
.
ÖÖ2 3
Join
ÖÖ3 7
(
ÖÖ7 8
$str
ÖÖ8 =
,
ÖÖ= >
dataId
ÖÖ? E
)
ÖÖE F
}
ÖÖF G
$str
ÖÖG I
"
ÖÖI J
;
ÖÖJ K
var
áá "
jsonParseReturnCheck
áá (
=
áá) *
JsonConvert
áá+ 6
.
áá6 7
DeserializeObject
áá7 H
<
ááH I!
ResultStatusDataInt
ááI \
<
áá\ ]/
!NoticeOfDisbursementJOB_ViewModel
áá] ~
>
áá~ 
>áá Ä
(ááÄ Å
$strááÅ É
)ááÉ Ñ
;ááÑ Ö
var
àà 
urlCheck
àà 
=
àà 
	GetConfig
àà (
.
àà( )

AppSetting
àà) 3
[
àà3 4
$str
àà4 E
]
ààE F
+
ààG H
	GetConfig
ààI R
.
ààR S

AppSetting
ààS ]
[
àà] ^
$str
àà^ s
]
ààs t
+
ààu v
$strààw Ö
+ààÜ á
formattedDataààà ï
;ààï ñ
(
ââ 
bool
ââ 
resultApiCheck
ââ $
,
ââ$ %
string
ââ& ,
resultCheck
ââ- 8
)
ââ8 9
=
ââ: ;
RequestToAPI
ââ< H
.
ââH I!
GetJsonStringWebApi
ââI \
(
ââ\ ]
urlCheck
ââ] e
,
ââe f
null
ââg k
)
ââk l
;
ââl m
if
ää 
(
ää 
resultApiCheck
ää "
&&
ää# %
!
ää& '
string
ää' -
.
ää- .
IsNullOrEmpty
ää. ;
(
ää; <
resultCheck
ää< G
)
ääG H
)
ääH I
{
ãã "
jsonParseReturnCheck
åå (
=
åå) *
JsonConvert
åå+ 6
.
åå6 7
DeserializeObject
åå7 H
<
ååH I!
ResultStatusDataInt
ååI \
<
åå\ ]/
!NoticeOfDisbursementJOB_ViewModel
åå] ~
>
åå~ 
>åå Ä
(ååÄ Å
resultCheckååÅ å
)ååå ç
;ååç é
if
éé 
(
éé "
jsonParseReturnCheck
éé ,
.
éé, -
Value
éé- 2
!=
éé3 5
null
éé6 :
)
éé: ;
{
èè 
foreach
êê 
(
êê  !
var
êê! $
item
êê% )
in
êê* ,
data
êê- 1
)
êê1 2
{
ëë 
var
íí 
updatedStatus
íí  -
=
íí. /"
jsonParseReturnCheck
íí0 D
.
ííD E
Value
ííE J
.
ííJ K
FirstOrDefault
ííK Y
(
ííY Z
m
ííZ [
=>
íí\ ^
m
íí_ `
.
íí` a
Id
íía c
==
ííd f
item
ííg k
.
íík l
IdNodFromApi
ííl x
)
ííx y
;
ííy z
if
ìì 
(
ìì  
updatedStatus
ìì  -
!=
ìì. 0
null
ìì1 5
)
ìì5 6
{
îî 
item
ïï  $
.
ïï$ %
Status
ïï% +
=
ïï, -
updatedStatus
ïï. ;
.
ïï; <
Status
ïï< B
;
ïïB C
item
ññ  $
.
ññ$ %
UpdatedTime
ññ% 0
=
ññ1 2
DateTime
ññ3 ;
.
ññ; <
Now
ññ< ?
;
ññ? @
_context
óó  (
.
óó( )
Entry
óó) .
(
óó. /
item
óó/ 3
)
óó3 4
.
óó4 5
State
óó5 :
=
óó; <
EntityState
óó= H
.
óóH I
Modified
óóI Q
;
óóQ R
_context
òò  (
.
òò( )
SaveChanges
òò) 4
(
òò4 5
)
òò5 6
;
òò6 7
}
ôô 
}
öö 
}
õõ 
}
úú 
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
throw
†† 
;
†† 
}
°° 
}
¢¢ 	
[
££ 	
HttpPost
££	 
]
££ 
public
§§ 
async
§§ 
Task
§§ 
CheckToDevaOld
§§ (
(
§§( )
)
§§) *
{
•• 	
try
¶¶ 
{
ßß 
List
®® 
<
®® %
TblNoticeOfDisbursement
®® ,
>
®®, -
data
®®. 2
=
®®3 4
_context
®®5 =
.
®®= >&
TblNoticeOfDisbursements
®®> V
.
®®V W
Where
®®W \
(
®®\ ]
m
®®] ^
=>
®®_ a
m
®®b c
.
®®c d
Status
®®d j
==
®®k m
$str
®®n z
)
®®z {
.
®®{ |
ToList®®| Ç
(®®Ç É
)®®É Ñ
;®®Ñ Ö
foreach
™™ 
(
™™ 
var
™™ 
item
™™ !
in
™™" $
data
™™% )
)
™™) *
{
´´ 
if
≠≠ 
(
≠≠ 
item
≠≠ 
.
≠≠ 
IdNodFromApi
≠≠ )
!=
≠≠* ,
null
≠≠- 1
)
≠≠1 2
{
ÆÆ 
var
ØØ 

dataAssign
ØØ &
=
ØØ' (
await
ØØ) .
_context
ØØ/ 7
.
ØØ7 8&
TblNoticeOfDisbursements
ØØ8 P
.
ØØP Q
Where
ØØQ V
(
ØØV W
m
ØØW X
=>
ØØY [
m
ØØ\ ]
.
ØØ] ^
Id
ØØ^ `
==
ØØa c
item
ØØd h
.
ØØh i
Id
ØØi k
&&
ØØl n
m
ØØo p
.
ØØp q
	IsDeleted
ØØq z
==
ØØ{ }
$num
ØØ~ 
)ØØ Ä
.ØØÄ Å#
FirstOrDefaultAsyncØØÅ î
(ØØî ï
)ØØï ñ
;ØØñ ó
var
±± "
jsonParseReturnCheck
±± 0
=
±±1 2
JsonConvert
±±3 >
.
±±> ?
DeserializeObject
±±? P
<
±±P Q!
ResultStatusDataInt
±±Q d
<
±±d e!
ResultStatusDataNod
±±e x
>
±±x y
>
±±y z
(
±±z {
$str
±±{ }
)
±±} ~
;
±±~ 
var
≤≤ 
urlCheck
≤≤ $
=
≤≤% &
	GetConfig
≤≤' 0
.
≤≤0 1

AppSetting
≤≤1 ;
[
≤≤; <
$str
≤≤< M
]
≤≤M N
+
≤≤O P
	GetConfig
≤≤Q Z
.
≤≤Z [

AppSetting
≤≤[ e
[
≤≤e f
$str
≤≤f {
]
≤≤{ |
+
≤≤} ~

dataAssign≤≤ â
.≤≤â ä
IdNodFromApi≤≤ä ñ
;≤≤ñ ó
(
≥≥ 
bool
≥≥ 
resultApiCheck
≥≥ ,
,
≥≥, -
string
≥≥. 4
resultCheck
≥≥5 @
)
≥≥@ A
=
≥≥B C
RequestToAPI
≥≥D P
.
≥≥P Q!
GetJsonStringWebApi
≥≥Q d
(
≥≥d e
urlCheck
≥≥e m
,
≥≥m n
null
≥≥o s
)
≥≥s t
;
≥≥t u
if
¥¥ 
(
¥¥ 
resultApiCheck
¥¥ *
&&
¥¥+ -
!
¥¥. /
string
¥¥/ 5
.
¥¥5 6
IsNullOrEmpty
¥¥6 C
(
¥¥C D
resultCheck
¥¥D O
)
¥¥O P
)
¥¥P Q
{
µµ "
jsonParseReturnCheck
∂∂ 0
=
∂∂1 2
JsonConvert
∂∂3 >
.
∂∂> ?
DeserializeObject
∂∂? P
<
∂∂P Q!
ResultStatusDataInt
∂∂Q d
<
∂∂d e!
ResultStatusDataNod
∂∂e x
>
∂∂x y
>
∂∂y z
(
∂∂z {
resultCheck∂∂{ Ü
)∂∂Ü á
;∂∂á à
if
∑∑ 
(
∑∑  "
jsonParseReturnCheck
∑∑  4
.
∑∑4 5

StatusCode
∑∑5 ?
==
∑∑@ B
$num
∑∑C F
||
∑∑G I"
jsonParseReturnCheck
∑∑J ^
.
∑∑^ _

StatusCode
∑∑_ i
==
∑∑j l
$num
∑∑m p
)
∑∑p q
{
∏∏ 
if
ππ  "
(
ππ# $"
jsonParseReturnCheck
ππ$ 8
.
ππ8 9
Data
ππ9 =
.
ππ= >
Status
ππ> D
==
ππE G
$str
ππH R
)
ππR S
{
∫∫  !
item
ªª$ (
.
ªª( )
Status
ªª) /
=
ªª0 1"
jsonParseReturnCheck
ªª2 F
.
ªªF G
Data
ªªG K
.
ªªK L
Status
ªªL R
;
ªªR S
_context
ºº$ ,
.
ºº, -
Entry
ºº- 2
(
ºº2 3
item
ºº3 7
)
ºº7 8
.
ºº8 9
State
ºº9 >
=
ºº? @
EntityState
ººA L
.
ººL M
Modified
ººM U
;
ººU V
_context
ΩΩ$ ,
.
ΩΩ, -
SaveChanges
ΩΩ- 8
(
ΩΩ8 9
)
ΩΩ9 :
;
ΩΩ: ;
}
ææ  !
}
øø 
}
¿¿ 
}
¡¡ 
}
¬¬ 
}
√√ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
≈≈ 
throw
∆∆ 
;
∆∆ 
}
«« 
}
»» 	
public
ÃÃ 
async
ÃÃ 
Task
ÃÃ 
<
ÃÃ 
IActionResult
ÃÃ '
>
ÃÃ' (
PrintExcelNoD
ÃÃ) 6
(
ÃÃ6 7
string
ÃÃ7 =
Tanggal
ÃÃ> E
,
ÃÃE F
string
ÃÃG M
	TypeExcel
ÃÃN W
)
ÃÃW X
{
ÕÕ 	
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
lastSession
ŒŒ 
.
ŒŒ 
Update
ŒŒ #
(
ŒŒ# $
)
ŒŒ$ %
)
ŒŒ% &
{
œœ 
return
–– 
RedirectToAction
–– '
(
––' (
$str
––( /
,
––/ 0
	GetConfig
––1 :
.
––: ;

AppSetting
––; E
[
––E F
$str
––F n
]
––n o
+
––p q
$str
––r y
,
––y z
new
––{ ~
{–– Ä
a––Å Ç
=––É Ñ
true––Ö â
}––ä ã
)––ã å
;––å ç
}
—— 
var
““ 
location
““ 
=
““ 
new
““ 
Uri
““ "
(
““" #
$"
““# %
{
““% &
Request
““& -
.
““- .
Scheme
““. 4
}
““4 5
$str
““5 8
{
““8 9
Request
““9 @
.
““@ A
Host
““A E
}
““E F
{
““F G
Request
““G N
.
““N O
Path
““O S
}
““S T
"
““T U
)
““U V
;
““V W
string
”” 
path
”” 
=
”” 
location
”” "
.
””" #
AbsolutePath
””# /
.
””/ 0
Replace
””0 7
(
””7 8
this
””8 <
.
””< =
ControllerContext
””= N
.
””N O
	RouteData
””O X
.
””X Y
Values
””Y _
[
””_ `
$str
””` h
]
””h i
.
””i j
ToString
””j r
(
””r s
)
””s t
,
””t u
$str
””v }
)
””} ~
;
””~ 
if
‘‘ 
(
‘‘ 
!
‘‘ 
accessSecurity
‘‘ 
.
‘‘  
IsGetAccess
‘‘  +
(
‘‘+ ,
$str
‘‘, 0
+
‘‘1 2
path
‘‘3 7
)
‘‘7 8
)
‘‘8 9
{
’’ 
return
÷÷ 
RedirectToAction
÷÷ '
(
÷÷' (
$str
÷÷( 3
,
÷÷3 4
$str
÷÷5 <
)
÷÷< =
;
÷÷= >
}
◊◊ 
var
ŸŸ 

insertData
ŸŸ 
=
ŸŸ 
new
ŸŸ   
TblDownloadBigFile
ŸŸ! 3
(
ŸŸ3 4
)
ŸŸ4 5
;
ŸŸ5 6
try
€€ 
{
‹‹ 
var
›› 
req
›› 
=
›› 
new
›› 
{
›› 
	TypeExcel
››  )
=
››* +
	TypeExcel
››, 5
}
››6 7
;
››7 8
var
ﬂﬂ 
regex
ﬂﬂ 
=
ﬂﬂ 
await
ﬂﬂ !
RegexRequest
ﬂﬂ" .
.
ﬂﬂ. /
RegexValidation
ﬂﬂ/ >
(
ﬂﬂ> ?
req
ﬂﬂ? B
)
ﬂﬂB C
;
ﬂﬂC D
if
‡‡ 
(
‡‡ 
!
‡‡ 
regex
‡‡ 
)
‡‡ 
{
·· 
return
‚‚ 
Content
‚‚ "
(
‚‚" #
$str
‚‚# 1
)
‚‚1 2
;
‚‚2 3
}
„„ 

insertData
ÂÂ 
.
ÂÂ 
Path
ÂÂ 
=
ÂÂ  !
	GetConfig
ÂÂ" +
.
ÂÂ+ ,

AppSetting
ÂÂ, 6
[
ÂÂ6 7
$str
ÂÂ7 =
]
ÂÂ= >
+
ÂÂ? @
$str
ÂÂA T
+
ÂÂU V
DateTime
ÂÂW _
.
ÂÂ_ `
Now
ÂÂ` c
.
ÂÂc d
ToString
ÂÂd l
(
ÂÂl m
$strÂÂm Ä
)ÂÂÄ Å
+ÂÂÇ É
$strÂÂÑ á
+ÂÂà â
	TypeExcelÂÂä ì
;ÂÂì î

insertData
ÊÊ 
.
ÊÊ 
FileName
ÊÊ #
=
ÊÊ$ %
$str
ÊÊ& 9
+
ÊÊ: ;
DateTime
ÊÊ< D
.
ÊÊD E
Now
ÊÊE H
.
ÊÊH I
ToString
ÊÊI Q
(
ÊÊQ R
$str
ÊÊR e
)
ÊÊe f
;
ÊÊf g

insertData
ÁÁ 
.
ÁÁ 
StatusDownload
ÁÁ )
=
ÁÁ* +
$num
ÁÁ, -
;
ÁÁ- .

insertData
ËË 
.
ËË 
FileExt
ËË "
=
ËË# $
$str
ËË% +
;
ËË+ ,

insertData
ÈÈ 
.
ÈÈ 
CreatedTime
ÈÈ &
=
ÈÈ' (
DateTime
ÈÈ) 1
.
ÈÈ1 2
Now
ÈÈ2 5
;
ÈÈ5 6

insertData
ÍÍ 
.
ÍÍ 
CreatedById
ÍÍ &
=
ÍÍ' (
int
ÍÍ) ,
.
ÍÍ, -
Parse
ÍÍ- 2
(
ÍÍ2 3
HttpContext
ÍÍ3 >
.
ÍÍ> ?
Session
ÍÍ? F
.
ÍÍF G
	GetString
ÍÍG P
(
ÍÍP Q
SessionConstan
ÍÍQ _
.
ÍÍ_ `
Session_UserId
ÍÍ` n
)
ÍÍn o
)
ÍÍo p
;
ÍÍp q
await
ÎÎ 
_context
ÎÎ 
.
ÎÎ !
TblDownloadBigFiles
ÎÎ 2
.
ÎÎ2 3
AddAsync
ÎÎ3 ;
(
ÎÎ; <

insertData
ÎÎ< F
)
ÎÎF G
;
ÎÎG H
await
ÏÏ 
_context
ÏÏ 
.
ÏÏ 
SaveChangesAsync
ÏÏ /
(
ÏÏ/ 0
)
ÏÏ0 1
;
ÏÏ1 2
var
ÓÓ 
print
ÓÓ 
=
ÓÓ 
new
ÓÓ 
PrintExport
ÓÓ  +
(
ÓÓ+ ,

_converter
ÓÓ, 6
)
ÓÓ6 7
;
ÓÓ7 8
Task
ÔÔ 
.
ÔÔ 
Run
ÔÔ 
(
ÔÔ 
(
ÔÔ 
)
ÔÔ 
=>
ÔÔ 
print
ÔÔ $
.
ÔÔ$ %
PrintNoDExcel
ÔÔ% 2
(
ÔÔ2 3
	TypeExcel
ÔÔ3 <
,
ÔÔ< =

insertData
ÔÔ> H
.
ÔÔH I
FileName
ÔÔI Q
,
ÔÔQ R

insertData
ÔÔS ]
.
ÔÔ] ^
Id
ÔÔ^ `
,
ÔÔ` a
Tanggal
ÔÔb i
)
ÔÔi j
)
ÔÔj k
;
ÔÔk l
return
 
Content
 
(
 
$str
 o
)
o p
;
p q
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
throw
ÙÙ 
;
ÙÙ 
}
ıı 
}
ˆˆ 	
public
˜˜ 
async
˜˜ 
Task
˜˜ 
<
˜˜ 
IActionResult
˜˜ '
>
˜˜' (
PrintPDFNoD
˜˜) 4
(
˜˜4 5
string
˜˜5 ;
Tanggal
˜˜< C
)
˜˜C D
{
¯¯ 	
if
˘˘ 
(
˘˘ 
!
˘˘ 
lastSession
˘˘ 
.
˘˘ 
Update
˘˘ #
(
˘˘# $
)
˘˘$ %
)
˘˘% &
{
˙˙ 
return
˚˚ 
RedirectToAction
˚˚ '
(
˚˚' (
$str
˚˚( /
,
˚˚/ 0
	GetConfig
˚˚1 :
.
˚˚: ;

AppSetting
˚˚; E
[
˚˚E F
$str
˚˚F n
]
˚˚n o
+
˚˚p q
$str
˚˚r y
,
˚˚y z
new
˚˚{ ~
{˚˚ Ä
a˚˚Å Ç
=˚˚É Ñ
true˚˚Ö â
}˚˚ä ã
)˚˚ã å
;˚˚å ç
}
¸¸ 
var
˝˝ 
location
˝˝ 
=
˝˝ 
new
˝˝ 
Uri
˝˝ "
(
˝˝" #
$"
˝˝# %
{
˝˝% &
Request
˝˝& -
.
˝˝- .
Scheme
˝˝. 4
}
˝˝4 5
$str
˝˝5 8
{
˝˝8 9
Request
˝˝9 @
.
˝˝@ A
Host
˝˝A E
}
˝˝E F
{
˝˝F G
Request
˝˝G N
.
˝˝N O
Path
˝˝O S
}
˝˝S T
"
˝˝T U
)
˝˝U V
;
˝˝V W
string
˛˛ 
path
˛˛ 
=
˛˛ 
location
˛˛ "
.
˛˛" #
AbsolutePath
˛˛# /
.
˛˛/ 0
Replace
˛˛0 7
(
˛˛7 8
this
˛˛8 <
.
˛˛< =
ControllerContext
˛˛= N
.
˛˛N O
	RouteData
˛˛O X
.
˛˛X Y
Values
˛˛Y _
[
˛˛_ `
$str
˛˛` h
]
˛˛h i
.
˛˛i j
ToString
˛˛j r
(
˛˛r s
)
˛˛s t
,
˛˛t u
$str
˛˛v }
)
˛˛} ~
;
˛˛~ 
if
ˇˇ 
(
ˇˇ 
!
ˇˇ 
accessSecurity
ˇˇ 
.
ˇˇ  
IsGetAccess
ˇˇ  +
(
ˇˇ+ ,
$str
ˇˇ, 0
+
ˇˇ1 2
path
ˇˇ3 7
)
ˇˇ7 8
)
ˇˇ8 9
{
ÄÄ 
return
ÅÅ 
RedirectToAction
ÅÅ '
(
ÅÅ' (
$str
ÅÅ( 3
,
ÅÅ3 4
$str
ÅÅ5 <
)
ÅÅ< =
;
ÅÅ= >
}
ÇÇ 
var
ÑÑ 

insertData
ÑÑ 
=
ÑÑ 
new
ÑÑ   
TblDownloadBigFile
ÑÑ! 3
(
ÑÑ3 4
)
ÑÑ4 5
;
ÑÑ5 6
try
ÜÜ 
{
áá 
var
àà 
req
àà 
=
àà 
new
àà 
{
àà 
tanggal
àà  '
=
àà( )
Tanggal
àà* 1
}
àà1 2
;
àà2 3
var
ää 
regex
ää 
=
ää 
await
ää !
RegexRequest
ää" .
.
ää. /
RegexValidation
ää/ >
(
ää> ?
req
ää? B
)
ääB C
;
ääC D
if
ãã 
(
ãã 
!
ãã 
regex
ãã 
)
ãã 
{
åå 
return
çç 
Content
çç "
(
çç" #
$str
çç# 1
)
çç1 2
;
çç2 3
}
éé 

insertData
íí 
.
íí 
Path
íí 
=
íí  !
	GetConfig
íí" +
.
íí+ ,

AppSetting
íí, 6
[
íí6 7
$str
íí7 =
]
íí= >
+
íí? @
$str
ííA R
+
ííS T
DateTime
ííU ]
.
íí] ^
Now
íí^ a
.
íía b
ToString
ííb j
(
ííj k
$str
íík ~
)
íí~ 
+ííÄ Å
$strííÇ à
;ííà â

insertData
ìì 
.
ìì 
FileName
ìì #
=
ìì$ %
$str
ìì& 7
+
ìì8 9
DateTime
ìì: B
.
ììB C
Now
ììC F
.
ììF G
ToString
ììG O
(
ììO P
$str
ììP c
)
ììc d
;
ììd e

insertData
îî 
.
îî 
StatusDownload
îî )
=
îî* +
$num
îî, -
;
îî- .

insertData
ïï 
.
ïï 
FileExt
ïï "
=
ïï# $
$str
ïï% *
;
ïï* +

insertData
ññ 
.
ññ 
CreatedTime
ññ &
=
ññ' (
DateTime
ññ) 1
.
ññ1 2
Now
ññ2 5
;
ññ5 6

insertData
óó 
.
óó 
CreatedById
óó &
=
óó' (
int
óó) ,
.
óó, -
Parse
óó- 2
(
óó2 3
HttpContext
óó3 >
.
óó> ?
Session
óó? F
.
óóF G
	GetString
óóG P
(
óóP Q
SessionConstan
óóQ _
.
óó_ `
Session_UserId
óó` n
)
óón o
)
óóo p
;
óóp q
await
òò 
_context
òò 
.
òò !
TblDownloadBigFiles
òò 2
.
òò2 3
AddAsync
òò3 ;
(
òò; <

insertData
òò< F
)
òòF G
;
òòG H
await
ôô 
_context
ôô 
.
ôô 
SaveChangesAsync
ôô /
(
ôô/ 0
)
ôô0 1
;
ôô1 2
var
õõ 
print
õõ 
=
õõ 
new
õõ 
PrintExport
õõ  +
(
õõ+ ,

_converter
õõ, 6
)
õõ6 7
;
õõ7 8
var
úú 
namaPegawai
úú 
=
úú  !
HttpContext
úú" -
.
úú- .
Session
úú. 5
.
úú5 6
	GetString
úú6 ?
(
úú? @
SessionConstan
úú@ N
.
úúN O
Session_Name
úúO [
)
úú[ \
;
úú\ ]
var
ùù 
requestScheme
ùù !
=
ùù" #
Request
ùù$ +
.
ùù+ ,
Scheme
ùù, 2
;
ùù2 3
var
ûû 
requestHost
ûû 
=
ûû  !
Request
ûû" )
.
ûû) *
Host
ûû* .
.
ûû. /
ToString
ûû/ 7
(
ûû7 8
)
ûû8 9
;
ûû9 :
Task
üü 
.
üü 
Run
üü 
(
üü 
(
üü 
)
üü 
=>
üü 
print
üü $
.
üü$ %
PrintNoDPDF
üü% 0
(
üü0 1
Tanggal
üü1 8
,
üü8 9
namaPegawai
üü: E
,
üüE F
requestScheme
üüG T
,
üüT U
requestHost
üüV a
,
üüa b

insertData
üüc m
.
üüm n
Id
üün p
)
üüp q
)
üüq r
;
üür s
return
†† 
Content
†† 
(
†† 
$str
†† o
)
††o p
;
††p q
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
§§ 
var
•• 
log
•• 
=
•• 
new
•• 
TblLogErrorPrint
•• .
(
••. /
)
••/ 0
;
••0 1
log
¶¶ 
.
¶¶ 
IdFile
¶¶ 
=
¶¶ 

insertData
¶¶ '
.
¶¶' (
Id
¶¶( *
;
¶¶* +
log
ßß 
.
ßß 
ErrorMessage
ßß  
=
ßß! "
ex
ßß# %
.
ßß% &
Message
ßß& -
+
ßß. /
$str
ßß0 5
+
ßß6 7
ex
ßß8 :
.
ßß: ;
InnerException
ßß; I
;
ßßI J
log
®® 
.
®® 
CreatedTime
®® 
=
®®  !
DateTime
®®" *
.
®®* +
Now
®®+ .
;
®®. /
await
©© 
_context
©© 
.
©© 
TblLogErrorPrints
©© 0
.
©©0 1
AddAsync
©©1 9
(
©©9 :
log
©©: =
)
©©= >
;
©©> ?
await
™™ 
_context
™™ 
.
™™ 
SaveChangesAsync
™™ /
(
™™/ 0
)
™™0 1
;
™™1 2
throw
´´ 
;
´´ 
}
¨¨ 
}
≠≠ 	
public
±± 
async
±± 
Task
±± 
<
±± 
object
±±  
>
±±  !'
DownloadFilePendukungTemp
±±" ;
(
±±; <
int
±±< ?
id
±±@ B
)
±±B C
{
≤≤ 	
if
¥¥ 
(
¥¥ 
!
¥¥ 
lastSession
¥¥ 
.
¥¥ 
Update
¥¥ #
(
¥¥# $
)
¥¥$ %
)
¥¥% &
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( /
,
∂∂/ 0
$str
∂∂1 8
,
∂∂8 9
new
∂∂: =
{
∂∂> ?
a
∂∂@ A
=
∂∂B C
true
∂∂D H
}
∂∂I J
)
∂∂J K
;
∂∂K L
}
∑∑ 
var
∏∏ 
location
∏∏ 
=
∏∏ 
new
∏∏ 
Uri
∏∏ "
(
∏∏" #
$"
∏∏# %
{
∏∏% &
Request
∏∏& -
.
∏∏- .
Scheme
∏∏. 4
}
∏∏4 5
$str
∏∏5 8
{
∏∏8 9
Request
∏∏9 @
.
∏∏@ A
Host
∏∏A E
}
∏∏E F
{
∏∏F G
Request
∏∏G N
.
∏∏N O
Path
∏∏O S
}
∏∏S T
"
∏∏T U
)
∏∏U V
;
∏∏V W
string
ππ 
Patha
ππ 
=
ππ 
location
ππ #
.
ππ# $
AbsolutePath
ππ$ 0
.
ππ0 1
Replace
ππ1 8
(
ππ8 9
this
ππ9 =
.
ππ= >
ControllerContext
ππ> O
.
ππO P
	RouteData
ππP Y
.
ππY Z
Values
ππZ `
[
ππ` a
$str
ππa i
]
ππi j
.
ππj k
ToString
ππk s
(
ππs t
)
ππt u
,
ππu v
$str
ππw ~
)
ππ~ 
;ππ Ä
if
∫∫ 
(
∫∫ 
!
∫∫ 
accessSecurity
∫∫ 
.
∫∫  
IsGetAccess
∫∫  +
(
∫∫+ ,
$str
∫∫, 0
+
∫∫1 2
Patha
∫∫3 8
)
∫∫8 9
)
∫∫9 :
{
ªª 
return
ºº 
RedirectToAction
ºº '
(
ºº' (
$str
ºº( 3
,
ºº3 4
$str
ºº5 <
)
ºº< =
;
ºº= >
}
ΩΩ 
try
øø 
{
¿¿ 
var
¬¬ 
data
¬¬ 
=
¬¬ 
new
¬¬ 
object
¬¬ %
(
¬¬% &
)
¬¬& '
;
¬¬' (
var
√√ 
check
√√ 
=
√√ 
await
√√ !
_context
√√" *
.
√√* +#
TblFileUploadNodTemps
√√+ @
.
√√@ A
Where
√√A F
(
√√F G
x
√√G H
=>
√√I K
x
√√L M
.
√√M N
Id
√√N P
==
√√Q S
id
√√T V
)
√√V W
.
√√W X!
FirstOrDefaultAsync
√√X k
(
√√k l
)
√√l m
;
√√m n
if
ƒƒ 
(
ƒƒ 
System
ƒƒ 
.
ƒƒ 
IO
ƒƒ 
.
ƒƒ 
File
ƒƒ "
.
ƒƒ" #
Exists
ƒƒ# )
(
ƒƒ) *
check
ƒƒ* /
.
ƒƒ/ 0
FilePath
ƒƒ0 8
)
ƒƒ8 9
)
ƒƒ9 :
{
≈≈ 
byte
«« 
[
«« 
]
«« 
	fileBytes
«« $
=
««% &
System
««' -
.
««- .
IO
««. 0
.
««0 1
File
««1 5
.
««5 6
ReadAllBytes
««6 B
(
««B C
check
««C H
.
««H I
FilePath
««I Q
)
««Q R
;
««R S
Response
   
.
   
Headers
   $
.
  $ %
Add
  % (
(
  ( )
$str
  ) >
,
  > ?
$str
  @ Y
+
  Z [
check
  \ a
.
  a b
FileName
  b j
+
  k l
$str
  m p
+
  q r
check
  s x
.
  x y
FileExt  y Ä
+  Å Ç
$str  É á
)  á à
;  à â
Response
ÀÀ 
.
ÀÀ 
Headers
ÀÀ $
.
ÀÀ$ %
Add
ÀÀ% (
(
ÀÀ( )
$str
ÀÀ) 7
,
ÀÀ7 8
$str
ÀÀ9 S
)
ÀÀS T
;
ÀÀT U
return
ŒŒ 
File
ŒŒ 
(
ŒŒ  
	fileBytes
ŒŒ  )
,
ŒŒ) *
$str
ŒŒ+ E
)
ŒŒE F
;
ŒŒF G
}
œœ 
else
–– 
{
—— 
return
““ 
NotFound
““ #
(
““# $
$str
““$ 4
)
““4 5
;
““5 6
}
”” 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
Ex
’’ 
)
’’  
{
÷÷ 
return
◊◊ 
Content
◊◊ 
(
◊◊ 
Ex
◊◊ !
.
◊◊! "
Message
◊◊" )
.
◊◊) *
ToString
◊◊* 2
(
◊◊2 3
)
◊◊3 4
)
◊◊4 5
;
◊◊5 6
}
ÿÿ 
}
ŸŸ 	
public
⁄⁄ 
async
⁄⁄ 
Task
⁄⁄ 
<
⁄⁄ 
object
⁄⁄  
>
⁄⁄  !#
DownloadFilePendukung
⁄⁄" 7
(
⁄⁄7 8
int
⁄⁄8 ;
id
⁄⁄< >
)
⁄⁄> ?
{
€€ 	
if
›› 
(
›› 
!
›› 
lastSession
›› 
.
›› 
Update
›› #
(
››# $
)
››$ %
)
››% &
{
ﬁﬁ 
return
ﬂﬂ 
RedirectToAction
ﬂﬂ '
(
ﬂﬂ' (
$str
ﬂﬂ( /
,
ﬂﬂ/ 0
$str
ﬂﬂ1 8
,
ﬂﬂ8 9
new
ﬂﬂ: =
{
ﬂﬂ> ?
a
ﬂﬂ@ A
=
ﬂﬂB C
true
ﬂﬂD H
}
ﬂﬂI J
)
ﬂﬂJ K
;
ﬂﬂK L
}
‡‡ 
var
·· 
location
·· 
=
·· 
new
·· 
Uri
·· "
(
··" #
$"
··# %
{
··% &
Request
··& -
.
··- .
Scheme
··. 4
}
··4 5
$str
··5 8
{
··8 9
Request
··9 @
.
··@ A
Host
··A E
}
··E F
{
··F G
Request
··G N
.
··N O
Path
··O S
}
··S T
"
··T U
)
··U V
;
··V W
string
‚‚ 
Patha
‚‚ 
=
‚‚ 
location
‚‚ #
.
‚‚# $
AbsolutePath
‚‚$ 0
.
‚‚0 1
Replace
‚‚1 8
(
‚‚8 9
this
‚‚9 =
.
‚‚= >
ControllerContext
‚‚> O
.
‚‚O P
	RouteData
‚‚P Y
.
‚‚Y Z
Values
‚‚Z `
[
‚‚` a
$str
‚‚a i
]
‚‚i j
.
‚‚j k
ToString
‚‚k s
(
‚‚s t
)
‚‚t u
,
‚‚u v
$str
‚‚w ~
)
‚‚~ 
;‚‚ Ä
if
„„ 
(
„„ 
!
„„ 
accessSecurity
„„ 
.
„„  
IsGetAccess
„„  +
(
„„+ ,
$str
„„, 0
+
„„1 2
Patha
„„3 8
)
„„8 9
)
„„9 :
{
‰‰ 
return
ÂÂ 
RedirectToAction
ÂÂ '
(
ÂÂ' (
$str
ÂÂ( 3
,
ÂÂ3 4
$str
ÂÂ5 <
)
ÂÂ< =
;
ÂÂ= >
}
ÊÊ 
try
ËË 
{
ÈÈ 
var
ÎÎ 
data
ÎÎ 
=
ÎÎ 
new
ÎÎ 
object
ÎÎ %
(
ÎÎ% &
)
ÎÎ& '
;
ÎÎ' (
var
ÏÏ 
check
ÏÏ 
=
ÏÏ 
await
ÏÏ !
_context
ÏÏ" *
.
ÏÏ* +
TblFileUploadNods
ÏÏ+ <
.
ÏÏ< =
Where
ÏÏ= B
(
ÏÏB C
x
ÏÏC D
=>
ÏÏE G
x
ÏÏH I
.
ÏÏI J
Id
ÏÏJ L
==
ÏÏM O
id
ÏÏP R
)
ÏÏR S
.
ÏÏS T!
FirstOrDefaultAsync
ÏÏT g
(
ÏÏg h
)
ÏÏh i
;
ÏÏi j
if
ÌÌ 
(
ÌÌ 
System
ÌÌ 
.
ÌÌ 
IO
ÌÌ 
.
ÌÌ 
File
ÌÌ "
.
ÌÌ" #
Exists
ÌÌ# )
(
ÌÌ) *
check
ÌÌ* /
.
ÌÌ/ 0
FilePath
ÌÌ0 8
)
ÌÌ8 9
)
ÌÌ9 :
{
ÓÓ 
byte
 
[
 
]
 
	fileBytes
 $
=
% &
System
' -
.
- .
IO
. 0
.
0 1
File
1 5
.
5 6
ReadAllBytes
6 B
(
B C
check
C H
.
H I
FilePath
I Q
)
Q R
;
R S
Response
ÛÛ 
.
ÛÛ 
Headers
ÛÛ $
.
ÛÛ$ %
Add
ÛÛ% (
(
ÛÛ( )
$str
ÛÛ) >
,
ÛÛ> ?
$str
ÛÛ@ Y
+
ÛÛZ [
check
ÛÛ\ a
.
ÛÛa b
FileName
ÛÛb j
+
ÛÛk l
$str
ÛÛm p
+
ÛÛq r
check
ÛÛs x
.
ÛÛx y
FileExtÛÛy Ä
+ÛÛÅ Ç
$strÛÛÉ á
)ÛÛá à
;ÛÛà â
Response
ÙÙ 
.
ÙÙ 
Headers
ÙÙ $
.
ÙÙ$ %
Add
ÙÙ% (
(
ÙÙ( )
$str
ÙÙ) 7
,
ÙÙ7 8
$str
ÙÙ9 S
)
ÙÙS T
;
ÙÙT U
return
˜˜ 
File
˜˜ 
(
˜˜  
	fileBytes
˜˜  )
,
˜˜) *
$str
˜˜+ E
)
˜˜E F
;
˜˜F G
}
¯¯ 
else
˘˘ 
{
˙˙ 
return
˚˚ 
NotFound
˚˚ #
(
˚˚# $
$str
˚˚$ 4
)
˚˚4 5
;
˚˚5 6
}
¸¸ 
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
Ex
˛˛ 
)
˛˛  
{
ˇˇ 
return
ÄÄ 
Content
ÄÄ 
(
ÄÄ 
Ex
ÄÄ !
.
ÄÄ! "
Message
ÄÄ" )
.
ÄÄ) *
ToString
ÄÄ* 2
(
ÄÄ2 3
)
ÄÄ3 4
)
ÄÄ4 5
;
ÄÄ5 6
}
ÅÅ 
}
ÇÇ 	
public
ÜÜ 
bool
ÜÜ 
CheckCreditorRef
ÜÜ $
(
ÜÜ$ %
string
ÜÜ% +
CreditorRef
ÜÜ, 7
)
ÜÜ7 8
{
áá 	,
ListDataDropdownServerSideDeva
ââ *
source
ââ+ 1
=
ââ2 3
new
ââ4 7,
ListDataDropdownServerSideDeva
ââ8 V
(
ââV W
)
ââW X
;
ââX Y
var
ãã 
Search
ãã 
=
ãã 
CreditorRef
ãã $
==
ãã% '
null
ãã( ,
?
ãã- .
$str
ãã/ 1
:
ãã2 3
CreditorRef
ãã4 ?
;
ãã? @
try
åå 
{
çç 
var
éé 
url
éé 
=
éé 
	GetConfig
éé #
.
éé# $

AppSetting
éé$ .
[
éé. /
$str
éé/ @
]
éé@ A
+
ééB C
	GetConfig
ééD M
.
ééM N

AppSetting
ééN X
[
ééX Y
$str
ééY n
]
één o
+
éép q
$str
éér x
+
ééy z
$num
éé{ |
+
éé} ~
$stréé á
+ééà â
$numééä ã
+ééå ç
$strééé »
+éé…  
SearchééÀ —
+éé“ ”
$stréé‘ ÿ
;ééÿ Ÿ
(
èè 
bool
èè 
	resultApi
èè 
,
èè  
string
èè! '
result
èè( .
)
èè. /
=
èè0 1
RequestToAPI
èè2 >
.
èè> ?!
GetJsonStringWebApi
èè? R
(
èèR S
url
èèS V
,
èèV W
null
èèX \
)
èè\ ]
;
èè] ^
if
êê 
(
êê 
	resultApi
êê 
&&
êê  
!
êê! "
string
êê" (
.
êê( )
IsNullOrEmpty
êê) 6
(
êê6 7
result
êê7 =
)
êê= >
)
êê> ?
{
ëë 
var
íí 
jsonParseReturn
íí '
=
íí( )
JsonConvert
íí* 5
.
íí5 6
DeserializeObject
íí6 G
<
ííG H!
ResultStatusDataInt
ííH [
<
íí[ \(
DataDropdownServerSideDeva
íí\ v
>
íív w
>
ííw x
(
ííx y
result
ííy 
)íí Ä
;ííÄ Å
if
îî 
(
îî 
jsonParseReturn
îî '
.
îî' (
Value
îî( -
.
îî- .
Count
îî. 3
(
îî3 4
)
îî4 5
!=
îî6 8
$num
îî9 :
)
îî: ;
{
ïï 
return
ññ 
true
ññ #
;
ññ# $
}
óó 
else
òò 
{
ôô 
return
öö 
false
öö $
;
öö$ %
}
õõ 
}
úú 
else
ùù 
{
ùù 
return
ûû 
false
ûû  
;
ûû  !
}
üü 
}
†† 
catch
°° 
(
°° 
	Exception
°° 
Ex
°° 
)
°°  
{
¢¢ 
return
££ 
false
££ 
;
££ 
}
§§ 
}
•• 	
}
ßß 
}®® £Ÿ
QD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\MasterUserController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public 
class  
MasterUserController "
:# $

Controller% /
{ 
private 	
readonly
 %
DbDashboardDevaBniContext ,
_context- 5
;5 6
private 	
readonly
 
IConfiguration !
_configuration" 0
;0 1
private 	
readonly
 
LastSessionLog !
lastSession" -
;- .
private 	
readonly
 
AccessSecurity !
accessSecurity" 0
;0 1
public  
MasterUserController	 
( 
IConfiguration ,
config- 3
,3 4%
DbDashboardDevaBniContext5 N
contextO V
,V W 
IHttpContextAccessorX l
accessorm u
)u v
{ 
_context 
= 
context 
; 
_configuration 
= 
config 
; 
lastSession 
= 
new 
LastSessionLog #
(# $
accessor$ ,
,, -
context. 5
,5 6
config7 =
)= >
;> ?
accessSecurity 
= 
new 
AccessSecurity &
(& '
accessor' /
,/ 0
context1 8
,8 9
config: @
)@ A
;A B
} 
public!! 
IActionResult!!	 
Index!! 
(!! 
)!! 
{"" 
if## 
(## 
!## 
lastSession## 
.## 
Update## 
(## 
)## 
)## 
{$$ 
return%% 

RedirectToAction%% 
(%% 
$str%% #
,%%# $
	GetConfig%%% .
.%%. /

AppSetting%%/ 9
[%%9 :
$str%%: V
]%%V W
+%%X Y
$str%%Z a
,%%a b
new%%c f
{%%g h
a%%i j
=%%k l
true%%m q
}%%r s
)%%s t
;%%t u
}&& 
var'' 
location'' 
='' 
new'' 
Uri'' 
('' 
$"'' 
{'' 
Request'' $
.''$ %
Scheme''% +
}''+ ,
$str'', /
{''/ 0
Request''0 7
.''7 8
Host''8 <
}''< =
{''= >
Request''> E
.''E F
Path''F J
}''J K
"''K L
)''L M
;''M N
string(( 	
Path((
 
=(( 
location(( 
.(( 
AbsolutePath(( &
;((& '
if)) 
()) 
!)) 
accessSecurity)) 
.)) 
IsGetAccess)) "
())" #
$str))# '
+))( )
Path))* .
))). /
)))/ 0
{** 
return++ 

RedirectToAction++ 
(++ 
$str++ '
,++' (
	GetConfig++) 2
.++2 3

AppSetting++3 =
[++= >
$str++> Z
]++Z [
+++\ ]
$str++^ e
)++e f
;++f g
},, 
ViewBag.. 

...
 
CurrentPath.. 
=.. 
Path.. 
;.. 
ViewBag// 

.//
 

Pengumuman// 
=// 
_context//  
.//  !%
TblMasterSystemParameters//! :
.//: ;
Where//; @
(//@ A
x//A B
=>//C E
x//F G
.//G H
Key//H K
==//L N
$str//O [
)//[ \
.//\ ]
Select//] c
(//c d
x//d e
=>//f h
x//i j
.//j k
Value//k p
)//p q
.//q r
FirstOrDefault	//r Ä
(
//Ä Å
)
//Å Ç
;
//Ç É
ViewBag00 

.00
 
Speed00 
=00 
int00 
.00 
Parse00 
(00 
_context00 %
.00% &%
TblMasterSystemParameters00& ?
.00? @
Where00@ E
(00E F
x00F G
=>00H J
x00K L
.00L M
Key00M P
==00Q S
$str00T [
)00[ \
.00\ ]
Select00] c
(00c d
x00d e
=>00f h
x00i j
.00j k
Value00k p
)00p q
.00q r
FirstOrDefault	00r Ä
(
00Ä Å
)
00Å Ç
)
00Ç É
;
00É Ñ
return11 	
View11
 
(11 
)11 
;11 
}22 
[55 
HttpPost55 
]55 
public66 
IActionResult66	 
LoadData66 
(66  
)66  !
{77 
if88 
(88 
!88 
lastSession88 
.88 
Update88 
(88 
)88 
)88 
{99 
return:: 

RedirectToAction:: 
(:: 
$str:: #
,::# $
	GetConfig::% .
.::. /

AppSetting::/ 9
[::9 :
$str::: V
]::V W
+::X Y
$str::Z a
,::a b
new::c f
{::g h
a::i j
=::k l
true::m q
}::r s
)::s t
;::t u
};; 
var<< 
location<< 
=<< 
new<< 
Uri<< 
(<< 
$"<< 
{<< 
Request<< $
.<<$ %
Scheme<<% +
}<<+ ,
$str<<, /
{<</ 0
Request<<0 7
.<<7 8
Host<<8 <
}<<< =
{<<= >
Request<<> E
.<<E F
Path<<F J
}<<J K
"<<K L
)<<L M
;<<M N
string== 	
Path==
 
=== 
location== 
.== 
AbsolutePath== &
.==& '
Replace==' .
(==. /
this==/ 3
.==3 4
ControllerContext==4 E
.==E F
	RouteData==F O
.==O P
Values==P V
[==V W
$str==W _
]==_ `
.==` a
ToString==a i
(==i j
)==j k
,==k l
$str==m t
)==t u
;==u v
if>> 
(>> 
!>> 
accessSecurity>> 
.>> 
IsGetAccess>> "
(>>" #
$str>># '
+>>( )
Path>>* .
)>>. /
)>>/ 0
{?? 
return@@ 

RedirectToAction@@ 
(@@ 
$str@@ '
,@@' (
$str@@) 0
)@@0 1
;@@1 2
}AA 
tryCC 
{DD 
varEE 
dictEE 
=EE 
RequestEE 
.EE 
FormEE 
.EE 
ToDictionaryEE (
(EE( )
xEE) *
=>EE+ -
xEE. /
.EE/ 0
KeyEE0 3
,EE3 4
xEE5 6
=>EE7 9
xEE: ;
.EE; <
ValueEE< A
.EEA B
ToStringEEB J
(EEJ K
)EEK L
)EEL M
;EEM N
varGG 
drawGG 
=GG 
dictGG 
[GG 
$strGG 
]GG 
;GG 
varJJ 
startJJ 
=JJ 
dictJJ 
[JJ 
$strJJ 
]JJ 
;JJ 
varKK 
lengthKK 
=KK 
dictKK 
[KK 
$strKK 
]KK 
;KK  
varOO 

pageNumberOO 
=OO 
(OO 
intOO 
.OO 
ParseOO 
(OO  
startOO  %
)OO% &
/OO' (
intOO) ,
.OO, -
ParseOO- 2
(OO2 3
lengthOO3 9
)OO9 :
)OO: ;
+OO< =
$numOO> ?
;OO? @
varRR 

sortColumnRR 
=RR 
dictRR 
[RR 
$strRR $
+RR% &
dictRR' +
[RR+ ,
$strRR, >
]RR> ?
+RR@ A
$strRRB K
]RRK L
;RRL M
varSS 
sortColumnDirSS 
=SS 
dictSS 
[SS 
$strSS ,
]SS, -
;SS- .
varTT 
NameSearchParamTT 
=TT 
dictTT 
[TT 
$strTT :
]TT: ;
;TT; <
varUU 
UsernameSearchParamUU 
=UU 
dictUU "
[UU" #
$strUU# >
]UU> ?
;UU? @
intYY 
pageSizeYY 
=YY 
lengthYY 
!=YY 
nullYY !
?YY" #
ConvertYY$ +
.YY+ ,
ToInt32YY, 3
(YY3 4
lengthYY4 :
)YY: ;
:YY< =
$numYY> ?
;YY? @
intZZ 
skipZZ 
=ZZ 
startZZ 
!=ZZ 
nullZZ 
?ZZ 
ConvertZZ &
.ZZ& '
ToInt32ZZ' .
(ZZ. /
startZZ/ 4
)ZZ4 5
:ZZ6 7
$numZZ8 9
;ZZ9 :
int[[ 
recordsTotal[[ 
=[[ 
$num[[ 
;[[ 
List\\ 
<\\ 	 
MasterUser_ViewModel\\	 
>\\ 
list\\ #
=\\$ %
new\\& )
List\\* .
<\\. / 
MasterUser_ViewModel\\/ C
>\\C D
(\\D E
)\\E F
;\\F G
list__ 
=__	 
#
StoredProcedureExecutor__ "
.__" #
ExecuteSPList__# 0
<__0 1 
MasterUser_ViewModel__1 E
>__E F
(__F G
_context__G O
,__O P
$str__Q j
,__j k
new__l o
SqlParameter__p |
[__| }
]__} ~
{__~ 
new`` 	
SqlParameter``
 
(`` 
$str`` 
,`` 
NameSearchParam``  /
)``/ 0
,``0 1
newaa 	
SqlParameteraa
 
(aa 
$straa "
,aa" #
UsernameSearchParamaa$ 7
)aa7 8
,aa8 9
newbb 	
SqlParameterbb
 
(bb 
$strbb $
,bb$ %

sortColumnbb& 0
)bb0 1
,bb1 2
newcc 	
SqlParametercc
 
(cc 
$strcc '
,cc' (
sortColumnDircc) 6
)cc6 7
,cc7 8
newdd 	
SqlParameterdd
 
(dd 
$strdd $
,dd$ %

pageNumberdd& 0
)dd0 1
,dd1 2
newee 	
SqlParameteree
 
(ee 
$stree "
,ee" #
pageSizeee$ ,
)ee, -
,ee- .
}ff 
)ff 
;ff 
recordsTotalii 
=ii #
StoredProcedureExecutorii *
.ii* +
ExecuteScalarIntii+ ;
(ii; <
_contextii< D
,iiD E
$striiF `
,ii` a
newiib e
SqlParameteriif r
[iir s
]iis t
{iit u
newjj 	
SqlParameterjj
 
(jj 
$strjj 
,jj 
NameSearchParamjj  /
)jj/ 0
,jj0 1
newkk 	
SqlParameterkk
 
(kk 
$strkk "
,kk" #
UsernameSearchParamkk$ 7
)kk7 8
}ll 
)ll 
;ll 
ifnn 
(nn 
listnn 
==nn 
nullnn 
)nn 
{oo 
listpp 	
=pp
 
newpp 
Listpp 
<pp  
MasterUser_ViewModelpp )
>pp) *
(pp* +
)pp+ ,
;pp, -
recordsTotalqq 
=qq 
$numqq 
;qq 
}rr 
returntt 

Jsontt 
(tt 
newtt 
{tt 
drawtt 
=tt 
drawtt !
,tt! "
recordsFilteredtt# 2
=tt3 4
recordsTotaltt5 A
,ttA B
recordsTotalttC O
=ttP Q
recordsTotalttR ^
,tt^ _
datatt` d
=tte f
listttg k
}ttl m
)ttm n
;ttn o
}uu 
catchvv 
(vv	 

	Exceptionvv
 
Exvv 
)vv 
{ww 
throwxx 	
;xx	 

}yy 
}zz 
public~~ 
ActionResult~~	 
Create~~ 
(~~ 
)~~ 
{ 
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
lastSession
ÄÄ 
.
ÄÄ 
Update
ÄÄ 
(
ÄÄ 
)
ÄÄ 
)
ÄÄ 
{
ÅÅ 
return
ÇÇ 

RedirectToAction
ÇÇ 
(
ÇÇ 
$str
ÇÇ #
,
ÇÇ# $
	GetConfig
ÇÇ% .
.
ÇÇ. /

AppSetting
ÇÇ/ 9
[
ÇÇ9 :
$str
ÇÇ: V
]
ÇÇV W
+
ÇÇX Y
$str
ÇÇZ a
,
ÇÇa b
new
ÇÇc f
{
ÇÇg h
a
ÇÇi j
=
ÇÇk l
true
ÇÇm q
}
ÇÇr s
)
ÇÇs t
;
ÇÇt u
}
ÉÉ 
var
ÑÑ 
location
ÑÑ 
=
ÑÑ 
new
ÑÑ 
Uri
ÑÑ 
(
ÑÑ 
$"
ÑÑ 
{
ÑÑ 
Request
ÑÑ $
.
ÑÑ$ %
Scheme
ÑÑ% +
}
ÑÑ+ ,
$str
ÑÑ, /
{
ÑÑ/ 0
Request
ÑÑ0 7
.
ÑÑ7 8
Host
ÑÑ8 <
}
ÑÑ< =
{
ÑÑ= >
Request
ÑÑ> E
.
ÑÑE F
Path
ÑÑF J
}
ÑÑJ K
"
ÑÑK L
)
ÑÑL M
;
ÑÑM N
string
ÖÖ 	
Path
ÖÖ
 
=
ÖÖ 
location
ÖÖ 
.
ÖÖ 
AbsolutePath
ÖÖ &
.
ÖÖ& '
Replace
ÖÖ' .
(
ÖÖ. /
this
ÖÖ/ 3
.
ÖÖ3 4
ControllerContext
ÖÖ4 E
.
ÖÖE F
	RouteData
ÖÖF O
.
ÖÖO P
Values
ÖÖP V
[
ÖÖV W
$str
ÖÖW _
]
ÖÖ_ `
.
ÖÖ` a
ToString
ÖÖa i
(
ÖÖi j
)
ÖÖj k
,
ÖÖk l
$str
ÖÖm t
)
ÖÖt u
;
ÖÖu v
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
accessSecurity
ÜÜ 
.
ÜÜ 
IsGetAccess
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# '
+
ÜÜ( )
Path
ÜÜ* .
)
ÜÜ. /
)
ÜÜ/ 0
{
áá 
return
àà 

RedirectToAction
àà 
(
àà 
$str
àà '
,
àà' (
$str
àà) 0
)
àà0 1
;
àà1 2
}
ââ 
ViewBag
ãã 

.
ãã
 
RoleId
ãã 
=
ãã 
new
ãã 

SelectList
ãã "
(
ãã" #
$str
ãã# %
,
ãã% &
$str
ãã' )
)
ãã) *
;
ãã* +
return
åå 	
PartialView
åå
 
(
åå 
$str
åå 
)
åå  
;
åå  !
}
çç 
[
èè &
ValidateAntiForgeryToken
èè 
]
èè 
[
êê 
HttpPost
êê 
]
êê 
public
ëë 
async
ëë	 
Task
ëë 
<
ëë 
ActionResult
ëë  
>
ëë  !
SubmitCreate
ëë" .
(
ëë. /
TblMasterUser
ëë/ <
model
ëë= B
)
ëëB C
{
íí 
if
ìì 
(
ìì 
!
ìì 
lastSession
ìì 
.
ìì 
Update
ìì 
(
ìì 
)
ìì 
)
ìì 
{
îî 
return
ïï 

RedirectToAction
ïï 
(
ïï 
$str
ïï #
,
ïï# $
	GetConfig
ïï% .
.
ïï. /

AppSetting
ïï/ 9
[
ïï9 :
$str
ïï: V
]
ïïV W
+
ïïX Y
$str
ïïZ a
,
ïïa b
new
ïïc f
{
ïïg h
a
ïïi j
=
ïïk l
true
ïïm q
}
ïïr s
)
ïïs t
;
ïït u
}
ññ 
var
óó 
location
óó 
=
óó 
new
óó 
Uri
óó 
(
óó 
$"
óó 
{
óó 
Request
óó $
.
óó$ %
Scheme
óó% +
}
óó+ ,
$str
óó, /
{
óó/ 0
Request
óó0 7
.
óó7 8
Host
óó8 <
}
óó< =
{
óó= >
Request
óó> E
.
óóE F
Path
óóF J
}
óóJ K
"
óóK L
)
óóL M
;
óóM N
string
òò 	
Path
òò
 
=
òò 
location
òò 
.
òò 
AbsolutePath
òò &
.
òò& '
Replace
òò' .
(
òò. /
this
òò/ 3
.
òò3 4
ControllerContext
òò4 E
.
òòE F
	RouteData
òòF O
.
òòO P
Values
òòP V
[
òòV W
$str
òòW _
]
òò_ `
.
òò` a
ToString
òòa i
(
òòi j
)
òòj k
,
òòk l
$str
òòm t
)
òòt u
;
òòu v
if
ôô 
(
ôô 
!
ôô 
accessSecurity
ôô 
.
ôô 
IsGetAccess
ôô "
(
ôô" #
$str
ôô# '
+
ôô( )
Path
ôô* .
)
ôô. /
)
ôô/ 0
{
öö 
return
õõ 

RedirectToAction
õõ 
(
õõ 
$str
õõ '
,
õõ' (
$str
õõ) 0
)
õõ0 1
;
õõ1 2
}
úú 
try
ûû 
{
üü 
var
†† 
Password
†† 
=
†† 
model
†† 
.
†† 
Password
†† !
;
††! "
var
¢¢ 
regex
¢¢ 
=
¢¢ 
await
¢¢ 
RegexRequest
¢¢ "
.
¢¢" #
RegexValidation
¢¢# 2
(
¢¢2 3
model
¢¢3 8
)
¢¢8 9
;
¢¢9 :
if
££ 
(
££ 
!
££ 	
regex
££	 
)
££ 
{
§§ 
return
•• 
Content
•• 
(
•• 
$str
•• "
)
••" #
;
••# $
}
¶¶ 
if
®® 
(
®® 
!
®® 	
RegexRequest
®®	 
.
®® 
ValidatePassword
®® &
(
®®& '
model
®®' ,
.
®®, -
Password
®®- 5
)
®®5 6
)
®®6 7
{
©© 
return
™™ 
Content
™™ 
(
™™ 
$str
™™ ,
)
™™, -
;
™™- .
}
´´ 
using
¨¨ 	
(
¨¨
 
TransactionScope
¨¨ 
trx
¨¨ 
=
¨¨  !
new
¨¨" %
TransactionScope
¨¨& 6
(
¨¨6 7
)
¨¨7 8
)
¨¨8 9
{
≠≠ 
TblMasterUser
ÆÆ 
dataUserName
ÆÆ 
=
ÆÆ  !
_context
ÆÆ" *
.
ÆÆ* +
TblMasterUsers
ÆÆ+ 9
.
ÆÆ9 :
Where
ÆÆ: ?
(
ÆÆ? @
m
ÆÆ@ A
=>
ÆÆB D
m
ÆÆE F
.
ÆÆF G
Username
ÆÆG O
==
ÆÆP R
model
ÆÆS X
.
ÆÆX Y
Username
ÆÆY a
&&
ÆÆb d
m
ÆÆe f
.
ÆÆf g
IsActive
ÆÆg o
==
ÆÆp r
true
ÆÆs w
&&
ÆÆx z
m
ÆÆ{ |
.
ÆÆ| }
	IsDeletedÆÆ} Ü
!=ÆÆá â
trueÆÆä é
)ÆÆé è
.ÆÆè ê
FirstOrDefaultÆÆê û
(ÆÆû ü
)ÆÆü †
;ÆÆ† °
if
ØØ 
(
ØØ 	
dataUserName
ØØ	 
!=
ØØ 
null
ØØ 
)
ØØ 
{
∞∞ 
return
±± 
Content
±± 
(
±± 
dataUserName
±± !
.
±±! "
Username
±±" *
+
±±+ ,
$str
±±- ?
)
±±? @
;
±±@ A
}
≤≤ 
TblMasterUser
≥≥ 
	dataEmail
≥≥ 
=
≥≥ 
_context
≥≥ '
.
≥≥' (
TblMasterUsers
≥≥( 6
.
≥≥6 7
Where
≥≥7 <
(
≥≥< =
m
≥≥= >
=>
≥≥? A
m
≥≥B C
.
≥≥C D
Email
≥≥D I
==
≥≥J L
model
≥≥M R
.
≥≥R S
Email
≥≥S X
&&
≥≥Y [
m
≥≥\ ]
.
≥≥] ^
IsActive
≥≥^ f
==
≥≥g i
true
≥≥j n
&&
≥≥o q
m
≥≥r s
.
≥≥s t
	IsDeleted
≥≥t }
!=≥≥~ Ä
true≥≥Å Ö
)≥≥Ö Ü
.≥≥Ü á
FirstOrDefault≥≥á ï
(≥≥ï ñ
)≥≥ñ ó
;≥≥ó ò
if
¥¥ 
(
¥¥ 	
	dataEmail
¥¥	 
!=
¥¥ 
null
¥¥ 
)
¥¥ 
{
µµ 
return
∂∂ 
Content
∂∂ 
(
∂∂ 
	dataEmail
∂∂ 
.
∂∂ 
Email
∂∂ $
+
∂∂% &
$str
∂∂' 9
)
∂∂9 :
;
∂∂: ;
}
∑∑ 
TblMasterUser
∏∏ !
dataWa
∏∏" (
=
∏∏) *
_context
∏∏+ 3
.
∏∏3 4
TblMasterUsers
∏∏4 B
.
∏∏B C
Where
∏∏C H
(
∏∏H I
m
∏∏I J
=>
∏∏K M
m
∏∏N O
.
∏∏O P
NoTelp
∏∏P V
==
∏∏W Y
model
∏∏Z _
.
∏∏_ `
NoTelp
∏∏` f
&&
∏∏g i
m
∏∏j k
.
∏∏k l
IsActive
∏∏l t
==
∏∏u w
true
∏∏x |
&&
∏∏} 
m∏∏Ä Å
.∏∏Å Ç
	IsDeleted∏∏Ç ã
!=∏∏å é
true∏∏è ì
)∏∏ì î
.∏∏î ï
FirstOrDefault∏∏ï £
(∏∏£ §
)∏∏§ •
;∏∏• ¶
if
ππ 
(
ππ 
	dataEmail
ππ !
!=
ππ" $
null
ππ% )
)
ππ) *
{
∫∫ 
return
ªª 
Content
ªª &
(
ªª& '
	dataEmail
ªª' 0
.
ªª0 1
NoTelp
ªª1 7
+
ªª8 9
$str
ªª: L
)
ªªL M
;
ªªM N
}
ºº 
model
ΩΩ 
.
ΩΩ 
Password
ΩΩ "
=
ΩΩ# $
BCrypt
ΩΩ% +
.
ΩΩ+ ,
Net
ΩΩ, /
.
ΩΩ/ 0
BCrypt
ΩΩ0 6
.
ΩΩ6 7
HashPassword
ΩΩ7 C
(
ΩΩC D
model
ΩΩD I
.
ΩΩI J
Password
ΩΩJ R
)
ΩΩR S
;
ΩΩS T
model
ææ 

.
ææ
 
IsActive
ææ 
=
ææ 
true
ææ 
;
ææ 
model
øø 

.
øø
 
	IsDeleted
øø 
=
øø 
false
øø 
;
øø 
model
¿¿ 

.
¿¿
 
CreatedById
¿¿ 
=
¿¿ 
int
¿¿ 
.
¿¿ 
Parse
¿¿ "
(
¿¿" #
HttpContext
¿¿# .
.
¿¿. /
Session
¿¿/ 6
.
¿¿6 7
	GetString
¿¿7 @
(
¿¿@ A
SessionConstan
¿¿A O
.
¿¿O P
Session_UserId
¿¿P ^
)
¿¿^ _
)
¿¿_ `
;
¿¿` a
model
¡¡ 

.
¡¡
 
IsVerifEmail
¡¡ 
=
¡¡ 
$str
¡¡ !
;
¡¡! "
model
¬¬ 

.
¬¬
 
IsVerifNoTelp
¬¬ 
=
¬¬ 
$str
¬¬ "
;
¬¬" #
model
√√ 

.
√√
 
CreatedTime
√√ 
=
√√ 
DateTime
√√ !
.
√√! "
Now
√√" %
;
√√% &
var
≈≈ 
UserId
≈≈ 
=
≈≈  
int
≈≈! $
.
≈≈$ %
Parse
≈≈% *
(
≈≈* +
HttpContext
≈≈+ 6
.
≈≈6 7
Session
≈≈7 >
.
≈≈> ?
	GetString
≈≈? H
(
≈≈H I
SessionConstan
≈≈I W
.
≈≈W X
Session_UserId
≈≈X f
)
≈≈f g
)
≈≈g h
;
≈≈h i
var
∆∆ 
RoleKode
∆∆  
=
∆∆! "
int
∆∆# &
.
∆∆& '
Parse
∆∆' ,
(
∆∆, -
HttpContext
∆∆- 8
.
∆∆8 9
Session
∆∆9 @
.
∆∆@ A
	GetString
∆∆A J
(
∆∆J K
SessionConstan
∆∆K Y
.
∆∆Y Z
Session_RoleKode
∆∆Z j
)
∆∆j k
)
∆∆k l
;
∆∆l m
if
»» 
(
»» 
RoleKode
»»  
==
»»! #
$num
»»$ %
)
»»% &
{
…… 
_context
    
.
    !
TblMasterUsers
  ! /
.
  / 0
Add
  0 3
(
  3 4
model
  4 9
)
  9 :
;
  : ;
_context
ÀÀ  
.
ÀÀ  !
SaveChanges
ÀÀ! ,
(
ÀÀ, -
)
ÀÀ- .
;
ÀÀ. /
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
if
œœ 
(
œœ 
model
œœ !
.
œœ! "
RoleId
œœ" (
==
œœ) +
$num
œœ, -
)
œœ- .
{
–– 
return
—— "
Content
——# *
(
——* +
	GetConfig
——+ 4
.
——4 5

AppSetting
——5 ?
[
——? @
$str
——@ M
]
——M N
)
——N O
;
——O P
}
““ 
else
”” 
{
‘‘ 
_context
’’ $
.
’’$ %
TblMasterUsers
’’% 3
.
’’3 4
Add
’’4 7
(
’’7 8
model
’’8 =
)
’’= >
;
’’> ?
_context
÷÷ $
.
÷÷$ %
SaveChanges
÷÷% 0
(
÷÷0 1
)
÷÷1 2
;
÷÷2 3
}
◊◊ 
}
ÿÿ 
trx
⁄⁄ 
.
⁄⁄ 	
Complete
⁄⁄	 
(
⁄⁄ 
)
⁄⁄ 
;
⁄⁄ 
}
€€ 
SendEmailConfig
‹‹ 
(
‹‹ 
model
‹‹ 
,
‹‹ 
Password
‹‹ #
)
‹‹# $
;
‹‹$ %
return
›› 

Content
›› 
(
›› 
$str
›› 
)
›› 
;
›› 
}
ﬂﬂ 
catch
‡‡ 
(
‡‡	 

	Exception
‡‡
 
Ex
‡‡ 
)
‡‡ 
{
·· 
return
‚‚ 

Content
‚‚ 
(
‚‚ 
	GetConfig
‚‚ 
.
‚‚ 

AppSetting
‚‚ '
[
‚‚' (
$str
‚‚( 5
]
‚‚5 6
)
‚‚6 7
;
‚‚7 8
}
„„ 
}
‰‰ 
public
ÊÊ 
ResultStatus
ÊÊ	 
SendEmailConfig
ÊÊ %
(
ÊÊ% &
TblMasterUser
ÊÊ& 3
model
ÊÊ4 9
,
ÊÊ9 :
string
ÊÊ; A
Password
ÊÊB J
)
ÊÊJ K
{
ÁÁ 
var
ËË 
result
ËË 
=
ËË 
new
ËË 
ResultStatus
ËË  
(
ËË  !
)
ËË! "
;
ËË" #
try
ÈÈ 
{
ÍÍ 
var
ÎÎ 
location
ÎÎ 
=
ÎÎ 
new
ÎÎ "
Uri
ÎÎ# &
(
ÎÎ& '
$"
ÎÎ' )
{
ÎÎ) *
Request
ÎÎ* 1
.
ÎÎ1 2
Scheme
ÎÎ2 8
}
ÎÎ8 9
$str
ÎÎ9 <
{
ÎÎ< =
Request
ÎÎ= D
.
ÎÎD E
Host
ÎÎE I
}
ÎÎI J
{
ÎÎJ K
Request
ÎÎK R
.
ÎÎR S
Path
ÎÎS W
}
ÎÎW X
"
ÎÎX Y
)
ÎÎY Z
;
ÎÎZ [
string
ÏÏ 
Path
ÏÏ 
=
ÏÏ 
location
ÏÏ &
.
ÏÏ& '
AbsolutePath
ÏÏ' 3
;
ÏÏ3 4
var
ÓÓ 
linkweb
ÓÓ 
=
ÓÓ 
$str
ÓÓ >
;
ÓÓ> ?
var
 
body
 
=
 
$str
 &
+
' (
$str
ÒÒ k
+
ÒÒl m
linkweb
ÒÒn u
+
ÒÒv w
$strÒÒx ç
+ÒÒé è
$str
ÚÚ 
+
ÚÚ 
$str
ÛÛ 
+
ÛÛ 
model
ÛÛ 
.
ÛÛ 
Username
ÛÛ "
+
ÛÛ# $
$str
ÙÙ 
+
ÙÙ 
Password
ÙÙ  
+
ÙÙ! "
$str
ıı 
+
ıı 
$str
ˆˆ h
+
ˆˆh i
$str
˜˜ 
+
˜˜ 
$str
¯¯ &
;
¯¯& '
using
˘˘ 
(
˘˘ 
var
˘˘ 
client
˘˘ !
=
˘˘" #
new
˘˘$ '

SmtpClient
˘˘( 2
(
˘˘2 3
	GetConfig
˘˘3 <
.
˘˘< =

AppSetting
˘˘= G
[
˘˘G H
$str
˘˘H Z
]
˘˘Z [
,
˘˘[ \
int
˘˘] `
.
˘˘` a
Parse
˘˘a f
(
˘˘f g
	GetConfig
˘˘g p
.
˘˘p q

AppSetting
˘˘q {
[
˘˘{ |
$str˘˘| å
]˘˘å ç
)˘˘ç é
)˘˘é è
)˘˘è ê
{
˙˙ 
if
˚˚ 
(
˚˚ 
	GetConfig
˚˚ !
.
˚˚! "

AppSetting
˚˚" ,
[
˚˚, -
$str
˚˚- C
]
˚˚C D
==
˚˚E G
$str
˚˚H K
)
˚˚K L
{
¸¸ 
client
˝˝ 
.
˝˝ 
	EnableSsl
˝˝ (
=
˝˝) *
false
˝˝+ 0
;
˝˝0 1
client
˛˛ 
.
˛˛ #
UseDefaultCredentials
˛˛ 4
=
˛˛5 6
false
˛˛7 <
;
˛˛< =
client
ˇˇ 
.
ˇˇ 
Credentials
ˇˇ *
=
ˇˇ+ ,
new
ˇˇ- 0
NetworkCredential
ˇˇ1 B
(
ˇˇB C
	GetConfig
ˇˇC L
.
ˇˇL M

AppSetting
ˇˇM W
[
ˇˇW X
$str
ˇˇX i
]
ˇˇi j
,
ˇˇj k
	GetConfig
ˇˇl u
.
ˇˇu v

AppSettingˇˇv Ä
[ˇˇÄ Å
$strˇˇÅ ï
]ˇˇï ñ
)ˇˇñ ó
;ˇˇó ò
client
ÄÄ 
.
ÄÄ 
DeliveryMethod
ÄÄ -
=
ÄÄ. / 
SmtpDeliveryMethod
ÄÄ0 B
.
ÄÄB C
Network
ÄÄC J
;
ÄÄJ K
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
client
ÑÑ 
.
ÑÑ 
	EnableSsl
ÑÑ (
=
ÑÑ) *
true
ÑÑ+ /
;
ÑÑ/ 0
client
ÖÖ 
.
ÖÖ 
Credentials
ÖÖ *
=
ÖÖ+ ,
new
ÖÖ- 0
NetworkCredential
ÖÖ1 B
(
ÖÖB C
	GetConfig
ÖÖC L
.
ÖÖL M

AppSetting
ÖÖM W
[
ÖÖW X
$str
ÖÖX i
]
ÖÖi j
,
ÖÖj k
	GetConfig
ÖÖl u
.
ÖÖu v

AppSettingÖÖv Ä
[ÖÖÄ Å
$strÖÖÅ ï
]ÖÖï ñ
)ÖÖñ ó
;ÖÖó ò
}
ÜÜ 
var
àà 
message
àà	 
=
àà 
new
àà 
MailMessage
àà "
(
àà" #
	GetConfig
àà# ,
.
àà, -

AppSetting
àà- 7
[
àà7 8
$str
àà8 I
]
ààI J
,
ààJ K
model
ààL Q
.
ààQ R
Email
ààR W
,
ààW X
$str
ààY j
,
ààj k
body
ààl p
)
ààp q
;
ààq r
message
ââ 
.
ââ 

IsBodyHtml
ââ 
=
ââ 
true
ââ 
;
ââ 
client
ää 
.
ää 
Send
ää 
(
ää 
message
ää 
)
ää 
;
ää 
}
ãã 
result
åå 

.
åå
 

StatusCode
åå 
=
åå 
$str
åå 
;
åå 
result
çç 

.
çç
 
Message
çç 
=
çç 
$str
çç 
;
çç 
return
èè 

result
èè 
;
èè 
}
êê 
catch
ëë 
(
ëë	 

	Exception
ëë
 
ex
ëë 
)
ëë 
{
íí 
result
ìì 

.
ìì
 

StatusCode
ìì 
=
ìì 
$str
ìì 
;
ìì 
result
îî 

.
îî
 
Message
îî 
=
îî 
$str
îî "
+
îî# $
ex
îî% '
.
îî' (
Message
îî( /
+
îî0 1
$str
îî2 H
+
îîI J
ex
îîK M
.
îîM N
InnerException
îîN \
+
îî] ^
$str
îî_ b
;
îîb c
return
ïï 

result
ïï 
;
ïï 
}
ññ 
}
óó 
public
õõ 
ActionResult
õõ	 
Edit
õõ 
(
õõ 
int
õõ 
id
õõ !
)
õõ! "
{
úú 
if
ùù 
(
ùù 
!
ùù 
lastSession
ùù 
.
ùù 
Update
ùù 
(
ùù 
)
ùù 
)
ùù 
{
ûû 
return
üü 

RedirectToAction
üü 
(
üü 
$str
üü #
,
üü# $
	GetConfig
üü% .
.
üü. /

AppSetting
üü/ 9
[
üü9 :
$str
üü: V
]
üüV W
+
üüX Y
$str
üüZ a
,
üüa b
new
üüc f
{
üüg h
a
üüi j
=
üük l
true
üüm q
}
üür s
)
üüs t
;
üüt u
}
†† 
var
°° 
location
°° 
=
°° 
new
°° 
Uri
°° 
(
°° 
$"
°° 
{
°° 
Request
°° $
.
°°$ %
Scheme
°°% +
}
°°+ ,
$str
°°, /
{
°°/ 0
Request
°°0 7
.
°°7 8
Host
°°8 <
}
°°< =
{
°°= >
Request
°°> E
.
°°E F
Path
°°F J
}
°°J K
"
°°K L
)
°°L M
;
°°M N
string
¢¢ 	
Path
¢¢
 
=
¢¢ 
location
¢¢ 
.
¢¢ 
AbsolutePath
¢¢ &
.
¢¢& '
Replace
¢¢' .
(
¢¢. /
this
¢¢/ 3
.
¢¢3 4
ControllerContext
¢¢4 E
.
¢¢E F
	RouteData
¢¢F O
.
¢¢O P
Values
¢¢P V
[
¢¢V W
$str
¢¢W _
]
¢¢_ `
.
¢¢` a
ToString
¢¢a i
(
¢¢i j
)
¢¢j k
,
¢¢k l
$str
¢¢m t
)
¢¢t u
;
¢¢u v
if
££ 
(
££ 
!
££ 
accessSecurity
££ 
.
££ 
IsGetAccess
££ "
(
££" #
$str
££# '
+
££( )
Path
££* .
)
££. /
)
££/ 0
{
§§ 
return
•• 

RedirectToAction
•• 
(
•• 
$str
•• '
,
••' (
$str
••) 0
)
••0 1
;
••1 2
}
¶¶ 
TblMasterUser
®® 
data
®® 
=
®®  
_context
®®! )
.
®®) *
TblMasterUsers
®®* 8
.
®®8 9
Where
®®9 >
(
®®> ?
m
®®? @
=>
®®A C
m
®®D E
.
®®E F
Id
®®F H
==
®®I K
id
®®L N
)
®®N O
.
®®O P
FirstOrDefault
®®P ^
(
®®^ _
)
®®_ `
;
®®` a
if
©© 
(
©© 
data
©© 
==
©© 
null
©© 
)
©© 
{
™™ 
data
´´ 
=
´´ 
new
´´ 
TblMasterUser
´´ (
(
´´( )
)
´´) *
;
´´* +
}
¨¨ 
else
≠≠ 
{
ÆÆ 
if
ØØ 
(
ØØ 
data
ØØ 
.
ØØ 
RoleId
ØØ 
!=
ØØ  "
null
ØØ# '
)
ØØ' (
{
∞∞ 
ViewBag
±± 
.
±± 
RoleId
±± "
=
±±# $
new
±±% (

SelectList
±±) 3
(
±±3 4
Utility
±±4 ;
.
±±; <
SelectDataRole
±±< J
(
±±J K
int
±±K N
.
±±N O
Parse
±±O T
(
±±T U
data
±±U Y
.
±±Y Z
RoleId
±±Z `
.
±±` a
ToString
±±a i
(
±±i j
)
±±j k
)
±±k l
,
±±l m
_context
±±n v
)
±±v w
,
±±w x
$str
±±y }
,
±±} ~
$str±± Ö
,±±Ö Ü
data±±á ã
.±±ã å
RoleId±±å í
)±±í ì
;±±ì î
}
≤≤ 
else
≥≥ 
{
¥¥ 
ViewBag
µµ 
.
µµ 
RoleId
µµ "
=
µµ# $
new
µµ% (

SelectList
µµ) 3
(
µµ3 4
$str
µµ4 6
,
µµ6 7
$str
µµ8 :
)
µµ: ;
;
µµ; <
}
∂∂ 
}
∑∑ 
var
ππ 
UserId
ππ 
=
ππ 
int
ππ 
.
ππ 
Parse
ππ "
(
ππ" #
HttpContext
ππ# .
.
ππ. /
Session
ππ/ 6
.
ππ6 7
	GetString
ππ7 @
(
ππ@ A
SessionConstan
ππA O
.
ππO P
Session_UserId
ππP ^
)
ππ^ _
)
ππ_ `
;
ππ` a
var
∫∫ 
RoleKode
∫∫ 
=
∫∫ 
int
∫∫ 
.
∫∫ 
Parse
∫∫ $
(
∫∫$ %
HttpContext
∫∫% 0
.
∫∫0 1
Session
∫∫1 8
.
∫∫8 9
	GetString
∫∫9 B
(
∫∫B C
SessionConstan
∫∫C Q
.
∫∫Q R
Session_RoleKode
∫∫R b
)
∫∫b c
)
∫∫c d
;
∫∫d e
if
ºº 
(
ºº 
RoleKode
ºº 
==
ºº 
$num
ºº 
)
ºº 
{
ΩΩ 
return
ææ 
PartialView
ææ "
(
ææ" #
$str
ææ# *
,
ææ* +
data
ææ, 0
)
ææ0 1
;
ææ1 2
}
øø 
else
¿¿ 
{
¿¿ 
if
¡¡ 
(
¡¡ 
data
¡¡ 
.
¡¡ 
RoleId
¡¡ 
==
¡¡ 
$num
¡¡ 
)
¡¡ 
{
¬¬ 
return
√√ 
PartialView
√√ 
(
√√ 
$str
√√ 
,
√√  
data
√√! %
)
√√% &
;
√√& '
}
ƒƒ 
else
≈≈ 
{
∆∆ 
return
«« 
PartialView
«« &
(
««& '
$str
««' .
,
««. /
data
««0 4
)
««4 5
;
««5 6
}
»» 
}
…… 
}
   
[
ÃÃ &
ValidateAntiForgeryToken
ÃÃ 
]
ÃÃ 
[
ÕÕ 
HttpPost
ÕÕ 
]
ÕÕ 
public
ŒŒ 
async
ŒŒ	 
Task
ŒŒ 
<
ŒŒ 
ActionResult
ŒŒ  
>
ŒŒ  !

SubmitEdit
ŒŒ" ,
(
ŒŒ, -
TblMasterUser
ŒŒ- :
model
ŒŒ; @
)
ŒŒ@ A
{
œœ 
if
–– 
(
–– 
!
–– 
lastSession
–– 
.
–– 
Update
–– 
(
–– 
)
–– 
)
–– 
{
—— 
return
““ 

RedirectToAction
““ 
(
““ 
$str
““ #
,
““# $
	GetConfig
““% .
.
““. /

AppSetting
““/ 9
[
““9 :
$str
““: V
]
““V W
+
““X Y
$str
““Z a
,
““a b
new
““c f
{
““g h
a
““i j
=
““k l
true
““m q
}
““r s
)
““s t
;
““t u
}
”” 
var
‘‘ 
location
‘‘ 
=
‘‘ 
new
‘‘ 
Uri
‘‘ 
(
‘‘ 
$"
‘‘ 
{
‘‘ 
Request
‘‘ $
.
‘‘$ %
Scheme
‘‘% +
}
‘‘+ ,
$str
‘‘, /
{
‘‘/ 0
Request
‘‘0 7
.
‘‘7 8
Host
‘‘8 <
}
‘‘< =
{
‘‘= >
Request
‘‘> E
.
‘‘E F
Path
‘‘F J
}
‘‘J K
"
‘‘K L
)
‘‘L M
;
‘‘M N
string
’’ 	
Path
’’
 
=
’’ 
location
’’ 
.
’’ 
AbsolutePath
’’ &
.
’’& '
Replace
’’' .
(
’’. /
this
’’/ 3
.
’’3 4
ControllerContext
’’4 E
.
’’E F
	RouteData
’’F O
.
’’O P
Values
’’P V
[
’’V W
$str
’’W _
]
’’_ `
.
’’` a
ToString
’’a i
(
’’i j
)
’’j k
,
’’k l
$str
’’m t
)
’’t u
;
’’u v
if
÷÷ 
(
÷÷ 
!
÷÷ 
accessSecurity
÷÷ 
.
÷÷ 
IsGetAccess
÷÷ "
(
÷÷" #
$str
÷÷# '
+
÷÷( )
Path
÷÷* .
)
÷÷. /
)
÷÷/ 0
{
◊◊ 
return
ÿÿ 

RedirectToAction
ÿÿ 
(
ÿÿ 
$str
ÿÿ '
,
ÿÿ' (
$str
ÿÿ) 0
)
ÿÿ0 1
;
ÿÿ1 2
}
ŸŸ 
try
€€ 
{
‹‹ 
var
ﬁﬁ 
regex
ﬁﬁ 
=
ﬁﬁ 
await
ﬁﬁ 
RegexRequest
ﬁﬁ "
.
ﬁﬁ" #
RegexValidation
ﬁﬁ# 2
(
ﬁﬁ2 3
model
ﬁﬁ3 8
)
ﬁﬁ8 9
;
ﬁﬁ9 :
if
ﬂﬂ 
(
ﬂﬂ 
!
ﬂﬂ 	
regex
ﬂﬂ	 
)
ﬂﬂ 
{
‡‡ 
return
·· 
Content
·· 
(
·· 
$str
·· "
)
··" #
;
··# $
}
‚‚ 
using
ÈÈ 	
(
ÈÈ
 
TransactionScope
ÈÈ 
trx
ÈÈ 
=
ÈÈ  !
new
ÈÈ" %
TransactionScope
ÈÈ& 6
(
ÈÈ6 7
)
ÈÈ7 8
)
ÈÈ8 9
{
ÍÍ 
TblMasterUser
ÎÎ 
data
ÎÎ 
=
ÎÎ 
_context
ÎÎ "
.
ÎÎ" #
TblMasterUsers
ÎÎ# 1
.
ÎÎ1 2
Where
ÎÎ2 7
(
ÎÎ7 8
m
ÎÎ8 9
=>
ÎÎ: <
m
ÎÎ= >
.
ÎÎ> ?
Id
ÎÎ? A
==
ÎÎB D
model
ÎÎE J
.
ÎÎJ K
Id
ÎÎK M
)
ÎÎM N
.
ÎÎN O
FirstOrDefault
ÎÎO ]
(
ÎÎ] ^
)
ÎÎ^ _
;
ÎÎ_ `
if
ÏÏ 
(
ÏÏ 	
data
ÏÏ	 
.
ÏÏ 
Username
ÏÏ 
!=
ÏÏ 
model
ÏÏ 
.
ÏÏ  
Username
ÏÏ  (
)
ÏÏ( )
{
ÌÌ 
TblMasterUser
ÓÓ 
dataUserName
ÓÓ  
=
ÓÓ! "
_context
ÓÓ# +
.
ÓÓ+ ,
TblMasterUsers
ÓÓ, :
.
ÓÓ: ;
Where
ÓÓ; @
(
ÓÓ@ A
m
ÓÓA B
=>
ÓÓC E
m
ÓÓF G
.
ÓÓG H
Username
ÓÓH P
==
ÓÓQ S
model
ÓÓT Y
.
ÓÓY Z
Username
ÓÓZ b
&&
ÓÓc e
m
ÓÓf g
.
ÓÓg h
IsActive
ÓÓh p
==
ÓÓq s
true
ÓÓt x
&&
ÓÓy {
m
ÓÓ| }
.
ÓÓ} ~
	IsDeletedÓÓ~ á
!=ÓÓà ä
trueÓÓã è
)ÓÓè ê
.ÓÓê ë
FirstOrDefaultÓÓë ü
(ÓÓü †
)ÓÓ† °
;ÓÓ° ¢
if
ÔÔ 
(
ÔÔ	 

dataUserName
ÔÔ
 
!=
ÔÔ 
null
ÔÔ 
)
ÔÔ 
{
 
return
ÒÒ 
Content
ÒÒ 
(
ÒÒ 
dataUserName
ÒÒ "
.
ÒÒ" #
Username
ÒÒ# +
+
ÒÒ, -
$str
ÒÒ. @
)
ÒÒ@ A
;
ÒÒA B
}
ÚÚ 
}
ÛÛ 
if
ÙÙ 
(
ÙÙ 	
data
ÙÙ	 
.
ÙÙ 
Email
ÙÙ 
!=
ÙÙ 
model
ÙÙ 
.
ÙÙ 
Email
ÙÙ "
)
ÙÙ" #
{
ıı 
TblMasterUser
ˆˆ 
	dataEmail
ˆˆ 
=
ˆˆ 
_context
ˆˆ  (
.
ˆˆ( )
TblMasterUsers
ˆˆ) 7
.
ˆˆ7 8
Where
ˆˆ8 =
(
ˆˆ= >
m
ˆˆ> ?
=>
ˆˆ@ B
m
ˆˆC D
.
ˆˆD E
Email
ˆˆE J
==
ˆˆK M
model
ˆˆN S
.
ˆˆS T
Email
ˆˆT Y
&&
ˆˆZ \
m
ˆˆ] ^
.
ˆˆ^ _
IsActive
ˆˆ_ g
==
ˆˆh j
true
ˆˆk o
&&
ˆˆp r
m
ˆˆs t
.
ˆˆt u
	IsDeleted
ˆˆu ~
!=ˆˆ Å
trueˆˆÇ Ü
)ˆˆÜ á
.ˆˆá à
FirstOrDefaultˆˆà ñ
(ˆˆñ ó
)ˆˆó ò
;ˆˆò ô
if
˜˜ 
(
˜˜	 

	dataEmail
˜˜
 
!=
˜˜ 
null
˜˜ 
)
˜˜ 
{
¯¯ 
return
˘˘ 
Content
˘˘ 
(
˘˘ 
	dataEmail
˘˘ 
.
˘˘  
Email
˘˘  %
+
˘˘& '
$str
˘˘( :
)
˘˘: ;
;
˘˘; <
}
˙˙ 
}
˚˚ 
data
¸¸ 	
.
¸¸	 

Username
¸¸
 
=
¸¸ 
model
¸¸ 
.
¸¸ 
Username
¸¸ #
;
¸¸# $
data
˝˝ 	
.
˝˝	 

Fullname
˝˝
 
=
˝˝ 
model
˝˝ 
.
˝˝ 
Fullname
˝˝ #
;
˝˝# $
data
˛˛ 	
.
˛˛	 

Email
˛˛
 
=
˛˛ 
model
˛˛ 
.
˛˛ 
Email
˛˛ 
;
˛˛ 
data
ˇˇ 	
.
ˇˇ	 

NoTelp
ˇˇ
 
=
ˇˇ 
model
ˇˇ 
.
ˇˇ 
NoTelp
ˇˇ 
;
ˇˇ  
data
ÄÄ 	
.
ÄÄ	 

RoleId
ÄÄ
 
=
ÄÄ 
model
ÄÄ 
.
ÄÄ 
RoleId
ÄÄ 
;
ÄÄ  
data
ÅÅ 	
.
ÅÅ	 

IsActive
ÅÅ
 
=
ÅÅ 
model
ÅÅ 
.
ÅÅ 
IsActive
ÅÅ #
;
ÅÅ# $
data
ÇÇ 	
.
ÇÇ	 

UpdatedById
ÇÇ
 
=
ÇÇ 
int
ÇÇ 
.
ÇÇ 
Parse
ÇÇ !
(
ÇÇ! "
HttpContext
ÇÇ" -
.
ÇÇ- .
Session
ÇÇ. 5
.
ÇÇ5 6
	GetString
ÇÇ6 ?
(
ÇÇ? @
SessionConstan
ÇÇ@ N
.
ÇÇN O
Session_UserId
ÇÇO ]
)
ÇÇ] ^
)
ÇÇ^ _
;
ÇÇ_ `
data
ÉÉ 	
.
ÉÉ	 

UpdatedTime
ÉÉ
 
=
ÉÉ 
DateTime
ÉÉ  
.
ÉÉ  !
Now
ÉÉ! $
;
ÉÉ$ %
var
ÖÖ 
UserId
ÖÖ 
=
ÖÖ  
int
ÖÖ! $
.
ÖÖ$ %
Parse
ÖÖ% *
(
ÖÖ* +
HttpContext
ÖÖ+ 6
.
ÖÖ6 7
Session
ÖÖ7 >
.
ÖÖ> ?
	GetString
ÖÖ? H
(
ÖÖH I
SessionConstan
ÖÖI W
.
ÖÖW X
Session_UserId
ÖÖX f
)
ÖÖf g
)
ÖÖg h
;
ÖÖh i
var
ÜÜ 
RoleKode
ÜÜ  
=
ÜÜ! "
int
ÜÜ# &
.
ÜÜ& '
Parse
ÜÜ' ,
(
ÜÜ, -
HttpContext
ÜÜ- 8
.
ÜÜ8 9
Session
ÜÜ9 @
.
ÜÜ@ A
	GetString
ÜÜA J
(
ÜÜJ K
SessionConstan
ÜÜK Y
.
ÜÜY Z
Session_RoleKode
ÜÜZ j
)
ÜÜj k
)
ÜÜk l
;
ÜÜl m
if
àà 
(
àà 
RoleKode
àà  
==
àà! #
$num
àà$ %
)
àà% &
{
ââ 
_context
ää  
.
ää  !
Entry
ää! &
(
ää& '
data
ää' +
)
ää+ ,
.
ää, -
State
ää- 2
=
ää3 4
EntityState
ää5 @
.
ää@ A
Modified
ääA I
;
ääI J
_context
ãã  
.
ãã  !
SaveChanges
ãã! ,
(
ãã, -
)
ãã- .
;
ãã. /
}
åå 
else
çç 
{
éé 
if
èè 
(
èè 
data
èè  
.
èè  !
RoleId
èè! '
==
èè( *
$num
èè+ ,
)
èè, -
{
êê 
return
ëë "
Content
ëë# *
(
ëë* +
	GetConfig
ëë+ 4
.
ëë4 5

AppSetting
ëë5 ?
[
ëë? @
$str
ëë@ M
]
ëëM N
)
ëëN O
;
ëëO P
}
íí 
else
ìì 
{
îî 
_context
ïï $
.
ïï$ %
Entry
ïï% *
(
ïï* +
data
ïï+ /
)
ïï/ 0
.
ïï0 1
State
ïï1 6
=
ïï7 8
EntityState
ïï9 D
.
ïïD E
Modified
ïïE M
;
ïïM N
_context
ññ $
.
ññ$ %
SaveChanges
ññ% 0
(
ññ0 1
)
ññ1 2
;
ññ2 3
}
óó 
}
òò 
trx
öö 
.
öö 	
Complete
öö	 
(
öö 
)
öö 
;
öö 
}
úú 
return
ùù 

Content
ùù 
(
ùù 
$str
ùù 
)
ùù 
;
ùù 
}
üü 
catch
†† 
{
°° 
return
¢¢ 

Content
¢¢ 
(
¢¢ 
	GetConfig
¢¢ 
.
¢¢ 

AppSetting
¢¢ '
[
¢¢' (
$str
¢¢( 5
]
¢¢5 6
)
¢¢6 7
;
¢¢7 8
}
££ 
}
§§ 
public
®® 
ActionResult
®®	 
View
®® 
(
®® 
int
®® 
id
®® !
)
®®! "
{
©© 
if
™™ 
(
™™ 
!
™™ 
lastSession
™™ 
.
™™ 
Update
™™ 
(
™™ 
)
™™ 
)
™™ 
{
´´ 
return
¨¨ 

RedirectToAction
¨¨ 
(
¨¨ 
$str
¨¨ #
,
¨¨# $
	GetConfig
¨¨% .
.
¨¨. /

AppSetting
¨¨/ 9
[
¨¨9 :
$str
¨¨: V
]
¨¨V W
+
¨¨X Y
$str
¨¨Z a
,
¨¨a b
new
¨¨c f
{
¨¨g h
a
¨¨i j
=
¨¨k l
true
¨¨m q
}
¨¨r s
)
¨¨s t
;
¨¨t u
}
≠≠ 
var
ÆÆ 
location
ÆÆ 
=
ÆÆ 
new
ÆÆ 
Uri
ÆÆ 
(
ÆÆ 
$"
ÆÆ 
{
ÆÆ 
Request
ÆÆ $
.
ÆÆ$ %
Scheme
ÆÆ% +
}
ÆÆ+ ,
$str
ÆÆ, /
{
ÆÆ/ 0
Request
ÆÆ0 7
.
ÆÆ7 8
Host
ÆÆ8 <
}
ÆÆ< =
{
ÆÆ= >
Request
ÆÆ> E
.
ÆÆE F
Path
ÆÆF J
}
ÆÆJ K
"
ÆÆK L
)
ÆÆL M
;
ÆÆM N
string
ØØ 	
Path
ØØ
 
=
ØØ 
location
ØØ 
.
ØØ 
AbsolutePath
ØØ &
.
ØØ& '
Replace
ØØ' .
(
ØØ. /
this
ØØ/ 3
.
ØØ3 4
ControllerContext
ØØ4 E
.
ØØE F
	RouteData
ØØF O
.
ØØO P
Values
ØØP V
[
ØØV W
$str
ØØW _
]
ØØ_ `
.
ØØ` a
ToString
ØØa i
(
ØØi j
)
ØØj k
,
ØØk l
$str
ØØm t
)
ØØt u
;
ØØu v
if
∞∞ 
(
∞∞ 
!
∞∞ 
accessSecurity
∞∞ 
.
∞∞ 
IsGetAccess
∞∞ "
(
∞∞" #
$str
∞∞# '
+
∞∞( )
Path
∞∞* .
)
∞∞. /
)
∞∞/ 0
{
±± 
return
≤≤ 

RedirectToAction
≤≤ 
(
≤≤ 
$str
≤≤ '
,
≤≤' (
$str
≤≤) 0
)
≤≤0 1
;
≤≤1 2
}
≥≥ 
TblMasterUser
µµ 
data
µµ 
=
µµ 
_context
µµ  
.
µµ  !
TblMasterUsers
µµ! /
.
µµ/ 0
Where
µµ0 5
(
µµ5 6
m
µµ6 7
=>
µµ8 :
m
µµ; <
.
µµ< =
Id
µµ= ?
==
µµ@ B
id
µµC E
)
µµE F
.
µµF G
FirstOrDefault
µµG U
(
µµU V
)
µµV W
;
µµW X
if
∂∂ 
(
∂∂ 
data
∂∂ 
==
∂∂ 
null
∂∂ 
)
∂∂ 
{
∑∑ 
data
∏∏ 
=
∏∏ 
new
∏∏ 
TblMasterUser
∏∏ (
(
∏∏( )
)
∏∏) *
;
∏∏* +
}
ππ 
else
∫∫ 
{
ªª 
if
ºº 
(
ºº 
data
ºº 
.
ºº 
RoleId
ºº 
!=
ºº  "
null
ºº# '
)
ºº' (
{
ΩΩ 
ViewBag
ææ 
.
ææ 
RoleId
ææ "
=
ææ# $
new
ææ% (

SelectList
ææ) 3
(
ææ3 4
Utility
ææ4 ;
.
ææ; <
SelectDataRole
ææ< J
(
ææJ K
int
ææK N
.
ææN O
Parse
ææO T
(
ææT U
data
ææU Y
.
ææY Z
RoleId
ææZ `
.
ææ` a
ToString
ææa i
(
ææi j
)
ææj k
)
ææk l
,
ææl m
_context
ææn v
)
ææv w
,
ææw x
$str
ææy }
,
ææ} ~
$strææ Ö
,ææÖ Ü
dataææá ã
.ææã å
RoleIdææå í
)ææí ì
;ææì î
}
øø 
else
¿¿ 
{
¡¡ 
ViewBag
¬¬ 
.
¬¬ 
RoleId
¬¬ "
=
¬¬# $
new
¬¬% (

SelectList
¬¬) 3
(
¬¬3 4
$str
¬¬4 6
,
¬¬6 7
$str
¬¬8 :
)
¬¬: ;
;
¬¬; <
}
√√ 
}
ƒƒ 
return
≈≈ 
PartialView
≈≈ 
(
≈≈ 
$str
≈≈ &
,
≈≈& '
data
≈≈( ,
)
≈≈, -
;
≈≈- .
}
∆∆ 
public
ÀÀ 
ActionResult
ÀÀ	 
Delete
ÀÀ 
(
ÀÀ 
string
ÀÀ #
Ids
ÀÀ$ '
)
ÀÀ' (
{
ÃÃ 
if
ÕÕ 
(
ÕÕ 
!
ÕÕ 
lastSession
ÕÕ 
.
ÕÕ 
Update
ÕÕ 
(
ÕÕ 
)
ÕÕ 
)
ÕÕ 
{
ŒŒ 
return
œœ 

RedirectToAction
œœ 
(
œœ 
$str
œœ #
,
œœ# $
	GetConfig
œœ% .
.
œœ. /

AppSetting
œœ/ 9
[
œœ9 :
$str
œœ: V
]
œœV W
+
œœX Y
$str
œœZ a
,
œœa b
new
œœc f
{
œœg h
a
œœi j
=
œœk l
true
œœm q
}
œœr s
)
œœs t
;
œœt u
}
–– 
var
—— 
location
—— 
=
—— 
new
—— 
Uri
—— 
(
—— 
$"
—— 
{
—— 
Request
—— $
.
——$ %
Scheme
——% +
}
——+ ,
$str
——, /
{
——/ 0
Request
——0 7
.
——7 8
Host
——8 <
}
——< =
{
——= >
Request
——> E
.
——E F
Path
——F J
}
——J K
"
——K L
)
——L M
;
——M N
string
““ 	
Path
““
 
=
““ 
location
““ 
.
““ 
AbsolutePath
““ &
.
““& '
Replace
““' .
(
““. /
this
““/ 3
.
““3 4
ControllerContext
““4 E
.
““E F
	RouteData
““F O
.
““O P
Values
““P V
[
““V W
$str
““W _
]
““_ `
.
““` a
ToString
““a i
(
““i j
)
““j k
,
““k l
$str
““m t
)
““t u
;
““u v
if
”” 
(
”” 
!
”” 
accessSecurity
”” 
.
”” 
IsGetAccess
”” "
(
””" #
$str
””# '
+
””( )
Path
””* .
)
””. /
)
””/ 0
{
‘‘ 
return
’’ 

RedirectToAction
’’ 
(
’’ 
$str
’’ '
,
’’' (
$str
’’) 0
)
’’0 1
;
’’1 2
}
÷÷ 
try
ÿÿ 
{
ŸŸ 
long
⁄⁄ 
[
⁄⁄ 	
]
⁄⁄	 

confirmedDeleteId
⁄⁄ 
=
⁄⁄ 
Ids
⁄⁄ "
.
⁄⁄" #
Split
⁄⁄# (
(
⁄⁄( )
$char
⁄⁄) ,
)
⁄⁄, -
.
⁄⁄- .
Select
⁄⁄. 4
(
⁄⁄4 5
long
⁄⁄5 9
.
⁄⁄9 :
Parse
⁄⁄: ?
)
⁄⁄? @
.
⁄⁄@ A
ToArray
⁄⁄A H
(
⁄⁄H I
)
⁄⁄I J
;
⁄⁄J K
List
‹‹ 
<
‹‹ 	
TblMasterUser
‹‹	 
>
‹‹ 

Transaksis
‹‹ "
=
‹‹# $
_context
‹‹% -
.
‹‹- .
TblMasterUsers
‹‹. <
.
‹‹< =
Where
‹‹= B
(
‹‹B C
x
‹‹C D
=>
‹‹E G
confirmedDeleteId
‹‹H Y
.
‹‹Y Z
Contains
‹‹Z b
(
‹‹b c
x
‹‹c d
.
‹‹d e
Id
‹‹e g
)
‹‹g h
)
‹‹h i
.
‹‹i j
ToList
‹‹j p
(
‹‹p q
)
‹‹q r
;
‹‹r s
for
›› 
(
›› 	
int
››	 
i
›› 
=
›› 
$num
›› 
;
›› 
i
›› 
<
›› 
confirmedDeleteId
›› )
.
››) *
Length
››* 0
;
››0 1
i
››2 3
++
››3 5
)
››5 6
{
ﬁﬁ 
var
ﬂﬂ 
Username
ﬂﬂ	 
=
ﬂﬂ 
_context
ﬂﬂ 
.
ﬂﬂ 
TblMasterUsers
ﬂﬂ +
.
ﬂﬂ+ ,
Where
ﬂﬂ, 1
(
ﬂﬂ1 2
m
ﬂﬂ2 3
=>
ﬂﬂ4 6
m
ﬂﬂ7 8
.
ﬂﬂ8 9
Id
ﬂﬂ9 ;
==
ﬂﬂ< >

Transaksis
ﬂﬂ? I
[
ﬂﬂI J
i
ﬂﬂJ K
]
ﬂﬂK L
.
ﬂﬂL M
Id
ﬂﬂM O
)
ﬂﬂO P
.
ﬂﬂP Q
Select
ﬂﬂQ W
(
ﬂﬂW X
m
ﬂﬂX Y
=>
ﬂﬂZ \
m
ﬂﬂ] ^
.
ﬂﬂ^ _
Username
ﬂﬂ_ g
)
ﬂﬂg h
.
ﬂﬂh i
FirstOrDefault
ﬂﬂi w
(
ﬂﬂw x
)
ﬂﬂx y
;
ﬂﬂy z
TblMasterUser
·· 
data
·· 
=
·· 
_context
·· "
.
··" #
TblMasterUsers
··# 1
.
··1 2
Find
··2 6
(
··6 7

Transaksis
··7 A
[
··A B
i
··B C
]
··C D
.
··D E
Id
··E G
)
··G H
;
··H I
data
‚‚ 	
.
‚‚	 

	IsDeleted
‚‚
 
=
‚‚ 
true
‚‚ 
;
‚‚ 
data
„„ 	
.
„„	 

DeletedById
„„
 
=
„„ 
int
„„ 
.
„„ 
Parse
„„ !
(
„„! "
HttpContext
„„" -
.
„„- .
Session
„„. 5
.
„„5 6
	GetString
„„6 ?
(
„„? @
SessionConstan
„„@ N
.
„„N O
Session_UserId
„„O ]
)
„„] ^
)
„„^ _
;
„„_ `
;
„„a b
data
‰‰ 	
.
‰‰	 

DeletedTime
‰‰
 
=
‰‰ 
DateTime
‰‰  
.
‰‰  !
Now
‰‰! $
;
‰‰$ %
var
ÊÊ 
UserId
ÊÊ 
=
ÊÊ  
int
ÊÊ! $
.
ÊÊ$ %
Parse
ÊÊ% *
(
ÊÊ* +
HttpContext
ÊÊ+ 6
.
ÊÊ6 7
Session
ÊÊ7 >
.
ÊÊ> ?
	GetString
ÊÊ? H
(
ÊÊH I
SessionConstan
ÊÊI W
.
ÊÊW X
Session_UserId
ÊÊX f
)
ÊÊf g
)
ÊÊg h
;
ÊÊh i
var
ÁÁ 
RoleKode
ÁÁ  
=
ÁÁ! "
int
ÁÁ# &
.
ÁÁ& '
Parse
ÁÁ' ,
(
ÁÁ, -
HttpContext
ÁÁ- 8
.
ÁÁ8 9
Session
ÁÁ9 @
.
ÁÁ@ A
	GetString
ÁÁA J
(
ÁÁJ K
SessionConstan
ÁÁK Y
.
ÁÁY Z
Session_RoleKode
ÁÁZ j
)
ÁÁj k
)
ÁÁk l
;
ÁÁl m
if
ÈÈ 
(
ÈÈ 
RoleKode
ÈÈ  
==
ÈÈ! #
$num
ÈÈ$ %
)
ÈÈ% &
{
ÍÍ 
_context
ÎÎ  
.
ÎÎ  !
Entry
ÎÎ! &
(
ÎÎ& '
data
ÎÎ' +
)
ÎÎ+ ,
.
ÎÎ, -
State
ÎÎ- 2
=
ÎÎ3 4
EntityState
ÎÎ5 @
.
ÎÎ@ A
Modified
ÎÎA I
;
ÎÎI J
_context
ÏÏ  
.
ÏÏ  !
SaveChanges
ÏÏ! ,
(
ÏÏ, -
)
ÏÏ- .
;
ÏÏ. /
}
ÌÌ 
else
ÓÓ 
{
ÔÔ 
if
 
(
 

Transaksis
 &
[
& '
i
' (
]
( )
.
) *
RoleId
* 0
==
1 3
$num
4 5
)
5 6
{
ÒÒ 
return
ÚÚ "
Content
ÚÚ# *
(
ÚÚ* +
$str
ÚÚ+ 2
)
ÚÚ2 3
;
ÚÚ3 4
}
ÛÛ 
else
ÙÙ 
{
ıı 
_context
ˆˆ $
.
ˆˆ$ %
Entry
ˆˆ% *
(
ˆˆ* +
data
ˆˆ+ /
)
ˆˆ/ 0
.
ˆˆ0 1
State
ˆˆ1 6
=
ˆˆ7 8
EntityState
ˆˆ9 D
.
ˆˆD E
Modified
ˆˆE M
;
ˆˆM N
_context
˜˜ $
.
˜˜$ %
SaveChanges
˜˜% 0
(
˜˜0 1
)
˜˜1 2
;
˜˜2 3
}
¯¯ 
}
˘˘ 
}
˙˙ 
return
˚˚ 

Content
˚˚ 
(
˚˚ 
$str
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 
catch
˝˝ 
{
˛˛ 
return
ˇˇ 

Content
ˇˇ 
(
ˇˇ 
$str
ˇˇ 
)
ˇˇ 
;
ˇˇ 
}
ÄÄ 
}
ÅÅ 
}
ÑÑ 
}ÖÖ ú¢
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\MasterLookupController.cs
	namespace		 	
DashboardDevaBNI		
 
.		 
Controllers		 &
{

 
public 

class "
MasterLookupController '
:( )

Controller* 4
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public "
MasterLookupController %
(% &
IConfiguration& 4
config5 ;
,; <%
DbDashboardDevaBniContext= V
contextW ^
,^ _ 
IHttpContextAccessor` t
accessoru }
)} ~
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
	GetConfig1 :
.: ;

AppSetting; E
[E F
$strF n
]n o
+p q
$strr y
,y z
new{ ~
{	 Ä
a
Å Ç
=
É Ñ
true
Ö â
}
ä ã
)
ã å
;
å ç
} 
var 
location 
= 
new 
Uri "
(" #
$"# %
{% &
Request& -
.- .
Scheme. 4
}4 5
$str5 8
{8 9
Request9 @
.@ A
HostA E
}E F
{F G
RequestG N
.N O
PathO S
}S T
"T U
)U V
;V W
string   
Path   
=   
location   "
.  " #
AbsolutePath  # /
;  / 0
if!! 
(!! 
!!! 
accessSecurity!! 
.!!  
IsGetAccess!!  +
(!!+ ,
$str!!, 0
+!!1 2
Path!!3 7
)!!7 8
)!!8 9
{"" 
return## 
RedirectToAction## '
(##' (
$str##( 3
,##3 4
	GetConfig##5 >
.##> ?

AppSetting##? I
[##I J
$str##J r
]##r s
+##t u
$str##v }
)##} ~
;##~ 
}$$ 
ViewBag&& 
.&& 
CurrentPath&& 
=&&  !
Path&&" &
;&&& '
return'' 
View'' 
('' 
)'' 
;'' 
}(( 	
[++ 	
HttpPost++	 
]++ 
public,, 
IActionResult,, 
LoadData,, %
(,,% &
),,& '
{-- 	
if.. 
(.. 
!.. 
lastSession.. 
... 
Update.. #
(..# $
)..$ %
)..% &
{// 
return00 
RedirectToAction00 '
(00' (
$str00( /
,00/ 0
	GetConfig001 :
.00: ;

AppSetting00; E
[00E F
$str00F n
]00n o
+00p q
$str00r y
,00y z
new00{ ~
{	00 Ä
a
00Å Ç
=
00É Ñ
true
00Ö â
}
00ä ã
)
00ã å
;
00å ç
}11 
var22 
location22 
=22 
new22 
Uri22 "
(22" #
$"22# %
{22% &
Request22& -
.22- .
Scheme22. 4
}224 5
$str225 8
{228 9
Request229 @
.22@ A
Host22A E
}22E F
{22F G
Request22G N
.22N O
Path22O S
}22S T
"22T U
)22U V
;22V W
string33 
Path33 
=33 
location33 "
.33" #
AbsolutePath33# /
.33/ 0
Replace330 7
(337 8
this338 <
.33< =
ControllerContext33= N
.33N O
	RouteData33O X
.33X Y
Values33Y _
[33_ `
$str33` h
]33h i
.33i j
ToString33j r
(33r s
)33s t
,33t u
$str33v }
)33} ~
;33~ 
if44 
(44 
!44 
accessSecurity44 
.44  
IsGetAccess44  +
(44+ ,
$str44, 0
+441 2
Path443 7
)447 8
)448 9
{55 
return66 
RedirectToAction66 '
(66' (
$str66( 3
,663 4
$str665 <
)66< =
;66= >
}77 
try99 
{:: 
var;; 
dict;; 
=;; 
Request;; "
.;;" #
Form;;# '
.;;' (
ToDictionary;;( 4
(;;4 5
x;;5 6
=>;;7 9
x;;: ;
.;;; <
Key;;< ?
,;;? @
x;;A B
=>;;C E
x;;F G
.;;G H
Value;;H M
.;;M N
ToString;;N V
(;;V W
);;W X
);;X Y
;;;Y Z
var== 
draw== 
=== 
dict== 
[==  
$str==  &
]==& '
;==' (
var@@ 
start@@ 
=@@ 
dict@@  
[@@  !
$str@@! (
]@@( )
;@@) *
varAA 
lengthAA 
=AA 
dictAA !
[AA! "
$strAA" *
]AA* +
;AA+ ,
varEE 

pageNumberEE 
=EE  
(EE! "
intEE" %
.EE% &
ParseEE& +
(EE+ ,
startEE, 1
)EE1 2
/EE3 4
intEE5 8
.EE8 9
ParseEE9 >
(EE> ?
lengthEE? E
)EEE F
)EEF G
+EEH I
$numEEJ K
;EEK L
varHH 

sortColumnHH 
=HH  
dictHH! %
[HH% &
$strHH& 0
+HH1 2
dictHH3 7
[HH7 8
$strHH8 J
]HHJ K
+HHL M
$strHHN W
]HHW X
;HHX Y
varII 
sortColumnDirII !
=II" #
dictII$ (
[II( )
$strII) 8
]II8 9
;II9 :
varJJ 
NameSearchParamJJ #
=JJ$ %
dictJJ& *
[JJ* +
$strJJ+ F
]JJF G
;JJG H
varKK 
TypeSearchParamKK #
=KK$ %
dictKK& *
[KK* +
$strKK+ F
]KKF G
;KKG H
intOO 
pageSizeOO 
=OO 
lengthOO %
!=OO& (
nullOO) -
?OO. /
ConvertOO0 7
.OO7 8
ToInt32OO8 ?
(OO? @
lengthOO@ F
)OOF G
:OOH I
$numOOJ K
;OOK L
intPP 
skipPP 
=PP 
startPP  
!=PP! #
nullPP$ (
?PP) *
ConvertPP+ 2
.PP2 3
ToInt32PP3 :
(PP: ;
startPP; @
)PP@ A
:PPB C
$numPPD E
;PPE F
intQQ 
recordsTotalQQ  
=QQ! "
$numQQ# $
;QQ$ %
ListRR 
<RR "
MasterLookup_ViewModelRR +
>RR+ ,
listRR- 1
=RR2 3
newRR4 7
ListRR8 <
<RR< ="
MasterLookup_ViewModelRR= S
>RRS T
(RRT U
)RRU V
{SS 
}TT 
;TT 
listYY 
=YY #
StoredProcedureExecutorYY .
.YY. /
ExecuteSPListYY/ <
<YY< ="
MasterLookup_ViewModelYY= S
>YYS T
(YYT U
_contextYYU ]
,YY] ^
$strYY_ z
,YYz {
newYY| 
SqlParameter
YYÄ å
[
YYå ç
]
YYç é
{
YYé è
newZZ 
SqlParameterZZ (
(ZZ( )
$strZZ) 0
,ZZ0 1
NameSearchParamZZ2 A
)ZZA B
,ZZB C
new[[ 
SqlParameter[[ (
([[( )
$str[[) 0
,[[0 1
TypeSearchParam[[2 A
)[[A B
,[[B C
new\\ 
SqlParameter\\ (
(\\( )
$str\\) 6
,\\6 7

sortColumn\\8 B
)\\B C
,\\C D
new]] 
SqlParameter]] (
(]]( )
$str]]) 9
,]]9 :
sortColumnDir]]; H
)]]H I
,]]I J
new^^ 
SqlParameter^^ (
(^^( )
$str^^) 6
,^^6 7

pageNumber^^8 B
)^^B C
,^^C D
new__ 
SqlParameter__ (
(__( )
$str__) 4
,__4 5
pageSize__6 >
)__> ?
,__? @
}`` 
)`` 
;`` 
recordsTotalcc 
=cc #
StoredProcedureExecutorcc 6
.cc6 7
ExecuteScalarIntcc7 G
(ccG H
_contextccH P
,ccP Q
$strccR n
,ccn o
newccp s
SqlParameter	cct Ä
[
ccÄ Å
]
ccÅ Ç
{
ccÇ É
newdd 
SqlParameterdd (
(dd( )
$strdd) 0
,dd0 1
NameSearchParamdd2 A
)ddA B
,ddB C
newee 
SqlParameteree (
(ee( )
$stree) 0
,ee0 1
TypeSearchParamee2 A
)eeA B
,eeB C
}ff 
)ff 
;ff 
ifhh 
(hh 
listhh 
==hh 
nullhh  
)hh  !
{ii 
listjj 
=jj 
newjj 
Listjj #
<jj# $"
MasterLookup_ViewModeljj$ :
>jj: ;
(jj; <
)jj< =
;jj= >
recordsTotalkk  
=kk! "
$numkk# $
;kk$ %
}ll 
returnmm 
Jsonmm 
(mm 
newmm 
{mm  !
drawmm" &
=mm' (
drawmm) -
,mm- .
recordsFilteredmm/ >
=mm? @
recordsTotalmmA M
,mmM N
recordsTotalmmO [
=mm\ ]
recordsTotalmm^ j
,mmj k
datamml p
=mmq r
listmms w
}mmx y
)mmy z
;mmz {
}nn 
catchoo 
(oo 
	Exceptionoo 
Exoo 
)oo  
{pp 
throwqq 
;qq 
}rr 
}ss 	
publicww 
ActionResultww 
Createww "
(ww" #
)ww# $
{xx 	
ifyy 
(yy 
!yy 
lastSessionyy 
.yy 
Updateyy #
(yy# $
)yy$ %
)yy% &
{zz 
return{{ 
RedirectToAction{{ '
({{' (
$str{{( /
,{{/ 0
	GetConfig{{1 :
.{{: ;

AppSetting{{; E
[{{E F
$str{{F n
]{{n o
+{{p q
$str{{r y
,{{y z
new{{{ ~
{	{{ Ä
a
{{Å Ç
=
{{É Ñ
true
{{Ö â
}
{{ä ã
)
{{ã å
;
{{å ç
}|| 
var}} 
location}} 
=}} 
new}} 
Uri}} "
(}}" #
$"}}# %
{}}% &
Request}}& -
.}}- .
Scheme}}. 4
}}}4 5
$str}}5 8
{}}8 9
Request}}9 @
.}}@ A
Host}}A E
}}}E F
{}}F G
Request}}G N
.}}N O
Path}}O S
}}}S T
"}}T U
)}}U V
;}}V W
string~~ 
Path~~ 
=~~ 
location~~ "
.~~" #
AbsolutePath~~# /
.~~/ 0
Replace~~0 7
(~~7 8
this~~8 <
.~~< =
ControllerContext~~= N
.~~N O
	RouteData~~O X
.~~X Y
Values~~Y _
[~~_ `
$str~~` h
]~~h i
.~~i j
ToString~~j r
(~~r s
)~~s t
,~~t u
$str~~v }
)~~} ~
;~~~ 
if 
( 
! 
accessSecurity 
.  
IsGetAccess  +
(+ ,
$str, 0
+1 2
Path3 7
)7 8
)8 9
{
ÄÄ 
return
ÅÅ 
RedirectToAction
ÅÅ '
(
ÅÅ' (
$str
ÅÅ( 3
,
ÅÅ3 4
$str
ÅÅ5 <
)
ÅÅ< =
;
ÅÅ= >
}
ÇÇ 
return
ÉÉ 
PartialView
ÉÉ 
(
ÉÉ 
$str
ÉÉ (
)
ÉÉ( )
;
ÉÉ) *
}
ÑÑ 	
[
áá 	&
ValidateAntiForgeryToken
áá	 !
]
áá! "
[
àà 	
HttpPost
àà	 
]
àà 
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
ActionResult
ââ &
>
ââ& '
SubmitCreate
ââ( 4
(
ââ4 5
TblMasterLookup
ââ5 D
model
ââE J
)
ââJ K
{
ää 	
if
ãã 
(
ãã 
!
ãã 
lastSession
ãã 
.
ãã 
Update
ãã #
(
ãã# $
)
ãã$ %
)
ãã% &
{
åå 
return
çç 
RedirectToAction
çç '
(
çç' (
$str
çç( /
,
çç/ 0
	GetConfig
çç1 :
.
çç: ;

AppSetting
çç; E
[
ççE F
$str
ççF n
]
ççn o
+
ççp q
$str
ççr y
,
ççy z
new
çç{ ~
{çç Ä
aççÅ Ç
=ççÉ Ñ
trueççÖ â
}ççä ã
)ççã å
;ççå ç
}
éé 
var
èè 
location
èè 
=
èè 
new
èè 
Uri
èè "
(
èè" #
$"
èè# %
{
èè% &
Request
èè& -
.
èè- .
Scheme
èè. 4
}
èè4 5
$str
èè5 8
{
èè8 9
Request
èè9 @
.
èè@ A
Host
èèA E
}
èèE F
{
èèF G
Request
èèG N
.
èèN O
Path
èèO S
}
èèS T
"
èèT U
)
èèU V
;
èèV W
string
êê 
Path
êê 
=
êê 
location
êê "
.
êê" #
AbsolutePath
êê# /
.
êê/ 0
Replace
êê0 7
(
êê7 8
this
êê8 <
.
êê< =
ControllerContext
êê= N
.
êêN O
	RouteData
êêO X
.
êêX Y
Values
êêY _
[
êê_ `
$str
êê` h
]
êêh i
.
êêi j
ToString
êêj r
(
êêr s
)
êês t
,
êêt u
$str
êêv }
)
êê} ~
;
êê~ 
if
ëë 
(
ëë 
!
ëë 
accessSecurity
ëë 
.
ëë  
IsGetAccess
ëë  +
(
ëë+ ,
$str
ëë, 0
+
ëë1 2
Path
ëë3 7
)
ëë7 8
)
ëë8 9
{
íí 
return
ìì 
RedirectToAction
ìì '
(
ìì' (
$str
ìì( 3
,
ìì3 4
$str
ìì5 <
)
ìì< =
;
ìì= >
}
îî 
try
ññ 
{
óó 
var
òò 
regex
òò 
=
òò 
await
òò !
RegexRequest
òò" .
.
òò. /
RegexValidation
òò/ >
(
òò> ?
model
òò? D
)
òòD E
;
òòE F
if
ôô 
(
ôô 
!
ôô 
regex
ôô 
)
ôô 
{
öö 
return
õõ 
Content
õõ "
(
õõ" #
$str
õõ# 1
)
õõ1 2
;
õõ2 3
}
úú 
TblMasterLookup
ùù 
dataKode
ùù  (
=
ùù) *
_context
ùù+ 3
.
ùù3 4
TblMasterLookups
ùù4 D
.
ùùD E
Where
ùùE J
(
ùùJ K
m
ùùK L
=>
ùùM O
m
ùùP Q
.
ùùQ R
Value
ùùR W
==
ùùX Z
model
ùù[ `
.
ùù` a
Value
ùùa f
&&
ùùg i
m
ùùj k
.
ùùk l
Type
ùùl p
==
ùùq s
model
ùùt y
.
ùùy z
Type
ùùz ~
&&ùù Å
mùùÇ É
.ùùÉ Ñ
	IsDeletedùùÑ ç
!=ùùé ê
trueùùë ï
)ùùï ñ
.ùùñ ó
FirstOrDefaultùùó •
(ùù• ¶
)ùù¶ ß
;ùùß ®
if
ûû 
(
ûû 
dataKode
ûû 
!=
ûû 
null
ûû  $
)
ûû$ %
{
üü 
return
†† 
Content
†† "
(
††" #
$str
††# ?
+
††@ A
dataKode
††B J
.
††J K
Name
††K O
)
††O P
;
††P Q
}
°° 
using
¢¢ 
(
¢¢ 
TransactionScope
¢¢ '
trx
¢¢( +
=
¢¢, -
new
¢¢. 1
TransactionScope
¢¢2 B
(
¢¢B C
)
¢¢C D
)
¢¢D E
{
££ 
model
§§ 
.
§§ 
	IsDeleted
§§ #
=
§§$ %
false
§§& +
;
§§+ ,
model
•• 
.
•• 
CreatedById
•• %
=
••& '
int
••( +
.
••+ ,
Parse
••, 1
(
••1 2
HttpContext
••2 =
.
••= >
Session
••> E
.
••E F
	GetString
••F O
(
••O P
SessionConstan
••P ^
.
••^ _
Session_UserId
••_ m
)
••m n
)
••n o
;
••o p
model
¶¶ 
.
¶¶ 
CreatedTime
¶¶ %
=
¶¶& '
DateTime
¶¶( 0
.
¶¶0 1
Now
¶¶1 4
;
¶¶4 5
_context
ßß 
.
ßß 
TblMasterLookups
ßß -
.
ßß- .
Add
ßß. 1
(
ßß1 2
model
ßß2 7
)
ßß7 8
;
ßß8 9
_context
®® 
.
®® 
SaveChanges
®® (
(
®®( )
)
®®) *
;
®®* +
trx
™™ 
.
™™ 
Complete
™™  
(
™™  !
)
™™! "
;
™™" #
}
´´ 
return
≠≠ 
Content
≠≠ 
(
≠≠ 
$str
≠≠ !
)
≠≠! "
;
≠≠" #
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
Ex
∞∞ 
)
∞∞  
{
±± 
return
≤≤ 
Content
≤≤ 
(
≤≤ 
	GetConfig
≤≤ (
.
≤≤( )

AppSetting
≤≤) 3
[
≤≤3 4
$str
≤≤4 M
]
≤≤M N
)
≤≤N O
;
≤≤O P
}
≥≥ 
}
¥¥ 	
public
∏∏ 
ActionResult
∏∏ 
Edit
∏∏  
(
∏∏  !
int
∏∏! $
id
∏∏% '
)
∏∏' (
{
ππ 	
if
∫∫ 
(
∫∫ 
!
∫∫ 
lastSession
∫∫ 
.
∫∫ 
Update
∫∫ #
(
∫∫# $
)
∫∫$ %
)
∫∫% &
{
ªª 
return
ºº 
RedirectToAction
ºº '
(
ºº' (
$str
ºº( /
,
ºº/ 0
	GetConfig
ºº1 :
.
ºº: ;

AppSetting
ºº; E
[
ººE F
$str
ººF n
]
ººn o
+
ººp q
$str
ººr y
,
ººy z
new
ºº{ ~
{ºº Ä
aººÅ Ç
=ººÉ Ñ
trueººÖ â
}ººä ã
)ººã å
;ººå ç
}
ΩΩ 
var
ææ 
location
ææ 
=
ææ 
new
ææ 
Uri
ææ "
(
ææ" #
$"
ææ# %
{
ææ% &
Request
ææ& -
.
ææ- .
Scheme
ææ. 4
}
ææ4 5
$str
ææ5 8
{
ææ8 9
Request
ææ9 @
.
ææ@ A
Host
ææA E
}
ææE F
{
ææF G
Request
ææG N
.
ææN O
Path
ææO S
}
ææS T
"
ææT U
)
ææU V
;
ææV W
string
øø 
Path
øø 
=
øø 
location
øø "
.
øø" #
AbsolutePath
øø# /
.
øø/ 0
Replace
øø0 7
(
øø7 8
this
øø8 <
.
øø< =
ControllerContext
øø= N
.
øøN O
	RouteData
øøO X
.
øøX Y
Values
øøY _
[
øø_ `
$str
øø` h
]
øøh i
.
øøi j
ToString
øøj r
(
øør s
)
øøs t
,
øøt u
$str
øøv }
)
øø} ~
;
øø~ 
if
¿¿ 
(
¿¿ 
!
¿¿ 
accessSecurity
¿¿ 
.
¿¿  
IsGetAccess
¿¿  +
(
¿¿+ ,
$str
¿¿, 0
+
¿¿1 2
Path
¿¿3 7
)
¿¿7 8
)
¿¿8 9
{
¡¡ 
return
¬¬ 
RedirectToAction
¬¬ '
(
¬¬' (
$str
¬¬( 3
,
¬¬3 4
$str
¬¬5 <
)
¬¬< =
;
¬¬= >
}
√√ 
TblMasterLookup
≈≈ 
data
≈≈  
=
≈≈! "
_context
≈≈# +
.
≈≈+ ,
TblMasterLookups
≈≈, <
.
≈≈< =
Where
≈≈= B
(
≈≈B C
m
≈≈C D
=>
≈≈E G
m
≈≈H I
.
≈≈I J
Id
≈≈J L
==
≈≈M O
id
≈≈P R
)
≈≈R S
.
≈≈S T
FirstOrDefault
≈≈T b
(
≈≈b c
)
≈≈c d
;
≈≈d e
if
∆∆ 
(
∆∆ 
data
∆∆ 
==
∆∆ 
null
∆∆ 
)
∆∆ 
{
«« 
data
»» 
=
»» 
new
»» 
TblMasterLookup
»» *
(
»»* +
)
»»+ ,
;
»», -
}
…… 
return
ÀÀ 
PartialView
ÀÀ 
(
ÀÀ 
$str
ÀÀ &
,
ÀÀ& '
data
ÀÀ( ,
)
ÀÀ, -
;
ÀÀ- .
}
ÃÃ 	
[
ŒŒ 	&
ValidateAntiForgeryToken
ŒŒ	 !
]
ŒŒ! "
[
œœ 	
HttpPost
œœ	 
]
œœ 
public
–– 
async
–– 
Task
–– 
<
–– 
ActionResult
–– &
>
––& '

SubmitEdit
––( 2
(
––2 3
TblMasterLookup
––3 B
model
––C H
)
––H I
{
—— 	
try
““ 
{
”” 
if
‘‘ 
(
‘‘ 
!
‘‘ 
lastSession
‘‘  
.
‘‘  !
Update
‘‘! '
(
‘‘' (
)
‘‘( )
)
‘‘) *
{
’’ 
return
÷÷ 
RedirectToAction
÷÷ +
(
÷÷+ ,
$str
÷÷, 3
,
÷÷3 4
	GetConfig
÷÷5 >
.
÷÷> ?

AppSetting
÷÷? I
[
÷÷I J
$str
÷÷J r
]
÷÷r s
+
÷÷t u
$str
÷÷v }
,
÷÷} ~
new÷÷ Ç
{÷÷É Ñ
a÷÷Ö Ü
=÷÷á à
true÷÷â ç
}÷÷é è
)÷÷è ê
;÷÷ê ë
}
◊◊ 
var
ÿÿ 
location
ÿÿ 
=
ÿÿ 
new
ÿÿ "
Uri
ÿÿ# &
(
ÿÿ& '
$"
ÿÿ' )
{
ÿÿ) *
Request
ÿÿ* 1
.
ÿÿ1 2
Scheme
ÿÿ2 8
}
ÿÿ8 9
$str
ÿÿ9 <
{
ÿÿ< =
Request
ÿÿ= D
.
ÿÿD E
Host
ÿÿE I
}
ÿÿI J
{
ÿÿJ K
Request
ÿÿK R
.
ÿÿR S
Path
ÿÿS W
}
ÿÿW X
"
ÿÿX Y
)
ÿÿY Z
;
ÿÿZ [
string
ŸŸ 
Path
ŸŸ 
=
ŸŸ 
location
ŸŸ &
.
ŸŸ& '
AbsolutePath
ŸŸ' 3
.
ŸŸ3 4
Replace
ŸŸ4 ;
(
ŸŸ; <
this
ŸŸ< @
.
ŸŸ@ A
ControllerContext
ŸŸA R
.
ŸŸR S
	RouteData
ŸŸS \
.
ŸŸ\ ]
Values
ŸŸ] c
[
ŸŸc d
$str
ŸŸd l
]
ŸŸl m
.
ŸŸm n
ToString
ŸŸn v
(
ŸŸv w
)
ŸŸw x
,
ŸŸx y
$strŸŸz Å
)ŸŸÅ Ç
;ŸŸÇ É
if
⁄⁄ 
(
⁄⁄ 
!
⁄⁄ 
accessSecurity
⁄⁄ #
.
⁄⁄# $
IsGetAccess
⁄⁄$ /
(
⁄⁄/ 0
$str
⁄⁄0 4
+
⁄⁄5 6
Path
⁄⁄7 ;
)
⁄⁄; <
)
⁄⁄< =
{
€€ 
return
‹‹ 
RedirectToAction
‹‹ +
(
‹‹+ ,
$str
‹‹, 7
,
‹‹7 8
$str
‹‹9 @
)
‹‹@ A
;
‹‹A B
}
›› 
var
ﬂﬂ 
regex
ﬂﬂ 
=
ﬂﬂ 
await
ﬂﬂ !
RegexRequest
ﬂﬂ" .
.
ﬂﬂ. /
RegexValidation
ﬂﬂ/ >
(
ﬂﬂ> ?
model
ﬂﬂ? D
)
ﬂﬂD E
;
ﬂﬂE F
if
‡‡ 
(
‡‡ 
!
‡‡ 
regex
‡‡ 
)
‡‡ 
{
·· 
return
‚‚ 
Content
‚‚ "
(
‚‚" #
$str
‚‚# 1
)
‚‚1 2
;
‚‚2 3
}
„„ 
using
ÊÊ 
(
ÊÊ 
TransactionScope
ÊÊ '
trx
ÊÊ( +
=
ÊÊ, -
new
ÊÊ. 1
TransactionScope
ÊÊ2 B
(
ÊÊB C
)
ÊÊC D
)
ÊÊD E
{
ÁÁ 
TblMasterLookup
ËË #
data
ËË$ (
=
ËË) *
_context
ËË+ 3
.
ËË3 4
TblMasterLookups
ËË4 D
.
ËËD E
Where
ËËE J
(
ËËJ K
m
ËËK L
=>
ËËM O
m
ËËP Q
.
ËËQ R
Id
ËËR T
==
ËËU W
model
ËËX ]
.
ËË] ^
Id
ËË^ `
)
ËË` a
.
ËËa b
FirstOrDefault
ËËb p
(
ËËp q
)
ËËq r
;
ËËr s
data
ÈÈ 
.
ÈÈ 
Name
ÈÈ 
=
ÈÈ 
model
ÈÈ  %
.
ÈÈ% &
Name
ÈÈ& *
;
ÈÈ* +
data
ÍÍ 
.
ÍÍ 
Value
ÍÍ 
=
ÍÍ  
model
ÍÍ! &
.
ÍÍ& '
Value
ÍÍ' ,
;
ÍÍ, -
data
ÎÎ 
.
ÎÎ 
Type
ÎÎ 
=
ÎÎ 
model
ÎÎ  %
.
ÎÎ% &
Type
ÎÎ& *
;
ÎÎ* +
data
ÏÏ 
.
ÏÏ 
Description
ÏÏ $
=
ÏÏ% &
model
ÏÏ' ,
.
ÏÏ, -
Description
ÏÏ- 8
;
ÏÏ8 9
data
ÌÌ 
.
ÌÌ 
IsActive
ÌÌ !
=
ÌÌ" #
model
ÌÌ$ )
.
ÌÌ) *
IsActive
ÌÌ* 2
;
ÌÌ2 3
data
ÓÓ 
.
ÓÓ 
UpdatedById
ÓÓ $
=
ÓÓ% &
int
ÓÓ' *
.
ÓÓ* +
Parse
ÓÓ+ 0
(
ÓÓ0 1
HttpContext
ÓÓ1 <
.
ÓÓ< =
Session
ÓÓ= D
.
ÓÓD E
	GetString
ÓÓE N
(
ÓÓN O
SessionConstan
ÓÓO ]
.
ÓÓ] ^
Session_UserId
ÓÓ^ l
)
ÓÓl m
)
ÓÓm n
;
ÓÓn o
data
ÔÔ 
.
ÔÔ 
UpdatedTime
ÔÔ $
=
ÔÔ% &
DateTime
ÔÔ' /
.
ÔÔ/ 0
Now
ÔÔ0 3
;
ÔÔ3 4
_context
 
.
 
Entry
 "
(
" #
data
# '
)
' (
.
( )
State
) .
=
/ 0
EntityState
1 <
.
< =
Modified
= E
;
E F
_context
ÒÒ 
.
ÒÒ 
SaveChanges
ÒÒ (
(
ÒÒ( )
)
ÒÒ) *
;
ÒÒ* +
trx
ÛÛ 
.
ÛÛ 
Complete
ÛÛ  
(
ÛÛ  !
)
ÛÛ! "
;
ÛÛ" #
}
ıı 
return
ˆˆ 
Content
ˆˆ 
(
ˆˆ 
$str
ˆˆ !
)
ˆˆ! "
;
ˆˆ" #
}
¯¯ 
catch
˘˘ 
{
˙˙ 
return
˚˚ 
Content
˚˚ 
(
˚˚ 
	GetConfig
˚˚ (
.
˚˚( )

AppSetting
˚˚) 3
[
˚˚3 4
$str
˚˚4 M
]
˚˚M N
)
˚˚N O
;
˚˚O P
}
¸¸ 
}
˝˝ 	
public
ÅÅ 
ActionResult
ÅÅ 
View
ÅÅ  
(
ÅÅ  !
int
ÅÅ! $
id
ÅÅ% '
)
ÅÅ' (
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
lastSession
ÉÉ 
.
ÉÉ 
Update
ÉÉ #
(
ÉÉ# $
)
ÉÉ$ %
)
ÉÉ% &
{
ÑÑ 
return
ÖÖ 
RedirectToAction
ÖÖ '
(
ÖÖ' (
$str
ÖÖ( /
,
ÖÖ/ 0
	GetConfig
ÖÖ1 :
.
ÖÖ: ;

AppSetting
ÖÖ; E
[
ÖÖE F
$str
ÖÖF n
]
ÖÖn o
+
ÖÖp q
$str
ÖÖr y
,
ÖÖy z
new
ÖÖ{ ~
{ÖÖ Ä
aÖÖÅ Ç
=ÖÖÉ Ñ
trueÖÖÖ â
}ÖÖä ã
)ÖÖã å
;ÖÖå ç
}
ÜÜ 
var
áá 
location
áá 
=
áá 
new
áá 
Uri
áá "
(
áá" #
$"
áá# %
{
áá% &
Request
áá& -
.
áá- .
Scheme
áá. 4
}
áá4 5
$str
áá5 8
{
áá8 9
Request
áá9 @
.
áá@ A
Host
ááA E
}
ááE F
{
ááF G
Request
ááG N
.
ááN O
Path
ááO S
}
ááS T
"
ááT U
)
ááU V
;
ááV W
string
àà 
Path
àà 
=
àà 
location
àà "
.
àà" #
AbsolutePath
àà# /
.
àà/ 0
Replace
àà0 7
(
àà7 8
this
àà8 <
.
àà< =
ControllerContext
àà= N
.
ààN O
	RouteData
ààO X
.
ààX Y
Values
ààY _
[
àà_ `
$str
àà` h
]
ààh i
.
àài j
ToString
ààj r
(
ààr s
)
ààs t
,
ààt u
$str
ààv }
)
àà} ~
;
àà~ 
if
ââ 
(
ââ 
!
ââ 
accessSecurity
ââ 
.
ââ  
IsGetAccess
ââ  +
(
ââ+ ,
$str
ââ, 0
+
ââ1 2
Path
ââ3 7
)
ââ7 8
)
ââ8 9
{
ää 
return
ãã 
RedirectToAction
ãã '
(
ãã' (
$str
ãã( 3
,
ãã3 4
$str
ãã5 <
)
ãã< =
;
ãã= >
}
åå 
TblMasterLookup
éé 
data
éé  
=
éé! "
_context
éé# +
.
éé+ ,
TblMasterLookups
éé, <
.
éé< =
Where
éé= B
(
ééB C
m
ééC D
=>
ééE G
m
ééH I
.
ééI J
Id
ééJ L
==
ééM O
id
ééP R
)
ééR S
.
ééS T
FirstOrDefault
ééT b
(
ééb c
)
ééc d
;
ééd e
if
èè 
(
èè 
data
èè 
==
èè 
null
èè 
)
èè 
{
êê 
data
ëë 
=
ëë 
new
ëë 
TblMasterLookup
ëë *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
íí 
return
îî 
PartialView
îî 
(
îî 
$str
îî &
,
îî& '
data
îî( ,
)
îî, -
;
îî- .
}
ïï 	
public
öö 
ActionResult
öö 
Delete
öö "
(
öö" #
string
öö# )
Ids
öö* -
)
öö- .
{
õõ 	
if
úú 
(
úú 
!
úú 
lastSession
úú 
.
úú 
Update
úú #
(
úú# $
)
úú$ %
)
úú% &
{
ùù 
return
ûû 
RedirectToAction
ûû '
(
ûû' (
$str
ûû( /
,
ûû/ 0
	GetConfig
ûû1 :
.
ûû: ;

AppSetting
ûû; E
[
ûûE F
$str
ûûF n
]
ûûn o
+
ûûp q
$str
ûûr y
,
ûûy z
new
ûû{ ~
{ûû Ä
aûûÅ Ç
=ûûÉ Ñ
trueûûÖ â
}ûûä ã
)ûûã å
;ûûå ç
}
üü 
var
†† 
location
†† 
=
†† 
new
†† 
Uri
†† "
(
††" #
$"
††# %
{
††% &
Request
††& -
.
††- .
Scheme
††. 4
}
††4 5
$str
††5 8
{
††8 9
Request
††9 @
.
††@ A
Host
††A E
}
††E F
{
††F G
Request
††G N
.
††N O
Path
††O S
}
††S T
"
††T U
)
††U V
;
††V W
string
°° 
Path
°° 
=
°° 
location
°° "
.
°°" #
AbsolutePath
°°# /
.
°°/ 0
Replace
°°0 7
(
°°7 8
this
°°8 <
.
°°< =
ControllerContext
°°= N
.
°°N O
	RouteData
°°O X
.
°°X Y
Values
°°Y _
[
°°_ `
$str
°°` h
]
°°h i
.
°°i j
ToString
°°j r
(
°°r s
)
°°s t
,
°°t u
$str
°°v }
)
°°} ~
;
°°~ 
if
¢¢ 
(
¢¢ 
!
¢¢ 
accessSecurity
¢¢ 
.
¢¢  
IsGetAccess
¢¢  +
(
¢¢+ ,
$str
¢¢, 0
+
¢¢1 2
Path
¢¢3 7
)
¢¢7 8
)
¢¢8 9
{
££ 
return
§§ 
RedirectToAction
§§ '
(
§§' (
$str
§§( 3
,
§§3 4
$str
§§5 <
)
§§< =
;
§§= >
}
•• 
try
ßß 
{
®® 
long
©© 
[
©© 
]
©© 
confirmedDeleteId
©© (
=
©©) *
Ids
©©+ .
.
©©. /
Split
©©/ 4
(
©©4 5
$char
©©5 8
)
©©8 9
.
©©9 :
Select
©©: @
(
©©@ A
long
©©A E
.
©©E F
Parse
©©F K
)
©©K L
.
©©L M
ToArray
©©M T
(
©©T U
)
©©U V
;
©©V W
List
´´ 
<
´´ 
TblMasterLookup
´´ $
>
´´$ %

Transaksis
´´& 0
=
´´1 2
_context
´´3 ;
.
´´; <
TblMasterLookups
´´< L
.
´´L M
Where
´´M R
(
´´R S
x
´´S T
=>
´´U W
confirmedDeleteId
´´X i
.
´´i j
Contains
´´j r
(
´´r s
x
´´s t
.
´´t u
Id
´´u w
)
´´w x
)
´´x y
.
´´y z
ToList´´z Ä
(´´Ä Å
)´´Å Ç
;´´Ç É
for
¨¨ 
(
¨¨ 
int
¨¨ 
i
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
i
¨¨  !
<
¨¨" #
confirmedDeleteId
¨¨$ 5
.
¨¨5 6
Length
¨¨6 <
;
¨¨< =
i
¨¨> ?
++
¨¨? A
)
¨¨A B
{
≠≠ 
TblMasterLookup
ÆÆ #
data
ÆÆ$ (
=
ÆÆ) *
_context
ÆÆ+ 3
.
ÆÆ3 4
TblMasterLookups
ÆÆ4 D
.
ÆÆD E
Find
ÆÆE I
(
ÆÆI J

Transaksis
ÆÆJ T
[
ÆÆT U
i
ÆÆU V
]
ÆÆV W
.
ÆÆW X
Id
ÆÆX Z
)
ÆÆZ [
;
ÆÆ[ \
data
ØØ 
.
ØØ 
	IsDeleted
ØØ "
=
ØØ# $
true
ØØ% )
;
ØØ) *
data
∞∞ 
.
∞∞ 
DeletedById
∞∞ $
=
∞∞% &
int
∞∞' *
.
∞∞* +
Parse
∞∞+ 0
(
∞∞0 1
HttpContext
∞∞1 <
.
∞∞< =
Session
∞∞= D
.
∞∞D E
	GetString
∞∞E N
(
∞∞N O
SessionConstan
∞∞O ]
.
∞∞] ^
Session_UserId
∞∞^ l
)
∞∞l m
)
∞∞m n
;
∞∞n o
;
∞∞p q
data
±± 
.
±± 
DeletedTime
±± $
=
±±% &
DateTime
±±' /
.
±±/ 0
Now
±±0 3
;
±±3 4
_context
≤≤ 
.
≤≤ 
Entry
≤≤ "
(
≤≤" #
data
≤≤# '
)
≤≤' (
.
≤≤( )
State
≤≤) .
=
≤≤/ 0
EntityState
≤≤1 <
.
≤≤< =
Modified
≤≤= E
;
≤≤E F
_context
≥≥ 
.
≥≥ 
SaveChanges
≥≥ (
(
≥≥( )
)
≥≥) *
;
≥≥* +
}
¥¥ 
return
µµ 
Content
µµ 
(
µµ 
$str
µµ !
)
µµ! "
;
µµ" #
}
∂∂ 
catch
∑∑ 
{
∏∏ 
return
ππ 
Content
ππ 
(
ππ 
$str
ππ &
)
ππ& '
;
ππ' (
}
∫∫ 
}
ªª 	
}
ΩΩ 
}ææ ÉÑ
LD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\LoginController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public 

class 
LoginController  
:! "

Controller# -
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7 
IHttpContextAccessor 
	_accessor &
;& '
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
public 
static 
bool 
isLogout #
=$ %
false& +
;+ ,
public 
LoginController 
( 
IConfiguration -
config. 4
,4 5%
DbDashboardDevaBniContext6 O
contextP W
,W X 
IHttpContextAccessorY m
accessorn v
)v w
{   	
_context!! 
=!! 
context!! 
;!! 
_configuration"" 
="" 
config"" #
;""# $
	_accessor## 
=## 
accessor##  
;##  !
lastSession$$ 
=$$ 
new$$ 
LastSessionLog$$ ,
($$, -
accessor$$- 5
,$$5 6
context$$7 >
,$$> ?
config$$@ F
)$$F G
;$$G H
}%% 	
public&& 
IActionResult&& 
Login&& "
(&&" #
bool&&# '
?&&' (
a&&) *
,&&* +
string&&, 2
	textError&&3 <
)&&< =
{'' 	
if(( 
((( 
HttpContext(( 
.(( 
Session(( #
.((# $
	GetString(($ -
(((- .
SessionConstan((. <
.((< =
Session_UserId((= K
)((K L
==((M O
null((P T
)((T U
{)) !
SliderLogin_ViewModel11 %

dataToView11& 0
=111 2
new113 6!
SliderLogin_ViewModel117 L
(11L M
)11M N
;11N O
ViewBagFF 
.FF 
ErrorMessageFF $
=FF% &
	textErrorFF' 0
;FF0 1
returnGG 
ViewGG 
(GG 

dataToViewGG &
)GG& '
;GG' (
}HH 
elseII 
{JJ 
ViewBagKK 
.KK 
ErrorMessageKK $
=KK% &
$strKK' D
;KKD E
lastSessionLL 
.LL 
UpdateLL "
(LL" #
)LL# $
;LL$ %
returnMM 
RedirectToActionMM '
(MM' (
$strMM( /
,MM/ 0
	GetConfigMM1 :
.MM: ;

AppSettingMM; E
[MME F
$strMMF b
]MMb c
+MMd e
$strMMf l
)MMl m
;MMm n
}NN 
}OO 	
publicPP 
IActionResultPP 
LogoutAccountPP *
(PP* +
boolPP+ /
?PP/ 0
aPP1 2
)PP2 3
{QQ 	
ifRR 
(RR 
HttpContextRR 
.RR 
SessionRR #
.RR# $
	GetStringRR$ -
(RR- .
SessionConstanRR. <
.RR< =
Session_UserIdRR= K
)RRK L
==RRM O
nullRRP T
)RRT U
{SS 
ViewBagUU 
.UU 
TahunUU 
=UU 
DateTimeUU  (
.UU( )
NowUU) ,
.UU, -
YearUU- 1
;UU1 2
ViewBagVV 
.VV 
IslogoutVV  
=VV! "
aVV# $
;VV$ %
returnWW 
ViewWW 
(WW 
)WW 
;WW 
}XX 
elseZZ 
{[[ 
ViewBag\\ 
.\\ 
ErrorMessage\\ $
=\\% &
$str\\' D
;\\D E
lastSession]] 
.]] 
Update]] "
(]]" #
)]]# $
;]]$ %
return^^ 
RedirectToAction^^ '
(^^' (
$str^^( /
,^^/ 0
$str^^1 7
)^^7 8
;^^8 9
}__ 
}`` 	
[aa 	$
ValidateAntiForgeryTokenaa	 !
]aa! "
[bb 	
HttpPostbb	 
]bb 
publiccc 
asynccc 
Taskcc 
<cc 
ActionResultcc &
>cc& '
Logincc( -
(cc- .
Login_ViewModelcc. =
modelcc> C
)ccC D
{dd 	
ifee 
(ee 
modelee 
.ee 
OtpValidee 
==ee !
$stree" (
)ee( )
{ff 
returngg 
RedirectToActiongg '
(gg' (
$strgg( /
,gg/ 0
$strgg1 7
)gg7 8
;gg8 9
}hh 
ifjj 
(jj 
!jj 
stringjj 
.jj 
IsNullOrEmptyjj %
(jj% &
modeljj& +
.jj+ ,
Usernamejj, 4
)jj4 5
&&jj6 8
!jj9 :
stringjj: @
.jj@ A
IsNullOrEmptyjjA N
(jjN O
modeljjO T
.jjT U
PasswordjjU ]
)jj] ^
)jj^ _
{kk 
boolll 
LoginAllowedll !
=ll" #
falsell$ )
;ll) *"
DetailLogin_ViewModelsmm &
datamm' +
=mm, -
newmm. 1"
DetailLogin_ViewModelsmm2 H
(mmH I
)mmI J
;mmJ K
IPHostEntrynn 
heservernn $
=nn% &
Dnsnn' *
.nn* +
GetHostEntrynn+ 7
(nn7 8
Dnsnn8 ;
.nn; <
GetHostNamenn< G
(nnG H
)nnH I
)nnI J
;nnJ K
varoo 
	ipAddressoo 
=oo 
heserveroo  (
.oo( )
AddressListoo) 4
.oo4 5
ToListoo5 ;
(oo; <
)oo< =
.oo= >
Whereoo> C
(ooC D
ipooD F
=>ooG I
ipooJ L
.ooL M
AddressFamilyooM Z
==oo[ ]
Systemoo^ d
.ood e
Netooe h
.ooh i
Socketsooi p
.oop q
AddressFamilyooq ~
.oo~ 
InterNetwork	oo ã
)
ooã å
.
ooå ç
FirstOrDefault
ooç õ
(
ooõ ú
)
ooú ù
?
ooù û
.
ooû ü
ToString
ooü ß
(
ooß ®
)
oo® ©
;
oo© ™
stringpp 
hostpp 
=pp 
	_accessorpp '
.pp' (
HttpContextpp( 3
.pp3 4
Requestpp4 ;
.pp; <
Hostpp< @
.pp@ A
ValueppA F
;ppF G
varqq 
locationqq 
=qq 
newqq "
Uriqq# &
(qq& '
$"qq' )
{qq) *
Requestqq* 1
.qq1 2
Schemeqq2 8
}qq8 9
$strqq9 <
{qq< =
Requestqq= D
.qqD E
HostqqE I
}qqI J
{qqJ K
RequestqqK R
.qqR S
PathqqS W
}qqW X
{qqX Y
RequestqqY `
.qq` a
QueryStringqqa l
}qql m
"qqm n
)qqn o
;qqo p
tryss 
{tt 
TblUserSessionuu "
updatesessionuu# 0
=uu1 2
_contextuu3 ;
.uu; <
TblUserSessionsuu< K
.uuK L
WhereuuL Q
(uuQ R
fuuR S
=>uuT V
fuuW X
.uuX Y
UserIduuY _
==uu` b
_contextuuc k
.uuk l
TblMasterUsersuul z
.uuz {
Where	uu{ Ä
(
uuÄ Å
x
uuÅ Ç
=>
uuÉ Ö
x
uuÜ á
.
uuá à
Username
uuà ê
==
uuë ì
model
uuî ô
.
uuô ö
Username
uuö ¢
)
uu¢ £
.
uu£ §
Select
uu§ ™
(
uu™ ´
x
uu´ ¨
=>
uu≠ Ø
x
uu∞ ±
.
uu± ≤
Id
uu≤ ¥
)
uu¥ µ
.
uuµ ∂
FirstOrDefault
uu∂ ƒ
(
uuƒ ≈
)
uu≈ ∆
)
uu∆ «
.
uu« »
FirstOrDefault
uu» ÷
(
uu÷ ◊
)
uu◊ ÿ
;
uuÿ Ÿ
ifvv 
(vv 
updatesessionvv %
!=vv& (
nullvv) -
&&vv. 0
updatesessionvv1 >
.vv> ?
IsLogoutvv? G
==vvH J
falsevvK P
&&vvQ S
(vvT U
DateTimevvU ]
.vv] ^
Nowvv^ a
-vvb c
updatesessionvvd q
.vvq r

LastActivevvr |
)vv| }
?vv} ~
.vv~ 
TotalMinutes	vv ã
>
vvå ç
int
vvé ë
.
vvë í
Parse
vví ó
(
vvó ò
	GetConfig
vvò °
.
vv° ¢

AppSetting
vv¢ ¨
[
vv¨ ≠
$str
vv≠ –
]
vv– —
)
vv— “
)
vv“ ”
{ww 
updatesessionxx %
.xx% &
IsLogoutxx& .
=xx/ 0
truexx1 5
;xx5 6
_contextyy  
.yy  !
TblUserSessionsyy! 0
.yy0 1
Updateyy1 7
(yy7 8
updatesessionyy8 E
)yyE F
;yyF G
_contextzz  
.zz  !
SaveChangeszz! ,
(zz, -
)zz- .
;zz. /
}{{ 
if|| 
(|| 
updatesession|| %
!=||& (
null||) -
&&||. 0
(||1 2
DateTime||2 :
.||: ;
Now||; >
-||? @
updatesession||A N
.||N O

LastActive||O Y
)||Y Z
?||Z [
.||[ \
TotalMinutes||\ h
>||i j
int||k n
.||n o
Parse||o t
(||t u
	GetConfig||u ~
.||~ 

AppSetting	|| â
[
||â ä
$str
||ä §
]
||§ •
)
||• ¶
)
||¶ ß
{}} 
updatesession~~ %
.~~% &
Counter~~& -
=~~. /
$num~~0 1
;~~1 2
updatesession %
.% &

LastActive& 0
=1 2
DateTime3 ;
.; <
Now< ?
;? @
_context
ÄÄ  
.
ÄÄ  !
TblUserSessions
ÄÄ! 0
.
ÄÄ0 1
Update
ÄÄ1 7
(
ÄÄ7 8
updatesession
ÄÄ8 E
)
ÄÄE F
;
ÄÄF G
_context
ÅÅ  
.
ÅÅ  !
SaveChanges
ÅÅ! ,
(
ÅÅ, -
)
ÅÅ- .
;
ÅÅ. /
}
ÇÇ 
try
ÑÑ 
{
ÖÖ 
var
ÜÜ 
ismatch
ÜÜ #
=
ÜÜ$ %
false
ÜÜ& +
;
ÜÜ+ ,
data
àà 
=
àà %
StoredProcedureExecutor
àà 6
.
àà6 7
ExecuteSPSingle
àà7 F
<
ààF G$
DetailLogin_ViewModels
ààG ]
>
àà] ^
(
àà^ _
_context
àà_ g
,
ààg h
$str
àài {
,
àà{ |
newàà} Ä
SqlParameterààÅ ç
[ààç é
]ààé è
{ààè ê
new
ââ 
SqlParameter
ââ (
(
ââ( )
$str
ââ) 4
,
ââ4 5
model
ââ6 ;
.
ââ; <
Username
ââ< D
)
ââD E
}
ââE F
)
ââF G
;
ââG H
if
ãã 
(
ãã 
data
ãã  
!=
ãã! #
null
ãã$ (
&&
ãã) +
model
ãã, 1
.
ãã1 2
Password
ãã2 :
!=
ãã; =
	GetConfig
ãã> G
.
ããG H

AppSetting
ããH R
[
ããR S
$str
ããS }
]
ãã} ~
)
ãã~ 
{
åå 
ismatch
çç #
=
çç$ %
BCrypt
çç& ,
.
çç, -
Net
çç- 0
.
çç0 1
BCrypt
çç1 7
.
çç7 8
Verify
çç8 >
(
çç> ?
model
çç? D
.
ççD E
Password
ççE M
,
ççM N
data
ççO S
.
ççS T
Password
ççT \
)
çç\ ]
;
çç] ^
}
éé 
if
êê 
(
êê 
data
êê  
==
êê! #
null
êê$ (
)
êê( )
{
ëë 
ViewBag
íí #
.
íí# $
ErrorMessage
íí$ 0
=
íí1 2
	GetConfig
íí3 <
.
íí< =

AppSetting
íí= G
[
ííG H
$str
ííH m
]
íím n
;
íín o
return
ìì "
View
ìì# '
(
ìì' (
)
ìì( )
;
ìì) *
}
îî 
else
ïï 
if
ïï 
(
ïï  !
data
ïï! %
.
ïï% &
Counter
ïï& -
>
ïï. /
$num
ïï0 1
&&
ïï2 4
(
ïï5 6
DateTime
ïï6 >
.
ïï> ?
Now
ïï? B
-
ïïC D
data
ïïE I
.
ïïI J

LastActive
ïïJ T
)
ïïT U
?
ïïU V
.
ïïV W
TotalMinutes
ïïW c
<
ïïd e
int
ïïf i
.
ïïi j
Parse
ïïj o
(
ïïo p
	GetConfig
ïïp y
.
ïïy z

AppSettingïïz Ñ
[ïïÑ Ö
$strïïÖ ü
]ïïü †
)ïï† °
)ïï° ¢
{
ññ 
ViewBag
óó #
.
óó# $
ErrorMessage
óó$ 0
=
óó1 2
	GetConfig
óó3 <
.
óó< =

AppSetting
óó= G
[
óóG H
$str
óóH a
]
óóa b
;
óób c
return
òò "
View
òò# '
(
òò' (
)
òò( )
;
òò) *
}
ôô 
else
öö 
if
öö 
(
öö  !
data
öö! %
.
öö% &
IsActive
öö& .
==
öö/ 1
false
öö2 7
)
öö7 8
{
õõ 
ViewBag
úú #
.
úú# $
ErrorMessage
úú$ 0
=
úú1 2
	GetConfig
úú3 <
.
úú< =

AppSetting
úú= G
[
úúG H
$str
úúH m
]
úúm n
;
úún o
return
ùù "
View
ùù# '
(
ùù' (
)
ùù( )
;
ùù) *
}
ûû 
else
üü 
if
üü 
(
üü  !
data
üü! %
.
üü% &
	IsDeleted
üü& /
==
üü0 2
true
üü3 7
)
üü7 8
{
†† 
ViewBag
°° #
.
°°# $
ErrorMessage
°°$ 0
=
°°1 2
	GetConfig
°°3 <
.
°°< =

AppSetting
°°= G
[
°°G H
$str
°°H m
]
°°m n
;
°°n o
return
¢¢ "
View
¢¢# '
(
¢¢' (
)
¢¢( )
;
¢¢) *
}
££ 
else
§§ 
if
§§ 
(
§§  !
data
§§! %
.
§§% &
isLogout
§§& .
==
§§/ 1
false
§§2 7
&&
§§8 :
(
§§; <
DateTime
§§< D
.
§§D E
Now
§§E H
-
§§I J
data
§§K O
.
§§O P

LastActive
§§P Z
)
§§Z [
?
§§[ \
.
§§\ ]
TotalMinutes
§§] i
<
§§j k
int
§§l o
.
§§o p
Parse
§§p u
(
§§u v
	GetConfig
§§v 
.§§ Ä

AppSetting§§Ä ä
[§§ä ã
$str§§ã •
]§§• ¶
)§§¶ ß
)§§ß ®
{
•• 
ViewBag
¶¶ #
.
¶¶# $
ErrorMessage
¶¶$ 0
=
¶¶1 2
	GetConfig
¶¶3 <
.
¶¶< =

AppSetting
¶¶= G
[
¶¶G H
$str
¶¶H e
]
¶¶e f
;
¶¶f g
return
ßß "
View
ßß# '
(
ßß' (
)
ßß( )
;
ßß) *
}
®® 
else
©© 
if
©© 
(
©©  !
model
©©! &
.
©©& '
Password
©©' /
==
©©0 2
	GetConfig
©©3 <
.
©©< =

AppSetting
©©= G
[
©©G H
$str
©©H r
]
©©r s
)
©©s t
{
™™ 
LoginAllowed
´´ (
=
´´) *
true
´´+ /
;
´´/ 0
}
¨¨ 
else
≠≠ 
if
≠≠ 
(
≠≠  !
ismatch
≠≠! (
)
≠≠( )
{
ÆÆ 
LoginAllowed
ØØ (
=
ØØ) *
true
ØØ+ /
;
ØØ/ 0
}
∞∞ 
else
±± 
{
≤≤ 
var
¥¥ 
	userAgent
¥¥  )
=
¥¥* +
	_accessor
¥¥, 5
.
¥¥5 6
HttpContext
¥¥6 A
.
¥¥A B
Request
¥¥B I
.
¥¥I J
Headers
¥¥J Q
[
¥¥Q R
$str
¥¥R ^
]
¥¥^ _
;
¥¥_ `
string
µµ "
uaString
µµ# +
=
µµ, -
Convert
µµ. 5
.
µµ5 6
ToString
µµ6 >
(
µµ> ?
	userAgent
µµ? H
[
µµH I
$num
µµI J
]
µµJ K
)
µµK L
;
µµL M
var
∂∂ 
uaParser
∂∂  (
=
∂∂) *
Parser
∂∂+ 1
.
∂∂1 2

GetDefault
∂∂2 <
(
∂∂< =
)
∂∂= >
;
∂∂> ?

ClientInfo
∑∑ &
c
∑∑' (
=
∑∑) *
uaParser
∑∑+ 3
.
∑∑3 4
Parse
∑∑4 9
(
∑∑9 :
uaString
∑∑: B
)
∑∑B C
;
∑∑C D
TblLogActivity
ππ *
dataLog
ππ+ 2
=
ππ3 4
new
ππ5 8
TblLogActivity
ππ9 G
(
ππG H
)
ππH I
;
ππI J
dataLog
∫∫ #
.
∫∫# $
Username
∫∫$ ,
=
∫∫- .
model
∫∫/ 4
.
∫∫4 5
Username
∫∫5 =
;
∫∫= >
dataLog
ªª #
.
ªª# $
Url
ªª$ '
=
ªª( )
$str
ªª* :
;
ªª: ;
dataLog
ºº #
.
ºº# $

ActionTime
ºº$ .
=
ºº/ 0
DateTime
ºº1 9
.
ºº9 :
Now
ºº: =
;
ºº= >
if
ΩΩ 
(
ΩΩ  
c
ΩΩ  !
!=
ΩΩ" $
null
ΩΩ% )
)
ΩΩ) *
{
ææ 
if
øø  "
(
øø# $
c
øø$ %
.
øø% &
	UserAgent
øø& /
!=
øø0 2
null
øø3 7
)
øø7 8
{
¿¿  !
dataLog
¡¡$ +
.
¡¡+ ,
Browser
¡¡, 3
=
¡¡4 5
c
¡¡6 7
.
¡¡7 8
	UserAgent
¡¡8 A
.
¡¡A B
Family
¡¡B H
+
¡¡I J
$str
¡¡K N
+
¡¡O P
c
¡¡Q R
.
¡¡R S
	UserAgent
¡¡S \
.
¡¡\ ]
Major
¡¡] b
+
¡¡c d
$str
¡¡e h
+
¡¡i j
c
¡¡k l
.
¡¡l m
	UserAgent
¡¡m v
.
¡¡v w
Minor
¡¡w |
;
¡¡| }
}
√√  !
if
≈≈  "
(
≈≈# $
c
≈≈$ %
.
≈≈% &
OS
≈≈& (
!=
≈≈) +
null
≈≈, 0
)
≈≈0 1
{
∆∆  !
dataLog
««$ +
.
««+ ,
Os
««, .
=
««/ 0
c
««1 2
.
««2 3
OS
««3 5
.
««5 6
Family
««6 <
+
««= >
$str
««? B
+
««C D
c
««E F
.
««F G
OS
««G I
.
««I J
Major
««J O
+
««P Q
$str
««R U
+
««V W
c
««X Y
.
««Y Z
OS
««Z \
.
««\ ]
Minor
««] b
;
««b c
}
»»  !
}
…… 
dataLog
ÀÀ #
.
ÀÀ# $
Ip
ÀÀ$ &
=
ÀÀ' (
	ipAddress
ÀÀ) 2
;
ÀÀ2 3
dataLog
ÃÃ #
.
ÃÃ# $

ClientInfo
ÃÃ$ .
=
ÃÃ/ 0
c
ÃÃ1 2
.
ÃÃ2 3
String
ÃÃ3 9
;
ÃÃ9 :
dataLog
ÕÕ #
.
ÕÕ# $

Keterangan
ÕÕ$ .
=
ÕÕ/ 0
	GetConfig
ÕÕ1 :
.
ÕÕ: ;

AppSetting
ÕÕ; E
[
ÕÕE F
$str
ÕÕF k
]
ÕÕk l
;
ÕÕl m
_context
ŒŒ $
.
ŒŒ$ %
TblLogActivities
ŒŒ% 5
.
ŒŒ5 6
Add
ŒŒ6 9
(
ŒŒ9 :
dataLog
ŒŒ: A
)
ŒŒA B
;
ŒŒB C
_context
œœ $
.
œœ$ %
SaveChanges
œœ% 0
(
œœ0 1
)
œœ1 2
;
œœ2 3
TblUserSession
—— *
ds
——+ -
=
——. /
_context
——0 8
.
——8 9
TblUserSessions
——9 H
.
——H I
Where
——I N
(
——N O
f
——O P
=>
——Q S
f
——T U
.
——U V
UserId
——V \
==
——] _
data
——` d
.
——d e
UserId
——e k
)
——k l
.
——l m
FirstOrDefault
——m {
(
——{ |
)
——| }
;
——} ~
if
““ 
(
““  
ds
““  "
!=
““# %
null
““& *
)
““* +
{
”” 
ds
‘‘  "
.
‘‘" #
	SessionId
‘‘# ,
=
‘‘- .
HttpContext
‘‘/ :
.
‘‘: ;
Session
‘‘; B
.
‘‘B C
Id
‘‘C E
;
‘‘E F
ds
’’  "
.
’’" #

LastActive
’’# -
=
’’. /
DateTime
’’0 8
.
’’8 9
Now
’’9 <
;
’’< =
ds
÷÷  "
.
÷÷" #
Counter
÷÷# *
=
÷÷+ ,
ds
÷÷- /
.
÷÷/ 0
Counter
÷÷0 7
+
÷÷8 9
$num
÷÷: ;
;
÷÷; <
_context
◊◊  (
.
◊◊( )
TblUserSessions
◊◊) 8
.
◊◊8 9
Update
◊◊9 ?
(
◊◊? @
ds
◊◊@ B
)
◊◊B C
;
◊◊C D
_context
ÿÿ  (
.
ÿÿ( )
SaveChanges
ÿÿ) 4
(
ÿÿ4 5
)
ÿÿ5 6
;
ÿÿ6 7
}
ŸŸ 
else
⁄⁄  
{
€€ 
var
‹‹  #
UserSession
‹‹$ /
=
‹‹0 1
new
‹‹2 5
TblUserSession
‹‹6 D
(
‹‹D E
)
‹‹E F
;
‹‹F G
UserSession
››  +
.
››+ ,
UserId
››, 2
=
››3 4
data
››5 9
.
››9 :
UserId
››: @
;
››@ A
UserSession
ﬁﬁ  +
.
ﬁﬁ+ ,

LastActive
ﬁﬁ, 6
=
ﬁﬁ7 8
DateTime
ﬁﬁ9 A
.
ﬁﬁA B
Now
ﬁﬁB E
;
ﬁﬁE F
UserSession
ﬂﬂ  +
.
ﬂﬂ+ ,
Counter
ﬂﬂ, 3
=
ﬂﬂ4 5
$num
ﬂﬂ6 7
;
ﬂﬂ7 8
_context
‡‡  (
.
‡‡( )
TblUserSessions
‡‡) 8
.
‡‡8 9
Add
‡‡9 <
(
‡‡< =
UserSession
‡‡= H
)
‡‡H I
;
‡‡I J
_context
··  (
.
··( )
SaveChanges
··) 4
(
··4 5
)
··5 6
;
··6 7
}
‚‚ 
ViewBag
‰‰ #
.
‰‰# $
ErrorMessage
‰‰$ 0
=
‰‰1 2
	GetConfig
‰‰3 <
.
‰‰< =

AppSetting
‰‰= G
[
‰‰G H
$str
‰‰H m
]
‰‰m n
;
‰‰n o
return
ÂÂ "
View
ÂÂ# '
(
ÂÂ' (
)
ÂÂ( )
;
ÂÂ) *
}
ÊÊ 
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË $
ex
ËË% '
)
ËË' (
{
ÈÈ 
ViewBag
ÍÍ 
.
ÍÍ  
ErrorMessage
ÍÍ  ,
+=
ÍÍ- /
	GetConfig
ÍÍ0 9
.
ÍÍ9 :

AppSetting
ÍÍ: D
[
ÍÍD E
$str
ÍÍE l
]
ÍÍl m
;
ÍÍm n
return
ÎÎ 
View
ÎÎ #
(
ÎÎ# $
)
ÎÎ$ %
;
ÎÎ% &
}
ÏÏ 
if
ÓÓ 
(
ÓÓ 
LoginAllowed
ÓÓ $
)
ÓÓ$ %
{
ÔÔ 
HttpContext
 #
.
# $
Session
$ +
.
+ ,
	SetString
, 5
(
5 6
SessionConstan
6 D
.
D E
Session_UserId
E S
,
S T
data
U Y
.
Y Z
UserId
Z `
.
` a
ToString
a i
(
i j
)
j k
==
l n
null
o s
?
t u
$str
v x
:
y z
data
{ 
. Ä
UserIdÄ Ü
.Ü á
ToStringá è
(è ê
)ê ë
)ë í
;í ì
HttpContext
ÒÒ #
.
ÒÒ# $
Session
ÒÒ$ +
.
ÒÒ+ ,
	SetString
ÒÒ, 5
(
ÒÒ5 6
SessionConstan
ÒÒ6 D
.
ÒÒD E&
Session_Username_Pegawai
ÒÒE ]
,
ÒÒ] ^
data
ÒÒ_ c
.
ÒÒc d
Username
ÒÒd l
.
ÒÒl m
ToString
ÒÒm u
(
ÒÒu v
)
ÒÒv w
==
ÒÒx z
null
ÒÒ{ 
?ÒÒÄ Å
$strÒÒÇ Ñ
:ÒÒÖ Ü
dataÒÒá ã
.ÒÒã å
UsernameÒÒå î
.ÒÒî ï
ToStringÒÒï ù
(ÒÒù û
)ÒÒû ü
)ÒÒü †
;ÒÒ† °
HttpContext
ÚÚ #
.
ÚÚ# $
Session
ÚÚ$ +
.
ÚÚ+ ,
	SetString
ÚÚ, 5
(
ÚÚ5 6
SessionConstan
ÚÚ6 D
.
ÚÚD E
Session_RoleKode
ÚÚE U
,
ÚÚU V
data
ÚÚW [
.
ÚÚ[ \
KodeRole
ÚÚ\ d
.
ÚÚd e
ToString
ÚÚe m
(
ÚÚm n
)
ÚÚn o
==
ÚÚp r
null
ÚÚs w
?
ÚÚx y
$str
ÚÚz |
:
ÚÚ} ~
dataÚÚ É
.ÚÚÉ Ñ
KodeRoleÚÚÑ å
.ÚÚå ç
ToStringÚÚç ï
(ÚÚï ñ
)ÚÚñ ó
)ÚÚó ò
;ÚÚò ô
HttpContext
ÛÛ #
.
ÛÛ# $
Session
ÛÛ$ +
.
ÛÛ+ ,
	SetString
ÛÛ, 5
(
ÛÛ5 6
SessionConstan
ÛÛ6 D
.
ÛÛD E
Session_RoleName
ÛÛE U
,
ÛÛU V
data
ÛÛW [
.
ÛÛ[ \
RoleName
ÛÛ\ d
==
ÛÛe g
null
ÛÛh l
?
ÛÛm n
$str
ÛÛo q
:
ÛÛr s
data
ÛÛt x
.
ÛÛx y
RoleNameÛÛy Å
)ÛÛÅ Ç
;ÛÛÇ É
HttpContext
ÙÙ #
.
ÙÙ# $
Session
ÙÙ$ +
.
ÙÙ+ ,
	SetString
ÙÙ, 5
(
ÙÙ5 6
SessionConstan
ÙÙ6 D
.
ÙÙD E
Session_Name
ÙÙE Q
,
ÙÙQ R
data
ÙÙS W
.
ÙÙW X
Fullname
ÙÙX `
==
ÙÙa c
null
ÙÙd h
?
ÙÙi j
$str
ÙÙk m
:
ÙÙn o
data
ÙÙp t
.
ÙÙt u
Fullname
ÙÙu }
)
ÙÙ} ~
;
ÙÙ~ 
HttpContext
ıı #
.
ıı# $
Session
ıı$ +
.
ıı+ ,
	SetString
ıı, 5
(
ıı5 6
SessionConstan
ıı6 D
.
ııD E
Session_Email
ııE R
,
ııR S
data
ııT X
.
ııX Y
Email
ııY ^
==
ıı_ a
null
ııb f
?
ııg h
$str
ııi k
:
ııl m
data
ıın r
.
ıır s
Email
ııs x
)
ııx y
;
ııy z
HttpContext
ˆˆ #
.
ˆˆ# $
Session
ˆˆ$ +
.
ˆˆ+ ,
	SetString
ˆˆ, 5
(
ˆˆ5 6
SessionConstan
ˆˆ6 D
.
ˆˆD E
Session_NoHP
ˆˆE Q
,
ˆˆQ R
data
ˆˆS W
.
ˆˆW X
NoHP
ˆˆX \
==
ˆˆ] _
null
ˆˆ` d
?
ˆˆe f
$str
ˆˆg i
:
ˆˆj k
data
ˆˆl p
.
ˆˆp q
NoHP
ˆˆq u
)
ˆˆu v
;
ˆˆv w
HttpContext
˜˜ #
.
˜˜# $
Session
˜˜$ +
.
˜˜+ ,
	SetString
˜˜, 5
(
˜˜5 6
SessionConstan
˜˜6 D
.
˜˜D E
Session_IsOTP
˜˜E R
,
˜˜R S
data
˜˜T X
.
˜˜X Y
IsOTP
˜˜Y ^
==
˜˜_ a
null
˜˜b f
?
˜˜g h
$str
˜˜i k
:
˜˜l m
data
˜˜n r
.
˜˜r s
IsOTP
˜˜s x
)
˜˜x y
;
˜˜y z
HttpContext
¯¯ #
.
¯¯# $
Session
¯¯$ +
.
¯¯+ ,
	SetString
¯¯, 5
(
¯¯5 6
SessionConstan
¯¯6 D
.
¯¯D E"
Session_IsVerifEmail
¯¯E Y
,
¯¯Y Z
data
¯¯[ _
.
¯¯_ `
IsVerifEmail
¯¯` l
==
¯¯m o
null
¯¯p t
?
¯¯u v
$str
¯¯w y
:
¯¯z {
data¯¯| Ä
.¯¯Ä Å
IsVerifEmail¯¯Å ç
)¯¯ç é
;¯¯é è
HttpContext
˘˘ #
.
˘˘# $
Session
˘˘$ +
.
˘˘+ ,
	SetString
˘˘, 5
(
˘˘5 6
SessionConstan
˘˘6 D
.
˘˘D E#
Session_IsVerifNoTelp
˘˘E Z
,
˘˘Z [
data
˘˘\ `
.
˘˘` a
IsVerifNoTelp
˘˘a n
==
˘˘o q
null
˘˘r v
?
˘˘w x
$str
˘˘y {
:
˘˘| }
data˘˘~ Ç
.˘˘Ç É
IsVerifNoTelp˘˘É ê
)˘˘ê ë
;˘˘ë í
var
¸¸ 

checkOtpON
¸¸ &
=
¸¸' (
_context
¸¸) 1
.
¸¸1 2'
TblMasterSystemParameters
¸¸2 K
.
¸¸K L
Where
¸¸L Q
(
¸¸Q R
m
¸¸R S
=>
¸¸T V
m
¸¸W X
.
¸¸X Y
Key
¸¸Y \
==
¸¸] _
$str
¸¸` j
)
¸¸j k
.
¸¸k l
Select
¸¸l r
(
¸¸r s
m
¸¸s t
=>
¸¸u w
m
¸¸x y
.
¸¸y z
Value
¸¸z 
)¸¸ Ä
.¸¸Ä Å
FirstOrDefault¸¸Å è
(¸¸è ê
)¸¸ê ë
;¸¸ë í
if
˛˛ 
(
˛˛ 

checkOtpON
˛˛ &
==
˛˛' )
$str
˛˛* -
||
˛˛. 0
model
˛˛1 6
.
˛˛6 7
Password
˛˛7 ?
==
˛˛@ B
	GetConfig
˛˛C L
.
˛˛L M

AppSetting
˛˛M W
[
˛˛W X
$str˛˛X Ç
]˛˛Ç É
)˛˛É Ñ
{
ˇˇ 
var
ÄÄ 
	userAgent
ÄÄ  )
=
ÄÄ* +
	_accessor
ÄÄ, 5
.
ÄÄ5 6
HttpContext
ÄÄ6 A
.
ÄÄA B
Request
ÄÄB I
.
ÄÄI J
Headers
ÄÄJ Q
[
ÄÄQ R
$str
ÄÄR ^
]
ÄÄ^ _
;
ÄÄ_ `
string
ÅÅ "
uaString
ÅÅ# +
=
ÅÅ, -
Convert
ÅÅ. 5
.
ÅÅ5 6
ToString
ÅÅ6 >
(
ÅÅ> ?
	userAgent
ÅÅ? H
[
ÅÅH I
$num
ÅÅI J
]
ÅÅJ K
)
ÅÅK L
;
ÅÅL M
var
ÇÇ 
uaParser
ÇÇ  (
=
ÇÇ) *
Parser
ÇÇ+ 1
.
ÇÇ1 2

GetDefault
ÇÇ2 <
(
ÇÇ< =
)
ÇÇ= >
;
ÇÇ> ?

ClientInfo
ÉÉ &
c
ÉÉ' (
=
ÉÉ) *
uaParser
ÉÉ+ 3
.
ÉÉ3 4
Parse
ÉÉ4 9
(
ÉÉ9 :
uaString
ÉÉ: B
)
ÉÉB C
;
ÉÉC D
TblLogActivity
ÑÑ *
dataLog
ÑÑ+ 2
=
ÑÑ3 4
new
ÑÑ5 8
TblLogActivity
ÑÑ9 G
(
ÑÑG H
)
ÑÑH I
;
ÑÑI J
List
ÖÖ  
<
ÖÖ  !#
Navigation_ViewModels
ÖÖ! 6
>
ÖÖ6 7
ListNav
ÖÖ8 ?
=
ÖÖ@ A
new
ÖÖB E
List
ÖÖF J
<
ÖÖJ K#
Navigation_ViewModels
ÖÖK `
>
ÖÖ` a
(
ÖÖa b
)
ÖÖb c
;
ÖÖc d
ListNav
áá #
=
áá$ %%
StoredProcedureExecutor
áá& =
.
áá= >
ExecuteSPList
áá> K
<
ááK L#
Navigation_ViewModels
ááL a
>
ááa b
(
ááb c
_context
áác k
,
áák l
$str
áám y
,
ááy z
new
áá{ ~
SqlParameteráá ã
[ááã å
]ááå ç
{ááç é
new
àà  #
SqlParameter
àà$ 0
(
àà0 1
$str
àà1 ;
,
àà; <
data
àà= A
.
ààA B
RoleId
ààB H
)
ààH I
}
ââ 
)
ââ 
;
ââ 
if
ää 
(
ää  
ListNav
ää  '
==
ää( *
null
ää+ /
)
ää/ 0
{
ãã 
	userAgent
çç  )
=
çç* +
	_accessor
çç, 5
.
çç5 6
HttpContext
çç6 A
.
ççA B
Request
ççB I
.
ççI J
Headers
ççJ Q
[
ççQ R
$str
ççR ^
]
çç^ _
;
çç_ `
uaString
éé  (
=
éé) *
Convert
éé+ 2
.
éé2 3
ToString
éé3 ;
(
éé; <
	userAgent
éé< E
[
ééE F
$num
ééF G
]
ééG H
)
ééH I
;
ééI J
uaParser
èè  (
=
èè) *
Parser
èè+ 1
.
èè1 2

GetDefault
èè2 <
(
èè< =
)
èè= >
;
èè> ?
c
êê  !
=
êê" #
uaParser
êê$ ,
.
êê, -
Parse
êê- 2
(
êê2 3
uaString
êê3 ;
)
êê; <
;
êê< =
dataLog
ëë  '
=
ëë( )
new
ëë* -
TblLogActivity
ëë. <
(
ëë< =
)
ëë= >
;
ëë> ?
dataLog
ìì  '
.
ìì' (
Username
ìì( 0
=
ìì1 2
model
ìì3 8
.
ìì8 9
Username
ìì9 A
;
ììA B
dataLog
îî  '
.
îî' (
Url
îî( +
=
îî, -
$str
îî. >
;
îî> ?
dataLog
ïï  '
.
ïï' (

ActionTime
ïï( 2
=
ïï3 4
DateTime
ïï5 =
.
ïï= >
Now
ïï> A
;
ïïA B
if
ññ  "
(
ññ# $
c
ññ$ %
!=
ññ& (
null
ññ) -
)
ññ- .
{
óó  !
if
òò$ &
(
òò' (
c
òò( )
.
òò) *
	UserAgent
òò* 3
!=
òò4 6
null
òò7 ;
)
òò; <
{
ôô$ %
dataLog
öö( /
.
öö/ 0
Browser
öö0 7
=
öö8 9
c
öö: ;
.
öö; <
	UserAgent
öö< E
.
ööE F
Family
ööF L
+
ööM N
$str
ööO R
+
ööS T
c
ööU V
.
ööV W
	UserAgent
ööW `
.
öö` a
Major
ööa f
+
öög h
$str
ööi l
+
ööm n
c
ööo p
.
ööp q
	UserAgent
ööq z
.
ööz {
Minoröö{ Ä
;ööÄ Å
}
úú$ %
if
ûû$ &
(
ûû' (
c
ûû( )
.
ûû) *
OS
ûû* ,
!=
ûû- /
null
ûû0 4
)
ûû4 5
{
üü$ %
dataLog
††( /
.
††/ 0
Os
††0 2
=
††3 4
c
††5 6
.
††6 7
OS
††7 9
.
††9 :
Family
††: @
+
††A B
$str
††C F
+
††G H
c
††I J
.
††J K
OS
††K M
.
††M N
Major
††N S
+
††T U
$str
††V Y
+
††Z [
c
††\ ]
.
††] ^
OS
††^ `
.
††` a
Minor
††a f
;
††f g
}
°°$ %
}
¢¢  !
dataLog
££  '
.
££' (
Ip
££( *
=
££+ ,
	ipAddress
££- 6
;
££6 7
dataLog
§§  '
.
§§' (

ClientInfo
§§( 2
=
§§3 4
c
§§5 6
.
§§6 7
String
§§7 =
;
§§= >
dataLog
••  '
.
••' (

Keterangan
••( 2
=
••3 4
string
••5 ;
.
••; <
Format
••< B
(
••B C
$str
••C r
)
••r s
;
••s t
_context
¶¶  (
.
¶¶( )
TblLogActivities
¶¶) 9
.
¶¶9 :
Add
¶¶: =
(
¶¶= >
dataLog
¶¶> E
)
¶¶E F
;
¶¶F G
_context
ßß  (
.
ßß( )
SaveChanges
ßß) 4
(
ßß4 5
)
ßß5 6
;
ßß6 7
ViewBag
©©  '
.
©©' (
ErrorMessage
©©( 4
=
©©5 6
$str
©©7 f
;
©©f g
return
™™  &
View
™™' +
(
™™+ ,
)
™™, -
;
™™- .
}
´´ 
else
¨¨  
{
≠≠ 
TblUserSession
ÆÆ  .
UserSession
ÆÆ/ :
=
ÆÆ; <
new
ÆÆ= @
TblUserSession
ÆÆA O
(
ÆÆO P
)
ÆÆP Q
;
ÆÆQ R
TblUserSession
ØØ  .
ds
ØØ/ 1
=
ØØ2 3
_context
ØØ4 <
.
ØØ< =
TblUserSessions
ØØ= L
.
ØØL M
Where
ØØM R
(
ØØR S
f
ØØS T
=>
ØØU W
f
ØØX Y
.
ØØY Z
UserId
ØØZ `
==
ØØa c
data
ØØd h
.
ØØh i
UserId
ØØi o
)
ØØo p
.
ØØp q
FirstOrDefault
ØØq 
(ØØ Ä
)ØØÄ Å
;ØØÅ Ç
if
∞∞  "
(
∞∞# $
ds
∞∞$ &
!=
∞∞' )
null
∞∞* .
)
∞∞. /
{
±±  !
ds
≤≤$ &
.
≤≤& '
	SessionId
≤≤' 0
=
≤≤1 2
HttpContext
≤≤3 >
.
≤≤> ?
Session
≤≤? F
.
≤≤F G
Id
≤≤G I
;
≤≤I J
ds
≥≥$ &
.
≥≥& '

LastActive
≥≥' 1
=
≥≥2 3
DateTime
≥≥4 <
.
≥≥< =
Now
≥≥= @
;
≥≥@ A
ds
¥¥$ &
.
¥¥& '
RoleId
¥¥' -
=
¥¥. /
int
¥¥0 3
.
¥¥3 4
Parse
¥¥4 9
(
¥¥9 :
HttpContext
¥¥: E
.
¥¥E F
Session
¥¥F M
.
¥¥M N
	GetString
¥¥N W
(
¥¥W X
SessionConstan
¥¥X f
.
¥¥f g
Session_RoleKode
¥¥g w
)
¥¥w x
)
¥¥x y
;
¥¥y z
ds
µµ$ &
.
µµ& '
Info
µµ' +
=
µµ, -
	ipAddress
µµ. 7
;
µµ7 8
ds
∂∂$ &
.
∂∂& '
IsLogout
∂∂' /
=
∂∂0 1
false
∂∂2 7
;
∂∂7 8
_context
∏∏$ ,
.
∏∏, -
TblUserSessions
∏∏- <
.
∏∏< =
Update
∏∏= C
(
∏∏C D
ds
∏∏D F
)
∏∏F G
;
∏∏G H
_context
ππ$ ,
.
ππ, -
SaveChanges
ππ- 8
(
ππ8 9
)
ππ9 :
;
ππ: ;
}
∫∫  !
else
ªª  $
{
ºº  !
UserSession
ΩΩ$ /
.
ΩΩ/ 0
UserId
ΩΩ0 6
=
ΩΩ7 8
int
ΩΩ9 <
.
ΩΩ< =
Parse
ΩΩ= B
(
ΩΩB C
HttpContext
ΩΩC N
.
ΩΩN O
Session
ΩΩO V
.
ΩΩV W
	GetString
ΩΩW `
(
ΩΩ` a
SessionConstan
ΩΩa o
.
ΩΩo p
Session_UserId
ΩΩp ~
)
ΩΩ~ 
)ΩΩ Ä
;ΩΩÄ Å
UserSession
ææ$ /
.
ææ/ 0
	SessionId
ææ0 9
=
ææ: ;
HttpContext
ææ< G
.
ææG H
Session
ææH O
.
ææO P
Id
ææP R
;
ææR S
UserSession
øø$ /
.
øø/ 0

LastActive
øø0 :
=
øø; <
DateTime
øø= E
.
øøE F
Now
øøF I
;
øøI J
UserSession
¿¿$ /
.
¿¿/ 0
Info
¿¿0 4
=
¿¿5 6
	ipAddress
¿¿7 @
;
¿¿@ A
UserSession
¡¡$ /
.
¡¡/ 0
RoleId
¡¡0 6
=
¡¡7 8
int
¡¡9 <
.
¡¡< =
Parse
¡¡= B
(
¡¡B C
HttpContext
¡¡C N
.
¡¡N O
Session
¡¡O V
.
¡¡V W
	GetString
¡¡W `
(
¡¡` a
SessionConstan
¡¡a o
.
¡¡o p
Session_RoleKode¡¡p Ä
)¡¡Ä Å
)¡¡Å Ç
;¡¡Ç É
UserSession
¬¬$ /
.
¬¬/ 0
IsLogout
¬¬0 8
=
¬¬9 :
false
¬¬; @
;
¬¬@ A
_context
ƒƒ$ ,
.
ƒƒ, -
TblUserSessions
ƒƒ- <
.
ƒƒ< =
Add
ƒƒ= @
(
ƒƒ@ A
UserSession
ƒƒA L
)
ƒƒL M
;
ƒƒM N
_context
≈≈$ ,
.
≈≈, -
SaveChanges
≈≈- 8
(
≈≈8 9
)
≈≈9 :
;
≈≈: ;
}
∆∆  !
HttpContext
»»  +
.
»»+ ,
Session
»», 3
.
»»3 4
	SetObject
»»4 =
(
»»= >
$str
»»> G
,
»»G H
ListNav
»»I P
)
»»P Q
;
»»Q R
return
……  &
RedirectToAction
……' 7
(
……7 8
$str
……8 ?
,
……? @
$str
……A G
)
……G H
;
……H I
}
   
}
ÀÀ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ  !

checkOtpON
ÃÃ! +
==
ÃÃ, .
$str
ÃÃ/ 2
&&
ÃÃ3 5
(
ÃÃ6 7
data
ÃÃ7 ;
.
ÃÃ; <
IsVerifEmail
ÃÃ< H
==
ÃÃI K
null
ÃÃL P
||
ÃÃQ S
data
ÃÃT X
.
ÃÃX Y
IsVerifEmail
ÃÃY e
.
ÃÃe f
ToLower
ÃÃf m
(
ÃÃm n
)
ÃÃn o
==
ÃÃp r
$str
ÃÃs z
)
ÃÃz {
&&
ÃÃ| ~
(ÃÃ Ä
dataÃÃÄ Ñ
.ÃÃÑ Ö
IsVerifNoTelpÃÃÖ í
==ÃÃì ï
nullÃÃñ ö
||ÃÃõ ù
dataÃÃû ¢
.ÃÃ¢ £
IsVerifNoTelpÃÃ£ ∞
.ÃÃ∞ ±
ToLowerÃÃ± ∏
(ÃÃ∏ π
)ÃÃπ ∫
==ÃÃª Ω
$strÃÃæ ≈
)ÃÃ≈ ∆
)ÃÃ∆ «
{
ÕÕ 
var
ŒŒ 
	userAgent
ŒŒ  )
=
ŒŒ* +
	_accessor
ŒŒ, 5
.
ŒŒ5 6
HttpContext
ŒŒ6 A
.
ŒŒA B
Request
ŒŒB I
.
ŒŒI J
Headers
ŒŒJ Q
[
ŒŒQ R
$str
ŒŒR ^
]
ŒŒ^ _
;
ŒŒ_ `
string
œœ "
uaString
œœ# +
=
œœ, -
Convert
œœ. 5
.
œœ5 6
ToString
œœ6 >
(
œœ> ?
	userAgent
œœ? H
[
œœH I
$num
œœI J
]
œœJ K
)
œœK L
;
œœL M
var
–– 
uaParser
––  (
=
––) *
Parser
––+ 1
.
––1 2

GetDefault
––2 <
(
––< =
)
––= >
;
––> ?

ClientInfo
—— &
c
——' (
=
——) *
uaParser
——+ 3
.
——3 4
Parse
——4 9
(
——9 :
uaString
——: B
)
——B C
;
——C D
TblLogActivity
““ *
dataLog
““+ 2
=
““3 4
new
““5 8
TblLogActivity
““9 G
(
““G H
)
““H I
;
““I J
List
””  
<
””  !#
Navigation_ViewModels
””! 6
>
””6 7
ListNav
””8 ?
=
””@ A
new
””B E
List
””F J
<
””J K#
Navigation_ViewModels
””K `
>
””` a
(
””a b
)
””b c
;
””c d
ListNav
’’ #
=
’’$ %%
StoredProcedureExecutor
’’& =
.
’’= >
ExecuteSPList
’’> K
<
’’K L#
Navigation_ViewModels
’’L a
>
’’a b
(
’’b c
_context
’’c k
,
’’k l
$str
’’m y
,
’’y z
new
’’{ ~
SqlParameter’’ ã
[’’ã å
]’’å ç
{’’ç é
new
÷÷  #
SqlParameter
÷÷$ 0
(
÷÷0 1
$str
÷÷1 ;
,
÷÷; <
data
÷÷= A
.
÷÷A B
RoleId
÷÷B H
)
÷÷H I
}
◊◊ 
)
◊◊ 
;
◊◊ 
if
ÿÿ 
(
ÿÿ  
ListNav
ÿÿ  '
==
ÿÿ( *
null
ÿÿ+ /
)
ÿÿ/ 0
{
ŸŸ 
	userAgent
€€  )
=
€€* +
	_accessor
€€, 5
.
€€5 6
HttpContext
€€6 A
.
€€A B
Request
€€B I
.
€€I J
Headers
€€J Q
[
€€Q R
$str
€€R ^
]
€€^ _
;
€€_ `
uaString
‹‹  (
=
‹‹) *
Convert
‹‹+ 2
.
‹‹2 3
ToString
‹‹3 ;
(
‹‹; <
	userAgent
‹‹< E
[
‹‹E F
$num
‹‹F G
]
‹‹G H
)
‹‹H I
;
‹‹I J
uaParser
››  (
=
››) *
Parser
››+ 1
.
››1 2

GetDefault
››2 <
(
››< =
)
››= >
;
››> ?
c
ﬁﬁ  !
=
ﬁﬁ" #
uaParser
ﬁﬁ$ ,
.
ﬁﬁ, -
Parse
ﬁﬁ- 2
(
ﬁﬁ2 3
uaString
ﬁﬁ3 ;
)
ﬁﬁ; <
;
ﬁﬁ< =
dataLog
ﬂﬂ  '
=
ﬂﬂ( )
new
ﬂﬂ* -
TblLogActivity
ﬂﬂ. <
(
ﬂﬂ< =
)
ﬂﬂ= >
;
ﬂﬂ> ?
dataLog
··  '
.
··' (
Username
··( 0
=
··1 2
model
··3 8
.
··8 9
Username
··9 A
;
··A B
dataLog
‚‚  '
.
‚‚' (
Url
‚‚( +
=
‚‚, -
$str
‚‚. >
;
‚‚> ?
dataLog
„„  '
.
„„' (

ActionTime
„„( 2
=
„„3 4
DateTime
„„5 =
.
„„= >
Now
„„> A
;
„„A B
if
‰‰  "
(
‰‰# $
c
‰‰$ %
!=
‰‰& (
null
‰‰) -
)
‰‰- .
{
ÂÂ  !
if
ÊÊ$ &
(
ÊÊ' (
c
ÊÊ( )
.
ÊÊ) *
	UserAgent
ÊÊ* 3
!=
ÊÊ4 6
null
ÊÊ7 ;
)
ÊÊ; <
{
ÁÁ$ %
dataLog
ËË( /
.
ËË/ 0
Browser
ËË0 7
=
ËË8 9
c
ËË: ;
.
ËË; <
	UserAgent
ËË< E
.
ËËE F
Family
ËËF L
+
ËËM N
$str
ËËO R
+
ËËS T
c
ËËU V
.
ËËV W
	UserAgent
ËËW `
.
ËË` a
Major
ËËa f
+
ËËg h
$str
ËËi l
+
ËËm n
c
ËËo p
.
ËËp q
	UserAgent
ËËq z
.
ËËz {
MinorËË{ Ä
;ËËÄ Å
}
ÍÍ$ %
if
ÏÏ$ &
(
ÏÏ' (
c
ÏÏ( )
.
ÏÏ) *
OS
ÏÏ* ,
!=
ÏÏ- /
null
ÏÏ0 4
)
ÏÏ4 5
{
ÌÌ$ %
dataLog
ÓÓ( /
.
ÓÓ/ 0
Os
ÓÓ0 2
=
ÓÓ3 4
c
ÓÓ5 6
.
ÓÓ6 7
OS
ÓÓ7 9
.
ÓÓ9 :
Family
ÓÓ: @
+
ÓÓA B
$str
ÓÓC F
+
ÓÓG H
c
ÓÓI J
.
ÓÓJ K
OS
ÓÓK M
.
ÓÓM N
Major
ÓÓN S
+
ÓÓT U
$str
ÓÓV Y
+
ÓÓZ [
c
ÓÓ\ ]
.
ÓÓ] ^
OS
ÓÓ^ `
.
ÓÓ` a
Minor
ÓÓa f
;
ÓÓf g
}
ÔÔ$ %
}
  !
dataLog
ÒÒ  '
.
ÒÒ' (
Ip
ÒÒ( *
=
ÒÒ+ ,
	ipAddress
ÒÒ- 6
;
ÒÒ6 7
dataLog
ÚÚ  '
.
ÚÚ' (

ClientInfo
ÚÚ( 2
=
ÚÚ3 4
c
ÚÚ5 6
.
ÚÚ6 7
String
ÚÚ7 =
;
ÚÚ= >
dataLog
ÛÛ  '
.
ÛÛ' (

Keterangan
ÛÛ( 2
=
ÛÛ3 4
string
ÛÛ5 ;
.
ÛÛ; <
Format
ÛÛ< B
(
ÛÛB C
$str
ÛÛC r
)
ÛÛr s
;
ÛÛs t
_context
ÙÙ  (
.
ÙÙ( )
TblLogActivities
ÙÙ) 9
.
ÙÙ9 :
Add
ÙÙ: =
(
ÙÙ= >
dataLog
ÙÙ> E
)
ÙÙE F
;
ÙÙF G
_context
ıı  (
.
ıı( )
SaveChanges
ıı) 4
(
ıı4 5
)
ıı5 6
;
ıı6 7
ViewBag
˜˜  '
.
˜˜' (
ErrorMessage
˜˜( 4
=
˜˜5 6
$str
˜˜7 f
;
˜˜f g
return
¯¯  &
View
¯¯' +
(
¯¯+ ,
)
¯¯, -
;
¯¯- .
}
˘˘ 
else
˙˙  
{
˚˚ 
TblUserSession
¸¸  .
UserSession
¸¸/ :
=
¸¸; <
new
¸¸= @
TblUserSession
¸¸A O
(
¸¸O P
)
¸¸P Q
;
¸¸Q R
TblUserSession
˝˝  .
ds
˝˝/ 1
=
˝˝2 3
_context
˝˝4 <
.
˝˝< =
TblUserSessions
˝˝= L
.
˝˝L M
Where
˝˝M R
(
˝˝R S
f
˝˝S T
=>
˝˝U W
f
˝˝X Y
.
˝˝Y Z
UserId
˝˝Z `
==
˝˝a c
data
˝˝d h
.
˝˝h i
UserId
˝˝i o
)
˝˝o p
.
˝˝p q
FirstOrDefault
˝˝q 
(˝˝ Ä
)˝˝Ä Å
;˝˝Å Ç
if
˛˛  "
(
˛˛# $
ds
˛˛$ &
!=
˛˛' )
null
˛˛* .
)
˛˛. /
{
ˇˇ  !
ds
ÄÄ$ &
.
ÄÄ& '
	SessionId
ÄÄ' 0
=
ÄÄ1 2
HttpContext
ÄÄ3 >
.
ÄÄ> ?
Session
ÄÄ? F
.
ÄÄF G
Id
ÄÄG I
;
ÄÄI J
ds
ÅÅ$ &
.
ÅÅ& '

LastActive
ÅÅ' 1
=
ÅÅ2 3
DateTime
ÅÅ4 <
.
ÅÅ< =
Now
ÅÅ= @
;
ÅÅ@ A
ds
ÇÇ$ &
.
ÇÇ& '
RoleId
ÇÇ' -
=
ÇÇ. /
int
ÇÇ0 3
.
ÇÇ3 4
Parse
ÇÇ4 9
(
ÇÇ9 :
HttpContext
ÇÇ: E
.
ÇÇE F
Session
ÇÇF M
.
ÇÇM N
	GetString
ÇÇN W
(
ÇÇW X
SessionConstan
ÇÇX f
.
ÇÇf g
Session_RoleKode
ÇÇg w
)
ÇÇw x
)
ÇÇx y
;
ÇÇy z
ds
ÉÉ$ &
.
ÉÉ& '
Info
ÉÉ' +
=
ÉÉ, -
	ipAddress
ÉÉ. 7
;
ÉÉ7 8
ds
ÑÑ$ &
.
ÑÑ& '
IsLogout
ÑÑ' /
=
ÑÑ0 1
false
ÑÑ2 7
;
ÑÑ7 8
_context
ÜÜ$ ,
.
ÜÜ, -
TblUserSessions
ÜÜ- <
.
ÜÜ< =
Update
ÜÜ= C
(
ÜÜC D
ds
ÜÜD F
)
ÜÜF G
;
ÜÜG H
_context
áá$ ,
.
áá, -
SaveChanges
áá- 8
(
áá8 9
)
áá9 :
;
áá: ;
}
àà  !
else
ââ  $
{
ää  !
UserSession
ãã$ /
.
ãã/ 0
UserId
ãã0 6
=
ãã7 8
int
ãã9 <
.
ãã< =
Parse
ãã= B
(
ããB C
HttpContext
ããC N
.
ããN O
Session
ããO V
.
ããV W
	GetString
ããW `
(
ãã` a
SessionConstan
ããa o
.
ãão p
Session_UserId
ããp ~
)
ãã~ 
)ãã Ä
;ããÄ Å
UserSession
åå$ /
.
åå/ 0
	SessionId
åå0 9
=
åå: ;
HttpContext
åå< G
.
ååG H
Session
ååH O
.
ååO P
Id
ååP R
;
ååR S
UserSession
çç$ /
.
çç/ 0

LastActive
çç0 :
=
çç; <
DateTime
çç= E
.
ççE F
Now
ççF I
;
ççI J
UserSession
éé$ /
.
éé/ 0
Info
éé0 4
=
éé5 6
	ipAddress
éé7 @
;
éé@ A
UserSession
èè$ /
.
èè/ 0
RoleId
èè0 6
=
èè7 8
int
èè9 <
.
èè< =
Parse
èè= B
(
èèB C
HttpContext
èèC N
.
èèN O
Session
èèO V
.
èèV W
	GetString
èèW `
(
èè` a
SessionConstan
èèa o
.
èèo p
Session_RoleKodeèèp Ä
)èèÄ Å
)èèÅ Ç
;èèÇ É
UserSession
êê$ /
.
êê/ 0
IsLogout
êê0 8
=
êê9 :
false
êê; @
;
êê@ A
_context
íí$ ,
.
íí, -
TblUserSessions
íí- <
.
íí< =
Add
íí= @
(
íí@ A
UserSession
ííA L
)
ííL M
;
ííM N
_context
ìì$ ,
.
ìì, -
SaveChanges
ìì- 8
(
ìì8 9
)
ìì9 :
;
ìì: ;
}
îî  !
HttpContext
ññ  +
.
ññ+ ,
Session
ññ, 3
.
ññ3 4
	SetObject
ññ4 =
(
ññ= >
$str
ññ> G
,
ññG H
ListNav
ññI P
.
ññP Q
Where
ññQ V
(
ññV W
m
ññW X
=>
ññY [
m
ññ\ ]
.
ññ] ^
Name
ññ^ b
==
ññc e
$str
ññf o
)
ñño p
)
ññp q
;
ññq r
return
óó  &
RedirectToAction
óó' 7
(
óó7 8
$str
óó8 ?
,
óó? @
$str
óóA J
)
óóJ K
;
óóK L
}
òò 
}
ôô 
else
öö 
{
õõ 
ViewBag
úú #
.
úú# $

Validation
úú$ .
=
úú/ 0
$str
úú1 4
;
úú4 5
ViewBag
ùù #
.
ùù# $
IsVerifEmail
ùù$ 0
=
ùù1 2
data
ùù3 7
.
ùù7 8
IsVerifEmail
ùù8 D
==
ùùE G
null
ùùH L
?
ùùM N
$str
ùùO V
:
ùùW X
data
ùùY ]
.
ùù] ^
IsVerifEmail
ùù^ j
.
ùùj k
ToLower
ùùk r
(
ùùr s
)
ùùs t
;
ùùt u
ViewBag
ûû #
.
ûû# $
IsVerifNoTelp
ûû$ 1
=
ûû2 3
data
ûû4 8
.
ûû8 9
IsVerifNoTelp
ûû9 F
==
ûûG I
null
ûûJ N
?
ûûO P
$str
ûûQ X
:
ûûY Z
data
ûû[ _
.
ûû_ `
IsVerifNoTelp
ûû` m
.
ûûm n
ToLower
ûûn u
(
ûûu v
)
ûûv w
;
ûûw x
return
üü "
View
üü# '
(
üü' (
)
üü( )
;
üü) *
}
†† 
}
°° 
else
¢¢ 
{
££ 
HttpContext
§§ #
.
§§# $
Session
§§$ +
.
§§+ ,
Clear
§§, 1
(
§§1 2
)
§§2 3
;
§§3 4
ViewBag
•• 
.
••  
ErrorMessage
••  ,
=
••- .
	GetConfig
••/ 8
.
••8 9

AppSetting
••9 C
[
••C D
$str
••D i
]
••i j
;
••j k
return
¶¶ 
View
¶¶ #
(
¶¶# $
)
¶¶$ %
;
¶¶% &
}
ßß 
}
©© 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
´´ 
HttpContext
¨¨ 
.
¨¨  
Session
¨¨  '
.
¨¨' (
Clear
¨¨( -
(
¨¨- .
)
¨¨. /
;
¨¨/ 0
ViewBag
≠≠ 
.
≠≠ 
ErrorMessage
≠≠ (
+=
≠≠) +
	GetConfig
≠≠, 5
.
≠≠5 6

AppSetting
≠≠6 @
[
≠≠@ A
$str
≠≠A h
]
≠≠h i
;
≠≠i j
return
ÆÆ 
View
ÆÆ 
(
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
}
ØØ 
}
∞∞ 
else
±± 
{
≤≤ 
ViewBag
≥≥ 
.
≥≥ 
ErrorMessage
≥≥ $
+=
≥≥% '
string
≥≥( .
.
≥≥. /
Format
≥≥/ 5
(
≥≥5 6
$str
≥≥6 a
)
≥≥a b
;
≥≥b c
return
¥¥ 
View
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
}
∂∂ 	
private
∆∆ 
string
∆∆ "
GenerateRandomString
∆∆ +
(
∆∆+ ,
int
∆∆, /
length
∆∆0 6
)
∆∆6 7
{
«« 	
using
»» 
(
»» 
var
»» 
randomGenerator
»» &
=
»»' (#
RandomNumberGenerator
»») >
.
»»> ?
Create
»»? E
(
»»E F
)
»»F G
)
»»G H
{
…… 
byte
   
[
   
]
   
data
   
=
   
new
   !
byte
  " &
[
  & '
$num
  ' (
]
  ( )
;
  ) *
randomGenerator
ÀÀ 
.
ÀÀ  
GetBytes
ÀÀ  (
(
ÀÀ( )
data
ÀÀ) -
)
ÀÀ- .
;
ÀÀ. /
int
ŒŒ 
value
ŒŒ 
=
ŒŒ 
BitConverter
ŒŒ (
.
ŒŒ( )
ToInt32
ŒŒ) 0
(
ŒŒ0 1
data
ŒŒ1 5
,
ŒŒ5 6
$num
ŒŒ7 8
)
ŒŒ8 9
&
ŒŒ: ;
$num
ŒŒ< F
;
ŒŒF G
int
—— 
fiveDigitNumber
—— #
=
——$ %
value
——& +
%
——, -
$num
——. 3
+
——4 5
$num
——6 ;
;
——; <
return
”” 
fiveDigitNumber
”” &
.
””& '
ToString
””' /
(
””/ 0
)
””0 1
;
””1 2
}
‘‘ 
}
’’ 	
public
◊◊ 
ResultStatus
◊◊ 
SendEmailOTP
◊◊ (
(
◊◊( )
)
◊◊) *
{
ÿÿ 	
var
ŸŸ 

resultData
ŸŸ 
=
ŸŸ 
new
ŸŸ 
ResultStatus
ŸŸ $
(
ŸŸ$ %
)
ŸŸ% &
;
ŸŸ& '
try
€€ 
{
‹‹ 
var
›› 
userId
›› 
=
›› 
HttpContext
›› (
.
››( )
Session
››) 0
.
››0 1
	GetString
››1 :
(
››: ;
SessionConstan
››; I
.
››I J
Session_UserId
››J X
)
››X Y
;
››Y Z
var
ﬁﬁ 
email
ﬁﬁ 
=
ﬁﬁ 
HttpContext
ﬁﬁ 
.
ﬁﬁ 
Session
ﬁﬁ #
.
ﬁﬁ# $
	GetString
ﬁﬁ$ -
(
ﬁﬁ- .
SessionConstan
ﬁﬁ. <
.
ﬁﬁ< =
Session_Email
ﬁﬁ= J
)
ﬁﬁJ K
;
ﬁﬁK L
var
ﬂﬂ 
username
ﬂﬂ 
=
ﬂﬂ 
HttpContext
ﬂﬂ *
.
ﬂﬂ* +
Session
ﬂﬂ+ 2
.
ﬂﬂ2 3
	GetString
ﬂﬂ3 <
(
ﬂﬂ< =
SessionConstan
ﬂﬂ= K
.
ﬂﬂK L&
Session_Username_Pegawai
ﬂﬂL d
)
ﬂﬂd e
;
ﬂﬂe f
	TblGetOtp
·· 
dataOtp
·· !
=
··" #
_context
··$ ,
.
··, -

TblGetOtps
··- 7
.
··7 8
Where
··8 =
(
··= >
m
··> ?
=>
··@ B
m
··C D
.
··D E
Username
··E M
==
··N P
username
··Q Y
)
··Y Z
.
··Z [
FirstOrDefault
··[ i
(
··i j
)
··j k
;
··k l
TblUserSession
„„ 
updatesession
„„ ,
=
„„- .
_context
„„/ 7
.
„„7 8
TblUserSessions
„„8 G
.
„„G H
Where
„„H M
(
„„M N
f
„„N O
=>
„„P R
f
„„S T
.
„„T U
UserId
„„U [
==
„„\ ^
int
„„_ b
.
„„b c
Parse
„„c h
(
„„h i
userId
„„i o
)
„„o p
)
„„p q
.
„„q r
FirstOrDefault„„r Ä
(„„Ä Å
)„„Å Ç
;„„Ç É
if
‰‰ 
(
‰‰ 
updatesession
‰‰ !
!=
‰‰" $
null
‰‰% )
&&
‰‰* ,
(
‰‰- .
DateTime
‰‰. 6
.
‰‰6 7
Now
‰‰7 :
-
‰‰; <
updatesession
‰‰= J
.
‰‰J K

LastActive
‰‰K U
)
‰‰U V
?
‰‰V W
.
‰‰W X
TotalSeconds
‰‰X d
>
‰‰e f
int
‰‰g j
.
‰‰j k
Parse
‰‰k p
(
‰‰p q
	GetConfig
‰‰q z
.
‰‰z {

AppSetting‰‰{ Ö
[‰‰Ö Ü
$str‰‰Ü †
]‰‰† °
)‰‰° ¢
)‰‰¢ £
{
ÂÂ 
updatesession
ÊÊ !
.
ÊÊ! "
Counter
ÊÊ" )
=
ÊÊ* +
$num
ÊÊ, -
;
ÊÊ- .
updatesession
ÁÁ !
.
ÁÁ! "

LastActive
ÁÁ" ,
=
ÁÁ- .
DateTime
ÁÁ/ 7
.
ÁÁ7 8
Now
ÁÁ8 ;
;
ÁÁ; <
_context
ËË 
.
ËË 
TblUserSessions
ËË ,
.
ËË, -
Update
ËË- 3
(
ËË3 4
updatesession
ËË4 A
)
ËËA B
;
ËËB C
_context
ÈÈ 
.
ÈÈ 
SaveChanges
ÈÈ (
(
ÈÈ( )
)
ÈÈ) *
;
ÈÈ* +
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
updatesession
ÏÏ !
.
ÏÏ! "
Counter
ÏÏ" )
>
ÏÏ* +
$num
ÏÏ, -
&&
ÏÏ. 0
(
ÏÏ1 2
DateTime
ÏÏ2 :
.
ÏÏ: ;
Now
ÏÏ; >
-
ÏÏ? @
updatesession
ÏÏA N
.
ÏÏN O

LastActive
ÏÏO Y
)
ÏÏY Z
?
ÏÏZ [
.
ÏÏ[ \
TotalSeconds
ÏÏ\ h
<
ÏÏi j
int
ÏÏk n
.
ÏÏn o
Parse
ÏÏo t
(
ÏÏt u
	GetConfig
ÏÏu ~
.
ÏÏ~ 

AppSettingÏÏ â
[ÏÏâ ä
$strÏÏä §
]ÏÏ§ •
)ÏÏ• ¶
)ÏÏ¶ ß
{
ÌÌ 

resultData
ÓÓ 
.
ÓÓ 

StatusCode
ÓÓ )
=
ÓÓ* +
$str
ÓÓ, /
;
ÓÓ/ 0

resultData
ÔÔ 
.
ÔÔ 
Message
ÔÔ &
=
ÔÔ' (
$str
ÔÔ) O
;
ÔÔO P
return
 

resultData
 %
;
% &
}
ÒÒ 
using
ÛÛ 
(
ÛÛ 
TransactionScope
ÛÛ '
trx
ÛÛ( +
=
ÛÛ, -
new
ÛÛ. 1
TransactionScope
ÛÛ2 B
(
ÛÛB C
)
ÛÛC D
)
ÛÛD E
{
ÙÙ 
if
ıı 
(
ıı 
dataOtp
ıı 
==
ıı  "
null
ıı# '
)
ıı' (
{
ˆˆ 
	TblGetOtp
˜˜ !
model
˜˜" '
=
˜˜( )
new
˜˜* -
	TblGetOtp
˜˜. 7
(
˜˜7 8
)
˜˜8 9
;
˜˜9 :
model
¯¯ 
.
¯¯ 
Username
¯¯ 
=
¯¯ 
username
¯¯ 
;
¯¯  
model
˘˘ 
.
˘˘ 
KodeOtp
˘˘ 
=
˘˘ "
GenerateRandomString
˘˘ *
(
˘˘* +
$num
˘˘+ ,
)
˘˘, -
;
˘˘- .
model
˙˙ 
.
˙˙ 
ExpiredTime
˙˙ 
=
˙˙ 
DateTime
˙˙ "
.
˙˙" #
Now
˙˙# &
.
˙˙& '

AddMinutes
˙˙' 1
(
˙˙1 2
$num
˙˙2 3
)
˙˙3 4
;
˙˙4 5
_context
˚˚ 
.
˚˚ 

TblGetOtps
˚˚ 
.
˚˚ 
Add
˚˚ 
(
˚˚ 
model
˚˚ #
)
˚˚# $
;
˚˚$ %
_context
¸¸ 
.
¸¸ 
SaveChanges
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
}
˛˛ 
else
ˇˇ 	
{
ˇˇ
 
dataOtp
ÄÄ 
.
ÄÄ 
Username
ÄÄ 
=
ÄÄ 
username
ÄÄ !
;
ÄÄ! "
dataOtp
ÅÅ 
.
ÅÅ 
KodeOtp
ÅÅ 
=
ÅÅ "
GenerateRandomString
ÅÅ ,
(
ÅÅ, -
$num
ÅÅ- .
)
ÅÅ. /
;
ÅÅ/ 0
dataOtp
ÇÇ 
.
ÇÇ 
ExpiredTime
ÇÇ 
=
ÇÇ 
DateTime
ÇÇ $
.
ÇÇ$ %
Now
ÇÇ% (
.
ÇÇ( )

AddMinutes
ÇÇ) 3
(
ÇÇ3 4
$num
ÇÇ4 5
)
ÇÇ5 6
;
ÇÇ6 7
_context
ÉÉ 
.
ÉÉ 
Entry
ÉÉ 
(
ÉÉ 
dataOtp
ÉÉ 
)
ÉÉ 
.
ÉÉ 
State
ÉÉ #
=
ÉÉ$ %
EntityState
ÉÉ& 1
.
ÉÉ1 2
Modified
ÉÉ2 :
;
ÉÉ: ;
_context
ÑÑ 
.
ÑÑ 
SaveChanges
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
trx
áá 
.
áá 	
Complete
áá	 
(
áá 
)
áá 
;
áá 
}
àà 
try
ää 
{
ãã 
	TblGetOtp
åå 
dataKode
åå &
=
åå' (
_context
åå) 1
.
åå1 2

TblGetOtps
åå2 <
.
åå< =
Where
åå= B
(
ååB C
m
ååC D
=>
ååE G
m
ååH I
.
ååI J
Username
ååJ R
==
ååS U
username
ååV ^
)
åå^ _
.
åå_ `
FirstOrDefault
åå` n
(
åån o
)
ååo p
;
ååp q
var
éé 
body
éé	 
=
éé 
$str
éé 
+
éé 
username
éé "
+
éé# $
$str
èè o
+
èèp q
$str
êê 
+
êê 
dataKode
êê !
.
êê! "
KodeOtp
êê" )
+
êê* +
$str
êê, 2
+
êê3 4
$str
ëë m
+
ëën o
$str
íí 
+
íí 
$str
ìì 8
;
ìì8 9
using
îî 

(
îî 
var
îî 
client
îî 
=
îî 
new
îî 

SmtpClient
îî '
(
îî' (
	GetConfig
îî( 1
.
îî1 2

AppSetting
îî2 <
[
îî< =
$str
îî= O
]
îîO P
,
îîP Q
int
îîR U
.
îîU V
Parse
îîV [
(
îî[ \
	GetConfig
îî\ e
.
îîe f

AppSetting
îîf p
[
îîp q
$strîîq Å
]îîÅ Ç
)îîÇ É
)îîÉ Ñ
)îîÑ Ö
{
ïï 
if
óó 
(
óó 
	GetConfig
óó %
.
óó% &

AppSetting
óó& 0
[
óó0 1
$str
óó1 G
]
óóG H
==
óóI K
$str
óóL O
)
óóO P
{
òò 
client
ôô "
.
ôô" #
	EnableSsl
ôô# ,
=
ôô- .
false
ôô/ 4
;
ôô4 5
client
öö "
.
öö" ##
UseDefaultCredentials
öö# 8
=
öö9 :
false
öö; @
;
öö@ A
client
õõ "
.
õõ" #
Credentials
õõ# .
=
õõ/ 0
new
õõ1 4
NetworkCredential
õõ5 F
(
õõF G
	GetConfig
õõG P
.
õõP Q

AppSetting
õõQ [
[
õõ[ \
$str
õõ\ m
]
õõm n
,
õõn o
	GetConfig
õõp y
.
õõy z

AppSettingõõz Ñ
[õõÑ Ö
$strõõÖ ô
]õõô ö
)õõö õ
;õõõ ú
client
úú "
.
úú" #
DeliveryMethod
úú# 1
=
úú2 3 
SmtpDeliveryMethod
úú4 F
.
úúF G
Network
úúG N
;
úúN O
}
ùù 
else
ûû 
{
üü 
client
†† "
.
††" #
	EnableSsl
††# ,
=
††- .
true
††/ 3
;
††3 4
client
°° "
.
°°" #
Credentials
°°# .
=
°°/ 0
new
°°1 4
NetworkCredential
°°5 F
(
°°F G
	GetConfig
°°G P
.
°°P Q

AppSetting
°°Q [
[
°°[ \
$str
°°\ m
]
°°m n
,
°°n o
	GetConfig
°°p y
.
°°y z

AppSetting°°z Ñ
[°°Ñ Ö
$str°°Ö ô
]°°ô ö
)°°ö õ
;°°õ ú
}
¢¢ 
var
§§ 
message
§§ #
=
§§$ %
new
§§& )
MailMessage
§§* 5
(
§§5 6
	GetConfig
§§6 ?
.
§§? @

AppSetting
§§@ J
[
§§J K
$str
§§K \
]
§§\ ]
,
§§] ^
email
§§_ d
,
§§d e
$str
§§f z
,
§§z {
body§§| Ä
)§§Ä Å
;§§Å Ç
message
•• 
.
•• 

IsBodyHtml
•• 
=
•• 
true
•• 
;
••  
client
¶¶ 
.
¶¶ 
Send
¶¶ 
(
¶¶ 
message
¶¶ 
)
¶¶ 
;
¶¶ 
}
ßß 
TblUserSession
©© "
ds
©©# %
=
©©& '
_context
©©( 0
.
©©0 1
TblUserSessions
©©1 @
.
©©@ A
Where
©©A F
(
©©F G
f
©©G H
=>
©©I K
f
©©L M
.
©©M N
UserId
©©N T
==
©©U W
int
©©X [
.
©©[ \
Parse
©©\ a
(
©©a b
userId
©©b h
)
©©h i
)
©©i j
.
©©j k
FirstOrDefault
©©k y
(
©©y z
)
©©z {
;
©©{ |
if
™™ 
(
™™ 
ds
™™ 
!=
™™ 
null
™™ "
)
™™" #
{
´´ 
ds
¨¨ 
.
¨¨ 
	SessionId
¨¨ $
=
¨¨% &
HttpContext
¨¨' 2
.
¨¨2 3
Session
¨¨3 :
.
¨¨: ;
Id
¨¨; =
;
¨¨= >
ds
≠≠ 
.
≠≠ 

LastActive
≠≠ %
=
≠≠& '
DateTime
≠≠( 0
.
≠≠0 1
Now
≠≠1 4
;
≠≠4 5
ds
ÆÆ 
.
ÆÆ 
Counter
ÆÆ "
=
ÆÆ# $
ds
ÆÆ% '
.
ÆÆ' (
Counter
ÆÆ( /
+
ÆÆ0 1
$num
ÆÆ2 3
;
ÆÆ3 4
_context
ØØ  
.
ØØ  !
TblUserSessions
ØØ! 0
.
ØØ0 1
Update
ØØ1 7
(
ØØ7 8
ds
ØØ8 :
)
ØØ: ;
;
ØØ; <
_context
∞∞  
.
∞∞  !
SaveChanges
∞∞! ,
(
∞∞, -
)
∞∞- .
;
∞∞. /
}
±± 
else
≤≤ 
{
≥≥ 
var
¥¥ 
UserSession
¥¥ '
=
¥¥( )
new
¥¥* -
TblUserSession
¥¥. <
(
¥¥< =
)
¥¥= >
;
¥¥> ?
UserSession
µµ #
.
µµ# $
UserId
µµ$ *
=
µµ+ ,
int
µµ- 0
.
µµ0 1
Parse
µµ1 6
(
µµ6 7
userId
µµ7 =
)
µµ= >
;
µµ> ?
UserSession
∂∂ #
.
∂∂# $

LastActive
∂∂$ .
=
∂∂/ 0
DateTime
∂∂1 9
.
∂∂9 :
Now
∂∂: =
;
∂∂= >
UserSession
∑∑ #
.
∑∑# $
Counter
∑∑$ +
=
∑∑, -
$num
∑∑. /
;
∑∑/ 0
_context
∏∏  
.
∏∏  !
TblUserSessions
∏∏! 0
.
∏∏0 1
Add
∏∏1 4
(
∏∏4 5
UserSession
∏∏5 @
)
∏∏@ A
;
∏∏A B
_context
ππ  
.
ππ  !
SaveChanges
ππ! ,
(
ππ, -
)
ππ- .
;
ππ. /
}
∫∫ 

resultData
ºº 
.
ºº 

StatusCode
ºº )
=
ºº* +
$str
ºº, /
;
ºº/ 0

resultData
ΩΩ 
.
ΩΩ 
Message
ΩΩ 
=
ΩΩ 
CensorEmail
ΩΩ %
(
ΩΩ% &
email
ΩΩ& +
)
ΩΩ+ ,
;
ΩΩ, -
return
øø 

resultData
øø 
;
øø 
}
¿¿ 
catch
¡¡ 	
(
¡¡
 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡ 
{
¬¬ 

resultData
√√ 
.
√√ 

StatusCode
√√ 
=
√√ 
$str
√√  
;
√√  !

resultData
ƒƒ 
.
ƒƒ 
Message
ƒƒ 
=
ƒƒ 
$str
ƒƒ '
+
ƒƒ( )
ex
ƒƒ* ,
.
ƒƒ, -
Message
ƒƒ- 4
+
ƒƒ5 6
$str
ƒƒ7 M
+
ƒƒN O
ex
ƒƒP R
.
ƒƒR S
InnerException
ƒƒS a
+
ƒƒb c
$str
ƒƒd g
;
ƒƒg h
return
≈≈ 

resultData
≈≈ 
;
≈≈ 
}
∆∆ 
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   

resultData
ÃÃ 
.
ÃÃ 

StatusCode
ÃÃ %
=
ÃÃ& '
$str
ÃÃ( +
;
ÃÃ+ ,

resultData
ÕÕ 
.
ÕÕ 
Message
ÕÕ "
=
ÕÕ# $
	GetConfig
ÕÕ% .
.
ÕÕ. /

AppSetting
ÕÕ/ 9
[
ÕÕ9 :
$str
ÕÕ: a
]
ÕÕa b
;
ÕÕb c
return
ŒŒ 

resultData
ŒŒ !
;
ŒŒ! "
}
œœ 
}
—— 	
public
““ 
ResultStatus
““ 
	SendWaOTP
““ %
(
““% &
)
““& '
{
”” 	
var
‘‘ 

resultData
‘‘ 
=
‘‘ 
new
‘‘ 
ResultStatus
‘‘ $
(
‘‘$ %
)
‘‘% &
;
‘‘& '
try
÷÷ 
{
◊◊ 
var
ÿÿ 
userId
ÿÿ 
=
ÿÿ 
HttpContext
ÿÿ (
.
ÿÿ( )
Session
ÿÿ) 0
.
ÿÿ0 1
	GetString
ÿÿ1 :
(
ÿÿ: ;
SessionConstan
ÿÿ; I
.
ÿÿI J
Session_UserId
ÿÿJ X
)
ÿÿX Y
;
ÿÿY Z
var
ŸŸ 
email
ŸŸ 
=
ŸŸ 
HttpContext
ŸŸ '
.
ŸŸ' (
Session
ŸŸ( /
.
ŸŸ/ 0
	GetString
ŸŸ0 9
(
ŸŸ9 :
SessionConstan
ŸŸ: H
.
ŸŸH I
Session_Email
ŸŸI V
)
ŸŸV W
;
ŸŸW X
var
⁄⁄ 
username
⁄⁄ 
=
⁄⁄ 
HttpContext
⁄⁄ 
.
⁄⁄ 
Session
⁄⁄ &
.
⁄⁄& '
	GetString
⁄⁄' 0
(
⁄⁄0 1
SessionConstan
⁄⁄1 ?
.
⁄⁄? @&
Session_Username_Pegawai
⁄⁄@ X
)
⁄⁄X Y
;
⁄⁄Y Z
	TblGetOtp
‹‹ 
dataOtp
‹‹ 
=
‹‹ 
_context
‹‹  
.
‹‹  !

TblGetOtps
‹‹! +
.
‹‹+ ,
Where
‹‹, 1
(
‹‹1 2
m
‹‹2 3
=>
‹‹4 6
m
‹‹7 8
.
‹‹8 9
Username
‹‹9 A
==
‹‹B D
username
‹‹E M
)
‹‹M N
.
‹‹N O
FirstOrDefault
‹‹O ]
(
‹‹] ^
)
‹‹^ _
;
‹‹_ `
TblUserSession
ﬁﬁ 
updatesession
ﬁﬁ ,
=
ﬁﬁ- .
_context
ﬁﬁ/ 7
.
ﬁﬁ7 8
TblUserSessions
ﬁﬁ8 G
.
ﬁﬁG H
Where
ﬁﬁH M
(
ﬁﬁM N
f
ﬁﬁN O
=>
ﬁﬁP R
f
ﬁﬁS T
.
ﬁﬁT U
UserId
ﬁﬁU [
==
ﬁﬁ\ ^
int
ﬁﬁ_ b
.
ﬁﬁb c
Parse
ﬁﬁc h
(
ﬁﬁh i
userId
ﬁﬁi o
)
ﬁﬁo p
)
ﬁﬁp q
.
ﬁﬁq r
FirstOrDefaultﬁﬁr Ä
(ﬁﬁÄ Å
)ﬁﬁÅ Ç
;ﬁﬁÇ É
if
ﬂﬂ 
(
ﬂﬂ 
updatesession
ﬂﬂ !
!=
ﬂﬂ" $
null
ﬂﬂ% )
&&
ﬂﬂ* ,
(
ﬂﬂ- .
DateTime
ﬂﬂ. 6
.
ﬂﬂ6 7
Now
ﬂﬂ7 :
-
ﬂﬂ; <
updatesession
ﬂﬂ= J
.
ﬂﬂJ K

LastActive
ﬂﬂK U
)
ﬂﬂU V
?
ﬂﬂV W
.
ﬂﬂW X
TotalSeconds
ﬂﬂX d
>
ﬂﬂe f
int
ﬂﬂg j
.
ﬂﬂj k
Parse
ﬂﬂk p
(
ﬂﬂp q
	GetConfig
ﬂﬂq z
.
ﬂﬂz {

AppSettingﬂﬂ{ Ö
[ﬂﬂÖ Ü
$strﬂﬂÜ †
]ﬂﬂ† °
)ﬂﬂ° ¢
)ﬂﬂ¢ £
{
‡‡ 
updatesession
·· !
.
··! "
Counter
··" )
=
··* +
$num
··, -
;
··- .
updatesession
‚‚ !
.
‚‚! "

LastActive
‚‚" ,
=
‚‚- .
DateTime
‚‚/ 7
.
‚‚7 8
Now
‚‚8 ;
;
‚‚; <
_context
„„ 
.
„„ 
TblUserSessions
„„ ,
.
„„, -
Update
„„- 3
(
„„3 4
updatesession
„„4 A
)
„„A B
;
„„B C
_context
‰‰ 
.
‰‰ 
SaveChanges
‰‰ (
(
‰‰( )
)
‰‰) *
;
‰‰* +
}
ÂÂ 
if
ÁÁ 
(
ÁÁ 
updatesession
ÁÁ !
.
ÁÁ! "
Counter
ÁÁ" )
>
ÁÁ* +
$num
ÁÁ, -
&&
ÁÁ. 0
(
ÁÁ1 2
DateTime
ÁÁ2 :
.
ÁÁ: ;
Now
ÁÁ; >
-
ÁÁ? @
updatesession
ÁÁA N
.
ÁÁN O

LastActive
ÁÁO Y
)
ÁÁY Z
?
ÁÁZ [
.
ÁÁ[ \
TotalSeconds
ÁÁ\ h
<
ÁÁi j
int
ÁÁk n
.
ÁÁn o
Parse
ÁÁo t
(
ÁÁt u
	GetConfig
ÁÁu ~
.
ÁÁ~ 

AppSettingÁÁ â
[ÁÁâ ä
$strÁÁä §
]ÁÁ§ •
)ÁÁ• ¶
)ÁÁ¶ ß
{
ËË 

resultData
ÈÈ 
.
ÈÈ 

StatusCode
ÈÈ )
=
ÈÈ* +
$str
ÈÈ, /
;
ÈÈ/ 0

resultData
ÍÍ 
.
ÍÍ 
Message
ÍÍ &
=
ÍÍ' (
$str
ÍÍ) O
;
ÍÍO P
return
ÎÎ 

resultData
ÎÎ %
;
ÎÎ% &
}
ÏÏ 
using
ÓÓ 
(
ÓÓ 
TransactionScope
ÓÓ '
trx
ÓÓ( +
=
ÓÓ, -
new
ÓÓ. 1
TransactionScope
ÓÓ2 B
(
ÓÓB C
)
ÓÓC D
)
ÓÓD E
{
ÔÔ 
if
 
(
 	
dataOtp
	 
==
 
null
 
)
 
{
ÒÒ 
	TblGetOtp
ÚÚ 
model
ÚÚ 
=
ÚÚ 
new
ÚÚ 
	TblGetOtp
ÚÚ %
(
ÚÚ% &
)
ÚÚ& '
;
ÚÚ' (
model
ÛÛ 
.
ÛÛ 
Username
ÛÛ 
=
ÛÛ 
username
ÛÛ 
;
ÛÛ  
model
ÙÙ 
.
ÙÙ 
KodeOtp
ÙÙ 
=
ÙÙ "
GenerateRandomString
ÙÙ *
(
ÙÙ* +
$num
ÙÙ+ ,
)
ÙÙ, -
;
ÙÙ- .
model
ıı 
.
ıı 
ExpiredTime
ıı 
=
ıı 
DateTime
ıı "
.
ıı" #
Now
ıı# &
.
ıı& '

AddMinutes
ıı' 1
(
ıı1 2
$num
ıı2 3
)
ıı3 4
;
ıı4 5
_context
ˆˆ 
.
ˆˆ 

TblGetOtps
ˆˆ 
.
ˆˆ 
Add
ˆˆ 
(
ˆˆ 
dataOtp
ˆˆ %
)
ˆˆ% &
;
ˆˆ& '
_context
˜˜ 
.
˜˜ 
SaveChanges
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
}
˘˘ 
else
˙˙ 	
{
˚˚ 
dataOtp
¸¸ 
.
¸¸ 
Username
¸¸ 
=
¸¸ 
username
¸¸ !
;
¸¸! "
dataOtp
˝˝ 
.
˝˝ 
KodeOtp
˝˝ 
=
˝˝ "
GenerateRandomString
˝˝ ,
(
˝˝, -
$num
˝˝- .
)
˝˝. /
;
˝˝/ 0
dataOtp
˛˛ 
.
˛˛ 
ExpiredTime
˛˛ 
=
˛˛ 
DateTime
˛˛ $
.
˛˛$ %
Now
˛˛% (
.
˛˛( )

AddMinutes
˛˛) 3
(
˛˛3 4
$num
˛˛4 5
)
˛˛5 6
;
˛˛6 7
_context
ˇˇ 
.
ˇˇ 
Entry
ˇˇ 
(
ˇˇ 
dataOtp
ˇˇ 
)
ˇˇ 
.
ˇˇ 
State
ˇˇ #
=
ˇˇ$ %
EntityState
ˇˇ& 1
.
ˇˇ1 2
Modified
ˇˇ2 :
;
ˇˇ: ;
_context
ÄÄ 
.
ÄÄ 
SaveChanges
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
trx
ÉÉ 
.
ÉÉ 	
Complete
ÉÉ	 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 
try
ÜÜ 
{
áá 
var
àà 
NoTelp
àà	 
=
àà 
_context
àà 
.
àà 
TblMasterUsers
àà )
.
àà) *
Where
àà* /
(
àà/ 0
m
àà0 1
=>
àà2 4
m
àà5 6
.
àà6 7
Username
àà7 ?
==
àà@ B
username
ààC K
)
ààK L
.
ààL M
Select
ààM S
(
ààS T
m
ààT U
=>
ààV X
m
ààY Z
.
ààZ [
NoTelp
àà[ a
)
ààa b
.
ààb c
FirstOrDefault
ààc q
(
ààq r
)
ààr s
;
ààs t
char
ãã 	

firstDigit
ãã
 
=
ãã 
NoTelp
ãã 
[
ãã 
$num
ãã 
]
ãã  
;
ãã  !
string
åå 

FinalValue
åå 
;
åå 
switch
éé 
(
éé 

firstDigit
éé 
)
éé 
{
èè 
case
êê 

$char
êê 
:
êê 

FinalValue
íí 
=
íí 
$str
íí 
+
íí 
NoTelp
íí !
.
íí! "
	Substring
íí" +
(
íí+ ,
$num
íí, -
)
íí- .
;
íí. /
break
ìì 
;
ìì 
case
îî 

$char
îî 
:
îî 

FinalValue
ññ 
=
ññ 
$str
ññ 
+
ññ 
NoTelp
ññ !
;
ññ! "
break
óó 
;
óó 
default
òò 
:
òò 

FinalValue
öö 
=
öö 
NoTelp
öö 
;
öö 
break
õõ 
;
õõ 
}
úú 
var
üü 
url
üü	 
=
üü 
	GetConfig
üü 
.
üü 

AppSetting
üü #
[
üü# $
$str
üü$ 3
]
üü3 4
+
üü5 6
	GetConfig
üü7 @
.
üü@ A

AppSetting
üüA K
[
üüK L
$str
üüL X
]
üüX Y
+
üüZ [
	GetConfig
üü\ e
.
üüe f

AppSetting
üüf p
[
üüp q
$str
üüq 
]üü Ä
+üüÅ Ç

FinalValueüüÉ ç
;üüç é
(
†† 
bool
†† 

	resultApi
†† 
,
†† 
string
†† 
resultApiData
†† *
)
††* +
=
††, -
RequestToAPI
††. :
.
††: ;
PostJsonOTP
††; F
(
††F G
url
††G J
,
††J K
new
††L O
{
††P Q
body
††R V
=
††W X
dataOtp
††Y `
.
††` a
KodeOtp
††a h
+
††i j
$str††k ™
}††´ ¨
)††¨ ≠
;††≠ Æ
if
°° 
(
°° 	
	resultApi
°°	 
&&
°° 
!
°° 
string
°° 
.
°° 
IsNullOrEmpty
°° +
(
°°+ ,
resultApiData
°°, 9
)
°°9 :
)
°°: ;
{
¢¢ 

resultData
££ 
.
££ 

StatusCode
££ 
=
££ 
$str
££ !
;
££! "

resultData
§§ 
.
§§ 
Message
§§ 
=
§§ 
CensorNumber
§§ '
(
§§' (
NoTelp
§§( .
)
§§. /
;
§§/ 0
}
•• 
TblUserSession
ßß "
ds
ßß# %
=
ßß& '
_context
ßß( 0
.
ßß0 1
TblUserSessions
ßß1 @
.
ßß@ A
Where
ßßA F
(
ßßF G
f
ßßG H
=>
ßßI K
f
ßßL M
.
ßßM N
UserId
ßßN T
==
ßßU W
int
ßßX [
.
ßß[ \
Parse
ßß\ a
(
ßßa b
userId
ßßb h
)
ßßh i
)
ßßi j
.
ßßj k
FirstOrDefault
ßßk y
(
ßßy z
)
ßßz {
;
ßß{ |
if
®® 
(
®® 
ds
®® 
!=
®® 
null
®® "
)
®®" #
{
©© 
ds
™™ 
.
™™ 
	SessionId
™™ $
=
™™% &
HttpContext
™™' 2
.
™™2 3
Session
™™3 :
.
™™: ;
Id
™™; =
;
™™= >
ds
´´ 
.
´´ 

LastActive
´´ %
=
´´& '
DateTime
´´( 0
.
´´0 1
Now
´´1 4
;
´´4 5
ds
¨¨ 
.
¨¨ 
Counter
¨¨ "
=
¨¨# $
ds
¨¨% '
.
¨¨' (
Counter
¨¨( /
+
¨¨0 1
$num
¨¨2 3
;
¨¨3 4
_context
≠≠  
.
≠≠  !
TblUserSessions
≠≠! 0
.
≠≠0 1
Update
≠≠1 7
(
≠≠7 8
ds
≠≠8 :
)
≠≠: ;
;
≠≠; <
_context
ÆÆ  
.
ÆÆ  !
SaveChanges
ÆÆ! ,
(
ÆÆ, -
)
ÆÆ- .
;
ÆÆ. /
}
ØØ 
else
∞∞ 
{
±± 
var
≤≤ 
UserSession
≤≤ '
=
≤≤( )
new
≤≤* -
TblUserSession
≤≤. <
(
≤≤< =
)
≤≤= >
;
≤≤> ?
UserSession
≥≥ #
.
≥≥# $
UserId
≥≥$ *
=
≥≥+ ,
int
≥≥- 0
.
≥≥0 1
Parse
≥≥1 6
(
≥≥6 7
userId
≥≥7 =
)
≥≥= >
;
≥≥> ?
UserSession
¥¥ #
.
¥¥# $

LastActive
¥¥$ .
=
¥¥/ 0
DateTime
¥¥1 9
.
¥¥9 :
Now
¥¥: =
;
¥¥= >
UserSession
µµ #
.
µµ# $
Counter
µµ$ +
=
µµ, -
$num
µµ. /
;
µµ/ 0
_context
∂∂  
.
∂∂  !
TblUserSessions
∂∂! 0
.
∂∂0 1
Add
∂∂1 4
(
∂∂4 5
UserSession
∂∂5 @
)
∂∂@ A
;
∂∂A B
_context
∑∑  
.
∑∑  !
SaveChanges
∑∑! ,
(
∑∑, -
)
∑∑- .
;
∑∑. /
}
∏∏ 
return
ªª 

resultData
ªª %
;
ªª% &
}
ºº 
catch
ΩΩ 	
(
ΩΩ
 
	Exception
ΩΩ 
ex
ΩΩ 
)
ΩΩ 
{
ææ 

resultData
øø 
.
øø 

StatusCode
øø 
=
øø 
$str
øø  
;
øø  !

resultData
¿¿ 
.
¿¿ 
Message
¿¿ 
=
¿¿ 
$str
¿¿ '
+
¿¿( )
ex
¿¿* ,
.
¿¿, -
Message
¿¿- 4
+
¿¿5 6
$str
¿¿7 M
+
¿¿N O
ex
¿¿P R
.
¿¿R S
InnerException
¿¿S a
+
¿¿b c
$str
¿¿d g
;
¿¿g h
return
¡¡ 

resultData
¡¡ 
;
¡¡ 
}
¬¬ 
}
ƒƒ 
catch
≈≈ 
(
≈≈	 

	Exception
≈≈
 
ex
≈≈ 
)
≈≈ 
{
∆∆ 

resultData
»» 
.
»» 

StatusCode
»» 
=
»» 
$str
»» 
;
»»  

resultData
…… 
.
…… 
Message
…… 
=
…… 
	GetConfig
…… "
.
……" #

AppSetting
……# -
[
……- .
$str
……. U
]
……U V
;
……V W
return
   


resultData
   
;
   
}
ÀÀ 
}
ÕÕ 	
static
ŒŒ 
string
ŒŒ 
CensorEmail
ŒŒ !
(
ŒŒ! "
string
ŒŒ" (
email
ŒŒ) .
)
ŒŒ. /
{
œœ 	
string
—— 
[
—— 
]
—— 
parts
—— 
=
—— 
email
—— "
.
——" #
Split
——# (
(
——( )
$char
——) ,
)
——, -
;
——- .
string
‘‘ 
censoredUsername
‘‘ #
=
‘‘$ %
parts
‘‘& +
[
‘‘+ ,
$num
‘‘, -
]
‘‘- .
[
‘‘. /
$num
‘‘/ 0
]
‘‘0 1
+
‘‘2 3
new
‘‘4 7
string
‘‘8 >
(
‘‘> ?
$char
‘‘? B
,
‘‘B C
parts
‘‘D I
[
‘‘I J
$num
‘‘J K
]
‘‘K L
.
‘‘L M
Length
‘‘M S
)
‘‘S T
;
‘‘T U
string
◊◊ 
censoredDomain
◊◊ !
=
◊◊" #
parts
◊◊$ )
[
◊◊) *
$num
◊◊* +
]
◊◊+ ,
[
◊◊, -
$num
◊◊- .
]
◊◊. /
+
◊◊0 1
new
◊◊2 5
string
◊◊6 <
(
◊◊< =
$char
◊◊= @
,
◊◊@ A
parts
◊◊B G
[
◊◊G H
$num
◊◊H I
]
◊◊I J
.
◊◊J K
Length
◊◊K Q
)
◊◊Q R
;
◊◊R S
return
⁄⁄ 
$"
⁄⁄ 
{
⁄⁄ 
censoredUsername
⁄⁄ &
}
⁄⁄& '
$str
⁄⁄' (
{
⁄⁄( )
censoredDomain
⁄⁄) 7
}
⁄⁄7 8
"
⁄⁄8 9
;
⁄⁄9 :
}
€€ 	
static
‹‹ 
string
‹‹ 
CensorNumber
‹‹ "
(
‹‹" #
string
‹‹# )
number
‹‹* 0
)
‹‹0 1
{
›› 	
int
ﬂﬂ 
length
ﬂﬂ 
=
ﬂﬂ 
number
ﬂﬂ 
.
ﬂﬂ  
Length
ﬂﬂ  &
;
ﬂﬂ& '
string
‚‚ 
censoredPart
‚‚ 
=
‚‚  !
new
‚‚" %
string
‚‚& ,
(
‚‚, -
$char
‚‚- 0
,
‚‚0 1
length
‚‚2 8
-
‚‚9 :
$num
‚‚; <
)
‚‚< =
+
‚‚> ?
$str
‚‚@ C
+
‚‚D E
new
‚‚F I
string
‚‚J P
(
‚‚P Q
$char
‚‚Q T
,
‚‚T U
$num
‚‚V W
)
‚‚W X
+
‚‚Y Z
$str
‚‚[ ^
+
‚‚_ `
number
‚‚a g
.
‚‚g h
	Substring
‚‚h q
(
‚‚q r
length
‚‚r x
-
‚‚y z
$num
‚‚{ |
)
‚‚| }
;
‚‚} ~
return
‰‰ 
censoredPart
‰‰ 
;
‰‰  
}
ÂÂ 	
public
ÊÊ 
ResultStatus
ÊÊ	 
ValidateOtp
ÊÊ !
(
ÊÊ! "
string
ÊÊ" (
otp
ÊÊ) ,
,
ÊÊ, -
int
ÊÊ. 1
type
ÊÊ2 6
)
ÊÊ6 7
{
ÁÁ 
var
ËË 

resultData
ËË 
=
ËË 
new
ËË 
ResultStatus
ËË $
(
ËË$ %
)
ËË% &
;
ËË& '
var
ÍÍ 
Username
ÍÍ 
=
ÍÍ 
HttpContext
ÍÍ 
.
ÍÍ 
Session
ÍÍ %
.
ÍÍ% &
	GetString
ÍÍ& /
(
ÍÍ/ 0
SessionConstan
ÍÍ0 >
.
ÍÍ> ?&
Session_Username_Pegawai
ÍÍ? W
)
ÍÍW X
;
ÍÍX Y
var
ÎÎ 
NoHP
ÎÎ 
=
ÎÎ 
HttpContext
ÎÎ 
.
ÎÎ 
Session
ÎÎ !
.
ÎÎ! "
	GetString
ÎÎ" +
(
ÎÎ+ ,
SessionConstan
ÎÎ, :
.
ÎÎ: ;
Session_NoHP
ÎÎ; G
)
ÎÎG H
;
ÎÎH I
var
ÏÏ 
Email
ÏÏ 
=
ÏÏ 
HttpContext
ÏÏ 
.
ÏÏ 
Session
ÏÏ "
.
ÏÏ" #
	GetString
ÏÏ# ,
(
ÏÏ, -
SessionConstan
ÏÏ- ;
.
ÏÏ; <
Session_Email
ÏÏ< I
)
ÏÏI J
;
ÏÏJ K
var
ÌÌ 
RoleId
ÌÌ 
=
ÌÌ 
HttpContext
ÌÌ 
.
ÌÌ 
Session
ÌÌ #
.
ÌÌ# $
	GetString
ÌÌ$ -
(
ÌÌ- .
SessionConstan
ÌÌ. <
.
ÌÌ< =
Session_RoleKode
ÌÌ= M
)
ÌÌM N
;
ÌÌN O
try
ÔÔ 
{
 
	TblGetOtp
ÒÒ 
dataOtp
ÒÒ 
=
ÒÒ 
_context
ÒÒ  
.
ÒÒ  !

TblGetOtps
ÒÒ! +
.
ÒÒ+ ,
Where
ÒÒ, 1
(
ÒÒ1 2
m
ÒÒ2 3
=>
ÒÒ4 6
m
ÒÒ7 8
.
ÒÒ8 9
Username
ÒÒ9 A
==
ÒÒB D
Username
ÒÒE M
)
ÒÒM N
.
ÒÒN O
FirstOrDefault
ÒÒO ]
(
ÒÒ] ^
)
ÒÒ^ _
;
ÒÒ_ `
if
ÛÛ 
(
ÛÛ 
dataOtp
ÛÛ 
.
ÛÛ 
ExpiredTime
ÛÛ '
<=
ÛÛ( *
DateTime
ÛÛ+ 3
.
ÛÛ3 4
Now
ÛÛ4 7
)
ÛÛ7 8
{
ÙÙ 

resultData
ıı 
.
ıı 

StatusCode
ıı )
=
ıı* +
$str
ıı, /
;
ıı/ 0

resultData
ˆˆ 
.
ˆˆ 
Message
ˆˆ &
=
ˆˆ' (
$str
ˆˆ) <
;
ˆˆ< =

resultData
˜˜ 
.
˜˜ 
ValueGeneratorOtp
˜˜ 0
=
˜˜1 2
type
˜˜3 7
==
˜˜8 :
$num
˜˜; <
?
˜˜= >
CensorEmail
˜˜? J
(
˜˜J K
Email
˜˜K P
)
˜˜P Q
:
˜˜R S
CensorNumber
˜˜T `
(
˜˜` a
NoHP
˜˜a e
)
˜˜e f
;
˜˜f g
return
¯¯ 

resultData
¯¯ %
;
¯¯% &
}
˘˘ 
else
˙˙ 
if
˙˙ 
(
˙˙ 
dataOtp
˙˙  
.
˙˙  !
KodeOtp
˙˙! (
==
˙˙) +
otp
˙˙, /
)
˙˙/ 0
{
˚˚ 
List
¸¸ 
<
¸¸ #
Navigation_ViewModels
¸¸ .
>
¸¸. /
ListNav
¸¸0 7
=
¸¸8 9%
StoredProcedureExecutor
¸¸: Q
.
¸¸Q R
ExecuteSPList
¸¸R _
<
¸¸_ `#
Navigation_ViewModels
¸¸` u
>
¸¸u v
(
¸¸v w
_context
¸¸w 
,¸¸ Ä
$str¸¸Å ç
,¸¸ç é
new¸¸è í
SqlParameter¸¸ì ü
[¸¸ü †
]¸¸† °
{¸¸° ¢
new
˝˝ 
SqlParameter
˝˝ (
(
˝˝( )
$str
˝˝) 3
,
˝˝3 4
RoleId
˝˝5 ;
)
˝˝; <
}
˛˛ 
)
˛˛ 
;
˛˛ 
HttpContext
ˇˇ 
.
ˇˇ  
Session
ˇˇ  '
.
ˇˇ' (
	SetObject
ˇˇ( 1
(
ˇˇ1 2
$str
ˇˇ2 ;
,
ˇˇ; <
ListNav
ˇˇ= D
)
ˇˇD E
;
ˇˇE F

resultData
ÅÅ 
.
ÅÅ 

StatusCode
ÅÅ )
=
ÅÅ* +
$str
ÅÅ, /
;
ÅÅ/ 0

resultData
ÇÇ 
.
ÇÇ 
Message
ÇÇ &
=
ÇÇ' (
$str
ÇÇ) 3
;
ÇÇ3 4

resultData
ÉÉ 
.
ÉÉ 
ValueGeneratorOtp
ÉÉ 0
=
ÉÉ1 2
type
ÉÉ3 7
==
ÉÉ8 :
$num
ÉÉ; <
?
ÉÉ= >
CensorEmail
ÉÉ? J
(
ÉÉJ K
Email
ÉÉK P
)
ÉÉP Q
:
ÉÉR S
CensorNumber
ÉÉT `
(
ÉÉ` a
NoHP
ÉÉa e
)
ÉÉe f
;
ÉÉf g
return
ÑÑ 

resultData
ÑÑ %
;
ÑÑ% &
}
ÖÖ 
else
ÜÜ 
{
ÜÜ 

resultData
áá 
.
áá 

StatusCode
áá 
=
áá 
$str
áá  
;
áá  !

resultData
àà 
.
àà 
Message
àà 
=
àà 
$str
àà 4
;
àà4 5

resultData
ââ 
.
ââ 
ValueGeneratorOtp
ââ !
=
ââ" #
type
ââ$ (
==
ââ) +
$num
ââ, -
?
ââ. /
CensorEmail
ââ0 ;
(
ââ; <
Email
ââ< A
)
ââA B
:
ââC D
CensorNumber
ââE Q
(
ââQ R
NoHP
ââR V
)
ââV W
;
ââW X
return
ää 

resultData
ää 
;
ää 
}
ãã 
}
åå 
catch
çç 
(
çç	 

	Exception
çç
 
ex
çç 
)
çç 
{
éé 

resultData
èè 
.
èè 

StatusCode
èè 
=
èè 
$str
èè 
;
èè  

resultData
êê 
.
êê 
Message
êê 
=
êê 
	GetConfig
êê "
.
êê" #

AppSetting
êê# -
[
êê- .
$str
êê. U
]
êêU V
;
êêV W

resultData
ëë 
.
ëë 
ValueGeneratorOtp
ëë  
=
ëë! "
type
ëë# '
==
ëë( *
$num
ëë+ ,
?
ëë- .
CensorEmail
ëë/ :
(
ëë: ;
Email
ëë; @
)
ëë@ A
:
ëëB C
CensorNumber
ëëD P
(
ëëP Q
NoHP
ëëQ U
)
ëëU V
;
ëëV W
return
íí 


resultData
íí 
;
íí 
}
ìì 
}
îî 
public
óó 
bool
óó	 

CekSession
óó 
(
óó 
)
óó 
{
òò 	
bool
ôô 
ret
ôô 
=
ôô 
false
ôô 
;
ôô 
if
öö 
(
öö 
	_accessor
öö 
.
öö 
HttpContext
öö %
.
öö% &
Session
öö& -
.
öö- .
	GetString
öö. 7
(
öö7 8
SessionConstan
öö8 F
.
ööF G
Session_UserId
ööG U
)
ööU V
!=
ööW Y
null
ööZ ^
)
öö^ _
{
õõ 
ret
úú 
=
úú 
true
úú 
;
úú 
}
ùù 
else
ûû 
{
üü 
ret
†† 
=
†† 
false
†† 
;
†† 
}
°° 
return
¢¢ 
ret
¢¢ 
;
¢¢ 
}
££ 	
public
ßß 
ActionResult
ßß 
Logout
ßß "
(
ßß" #
)
ßß# $
{
®® 	
isLogout
©© 
=
©© 
true
©© 
;
©© 
if
™™ 
(
™™ 
HttpContext
™™ 
.
™™ 
Session
™™ #
.
™™# $
	GetString
™™$ -
(
™™- .
SessionConstan
™™. <
.
™™< =
Session_UserId
™™= K
)
™™K L
!=
™™M O
null
™™P T
)
™™T U
{
´´ 
TblUserSession
¨¨ 
ds
¨¨ !
=
¨¨" #
_context
¨¨$ ,
.
¨¨, -
TblUserSessions
¨¨- <
.
¨¨< =
Where
¨¨= B
(
¨¨B C
f
¨¨C D
=>
¨¨E G
f
¨¨H I
.
¨¨I J
UserId
¨¨J P
==
¨¨Q S
int
¨¨T W
.
¨¨W X
Parse
¨¨X ]
(
¨¨] ^
HttpContext
¨¨^ i
.
¨¨i j
Session
¨¨j q
.
¨¨q r
	GetString
¨¨r {
(
¨¨{ |
SessionConstan¨¨| ä
.¨¨ä ã
Session_UserId¨¨ã ô
)¨¨ô ö
)¨¨ö õ
)¨¨õ ú
.¨¨ú ù
FirstOrDefault¨¨ù ´
(¨¨´ ¨
)¨¨¨ ≠
;¨¨≠ Æ
ds
≠≠ 
.
≠≠ 
IsLogout
≠≠ 
=
≠≠ 
true
≠≠ "
;
≠≠" #
_context
ÆÆ 
.
ÆÆ 
TblUserSessions
ÆÆ (
.
ÆÆ( )
Update
ÆÆ) /
(
ÆÆ/ 0
ds
ÆÆ0 2
)
ÆÆ2 3
;
ÆÆ3 4
_context
ØØ 
.
ØØ 
SaveChanges
ØØ $
(
ØØ$ %
)
ØØ% &
;
ØØ& '
}
∞∞ 
HttpContext
±± 
.
±± 
Session
±± 
.
±±  
Clear
±±  %
(
±±% &
)
±±& '
;
±±' (
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
cookie
≤≤ 
in
≤≤  "
Request
≤≤# *
.
≤≤* +
Cookies
≤≤+ 2
.
≤≤2 3
Keys
≤≤3 7
)
≤≤7 8
{
≥≥ 
Response
¥¥ 
.
¥¥ 
Cookies
¥¥  
.
¥¥  !
Delete
¥¥! '
(
¥¥' (
cookie
¥¥( .
)
¥¥. /
;
¥¥/ 0
}
µµ 
return
∂∂ 
RedirectToAction
∂∂ #
(
∂∂# $
	GetConfig
∂∂$ -
.
∂∂- .

AppSetting
∂∂. 8
[
∂∂8 9
$str
∂∂9 K
]
∂∂K L
+
∂∂M N
	GetConfig
∂∂O X
.
∂∂X Y

AppSetting
∂∂Y c
[
∂∂c d
$str
∂∂d z
]
∂∂z {
)
∂∂{ |
;
∂∂| }
}
∑∑ 	
public
∏∏ 
ActionResult
∏∏	 
LogoutFromAny
∏∏ #
(
∏∏# $
string
∏∏$ *
username
∏∏+ 3
,
∏∏3 4
string
∏∏5 ;
password
∏∏< D
)
∏∏D E
{
ππ 
if
∫∫ 
(
∫∫ 
username
∫∫ 
!=
∫∫ 
null
∫∫ 
&&
∫∫ 
password
∫∫ #
!=
∫∫$ &
null
∫∫' +
)
∫∫+ ,
{
ªª 
var
ºº 
ismatch
ºº 
=
ºº 
false
ºº 
;
ºº 
var
ææ 
data
ææ 
=
ææ %
StoredProcedureExecutor
ææ &
.
ææ& '
ExecuteSPSingle
ææ' 6
<
ææ6 7$
DetailLogin_ViewModels
ææ7 M
>
ææM N
(
ææN O
_context
ææO W
,
ææW X
$str
ææY k
,
ææk l
new
ææm p
SqlParameter
ææq }
[
ææ} ~
]
ææ~ 
{ææ Ä
new
øø 	
SqlParameter
øø
 
(
øø 
$str
øø "
,
øø" #
username
øø$ ,
)
øø, -
}
øø- .
)
øø. /
;
øø/ 0
if
¿¿ 
(
¿¿ 
data
¿¿ 
==
¿¿ 
null
¿¿ 
)
¿¿ 
{
¡¡ 
return
¬¬ 
RedirectToAction
¬¬ 
(
¬¬ 
$str
¬¬ $
,
¬¬$ %
$str
¬¬& -
,
¬¬- .
new
¬¬/ 2
{
¬¬3 4
a
¬¬5 6
=
¬¬7 8
true
¬¬9 =
,
¬¬= >
	textError
¬¬? H
=
¬¬I J
$str
¬¬K a
}
¬¬b c
)
¬¬c d
;
¬¬d e
}
ƒƒ 
if
≈≈ 
(
≈≈ 
password
≈≈ 
!=
≈≈ 
null
≈≈ 
)
≈≈ 
{
∆∆ 
ismatch
«« 
=
«« 
BCrypt
«« $
.
««$ %
Net
««% (
.
««( )
BCrypt
««) /
.
««/ 0
Verify
««0 6
(
««6 7
password
««7 ?
,
««? @
data
««A E
.
««E F
Password
««F N
)
««N O
;
««O P
}
»» 
if
…… 
(
…… 
password
…… 
==
…… 
	GetConfig
…… 
.
…… 

AppSetting
…… (
[
……( )
$str
……) S
]
……S T
)
……T U
{
   
TblUserSession
ÀÀ 
ds
ÀÀ 
=
ÀÀ 
_context
ÀÀ !
.
ÀÀ! "
TblUserSessions
ÀÀ" 1
.
ÀÀ1 2
Where
ÀÀ2 7
(
ÀÀ7 8
f
ÀÀ8 9
=>
ÀÀ: <
f
ÀÀ= >
.
ÀÀ> ?
UserId
ÀÀ? E
==
ÀÀF H
data
ÀÀI M
.
ÀÀM N
UserId
ÀÀN T
)
ÀÀT U
.
ÀÀU V
FirstOrDefault
ÀÀV d
(
ÀÀd e
)
ÀÀe f
;
ÀÀf g
ds
ÃÃ 
.
ÃÃ 
IsLogout
ÃÃ 
=
ÃÃ 
true
ÃÃ 
;
ÃÃ 
_context
ÕÕ 
.
ÕÕ 
TblUserSessions
ÕÕ 
.
ÕÕ 
Update
ÕÕ $
(
ÕÕ$ %
ds
ÕÕ% '
)
ÕÕ' (
;
ÕÕ( )
_context
ŒŒ 
.
ŒŒ 
SaveChanges
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
return
–– 
Content
–– "
(
––" #
$str
––# %
)
––% &
;
––& '
}
—— 
if
““ 
(
““ 
ismatch
““ 
)
““ 
{
”” 
TblUserSession
‘‘ 
ds
‘‘ 
=
‘‘ 
_context
‘‘ !
.
‘‘! "
TblUserSessions
‘‘" 1
.
‘‘1 2
Where
‘‘2 7
(
‘‘7 8
f
‘‘8 9
=>
‘‘: <
f
‘‘= >
.
‘‘> ?
UserId
‘‘? E
==
‘‘F H
data
‘‘I M
.
‘‘M N
UserId
‘‘N T
)
‘‘T U
.
‘‘U V
FirstOrDefault
‘‘V d
(
‘‘d e
)
‘‘e f
;
‘‘f g
ds
’’ 
.
’’ 
IsLogout
’’ 
=
’’ 
true
’’ 
;
’’ 
_context
÷÷ 
.
÷÷ 
TblUserSessions
÷÷ 
.
÷÷ 
Update
÷÷ $
(
÷÷$ %
ds
÷÷% '
)
÷÷' (
;
÷÷( )
_context
◊◊ 
.
◊◊ 
SaveChanges
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊ 
return
ŸŸ 
Content
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# %
)
ŸŸ% &
;
ŸŸ& '
}
⁄⁄ 
else
€€ 
{
‹‹ 
return
›› 
Content
›› "
(
››" #
$str
››# A
)
››A B
;
››B C
}
ﬁﬁ 
}
ﬂﬂ 
else
‡‡ 
{
·· 
return
‚‚ 

Content
‚‚ 
(
‚‚ 
	GetConfig
‚‚ 
.
‚‚ 

AppSetting
‚‚ '
[
‚‚' (
$str
‚‚( O
]
‚‚O P
)
‚‚P Q
;
‚‚Q R
}
„„ 
}
‰‰ 
public
ÈÈ 
ResultStatus
ÈÈ	 %
SendEmailForgetPassword
ÈÈ -
(
ÈÈ- .
string
ÈÈ. 4
email
ÈÈ5 :
)
ÈÈ: ;
{
ÍÍ 
var
ÎÎ 

resultData
ÎÎ 
=
ÎÎ 
new
ÎÎ 
ResultStatus
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
try
ÌÌ 
{
ÓÓ 
var
ÔÔ 
Username
ÔÔ 
=
ÔÔ 
_context
ÔÔ '
.
ÔÔ' (
TblMasterUsers
ÔÔ( 6
.
ÔÔ6 7
Where
ÔÔ7 <
(
ÔÔ< =
m
ÔÔ= >
=>
ÔÔ? A
m
ÔÔB C
.
ÔÔC D
Email
ÔÔD I
==
ÔÔJ L
email
ÔÔM R
)
ÔÔR S
.
ÔÔS T
Select
ÔÔT Z
(
ÔÔZ [
m
ÔÔ[ \
=>
ÔÔ\ ^
m
ÔÔ^ _
.
ÔÔ_ `
Username
ÔÔ` h
)
ÔÔh i
.
ÔÔi j
FirstOrDefault
ÔÔj x
(
ÔÔx y
)
ÔÔy z
;
ÔÔz {
var
 
	linkToken
 
=
 
new
  #
TokenVM
$ +
(
+ ,
)
, -
;
- .
	linkToken
ÒÒ 
.
ÒÒ 
Username
ÒÒ 
=
ÒÒ 
Username
ÒÒ !
;
ÒÒ! "
	linkToken
ÚÚ 
.
ÚÚ 
DateTime
ÚÚ 
=
ÚÚ 
DateTime
ÚÚ !
.
ÚÚ! "
Now
ÚÚ" %
.
ÚÚ% &

AddMinutes
ÚÚ& 0
(
ÚÚ0 1
$num
ÚÚ1 2
)
ÚÚ2 3
;
ÚÚ3 4
var
ÛÛ 
	tokenJSON
ÛÛ 
=
ÛÛ 
JsonConvert
ÛÛ 
.
ÛÛ  
SerializeObject
ÛÛ  /
(
ÛÛ/ 0
	linkToken
ÛÛ0 9
)
ÛÛ9 :
;
ÛÛ: ;
var
ÙÙ 
encryptedToken
ÙÙ 
=
ÙÙ 

EncryptAES
ÙÙ #
.
ÙÙ# $
Encrypt
ÙÙ$ +
(
ÙÙ+ ,
	tokenJSON
ÙÙ, 5
)
ÙÙ5 6
;
ÙÙ6 7
var
ıı 
encodedToken
ıı 
=
ıı 
HttpUtility
ıı "
.
ıı" #
	UrlEncode
ıı# ,
(
ıı, -
encryptedToken
ıı- ;
)
ıı; <
;
ıı< =
var
ˆˆ 
port
ˆˆ 
=
ˆˆ 
	GetConfig
ˆˆ 
.
ˆˆ 

AppSetting
ˆˆ #
[
ˆˆ# $
$str
ˆˆ$ 4
]
ˆˆ4 5
;
ˆˆ5 6
var
¯¯ 
configuration
¯¯ !
=
¯¯" #
new
¯¯$ '"
ConfigurationBuilder
¯¯( <
(
¯¯< =
)
¯¯= >
.
¯¯> ?%
AddEnvironmentVariables
¯¯? V
(
¯¯V W
)
¯¯W X
.
¯¯X Y
Build
¯¯Y ^
(
¯¯^ _
)
¯¯_ `
;
¯¯` a
string
˘˘ 
urldns
˘˘ 
=
˘˘ 
configuration
˘˘  -
[
˘˘- .
$str
˘˘. 3
]
˘˘3 4
;
˘˘4 5
var
˚˚ 
resetPasswordUrl
˚˚ $
=
˚˚% &
$str
˚˚' c
+
˚˚d e
encodedToken
˚˚f r
;
˚˚s t
var
ÄÄ 
body
ÄÄ 
=
ÄÄ 
$str
ÄÄ "
+
ÄÄ# $
Username
ÄÄ% -
+
ÄÄ. /
$str
ÅÅ x
+
ÅÅy z
$str
ÇÇ 
+
ÇÇ 
resetPasswordUrl
ÇÇ '
+
ÇÇ( )
$str
ÇÇ* B
+
ÇÇC D
$str
ÉÉ q
+
ÉÉr s
$str
ÑÑ 
+
ÑÑ  
$str
ÖÖ '
+
ÖÖ( )
$str
ÜÜ 7
;
ÜÜ7 8
using
áá 	
(
áá
 
var
áá 
client
áá 
=
áá 
new
áá 

SmtpClient
áá &
(
áá& '
	GetConfig
áá' 0
.
áá0 1

AppSetting
áá1 ;
[
áá; <
$str
áá< N
]
ááN O
,
ááO P
int
ááQ T
.
ááT U
Parse
ááU Z
(
ááZ [
	GetConfig
áá[ d
.
áád e

AppSetting
ááe o
[
ááo p
$strááp Ä
]ááÄ Å
)ááÅ Ç
)ááÇ É
)ááÉ Ñ
{
àà 
if
ââ 
(
ââ 
	GetConfig
ââ !
.
ââ! "

AppSetting
ââ" ,
[
ââ, -
$str
ââ- C
]
ââC D
==
ââE G
$str
ââH K
)
ââK L
{
ää 
client
ãã 
.
ãã 
	EnableSsl
ãã (
=
ãã) *
false
ãã+ 0
;
ãã0 1
client
åå 
.
åå #
UseDefaultCredentials
åå 4
=
åå5 6
false
åå7 <
;
åå< =
client
çç 
.
çç 
Credentials
çç *
=
çç+ ,
new
çç- 0
NetworkCredential
çç1 B
(
ççB C
	GetConfig
ççC L
.
ççL M

AppSetting
ççM W
[
ççW X
$str
ççX i
]
ççi j
,
ççj k
	GetConfig
ççl u
.
ççu v

AppSettingççv Ä
[ççÄ Å
$strççÅ ï
]ççï ñ
)ççñ ó
;ççó ò
client
éé 
.
éé 
DeliveryMethod
éé -
=
éé. / 
SmtpDeliveryMethod
éé0 B
.
ééB C
Network
ééC J
;
ééJ K
}
èè 
else
êê 
{
êê 
client
ëë 
.
ëë 
	EnableSsl
ëë (
=
ëë) *
true
ëë+ /
;
ëë/ 0
client
íí 
.
íí 
Credentials
íí *
=
íí+ ,
new
íí- 0
NetworkCredential
íí1 B
(
ííB C
	GetConfig
ííC L
.
ííL M

AppSetting
ííM W
[
ííW X
$str
ííX i
]
ííi j
,
ííj k
	GetConfig
ííl u
.
ííu v

AppSettingíív Ä
[ííÄ Å
$strííÅ ï
]ííï ñ
)ííñ ó
;ííó ò
}
ìì 
var
ïï 
message
ïï 
=
ïï  !
new
ïï" %
MailMessage
ïï& 1
(
ïï1 2
	GetConfig
ïï2 ;
.
ïï; <

AppSetting
ïï< F
[
ïïF G
$str
ïïG X
]
ïïX Y
,
ïïY Z
email
ïï[ `
,
ïï` a
$str
ïïb v
,
ïïv w
body
ïïx |
)
ïï| }
;
ïï} ~
message
ññ 
.
ññ 

IsBodyHtml
ññ 
=
ññ 
true
ññ 
;
ññ 
client
óó 
.
óó 
Send
óó 
(
óó 
message
óó 
)
óó 
;
óó 
}
òò 

resultData
ôô 
.
ôô 

StatusCode
ôô 
=
ôô 
$str
ôô 
;
ôô  

resultData
öö 
.
öö 
Message
öö 
=
öö 
$str
öö !
;
öö! "
return
õõ 


resultData
õõ 
;
õõ 
}
úú 
catch
ùù 
(
ùù	 

	Exception
ùù
 
ex
ùù 
)
ùù 
{
ûû 

resultData
üü 
.
üü 

StatusCode
üü 
=
üü 
$str
üü 
;
üü  

resultData
†† 
.
†† 
Message
†† 
=
†† 
	GetConfig
†† "
.
††" #

AppSetting
††# -
[
††- .
$str
††. U
]
††U V
;
††V W
return
°° 


resultData
°° 
;
°° 
}
¢¢ 
}
§§ 
public
¶¶ 
IActionResult
¶¶ 
ResetPassword
¶¶ *
(
¶¶* +
string
¶¶+ 1
encrypt
¶¶2 9
)
¶¶9 :
{
ßß '
DetailLoginOTP_ViewModels
©© 
req
©©  
=
©©! "
new
©©# &'
DetailLoginOTP_ViewModels
©©' @
(
©©@ A
)
©©A B
;
©©B C
req
™™ 
.
™™ 

ReqEncrypt
™™ 
=
™™ 
encrypt
™™ 
;
™™ 
return
¨¨ 	
View
¨¨
 
(
¨¨ 
req
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 
public
ÆÆ 
IActionResult
ÆÆ	 !
SubmitResetPassword
ÆÆ *
(
ÆÆ* +'
DetailLoginOTP_ViewModels
ÆÆ+ D
model
ÆÆE J
)
ÆÆJ K
{
ØØ 
var
∞∞ 

resultData
∞∞ 
=
∞∞ 
new
∞∞ 
ResultStatus
∞∞ $
(
∞∞$ %
)
∞∞% &
;
∞∞& '
if
≤≤ 
(
≤≤ 
model
≤≤ 
.
≤≤ 
PasswordInput
≤≤ 
!=
≤≤ 
model
≤≤ #
.
≤≤# $ 
PasswordKonfirmasi
≤≤$ 6
)
≤≤6 7
{
≥≥ 
ViewBag
¥¥ 
.
¥¥ 
ErrorMessage
¥¥ 
=
¥¥ 
$str
¥¥ B
;
¥¥B C
return
µµ 

View
µµ 
(
µµ 
$str
µµ 
,
µµ  
model
µµ! &
)
µµ& '
;
µµ' (
}
∂∂ 
if
∏∏ 
(
∏∏ 
!
∏∏ 
RegexRequest
∏∏ 
.
∏∏ 
ValidatePassword
∏∏ .
(
∏∏. /
model
∏∏/ 4
.
∏∏4 5
PasswordInput
∏∏5 B
)
∏∏B C
)
∏∏C D
{
ππ 
ViewBag
∫∫ 
.
∫∫ 
ErrorMessage
∫∫ $
=
∫∫% &
$str
∫∫' ?
;
∫∫? @
return
ªª 
View
ªª 
(
ªª 
$str
ªª +
,
ªª+ ,
model
ªª- 2
)
ªª2 3
;
ªª3 4
}
ºº 
try
ææ 
{
øø 
var
¿¿ 
	linkToken
¿¿ 
=
¿¿ 

EncryptAES
¿¿ 
.
¿¿ 
Decrypt
¿¿ &
(
¿¿& '
model
¿¿' ,
.
¿¿, -

ReqEncrypt
¿¿- 7
)
¿¿7 8
;
¿¿8 9
var
¡¡ 
decodedToken
¡¡  
=
¡¡! "
HttpUtility
¡¡# .
.
¡¡. /
	UrlDecode
¡¡/ 8
(
¡¡8 9
	linkToken
¡¡9 B
)
¡¡B C
;
¡¡C D
var
¬¬ 
userInfo
¬¬ 
=
¬¬ 
JsonConvert
¬¬ *
.
¬¬* +
DeserializeObject
¬¬+ <
<
¬¬< =
TokenVM
¬¬= D
>
¬¬D E
(
¬¬E F
decodedToken
¬¬F R
.
¬¬R S
Replace
¬¬S Z
(
¬¬Z [
$str
¬¬[ ^
,
¬¬^ _
$str
¬¬_ b
)
¬¬b c
)
¬¬c d
;
¬¬d e
if
ƒƒ 
(
ƒƒ 
userInfo
ƒƒ 
.
ƒƒ 
DateTime
ƒƒ 
.
ƒƒ 

AddMinutes
ƒƒ $
(
ƒƒ$ %
$num
ƒƒ% &
)
ƒƒ& '
>
ƒƒ( )
DateTime
ƒƒ* 2
.
ƒƒ2 3
Now
ƒƒ3 6
)
ƒƒ6 7
{
≈≈ 
TblMasterUser
∆∆ 
data
∆∆ 
=
∆∆ 
_context
∆∆ "
.
∆∆" #
TblMasterUsers
∆∆# 1
.
∆∆1 2
Where
∆∆2 7
(
∆∆7 8
m
∆∆8 9
=>
∆∆: <
m
∆∆= >
.
∆∆> ?
Username
∆∆? G
==
∆∆H J
userInfo
∆∆K S
.
∆∆S T
Username
∆∆T \
)
∆∆\ ]
.
∆∆] ^
FirstOrDefault
∆∆^ l
(
∆∆l m
)
∆∆m n
;
∆∆n o
data
«« 
.
«« 
Password
«« 
=
«« 
BCrypt
«« 
.
«« 
Net
«« "
.
««" #
BCrypt
««# )
.
««) *
HashPassword
««* 6
(
««6 7
model
««7 <
.
««< =
PasswordInput
««= J
)
««J K
;
««K L
data
»» 
.
»» 
UpdatedTime
»» 
=
»» 
DateTime
»» #
.
»»# $
Now
»»$ '
;
»»' (
_context
…… 
.
…… 
Entry
…… 
(
…… 
data
…… 
)
…… 
.
…… 
State
…… "
=
……# $
EntityState
……% 0
.
……0 1
Modified
……1 9
;
……9 :
_context
   
.
   
SaveChanges
   
(
   
)
   
;
   
ViewBag
ÃÃ 
.
ÃÃ 
ErrorMessage
ÃÃ 
=
ÃÃ 
$str
ÃÃ 7
;
ÃÃ7 8
return
ÕÕ 
RedirectToAction
ÕÕ 
(
ÕÕ  
$str
ÕÕ  '
,
ÕÕ' (
$str
ÕÕ) 0
)
ÕÕ0 1
;
ÕÕ1 2
}
ŒŒ 
else
œœ 
{
–– 
ViewBag
—— 
.
—— 
ErrorMessage
—— 
=
—— 
$str
—— ?
;
——? @
return
““ 
View
““ 
(
““ 
$str
““  
,
““  !
model
““" '
)
““' (
;
““( )
}
”” 
}
‘‘ 
catch
’’ 
(
’’	 

	Exception
’’
 
ex
’’ 
)
’’ 
{
÷÷ 
ViewBag
◊◊ 
.
◊◊ 
ErrorMessage
◊◊ 
=
◊◊ 
	GetConfig
◊◊ $
.
◊◊$ %

AppSetting
◊◊% /
[
◊◊/ 0
$str
◊◊0 W
]
◊◊W X
;
◊◊X Y
return
ÿÿ 

View
ÿÿ 
(
ÿÿ 
$str
ÿÿ 
,
ÿÿ  
model
ÿÿ! &
)
ÿÿ& '
;
ÿÿ' (
}
ŸŸ 
}
⁄⁄ 
}
‹‹ 
}›› Å$
KD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\HomeController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public		 

class		 
HomeController		 
:		  !

Controller		" ,
{

 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 

IConverter #

_converter$ .
;. /
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public 
HomeController 
( 
IConfiguration ,
config- 3
,3 4%
DbDashboardDevaBniContext5 N
contextO V
,V W 
IHttpContextAccessorX l
accessorm u
)u v
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
	GetConfig1 :
.: ;

AppSetting; E
[E F
$strF n
]n o
+p q
$strr y
,y z
new{ ~
{	 Ä
a
Å Ç
=
É Ñ
true
Ö â
}
ä ã
)
ã å
;
å ç
} 
var 
location 
= 
new 
Uri "
(" #
$"# %
{% &
Request& -
.- .
Scheme. 4
}4 5
$str5 8
{8 9
Request9 @
.@ A
HostA E
}E F
{F G
RequestG N
.N O
PathO S
}S T
"T U
)U V
;V W
string 
Path 
= 
location "
." #
AbsolutePath# /
;/ 0
if   
(   
!   
accessSecurity   
.    
IsGetAccess    +
(  + ,
$str  , 0
+  1 2
Path  3 7
)  7 8
)  8 9
{!! 
return"" 
RedirectToAction"" '
(""' (
$str""( 3
,""3 4
	GetConfig""5 >
.""> ?

AppSetting""? I
[""I J
$str""J r
]""r s
+""t u
$str""v }
)""} ~
;""~ 
}## 
ViewBag%% 
.%% 
CurrentPath%% 
=%%  !
Path%%" &
;%%& '
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
[** 	
ResponseCache**	 
(** 
Duration** 
=**  !
$num**" #
,**# $
Location**% -
=**. /!
ResponseCacheLocation**0 E
.**E F
None**F J
,**J K
NoStore**L S
=**T U
true**V Z
)**Z [
]**[ \
public++ 
IActionResult++ 
Error++ "
(++" #
)++# $
{,, 	
return-- 
View-- 
(-- 
new-- 
ErrorViewModel-- *
{--+ ,
	RequestId--- 6
=--7 8
Activity--9 A
.--A B
Current--B I
?--I J
.--J K
Id--K M
??--N P
HttpContext--Q \
.--\ ]
TraceIdentifier--] l
}--m n
)--n o
;--o p
}.. 	
}// 
}00 Ós
SD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Controllers\DownloadListController.cs
	namespace 	
DashboardDevaBNI
 
. 
Controllers &
{ 
public 

class "
DownloadListController '
:( )

Controller* 4
{ 
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
private 
readonly 
LastSessionLog '
lastSession( 3
;3 4
private 
readonly 
AccessSecurity '
accessSecurity( 6
;6 7
public "
DownloadListController %
(% &
IConfiguration& 4
config5 ;
,; <%
DbDashboardDevaBniContext= V
contextW ^
,^ _ 
IHttpContextAccessor` t
accessoru }
)} ~
{ 	
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
lastSession 
= 
new 
LastSessionLog ,
(, -
accessor- 5
,5 6
context7 >
,> ?
config@ F
)F G
;G H
accessSecurity 
= 
new  
AccessSecurity! /
(/ 0
accessor0 8
,8 9
context: A
,A B
configC I
)I J
;J K
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
lastSession 
. 
Update #
(# $
)$ %
)% &
{ 
return   
RedirectToAction   '
(  ' (
$str  ( /
,  / 0
	GetConfig  1 :
.  : ;

AppSetting  ; E
[  E F
$str  F n
]  n o
+  p q
$str  r y
,  y z
new  { ~
{	   Ä
a
  Å Ç
=
  É Ñ
true
  Ö â
}
  ä ã
)
  ã å
;
  å ç
}!! 
var"" 
location"" 
="" 
new"" 
Uri"" "
(""" #
$"""# %
{""% &
Request""& -
.""- .
Scheme"". 4
}""4 5
$str""5 8
{""8 9
Request""9 @
.""@ A
Host""A E
}""E F
{""F G
Request""G N
.""N O
Path""O S
}""S T
"""T U
)""U V
;""V W
string## 
Path## 
=## 
location## "
.##" #
AbsolutePath### /
;##/ 0
if$$ 
($$ 
!$$ 
accessSecurity$$ 
.$$  
IsGetAccess$$  +
($$+ ,
$str$$, 0
+$$1 2
Path$$3 7
)$$7 8
)$$8 9
{%% 
return&& 
RedirectToAction&& '
(&&' (
$str&&( 3
,&&3 4
	GetConfig&&5 >
.&&> ?

AppSetting&&? I
[&&I J
$str&&J r
]&&r s
+&&t u
$str&&v }
)&&} ~
;&&~ 
}'' 
ViewBag)) 
.)) 
CurrentPath)) 
=))  !
Path))" &
;))& '
return** 
View** 
(** 
)** 
;** 
}++ 	
[.. 	
HttpPost..	 
].. 
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
LoadData//) 1
(//1 2
)//2 3
{00 	
try<< 
{== 
var?? 

hardDelete?? 
=??  
await??! &
_context??' /
.??/ 0
TblDownloadBigFiles??0 C
.??C D
Where??D I
(??I J
x??J K
=>??L N
x??O P
.??P Q
CreatedTime??Q \
.??\ ]
Value??] b
.??b c
Date??c g
!=??h j
DateTime??k s
.??s t
Now??t w
.??w x
Date??x |
)??| }
.??} ~
ToListAsync	??~ â
(
??â ä
)
??ä ã
;
??ã å
if@@ 
(@@ 

hardDelete@@ 
.@@ 
Count@@ $
>@@% &
$num@@' (
)@@( )
{AA 
foreachBB 
(BB 
varBB  
itemBB! %
inBB& (

hardDeleteBB) 3
)BB3 4
{CC 
ifDD 
(DD 
SystemDD "
.DD" #
IODD# %
.DD% &
FileDD& *
.DD* +
ExistsDD+ 1
(DD1 2
itemDD2 6
.DD6 7
PathDD7 ;
)DD; <
)DD< =
{EE 
SystemFF "
.FF" #
IOFF# %
.FF% &
FileFF& *
.FF* +
DeleteFF+ 1
(FF1 2
itemFF2 6
.FF6 7
PathFF7 ;
)FF; <
;FF< =
}GG 
}HH 
_contextII 
.II 
RemoveRangeII (
(II( )

hardDeleteII) 3
)II3 4
;II4 5
_contextJJ 
.JJ 
SaveChangesJJ (
(JJ( )
)JJ) *
;JJ* +
}KK 
varMM 
dictMM 
=MM 
RequestMM "
.MM" #
FormMM# '
.MM' (
ToDictionaryMM( 4
(MM4 5
xMM5 6
=>MM7 9
xMM: ;
.MM; <
KeyMM< ?
,MM? @
xMMA B
=>MMC E
xMMF G
.MMG H
ValueMMH M
.MMM N
ToStringMMN V
(MMV W
)MMW X
)MMX Y
;MMY Z
varOO 
drawOO 
=OO 
dictOO 
[OO  
$strOO  &
]OO& '
;OO' (
varRR 
startRR 
=RR 
dictRR  
[RR  !
$strRR! (
]RR( )
;RR) *
varSS 
lengthSS 
=SS 
dictSS !
[SS! "
$strSS" *
]SS* +
;SS+ ,
varWW 

pageNumberWW 
=WW  
(WW! "
intWW" %
.WW% &
ParseWW& +
(WW+ ,
startWW, 1
)WW1 2
/WW3 4
intWW5 8
.WW8 9
ParseWW9 >
(WW> ?
lengthWW? E
)WWE F
)WWF G
+WWH I
$numWWJ K
;WWK L
varZZ 

sortColumnZZ 
=ZZ  
dictZZ! %
[ZZ% &
$strZZ& 0
+ZZ1 2
dictZZ3 7
[ZZ7 8
$strZZ8 J
]ZZJ K
+ZZL M
$strZZN W
]ZZW X
;ZZX Y
var[[ 
sortColumnDir[[ !
=[[" #
dict[[$ (
[[[( )
$str[[) 8
][[8 9
;[[9 :
var\\ 
KeySearchParam\\ "
=\\# $
dict\\% )
[\\) *
$str\\* E
]\\E F
;\\F G
int`` 
pageSize`` 
=`` 
length`` %
!=``& (
null``) -
?``. /
Convert``0 7
.``7 8
ToInt32``8 ?
(``? @
length``@ F
)``F G
:``H I
$num``J K
;``K L
intaa 
skipaa 
=aa 
startaa  
!=aa! #
nullaa$ (
?aa) *
Convertaa+ 2
.aa2 3
ToInt32aa3 :
(aa: ;
startaa; @
)aa@ A
:aaB C
$numaaD E
;aaE F
intbb 
recordsTotalbb  
=bb! "
$numbb# $
;bb$ %
Listcc 
<cc #
Downloadlist_LoadDataVMcc ,
>cc, -
listcc. 2
=cc3 4
newcc5 8
Listcc9 =
<cc= >#
Downloadlist_LoadDataVMcc> U
>ccU V
(ccV W
)ccW X
;ccX Y
listee 
=ee #
StoredProcedureExecutoree .
.ee. /
ExecuteSPListee/ <
<ee< =#
Downloadlist_LoadDataVMee= T
>eeT U
(eeU V
_contexteeV ^
,ee^ _
$stree` {
,ee{ |
new	ee} Ä
SqlParameter
eeÅ ç
[
eeç é
]
eeé è
{
eeè ê
newff 
SqlParameterff (
(ff( )
$strff) 0
,ff0 1
KeySearchParamff2 @
)ff@ A
,ffA B
newgg 
SqlParametergg (
(gg( )
$strgg) 2
,gg2 3
HttpContextgg4 ?
.gg? @
Sessiongg@ G
.ggG H
	GetStringggH Q
(ggQ R
SessionConstanggR `
.gg` a
Session_UserIdgga o
)ggo p
)ggp q
,ggq r
newhh 
SqlParameterhh (
(hh( )
$strhh) 6
,hh6 7

sortColumnhh8 B
)hhB C
,hhC D
newii 
SqlParameterii (
(ii( )
$strii) 9
,ii9 :
sortColumnDirii; H
)iiH I
,iiI J
newjj 
SqlParameterjj (
(jj( )
$strjj) 6
,jj6 7

pageNumberjj8 B
)jjB C
,jjC D
newkk 
SqlParameterkk (
(kk( )
$strkk) 4
,kk4 5
pageSizekk6 >
)kk> ?
}kk? @
)kk@ A
;kkA B
recordsTotalmm 
=mm #
StoredProcedureExecutormm 6
.mm6 7
ExecuteScalarIntmm7 G
(mmG H
_contextmmH P
,mmP Q
$strmmR n
,mmn o
newmmp s
SqlParameter	mmt Ä
[
mmÄ Å
]
mmÅ Ç
{
mmÇ É
newnn 
SqlParameternn (
(nn( )
$strnn) 0
,nn0 1
KeySearchParamnn2 @
)nn@ A
,nnA B
newoo 
SqlParameteroo (
(oo( )
$stroo) 2
,oo2 3
HttpContextoo4 ?
.oo? @
Sessionoo@ G
.ooG H
	GetStringooH Q
(ooQ R
SessionConstanooR `
.oo` a
Session_UserIdooa o
)ooo p
)oop q
,ooq r
}pp 
)pp 
;pp 
ifrr 
(rr 
listrr 
==rr 
nullrr  
)rr  !
{ss 
listtt 
=tt 
newtt 
Listtt #
<tt# $#
Downloadlist_LoadDataVMtt$ ;
>tt; <
(tt< =
)tt= >
;tt> ?
recordsTotaluu  
=uu! "
$numuu# $
;uu$ %
}vv 
returnxx 
Jsonxx 
(xx 
newxx 
{xx  !
drawxx" &
=xx' (
drawxx) -
,xx- .
recordsFilteredxx/ >
=xx? @
recordsTotalxxA M
,xxM N
recordsTotalxxO [
=xx\ ]
recordsTotalxx^ j
,xxj k
dataxxl p
=xxq r
listxxs w
}xxx y
)xxy z
;xxz {
}yy 
catchzz 
(zz 
	Exceptionzz 
Exzz 
)zz  
{{{ 
throw|| 
;|| 
}}} 
}~~ 	
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
object
ÄÄ  
>
ÄÄ  !
DownloadFile
ÄÄ" .
(
ÄÄ. /
int
ÄÄ/ 2
id
ÄÄ3 5
)
ÄÄ5 6
{
ÅÅ 	
try
éé 
{
èè 
var
êê 
UserId
êê 
=
êê 
HttpContext
êê (
.
êê( )
Session
êê) 0
.
êê0 1
	GetString
êê1 :
(
êê: ;
SessionConstan
êê; I
.
êêI J
Session_UserId
êêJ X
)
êêX Y
;
êêY Z
var
íí 
data
íí 
=
íí 
new
íí 
object
íí %
(
íí% &
)
íí& '
;
íí' (
var
ìì 
check
ìì 
=
ìì 
await
ìì !
_context
ìì" *
.
ìì* +!
TblDownloadBigFiles
ìì+ >
.
ìì> ?
Where
ìì? D
(
ììD E
x
ììE F
=>
ììG I
x
ììJ K
.
ììK L
Id
ììL N
==
ììO Q
id
ììR T
&&
ììU W
x
ììX Y
.
ììY Z
CreatedById
ììZ e
==
ììf h
int
ììi l
.
ììl m
Parse
ììm r
(
ììr s
UserId
ììs y
)
ììy z
)
ììz {
.
ìì{ |"
FirstOrDefaultAsyncìì| è
(ììè ê
)ììê ë
;ììë í
if
îî 
(
îî 
System
îî 
.
îî 
IO
îî 
.
îî 
File
îî "
.
îî" #
Exists
îî# )
(
îî) *
check
îî* /
.
îî/ 0
Path
îî0 4
)
îî4 5
)
îî5 6
{
ïï 
byte
óó 
[
óó 
]
óó 
	fileBytes
óó $
=
óó% &
System
óó' -
.
óó- .
IO
óó. 0
.
óó0 1
File
óó1 5
.
óó5 6
ReadAllBytes
óó6 B
(
óóB C
check
óóC H
.
óóH I
Path
óóI M
)
óóM N
;
óóN O
Response
öö 
.
öö 
Headers
öö $
.
öö$ %
Add
öö% (
(
öö( )
$str
öö) >
,
öö> ?
$str
öö@ Y
+
ööZ [
check
öö\ a
.
ööa b
FileName
ööb j
+
öök l
$str
ööm p
+
ööq r
check
öös x
.
ööx y
FileExtööy Ä
+ööÅ Ç
$strööÉ á
)ööá à
;ööà â
Response
õõ 
.
õõ 
Headers
õõ $
.
õõ$ %
Add
õõ% (
(
õõ( )
$str
õõ) 7
,
õõ7 8
$str
õõ9 S
)
õõS T
;
õõT U
return
ûû 
File
ûû 
(
ûû  
	fileBytes
ûû  )
,
ûû) *
$str
ûû+ E
)
ûûE F
;
ûûF G
}
üü 
else
†† 
{
°° 
return
¢¢ 
NotFound
¢¢ #
(
¢¢# $
$str
¢¢$ 4
)
¢¢4 5
;
¢¢5 6
}
££ 
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
Ex
∫∫ 
)
∫∫  
{
ªª 
return
ºº 
Content
ºº 
(
ºº 
Ex
ºº !
.
ºº! "
Message
ºº" )
.
ºº) *
ToString
ºº* 2
(
ºº2 3
)
ºº3 4
)
ºº4 5
;
ºº5 6
}
ΩΩ 
}
ææ 	
}
¿¿ 
}¡¡ ·C
BD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\Utility.cs
	namespace

 	
DashboardDevaBNI


 
.

 
	Component

 $
{ 
public 

class 
Utility 
{ 
public 
static 
IEnumerable !
<! "#
DropdownServerSideIntVM" 9
>9 : 
SelectDataLookupById; O
(O P
intP S
?S T
IdU W
,W X
StringY _
type` d
,d e%
DbDashboardDevaBniContextf 
_context
Ä à
)
à â
{ 	
List 
< #
DropdownServerSideIntVM (
>( )
data* .
=/ 0
new1 4
List5 9
<9 :#
DropdownServerSideIntVM: Q
>Q R
(R S
)S T
;T U
data 
= #
StoredProcedureExecutor *
.* +
ExecuteSPList+ 8
<8 9#
DropdownServerSideIntVM9 P
>P Q
(Q R
_contextR Z
,Z [
$str\ w
,w x
newy |
SqlParameter	} â
[
â ä
]
ä ã
{
ã å
new 
SqlParameter (
(( )
$str) .
,. /
Id0 2
)2 3
,3 4
new 
SqlParameter (
(( )
$str) 0
,0 1
type2 6
)6 7
} 
) 
; 
data 
= 
data 
!= 
null 
?  !
data" &
:' (
new) ,
List- 1
<1 2#
DropdownServerSideIntVM2 I
>I J
(J K
)K L
;L M
return 
data 
; 
} 	
public   
static   
IEnumerable   !
<  ! ""
DataDropdownServerSide  " 8
>  8 9 
SelectDataParentMenu  : N
(  N O
long  O S
?  S T
Id  U W
,  W X%
DbDashboardDevaBniContext  Y r
_context  s {
)  { |
{!! 	
List"" 
<"" "
DataDropdownServerSide"" '
>""' (
data"") -
="". /
new""0 3
List""4 8
<""8 9"
DataDropdownServerSide""9 O
>""O P
(""P Q
)""Q R
;""R S
data$$ 
=$$ #
StoredProcedureExecutor$$ *
.$$* +
ExecuteSPList$$+ 8
<$$8 9"
DataDropdownServerSide$$9 O
>$$O P
($$P Q
_context$$Q Y
,$$Y Z
$str$$[ z
,$$z {
new$$| 
SqlParameter
$$Ä å
[
$$å ç
]
$$ç é
{
$$é è
new%% 
SqlParameter%% (
(%%( )
$str%%) .
,%%. /
Id%%0 2
)%%2 3
}'' 
)'' 
;'' 
data(( 
=(( 
data(( 
!=(( 
null(( 
?((  !
data((" &
:((' (
new(() ,
List((- 1
<((1 2"
DataDropdownServerSide((2 H
>((H I
(((I J
)((J K
;((K L
return** 
data** 
;** 
}++ 	
public// 
static// 
IEnumerable// !
<//! ""
DataDropdownServerSide//" 8
>//8 9 
SelectDataMasterRole//: N
(//N O%
DbDashboardDevaBniContext//O h
_context//i q
)//q r
{00 	
List11 
<11 "
DataDropdownServerSide11 '
>11' (
data11) -
=11. /
new110 3
List114 8
<118 9"
DataDropdownServerSide119 O
>11O P
(11P Q
)11Q R
;11R S
data33 
=33 #
StoredProcedureExecutor33 *
.33* +
ExecuteSPList33+ 8
<338 9"
DataDropdownServerSide339 O
>33O P
(33P Q
_context33Q Y
,33Y Z
$str33[ u
,33u v
new33w z
SqlParameter	33{ á
[
33á à
]
33à â
{
33â ä
}55 
)55 
;55 
data66 
=66 
data66 
!=66 
null66 
?66  !
data66" &
:66' (
new66) ,
List66- 1
<661 2"
DataDropdownServerSide662 H
>66H I
(66I J
)66J K
;66K L
return88 
data88 
;88 
}99 	
public:: 
static:: 
IEnumerable:: !
<::! ""
DataDropdownServerSide::" 8
>::8 9
SelectDataRole::: H
(::H I
int::I L
?::L M
Id::N P
,::P Q%
DbDashboardDevaBniContext::R k
_context::l t
)::t u
{;; 	
List<< 
<<< "
DataDropdownServerSide<< '
><<' (
data<<) -
=<<. /
new<<0 3
List<<4 8
<<<8 9"
DataDropdownServerSide<<9 O
><<O P
(<<P Q
)<<Q R
;<<R S
data>> 
=>> #
StoredProcedureExecutor>> *
.>>* +
ExecuteSPList>>+ 8
<>>8 9"
DataDropdownServerSide>>9 O
>>>O P
(>>P Q
_context>>Q Y
,>>Y Z
$str>>[ t
,>>t u
new>>v y
SqlParameter	>>z Ü
[
>>Ü á
]
>>á à
{
>>à â
new?? 
SqlParameter??  
(??  !
$str??! &
,??& '
Id??( *
)??* +
}@@ 
)@@ 
;@@ 
dataAA 
=AA 
dataAA 
!=AA 
nullAA 
?AA  !
dataAA" &
:AA' (
newAA) ,
ListAA- 1
<AA1 2"
DataDropdownServerSideAA2 H
>AAH I
(AAI J
)AAJ K
;AAK L
returnCC 
dataCC 
;CC 
}DD 	
publicFF 
staticFF 
IEnumerableFF !
<FF! "#
DropdownServerSideIntVMFF" 9
>FF9 :
SelectDataRekIdFF; J
(FFJ K
intFFK N
rekIdFFO T
)FFT U
{GG 
ListHH 
<HH #
DropdownServerSideIntVMHH 
>HH  

dataReturnHH! +
=HH, -
newHH. 1
ListHH2 6
<HH6 7#
DropdownServerSideIntVMHH7 N
>HHN O
(HHO P
)HHP Q
;HHQ R
varJJ 
urlJJ 

=JJ 
	GetConfigJJ 
.JJ 

AppSettingJJ !
[JJ! "
$strJJ" 3
]JJ3 4
+JJ5 6
	GetConfigJJ7 @
.JJ@ A

AppSettingJJA K
[JJK L
$strJJL [
]JJ[ \
+JJ] ^
$str	JJ_ ì
+
JJî ï
rekId
JJñ õ
;
JJõ ú
(KK 
boolKK 
	resultApiKK 
,KK 
stringKK #
resultKK$ *
)KK* +
=KK, -
RequestToAPIKK. :
.KK: ;
GetJsonStringWebApiKK; N
(KKN O
urlKKO R
,KKR S
nullKKT X
)KKX Y
;KKY Z
ifMM 
(MM 
	resultApiMM 
&&MM 
!MM 
stringMM $
.MM$ %
IsNullOrEmptyMM% 2
(MM2 3
resultMM3 9
)MM9 :
)MM: ;
{NN 
varOO 
jsonParseReturnOO #
=OO$ %
JsonConvertOO& 1
.OO1 2
DeserializeObjectOO2 C
<OOC D
ResultStatusDataIntOOD W
<OOW X&
DataDropdownServerSideDevaOOX r
>OOr s
>OOs t
(OOt u
resultOOu {
)OO{ |
;OO| }
foreachQQ 
(QQ 
varQQ 
itemQQ 
inQQ 
jsonParseReturnQQ (
.QQ( )
ValueQQ) .
)QQ. /
{RR #
DropdownServerSideIntVMSS 
newItemSS $
=SS% &
newSS' *#
DropdownServerSideIntVMSS+ B
{TT 
idUU 
=UU	 

itemUU 
.UU 
RekIdUU 
,UU 
textVV 

=VV 
itemVV 
.VV 
accVV 
}WW 
;WW 

dataReturnYY 
.YY 
AddYY 
(YY 
newItemYY 
)YY 
;YY 
}ZZ 
}[[ 
return\\ 

dataReturn\\ 
;\\ 
}]] 	
}^^ 
}__ Âº
RD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\StoredProcedureExecutor.cs
	namespace		 	
DashboardDevaBNI		
 
.		 
	Component		 $
{

 
public 

static 
class #
StoredProcedureExecutor /
{ 
public 
static 
async 
Task  
<  !
T! "
>" # 
ExecuteScalarSFAsync$ 8
<8 9
T9 :
>: ;
(; <
this< @
	DbContextA J
contextK R
,R S
stringT Z
storedFunctionName[ m
,m n
stringo u

parameters	v Ä
=
Å Ç
$str
É Ö
,
Ö Ü
string
á ç
schema
é î
=
ï ñ
$str
ó ú
)
ú ù
{ 	
T 
returnObject 
= 
default $
($ %
T% &
)& '
;' (
using 
( 
var 
command 
=  
context! (
.( )
Database) 1
.1 2
GetDbConnection2 A
(A B
)B C
.C D
CreateCommandD Q
(Q R
)R S
)S T
{ 
command 
. 
CommandType #
=$ %
CommandType& 1
.1 2
Text2 6
;6 7
command 
. 
CommandTimeout &
=' (
$num) ,
;, -
command 
. 
CommandText #
=$ %
$"& (
$str( /
{/ 0
schema0 6
}6 7
$str7 8
{8 9
storedFunctionName9 K
}K L
$strL M
{M N

parametersN X
}X Y
$strY [
"[ \
;\ ]
context 
. 
Database  
.  !
OpenConnection! /
(/ 0
)0 1
;1 2
try 
{ 
returnObject  
=! "
(# $
T$ %
)% &
await& +
command, 3
.3 4
ExecuteScalarAsync4 F
(F G
)G H
;H I
} 
catch 
( 
	Exception  
)  !
{ 
context 
. 
Database $
.$ %
CloseConnection% 4
(4 5
)5 6
;6 7
throw   
;   
}!! 
context## 
.## 
Database##  
.##  !
CloseConnection##! 0
(##0 1
)##1 2
;##2 3
}$$ 
return&& 
returnObject&& 
;&&  
}'' 	
public)) 
static)) 
T)) 
ExecuteScalarSF)) '
<))' (
T))( )
>))) *
())* +
this))+ /
	DbContext))0 9
context)): A
,))A B
string))C I
storedFunctionName))J \
,))\ ]
string))^ d

parameters))e o
=))p q
$str))r t
,))t u
string))v |
schema	))} É
=
))Ñ Ö
$str
))Ü ã
)
))ã å
{** 	
T++ 
returnObject++ 
=++ 
default++ $
(++$ %
T++% &
)++& '
;++' (
using-- 
(-- 
var-- 
command-- 
=--  
context--! (
.--( )
Database--) 1
.--1 2
GetDbConnection--2 A
(--A B
)--B C
.--C D
CreateCommand--D Q
(--Q R
)--R S
)--S T
{.. 
command// 
.// 
CommandType// #
=//$ %
CommandType//& 1
.//1 2
Text//2 6
;//6 7
command00 
.00 
CommandTimeout00 &
=00' (
$num00) ,
;00, -
command11 
.11 
CommandText11 #
=11$ %
$"11& (
$str11( /
{11/ 0
schema110 6
}116 7
$str117 8
{118 9
storedFunctionName119 K
}11K L
$str11L M
{11M N

parameters11N X
}11X Y
$str11Y [
"11[ \
;11\ ]
context33 
.33 
Database33  
.33  !
OpenConnection33! /
(33/ 0
)330 1
;331 2
try55 
{66 
returnObject77  
=77! "
(77# $
T77$ %
)77% &
command77& -
.77- .
ExecuteScalar77. ;
(77; <
)77< =
;77= >
}88 
catch99 
(99 
	Exception99  
)99  !
{:: 
context;; 
.;; 
Database;; $
.;;$ %
CloseConnection;;% 4
(;;4 5
);;5 6
;;;6 7
throw<< 
;<< 
}== 
context?? 
.?? 
Database??  
.??  !
CloseConnection??! 0
(??0 1
)??1 2
;??2 3
}@@ 
returnBB 
returnObjectBB 
;BB  
}CC 	
publicEE 
staticEE 
asyncEE 
TaskEE  
<EE  !
TEE! "
>EE" # 
ExecuteScalarSPAsyncEE$ 8
<EE8 9
TEE9 :
>EE: ;
(EE; <
thisEE< @
	DbContextEEA J
contextEEK R
,EER S
stringEET Z
storedProcedureNameEE[ n
,EEn o
SqlParameterEEp |
[EE| }
]EE} ~

parameters	EE â
)
EEâ ä
{FF 	
TGG 
returnObjectGG 
=GG 
defaultGG $
(GG$ %
TGG% &
)GG& '
;GG' (
usingII 
(II 
varII 
commandII 
=II  
contextII! (
.II( )
DatabaseII) 1
.II1 2
GetDbConnectionII2 A
(IIA B
)IIB C
.IIC D
CreateCommandIID Q
(IIQ R
)IIR S
)IIS T
{JJ 
commandKK 
.KK 
CommandTypeKK #
=KK$ %
CommandTypeKK& 1
.KK1 2
StoredProcedureKK2 A
;KKA B
commandLL 
.LL 
CommandTimeoutLL &
=LL' (
$numLL) ,
;LL, -
commandMM 
.MM 
CommandTextMM #
=MM$ %
storedProcedureNameMM& 9
;MM9 :
commandNN 
.NN 

ParametersNN "
.NN" #
AddRangeNN# +
(NN+ ,

parametersNN, 6
)NN6 7
;NN7 8
contextPP 
.PP 
DatabasePP  
.PP  !
OpenConnectionPP! /
(PP/ 0
)PP0 1
;PP1 2
tryRR 
{SS 
returnObjectTT  
=TT! "
(TT# $
TTT$ %
)TT% &
awaitTT& +
commandTT, 3
.TT3 4
ExecuteScalarAsyncTT4 F
(TTF G
)TTG H
;TTH I
}UU 
catchVV 
(VV 
	ExceptionVV  
)VV  !
{WW 
contextXX 
.XX 
DatabaseXX $
.XX$ %
CloseConnectionXX% 4
(XX4 5
)XX5 6
;XX6 7
throwYY 
;YY 
}ZZ 
context\\ 
.\\ 
Database\\  
.\\  !
CloseConnection\\! 0
(\\0 1
)\\1 2
;\\2 3
}]] 
return__ 
returnObject__ 
;__  
}`` 	
publicbb 
staticbb 
Tbb 
ExecuteScalarSPbb '
<bb' (
Tbb( )
>bb) *
(bb* +
thisbb+ /
	DbContextbb0 9
contextbb: A
,bbA B
stringbbC I
storedProcedureNamebbJ ]
,bb] ^
SqlParameterbb_ k
[bbk l
]bbl m

parametersbbn x
)bbx y
{cc 	
Tdd 
returnObjectdd 
=dd 
defaultdd $
(dd$ %
Tdd% &
)dd& '
;dd' (
usingff 
(ff 
varff 
commandff 
=ff  
contextff! (
.ff( )
Databaseff) 1
.ff1 2
GetDbConnectionff2 A
(ffA B
)ffB C
.ffC D
CreateCommandffD Q
(ffQ R
)ffR S
)ffS T
{gg 
commandhh 
.hh 
CommandTypehh #
=hh$ %
CommandTypehh& 1
.hh1 2
StoredProcedurehh2 A
;hhA B
commandii 
.ii 
CommandTextii #
=ii$ %
storedProcedureNameii& 9
;ii9 :
commandjj 
.jj 
CommandTimeoutjj &
=jj' (
$numjj) ,
;jj, -
commandkk 
.kk 

Parameterskk "
.kk" #
AddRangekk# +
(kk+ ,

parameterskk, 6
)kk6 7
;kk7 8
contextmm 
.mm 
Databasemm  
.mm  !
OpenConnectionmm! /
(mm/ 0
)mm0 1
;mm1 2
tryoo 
{pp 
returnObjectqq  
=qq! "
(qq# $
Tqq$ %
)qq% &
commandqq& -
.qq- .
ExecuteScalarqq. ;
(qq; <
)qq< =
;qq= >
}rr 
catchss 
(ss 
	Exceptionss  
)ss  !
{tt 
contextuu 
.uu 
Databaseuu $
.uu$ %
CloseConnectionuu% 4
(uu4 5
)uu5 6
;uu6 7
throwvv 
;vv 
}ww 
contextyy 
.yy 
Databaseyy  
.yy  !
CloseConnectionyy! 0
(yy0 1
)yy1 2
;yy2 3
}zz 
return|| 
returnObject|| 
;||  
}}} 	
public 
static 
async 
Task  
ExecuteSPVoidAsync! 3
(3 4
this4 8
	DbContext9 B
contextC J
,J K
stringL R
storedProcedureNameS f
,f g
SqlParameterh t
[t u
]u v

parameters	w Å
)
Å Ç
{
ÄÄ 	
using
ÅÅ 
(
ÅÅ 
var
ÅÅ 
command
ÅÅ 
=
ÅÅ  
context
ÅÅ! (
.
ÅÅ( )
Database
ÅÅ) 1
.
ÅÅ1 2
GetDbConnection
ÅÅ2 A
(
ÅÅA B
)
ÅÅB C
.
ÅÅC D
CreateCommand
ÅÅD Q
(
ÅÅQ R
)
ÅÅR S
)
ÅÅS T
{
ÇÇ 
command
ÉÉ 
.
ÉÉ 
CommandType
ÉÉ #
=
ÉÉ$ %
CommandType
ÉÉ& 1
.
ÉÉ1 2
StoredProcedure
ÉÉ2 A
;
ÉÉA B
command
ÑÑ 
.
ÑÑ 
CommandText
ÑÑ #
=
ÑÑ$ %!
storedProcedureName
ÑÑ& 9
;
ÑÑ9 :
command
ÖÖ 
.
ÖÖ 
CommandTimeout
ÖÖ &
=
ÖÖ' (
$num
ÖÖ) ,
;
ÖÖ, -
command
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ "
.
ÜÜ" #
AddRange
ÜÜ# +
(
ÜÜ+ ,

parameters
ÜÜ, 6
)
ÜÜ6 7
;
ÜÜ7 8
context
àà 
.
àà 
Database
àà  
.
àà  !
OpenConnection
àà! /
(
àà/ 0
)
àà0 1
;
àà1 2
try
ää 
{
ãã 
await
åå 
command
åå !
.
åå! " 
ExecuteReaderAsync
åå" 4
(
åå4 5
)
åå5 6
;
åå6 7
}
çç 
catch
éé 
(
éé 
	Exception
éé  
)
éé  !
{
èè 
context
êê 
.
êê 
Database
êê $
.
êê$ %
CloseConnection
êê% 4
(
êê4 5
)
êê5 6
;
êê6 7
throw
ëë 
;
ëë 
}
íí 
context
îî 
.
îî 
Database
îî  
.
îî  !
CloseConnection
îî! 0
(
îî0 1
)
îî1 2
;
îî2 3
}
ïï 
}
ññ 	
public
ôô 
static
ôô 
int
ôô 
ExecuteScalarInt
ôô *
(
ôô* +
this
ôô+ /
	DbContext
ôô0 9
context
ôô: A
,
ôôA B
string
ôôC I!
storedProcedureName
ôôJ ]
,
ôô] ^
SqlParameter
ôô_ k
[
ôôk l
]
ôôl m

parameters
ôôn x
)
ôôx y
{
öö 	
int
õõ 
recordsTotal
õõ 
=
õõ 
$num
õõ  
;
õõ  !
using
úú 
(
úú 
var
úú 
command
úú 
=
úú  
context
úú! (
.
úú( )
Database
úú) 1
.
úú1 2
GetDbConnection
úú2 A
(
úúA B
)
úúB C
.
úúC D
CreateCommand
úúD Q
(
úúQ R
)
úúR S
)
úúS T
{
ùù 
command
ûû 
.
ûû 
CommandType
ûû #
=
ûû$ %
CommandType
ûû& 1
.
ûû1 2
StoredProcedure
ûû2 A
;
ûûA B
command
üü 
.
üü 
CommandText
üü #
=
üü$ %!
storedProcedureName
üü& 9
;
üü9 :
command
†† 
.
†† 
CommandTimeout
†† &
=
††' (
$num
††) ,
;
††, -
command
°° 
.
°° 

Parameters
°° "
.
°°" #
AddRange
°°# +
(
°°+ ,

parameters
°°, 6
)
°°6 7
;
°°7 8
context
££ 
.
££ 
Database
££  
.
££  !
OpenConnection
££! /
(
££/ 0
)
££0 1
;
££1 2
var
•• 
regex
•• 
=
•• 
RegexRequest
•• (
.
••( )
RegexSQLInjection
••) :
(
••: ;

parameters
••; E
)
••E F
;
••F G
if
¶¶ 
(
¶¶ 
!
¶¶ 
regex
¶¶ 
)
¶¶ 
{
ßß 
return
®® 
recordsTotal
®® '
;
®®' (
}
©© 
try
¨¨ 
{
≠≠ 
string
ÆÆ 
result
ÆÆ !
=
ÆÆ" #
command
ÆÆ$ +
.
ÆÆ+ ,
ExecuteScalar
ÆÆ, 9
(
ÆÆ9 :
)
ÆÆ: ;
.
ÆÆ; <
ToString
ÆÆ< D
(
ÆÆD E
)
ÆÆE F
;
ÆÆF G
int
ØØ 
.
ØØ 
TryParse
ØØ  
(
ØØ  !
result
ØØ! '
,
ØØ' (
out
ØØ) ,
recordsTotal
ØØ- 9
)
ØØ9 :
;
ØØ: ;
}
∞∞ 
catch
±± 
(
±± 
	Exception
±±  
)
±±  !
{
≤≤ 
context
≥≥ 
.
≥≥ 
Database
≥≥ $
.
≥≥$ %
CloseConnection
≥≥% 4
(
≥≥4 5
)
≥≥5 6
;
≥≥6 7
throw
¥¥ 
;
¥¥ 
}
µµ 
context
∑∑ 
.
∑∑ 
Database
∑∑  
.
∑∑  !
CloseConnection
∑∑! 0
(
∑∑0 1
)
∑∑1 2
;
∑∑2 3
}
∏∏ 
return
ππ 
recordsTotal
ππ 
;
ππ  
}
∫∫ 	
public
ºº 
static
ºº 
bool
ºº 
ExecuteScalarBool
ºº ,
(
ºº, -
this
ºº- 1
	DbContext
ºº2 ;
context
ºº< C
,
ººC D
string
ººE K!
storedProcedureName
ººL _
,
ºº_ `
SqlParameter
ººa m
[
ººm n
]
ººn o

parameters
ººp z
)
ººz {
{
ΩΩ 	
bool
ææ 
ResData
ææ 
=
ææ 
false
ææ  
;
ææ  !
using
øø 
(
øø 
var
øø 
command
øø 
=
øø  
context
øø! (
.
øø( )
Database
øø) 1
.
øø1 2
GetDbConnection
øø2 A
(
øøA B
)
øøB C
.
øøC D
CreateCommand
øøD Q
(
øøQ R
)
øøR S
)
øøS T
{
¿¿ 
command
¡¡ 
.
¡¡ 
CommandType
¡¡ #
=
¡¡$ %
CommandType
¡¡& 1
.
¡¡1 2
StoredProcedure
¡¡2 A
;
¡¡A B
command
¬¬ 
.
¬¬ 
CommandText
¬¬ #
=
¬¬$ %!
storedProcedureName
¬¬& 9
;
¬¬9 :
command
√√ 
.
√√ 
CommandTimeout
√√ &
=
√√' (
$num
√√) ,
;
√√, -
command
ƒƒ 
.
ƒƒ 

Parameters
ƒƒ "
.
ƒƒ" #
AddRange
ƒƒ# +
(
ƒƒ+ ,

parameters
ƒƒ, 6
)
ƒƒ6 7
;
ƒƒ7 8
context
∆∆ 
.
∆∆ 
Database
∆∆  
.
∆∆  !
OpenConnection
∆∆! /
(
∆∆/ 0
)
∆∆0 1
;
∆∆1 2
try
»» 
{
…… 
string
   
result
   !
=
  " #
command
  $ +
.
  + ,
ExecuteScalar
  , 9
(
  9 :
)
  : ;
.
  ; <
ToString
  < D
(
  D E
)
  E F
;
  F G
bool
ÀÀ 
.
ÀÀ 
TryParse
ÀÀ !
(
ÀÀ! "
result
ÀÀ" (
,
ÀÀ( )
out
ÀÀ* -
ResData
ÀÀ. 5
)
ÀÀ5 6
;
ÀÀ6 7
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
Ex
ÕÕ! #
)
ÕÕ# $
{
ŒŒ 
context
œœ 
.
œœ 
Database
œœ $
.
œœ$ %
CloseConnection
œœ% 4
(
œœ4 5
)
œœ5 6
;
œœ6 7
throw
–– 
;
–– 
}
—— 
context
”” 
.
”” 
Database
””  
.
””  !
CloseConnection
””! 0
(
””0 1
)
””1 2
;
””2 3
}
‘‘ 
return
’’ 
ResData
’’ 
;
’’ 
}
÷÷ 	
public
ŸŸ 
static
ŸŸ 
string
ŸŸ !
ExecuteScalarString
ŸŸ 0
(
ŸŸ0 1
this
ŸŸ1 5
	DbContext
ŸŸ6 ?
context
ŸŸ@ G
,
ŸŸG H
string
ŸŸI O!
storedProcedureName
ŸŸP c
,
ŸŸc d
SqlParameter
ŸŸe q
[
ŸŸq r
]
ŸŸr s

parameters
ŸŸt ~
)
ŸŸ~ 
{
⁄⁄ 	
string
€€ 
respon
€€ 
;
€€ 
using
‹‹ 
(
‹‹ 
var
‹‹ 
command
‹‹ 
=
‹‹  
context
‹‹! (
.
‹‹( )
Database
‹‹) 1
.
‹‹1 2
GetDbConnection
‹‹2 A
(
‹‹A B
)
‹‹B C
.
‹‹C D
CreateCommand
‹‹D Q
(
‹‹Q R
)
‹‹R S
)
‹‹S T
{
›› 
command
ﬁﬁ 
.
ﬁﬁ 
CommandType
ﬁﬁ #
=
ﬁﬁ$ %
CommandType
ﬁﬁ& 1
.
ﬁﬁ1 2
StoredProcedure
ﬁﬁ2 A
;
ﬁﬁA B
command
ﬂﬂ 
.
ﬂﬂ 
CommandText
ﬂﬂ #
=
ﬂﬂ$ %!
storedProcedureName
ﬂﬂ& 9
;
ﬂﬂ9 :
command
‡‡ 
.
‡‡ 
CommandTimeout
‡‡ &
=
‡‡' (
$num
‡‡) ,
;
‡‡, -
command
·· 
.
·· 

Parameters
·· "
.
··" #
AddRange
··# +
(
··+ ,

parameters
··, 6
)
··6 7
;
··7 8
context
„„ 
.
„„ 
Database
„„  
.
„„  !
OpenConnection
„„! /
(
„„/ 0
)
„„0 1
;
„„1 2
try
ÂÂ 
{
ÊÊ 
string
ÁÁ 
result
ÁÁ !
=
ÁÁ" #
(
ÁÁ$ %
string
ÁÁ% +
)
ÁÁ+ ,
command
ÁÁ, 3
.
ÁÁ3 4
ExecuteScalar
ÁÁ4 A
(
ÁÁA B
)
ÁÁB C
;
ÁÁC D
respon
ËË 
=
ËË 
result
ËË #
;
ËË# $
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
)
ÍÍ  !
{
ÎÎ 
context
ÏÏ 
.
ÏÏ 
Database
ÏÏ $
.
ÏÏ$ %
CloseConnection
ÏÏ% 4
(
ÏÏ4 5
)
ÏÏ5 6
;
ÏÏ6 7
throw
ÌÌ 
;
ÌÌ 
}
ÓÓ 
context
 
.
 
Database
  
.
  !
CloseConnection
! 0
(
0 1
)
1 2
;
2 3
}
ÒÒ 
return
ÚÚ 
respon
ÚÚ 
;
ÚÚ 
}
ÛÛ 	
public
ıı 
static
ıı 
void
ıı 
ExecuteSPVoid
ıı (
(
ıı( )
this
ıı) -
	DbContext
ıı. 7
context
ıı8 ?
,
ıı? @
string
ııA G!
storedProcedureName
ııH [
,
ıı[ \
SqlParameter
ıı] i
[
ııi j
]
ııj k

parameters
ııl v
)
ııv w
{
ˆˆ 	
using
˜˜ 
(
˜˜ 
var
˜˜ 
command
˜˜ 
=
˜˜  
context
˜˜! (
.
˜˜( )
Database
˜˜) 1
.
˜˜1 2
GetDbConnection
˜˜2 A
(
˜˜A B
)
˜˜B C
.
˜˜C D
CreateCommand
˜˜D Q
(
˜˜Q R
)
˜˜R S
)
˜˜S T
{
¯¯ 
command
˘˘ 
.
˘˘ 
CommandType
˘˘ #
=
˘˘$ %
CommandType
˘˘& 1
.
˘˘1 2
StoredProcedure
˘˘2 A
;
˘˘A B
command
˙˙ 
.
˙˙ 
CommandText
˙˙ #
=
˙˙$ %!
storedProcedureName
˙˙& 9
;
˙˙9 :
command
˚˚ 
.
˚˚ 
CommandTimeout
˚˚ &
=
˚˚' (
$num
˚˚) ,
;
˚˚, -
command
¸¸ 
.
¸¸ 

Parameters
¸¸ "
.
¸¸" #
AddRange
¸¸# +
(
¸¸+ ,

parameters
¸¸, 6
)
¸¸6 7
;
¸¸7 8
context
˛˛ 
.
˛˛ 
Database
˛˛  
.
˛˛  !
OpenConnection
˛˛! /
(
˛˛/ 0
)
˛˛0 1
;
˛˛1 2
try
ÄÄ 
{
ÅÅ 
command
ÇÇ 
.
ÇÇ 
ExecuteReader
ÇÇ )
(
ÇÇ) *
)
ÇÇ* +
;
ÇÇ+ ,
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
)
ÑÑ  !
{
ÖÖ 
context
ÜÜ 
.
ÜÜ 
Database
ÜÜ $
.
ÜÜ$ %
CloseConnection
ÜÜ% 4
(
ÜÜ4 5
)
ÜÜ5 6
;
ÜÜ6 7
throw
áá 
;
áá 
}
àà 
context
ää 
.
ää 
Database
ää  
.
ää  !
CloseConnection
ää! 0
(
ää0 1
)
ää1 2
;
ää2 3
}
ãã 
}
åå 	
public
éé 
static
éé 
void
éé "
ExecuteSPVoidNoparam
éé /
(
éé/ 0
this
éé0 4
	DbContext
éé5 >
context
éé? F
,
ééF G
string
ééH N!
storedProcedureName
ééO b
)
ééb c
{
èè 	
using
êê 
(
êê 
var
êê 
command
êê 
=
êê  
context
êê! (
.
êê( )
Database
êê) 1
.
êê1 2
GetDbConnection
êê2 A
(
êêA B
)
êêB C
.
êêC D
CreateCommand
êêD Q
(
êêQ R
)
êêR S
)
êêS T
{
ëë 
command
íí 
.
íí 
CommandType
íí #
=
íí$ %
CommandType
íí& 1
.
íí1 2
StoredProcedure
íí2 A
;
ííA B
command
ìì 
.
ìì 
CommandTimeout
ìì &
=
ìì' (
$num
ìì) ,
;
ìì, -
command
îî 
.
îî 
CommandText
îî #
=
îî$ %!
storedProcedureName
îî& 9
;
îî9 :
context
ññ 
.
ññ 
Database
ññ  
.
ññ  !
OpenConnection
ññ! /
(
ññ/ 0
)
ññ0 1
;
ññ1 2
try
òò 
{
ôô 
command
öö 
.
öö 
ExecuteReader
öö )
(
öö) *
)
öö* +
;
öö+ ,
}
õõ 
catch
úú 
(
úú 
	Exception
úú  
)
úú  !
{
ùù 
context
ûû 
.
ûû 
Database
ûû $
.
ûû$ %
CloseConnection
ûû% 4
(
ûû4 5
)
ûû5 6
;
ûû6 7
throw
üü 
;
üü 
}
†† 
context
¢¢ 
.
¢¢ 
Database
¢¢  
.
¢¢  !
CloseConnection
¢¢! 0
(
¢¢0 1
)
¢¢1 2
;
¢¢2 3
}
££ 
}
§§ 	
public
¶¶ 
static
¶¶ 
async
¶¶ 
Task
¶¶  
<
¶¶  !
T
¶¶! "
>
¶¶" #"
ExecuteSPSingleAsync
¶¶$ 8
<
¶¶8 9
T
¶¶9 :
>
¶¶: ;
(
¶¶; <
this
¶¶< @
	DbContext
¶¶A J
context
¶¶K R
,
¶¶R S
string
¶¶T Z!
storedProcedureName
¶¶[ n
,
¶¶n o
SqlParameter
¶¶p |
[
¶¶| }
]
¶¶} ~

parameters¶¶ â
)¶¶â ä
{
ßß 	
T
®® 
returnObject
®® 
=
®® 
default
®® $
(
®®$ %
T
®®% &
)
®®& '
;
®®' (
using
™™ 
(
™™ 
var
™™ 
command
™™ 
=
™™  
context
™™! (
.
™™( )
Database
™™) 1
.
™™1 2
GetDbConnection
™™2 A
(
™™A B
)
™™B C
.
™™C D
CreateCommand
™™D Q
(
™™Q R
)
™™R S
)
™™S T
{
´´ 
command
¨¨ 
.
¨¨ 
CommandType
¨¨ #
=
¨¨$ %
CommandType
¨¨& 1
.
¨¨1 2
StoredProcedure
¨¨2 A
;
¨¨A B
command
≠≠ 
.
≠≠ 
CommandText
≠≠ #
=
≠≠$ %!
storedProcedureName
≠≠& 9
;
≠≠9 :
command
ÆÆ 
.
ÆÆ 
CommandTimeout
ÆÆ &
=
ÆÆ' (
$num
ÆÆ) ,
;
ÆÆ, -
command
ØØ 
.
ØØ 

Parameters
ØØ "
.
ØØ" #
AddRange
ØØ# +
(
ØØ+ ,

parameters
ØØ, 6
)
ØØ6 7
;
ØØ7 8
var
±± 
regex
±± 
=
±± 
await
±± !
RegexRequest
±±" .
.
±±. /$
RegexSQLInjectionAsync
±±/ E
(
±±E F

parameters
±±F P
)
±±P Q
;
±±Q R
if
≤≤ 
(
≤≤ 
!
≤≤ 
regex
≤≤ 
)
≤≤ 
{
≥≥ 
return
¥¥ 
returnObject
¥¥ '
;
¥¥' (
}
µµ 
try
∑∑ 
{
∏∏ 
await
ππ 
context
ππ !
.
ππ! "
Database
ππ" *
.
ππ* +!
OpenConnectionAsync
ππ+ >
(
ππ> ?
)
ππ? @
;
ππ@ A
using
ªª 
(
ªª 
var
ªª 

dataReader
ªª )
=
ªª* +
await
ªª, 1
command
ªª2 9
.
ªª9 : 
ExecuteReaderAsync
ªª: L
(
ªªL M
)
ªªM N
)
ªªN O
{
ºº 
returnObject
ΩΩ $
=
ΩΩ% &
await
ΩΩ' ,

dataReader
ΩΩ- 7
.
ΩΩ7 8
ToSingleAsync
ΩΩ8 E
<
ΩΩE F
T
ΩΩF G
>
ΩΩG H
(
ΩΩH I
)
ΩΩI J
;
ΩΩJ K
}
ææ 
}
øø 
finally
¿¿ 
{
¡¡ 
context
¬¬ 
.
¬¬ 
Database
¬¬ $
.
¬¬$ %
CloseConnection
¬¬% 4
(
¬¬4 5
)
¬¬5 6
;
¬¬6 7
}
√√ 
}
ƒƒ 
return
‰‰ 
returnObject
‰‰ 
;
‰‰  
}
ÂÂ 	
public
ÁÁ 
static
ÁÁ 
T
ÁÁ 
ExecuteSPSingle
ÁÁ '
<
ÁÁ' (
T
ÁÁ( )
>
ÁÁ) *
(
ÁÁ* +
this
ÁÁ+ /
	DbContext
ÁÁ0 9
context
ÁÁ: A
,
ÁÁA B
string
ÁÁC I!
storedProcedureName
ÁÁJ ]
,
ÁÁ] ^
SqlParameter
ÁÁ_ k
[
ÁÁk l
]
ÁÁl m

parameters
ÁÁn x
)
ÁÁx y
{
ËË 	
T
ÈÈ 
returnObject
ÈÈ 
=
ÈÈ 
default
ÈÈ $
(
ÈÈ$ %
T
ÈÈ% &
)
ÈÈ& '
;
ÈÈ' (
using
ÎÎ 
(
ÎÎ 
var
ÎÎ 
command
ÎÎ 
=
ÎÎ  
context
ÎÎ! (
.
ÎÎ( )
Database
ÎÎ) 1
.
ÎÎ1 2
GetDbConnection
ÎÎ2 A
(
ÎÎA B
)
ÎÎB C
.
ÎÎC D
CreateCommand
ÎÎD Q
(
ÎÎQ R
)
ÎÎR S
)
ÎÎS T
{
ÏÏ 
command
ÌÌ 
.
ÌÌ 
CommandType
ÌÌ #
=
ÌÌ$ %
CommandType
ÌÌ& 1
.
ÌÌ1 2
StoredProcedure
ÌÌ2 A
;
ÌÌA B
command
ÓÓ 
.
ÓÓ 
CommandText
ÓÓ #
=
ÓÓ$ %!
storedProcedureName
ÓÓ& 9
;
ÓÓ9 :
command
ÔÔ 
.
ÔÔ 
CommandTimeout
ÔÔ &
=
ÔÔ' (
$num
ÔÔ) ,
;
ÔÔ, -
command
 
.
 

Parameters
 "
.
" #
AddRange
# +
(
+ ,

parameters
, 6
)
6 7
;
7 8
context
ÚÚ 
.
ÚÚ 
Database
ÚÚ  
.
ÚÚ  !
OpenConnection
ÚÚ! /
(
ÚÚ/ 0
)
ÚÚ0 1
;
ÚÚ1 2
var
ÙÙ 
regex
ÙÙ 
=
ÙÙ 
RegexRequest
ÙÙ (
.
ÙÙ( )
RegexSQLInjection
ÙÙ) :
(
ÙÙ: ;

parameters
ÙÙ; E
)
ÙÙE F
;
ÙÙF G
if
ıı 
(
ıı 
!
ıı 
regex
ıı 
)
ıı 
{
ˆˆ 
return
˜˜ 
returnObject
˜˜ '
;
˜˜' (
}
¯¯ 
try
˙˙ 
{
˚˚ 
var
¸¸ 

dataReader
¸¸ "
=
¸¸# $
command
¸¸% ,
.
¸¸, -
ExecuteReader
¸¸- :
(
¸¸: ;
)
¸¸; <
;
¸¸< =
returnObject
˝˝  
=
˝˝! "
SQLAutoMapper
˝˝# 0
.
˝˝0 1
ToSingle
˝˝1 9
<
˝˝9 :
T
˝˝: ;
>
˝˝; <
(
˝˝< =

dataReader
˝˝= G
)
˝˝G H
;
˝˝H I
}
˛˛ 
catch
ˇˇ 
(
ˇˇ 
	Exception
ˇˇ  
)
ˇˇ  !
{
ÄÄ 
context
ÅÅ 
.
ÅÅ 
Database
ÅÅ $
.
ÅÅ$ %
CloseConnection
ÅÅ% 4
(
ÅÅ4 5
)
ÅÅ5 6
;
ÅÅ6 7
throw
ÇÇ 
;
ÇÇ 
}
ÉÉ 
context
ÖÖ 
.
ÖÖ 
Database
ÖÖ  
.
ÖÖ  !
CloseConnection
ÖÖ! 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ 
return
àà 
returnObject
àà 
;
àà  
}
ââ 	
public
ãã 
static
ãã 
async
ãã 
Task
ãã  
<
ãã  !
List
ãã! %
<
ãã% &
T
ãã& '
>
ãã' (
>
ãã( ) 
ExecuteSPListAsync
ãã* <
<
ãã< =
T
ãã= >
>
ãã> ?
(
ãã? @
this
ãã@ D
	DbContext
ããE N
context
ããO V
,
ããV W
string
ããX ^!
storedProcedureName
ãã_ r
,
ããr s
SqlParameterããt Ä
[ããÄ Å
]ããÅ Ç

parametersããÉ ç
)ããç é
{
åå 	
var
çç 
returnObject
çç 
=
çç 
new
çç "
List
çç# '
<
çç' (
T
çç( )
>
çç) *
(
çç* +
)
çç+ ,
;
çç, -
using
èè 
(
èè 
var
èè 
command
èè 
=
èè  
context
èè! (
.
èè( )
Database
èè) 1
.
èè1 2
GetDbConnection
èè2 A
(
èèA B
)
èèB C
.
èèC D
CreateCommand
èèD Q
(
èèQ R
)
èèR S
)
èèS T
{
êê 
command
ëë 
.
ëë 
CommandType
ëë #
=
ëë$ %
CommandType
ëë& 1
.
ëë1 2
StoredProcedure
ëë2 A
;
ëëA B
command
íí 
.
íí 
CommandText
íí #
=
íí$ %!
storedProcedureName
íí& 9
;
íí9 :
command
ìì 
.
ìì 
CommandTimeout
ìì &
=
ìì' (
$num
ìì) ,
;
ìì, -
command
îî 
.
îî 

Parameters
îî "
.
îî" #
AddRange
îî# +
(
îî+ ,

parameters
îî, 6
)
îî6 7
;
îî7 8
context
ññ 
.
ññ 
Database
ññ  
.
ññ  !
OpenConnection
ññ! /
(
ññ/ 0
)
ññ0 1
;
ññ1 2
var
òò 
regex
òò 
=
òò 
await
òò !
RegexRequest
òò" .
.
òò. /$
RegexSQLInjectionAsync
òò/ E
(
òòE F

parameters
òòF P
)
òòP Q
;
òòQ R
if
ôô 
(
ôô 
!
ôô 
regex
ôô 
)
ôô 
{
öö 
return
õõ 
returnObject
õõ '
;
õõ' (
}
úú 
try
ûû 
{
üü 
var
†† 

dataReader
†† "
=
††# $
await
††% *
command
††+ 2
.
††2 3 
ExecuteReaderAsync
††3 E
(
††E F
)
††F G
;
††G H
returnObject
°°  
=
°°! "
await
°°# (

dataReader
°°) 3
.
°°3 4
ToListAsync
°°4 ?
<
°°? @
T
°°@ A
>
°°A B
(
°°B C
)
°°C D
;
°°D E
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
)
££  !
{
§§ 
context
•• 
.
•• 
Database
•• $
.
••$ %
CloseConnection
••% 4
(
••4 5
)
••5 6
;
••6 7
throw
¶¶ 
;
¶¶ 
}
ßß 
context
©© 
.
©© 
Database
©©  
.
©©  !
CloseConnection
©©! 0
(
©©0 1
)
©©1 2
;
©©2 3
}
™™ 
return
¨¨ 
returnObject
¨¨ 
;
¨¨  
}
≠≠ 	
public
ØØ 
static
ØØ 
List
ØØ 
<
ØØ 
T
ØØ 
>
ØØ 
ExecuteSPList
ØØ +
<
ØØ+ ,
T
ØØ, -
>
ØØ- .
(
ØØ. /
this
ØØ/ 3
	DbContext
ØØ4 =
context
ØØ> E
,
ØØE F
string
ØØG M!
storedProcedureName
ØØN a
,
ØØa b
SqlParameter
ØØc o
[
ØØo p
]
ØØp q

parameters
ØØr |
)
ØØ| }
{
∞∞ 	
var
±± 
returnObject
±± 
=
±± 
new
±± "
List
±±# '
<
±±' (
T
±±( )
>
±±) *
(
±±* +
)
±±+ ,
;
±±, -
using
≥≥ 
(
≥≥ 
var
≥≥ 
command
≥≥ 
=
≥≥  
context
≥≥! (
.
≥≥( )
Database
≥≥) 1
.
≥≥1 2
GetDbConnection
≥≥2 A
(
≥≥A B
)
≥≥B C
.
≥≥C D
CreateCommand
≥≥D Q
(
≥≥Q R
)
≥≥R S
)
≥≥S T
{
¥¥ 
command
µµ 
.
µµ 
CommandType
µµ #
=
µµ$ %
CommandType
µµ& 1
.
µµ1 2
StoredProcedure
µµ2 A
;
µµA B
command
∂∂ 
.
∂∂ 
CommandTimeout
∂∂ &
=
∂∂' (
$num
∂∂) /
;
∂∂/ 0
command
∑∑ 
.
∑∑ 
CommandText
∑∑ #
=
∑∑$ %!
storedProcedureName
∑∑& 9
;
∑∑9 :
command
∏∏ 
.
∏∏ 

Parameters
∏∏ "
.
∏∏" #
AddRange
∏∏# +
(
∏∏+ ,

parameters
∏∏, 6
)
∏∏6 7
;
∏∏7 8
context
ππ 
.
ππ 
Database
ππ  
.
ππ  !
OpenConnection
ππ! /
(
ππ/ 0
)
ππ0 1
;
ππ1 2
var
ªª 
regex
ªª 
=
ªª 
RegexRequest
ªª (
.
ªª( )
RegexSQLInjection
ªª) :
(
ªª: ;

parameters
ªª; E
)
ªªE F
;
ªªF G
if
ºº 
(
ºº 
!
ºº 
regex
ºº 
)
ºº 
{
ΩΩ 
return
ææ 
returnObject
ææ '
;
ææ' (
}
øø 
try
¡¡ 
{
¬¬ 
var
√√ 

dataReader
√√ "
=
√√# $
command
√√% ,
.
√√, -
ExecuteReader
√√- :
(
√√: ;
)
√√; <
;
√√< =
returnObject
ƒƒ  
=
ƒƒ! "

dataReader
ƒƒ# -
.
ƒƒ- .
ToList
ƒƒ. 4
<
ƒƒ4 5
T
ƒƒ5 6
>
ƒƒ6 7
(
ƒƒ7 8
)
ƒƒ8 9
;
ƒƒ9 :
}
≈≈ 
catch
∆∆ 
(
∆∆ 
	Exception
∆∆  
)
∆∆  !
{
«« 
context
»» 
.
»» 
Database
»» $
.
»»$ %
CloseConnection
»»% 4
(
»»4 5
)
»»5 6
;
»»6 7
throw
…… 
;
…… 
}
   
context
ÃÃ 
.
ÃÃ 
Database
ÃÃ  
.
ÃÃ  !
CloseConnection
ÃÃ! 0
(
ÃÃ0 1
)
ÃÃ1 2
;
ÃÃ2 3
}
ÕÕ 
return
œœ 
returnObject
œœ 
;
œœ  
}
–– 	
public
““ 
static
““ 
List
““ 
<
““ 
T
““ 
>
““ "
ExecuteSPListNoParam
““ 2
<
““2 3
T
““3 4
>
““4 5
(
““5 6
this
““6 :
	DbContext
““; D
context
““E L
,
““L M
string
““N T!
storedProcedureName
““U h
)
““h i
{
”” 	
var
‘‘ 
returnObject
‘‘ 
=
‘‘ 
new
‘‘ "
List
‘‘# '
<
‘‘' (
T
‘‘( )
>
‘‘) *
(
‘‘* +
)
‘‘+ ,
;
‘‘, -
using
÷÷ 
(
÷÷ 
var
÷÷ 
command
÷÷ 
=
÷÷  
context
÷÷! (
.
÷÷( )
Database
÷÷) 1
.
÷÷1 2
GetDbConnection
÷÷2 A
(
÷÷A B
)
÷÷B C
.
÷÷C D
CreateCommand
÷÷D Q
(
÷÷Q R
)
÷÷R S
)
÷÷S T
{
◊◊ 
command
ÿÿ 
.
ÿÿ 
CommandType
ÿÿ #
=
ÿÿ$ %
CommandType
ÿÿ& 1
.
ÿÿ1 2
StoredProcedure
ÿÿ2 A
;
ÿÿA B
command
ŸŸ 
.
ŸŸ 
CommandText
ŸŸ #
=
ŸŸ$ %!
storedProcedureName
ŸŸ& 9
;
ŸŸ9 :
command
⁄⁄ 
.
⁄⁄ 
CommandTimeout
⁄⁄ &
=
⁄⁄' (
$num
⁄⁄) ,
;
⁄⁄, -
context
‹‹ 
.
‹‹ 
Database
‹‹  
.
‹‹  !
OpenConnection
‹‹! /
(
‹‹/ 0
)
‹‹0 1
;
‹‹1 2
try
ﬁﬁ 
{
ﬂﬂ 
var
‡‡ 

dataReader
‡‡ "
=
‡‡# $
command
‡‡% ,
.
‡‡, -
ExecuteReader
‡‡- :
(
‡‡: ;
)
‡‡; <
;
‡‡< =
returnObject
··  
=
··! "

dataReader
··# -
.
··- .
ToList
··. 4
<
··4 5
T
··5 6
>
··6 7
(
··7 8
)
··8 9
;
··9 :
}
‚‚ 
catch
„„ 
(
„„ 
	Exception
„„  
)
„„  !
{
‰‰ 
context
ÂÂ 
.
ÂÂ 
Database
ÂÂ $
.
ÂÂ$ %
CloseConnection
ÂÂ% 4
(
ÂÂ4 5
)
ÂÂ5 6
;
ÂÂ6 7
throw
ÊÊ 
;
ÊÊ 
}
ÁÁ 
context
ÈÈ 
.
ÈÈ 
Database
ÈÈ  
.
ÈÈ  !
CloseConnection
ÈÈ! 0
(
ÈÈ0 1
)
ÈÈ1 2
;
ÈÈ2 3
}
ÍÍ 
return
ÏÏ 
returnObject
ÏÏ 
;
ÏÏ  
}
ÌÌ 	
}
 
}ÒÒ ât
HD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\SQLAutoMapper.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{		 
public

 

static

 
class

 
SQLAutoMapper

 %
{ 
public 
static 
async 
Task  
<  !
T! "
>" #
ToSingleAsync$ 1
<1 2
T2 3
>3 4
(4 5
this5 9
DbDataReader: F

dataReaderG Q
)Q R
{ 	
if 
( 

dataReader 
== 
null "
||# %
!& '

dataReader' 1
.1 2
HasRows2 9
)9 :
return 
default 
( 
T  
)  !
;! "
var 

returnType 
= 
typeof #
(# $
T$ %
)% &
;& '
T 
returnObject 
= 
( 
T 
)  
	Activator  )
.) *
CreateInstance* 8
(8 9

returnType9 C
)C D
;D E
var "
returnObjectProperties &
=' (

returnType) 3
.3 4
GetProperties4 A
(A B
BindingFlagsB N
.N O
InstanceO W
|X Y
BindingFlagsZ f
.f g
Publicg m
)m n
. 
ToDictionary 
( 
property &
=>' )
property* 2
.2 3
Name3 7
,7 8
property9 A
=>B D
propertyE M
)M N
;N O
await 

dataReader 
. 
	ReadAsync &
(& '
)' (
;( )
for 
( 
int 
i 
= 
$num 
; 
i 
< 

dataReader  *
.* +

FieldCount+ 5
;5 6
i7 8
++8 :
): ;
{ 
string 
colName 
=  

dataReader! +
.+ ,
GetName, 3
(3 4
i4 5
)5 6
;6 7
if 
( "
returnObjectProperties *
.* +
ContainsKey+ 6
(6 7
colName7 >
)> ?
)? @
{ 
var 
propertyInfo $
=% &"
returnObjectProperties' =
[= >
colName> E
]E F
;F G
if   
(   
propertyInfo   $
!=  % '
null  ( ,
&&  - /
propertyInfo  0 <
.  < =
CanWrite  = E
)  E F
{!! 
var"" 
colValue"" $
=""% &

dataReader""' 1
.""1 2
GetValue""2 :
("": ;
i""; <
)""< =
;""= >
var## 
isNull## "
=### $
string##% +
.##+ ,
IsNullOrEmpty##, 9
(##9 :
colValue##: B
.##B C
ToString##C K
(##K L
)##L M
)##M N
;##N O
propertyInfo$$ $
.$$$ %
SetValue$$% -
($$- .
returnObject$$. :
,$$: ;
isNull$$< B
?$$C D
null$$E I
:$$J K
colValue$$L T
)$$T U
;$$U V
}%% 
}&& 
}'' 
return)) 
returnObject)) 
;))  
}** 	
public,, 
static,, 
T,, 
ToSingle,,  
<,,  !
T,,! "
>,," #
(,,# $
this,,$ (
DbDataReader,,) 5

dataReader,,6 @
),,@ A
{-- 	
if.. 
(.. 

dataReader.. 
==.. 
null.. "
||..# %
!..& '

dataReader..' 1
...1 2
HasRows..2 9
)..9 :
return// 
default// 
(// 
T//  
)//  !
;//! "
var11 

returnType11 
=11 
typeof11 #
(11# $
T11$ %
)11% &
;11& '
T22 
returnObject22 
=22 
(22 
T22 
)22  
	Activator22  )
.22) *
CreateInstance22* 8
(228 9

returnType229 C
)22C D
;22D E
var33 "
returnObjectProperties33 &
=33' (

returnType33) 3
.333 4
GetProperties334 A
(33A B
BindingFlags33B N
.33N O
Instance33O W
|33X Y
BindingFlags33Z f
.33f g
Public33g m
)33m n
.44 
ToDictionary44 
(44 
property44 &
=>44' )
property44* 2
.442 3
Name443 7
,447 8
property449 A
=>44B D
property44E M
)44M N
;44N O

dataReader66 
.66 
Read66 
(66 
)66 
;66 
for88 
(88 
int88 
i88 
=88 
$num88 
;88 
i88 
<88 

dataReader88  *
.88* +

FieldCount88+ 5
;885 6
i887 8
++888 :
)88: ;
{99 
string:: 
colName:: 
=::  

dataReader::! +
.::+ ,
GetName::, 3
(::3 4
i::4 5
)::5 6
;::6 7
if<< 
(<< "
returnObjectProperties<< *
.<<* +
ContainsKey<<+ 6
(<<6 7
colName<<7 >
)<<> ?
)<<? @
{== 
var>> 
propertyInfo>> $
=>>% &"
returnObjectProperties>>' =
[>>= >
colName>>> E
]>>E F
;>>F G
if@@ 
(@@ 
propertyInfo@@ $
!=@@% '
null@@( ,
&&@@- /
propertyInfo@@0 <
.@@< =
CanWrite@@= E
)@@E F
{AA 
varBB 
colValueBB $
=BB% &

dataReaderBB' 1
.BB1 2
GetValueBB2 :
(BB: ;
iBB; <
)BB< =
;BB= >
varCC 
isNullCC "
=CC# $
stringCC% +
.CC+ ,
IsNullOrEmptyCC, 9
(CC9 :
colValueCC: B
.CCB C
ToStringCCC K
(CCK L
)CCL M
)CCM N
;CCN O
propertyInfoDD $
.DD$ %
SetValueDD% -
(DD- .
returnObjectDD. :
,DD: ;
isNullDD< B
?DDC D
nullDDE I
:DDJ K
colValueDDL T
)DDT U
;DDU V
}EE 
}FF 
}GG 
returnII 
returnObjectII 
;II  
}JJ 	
publicLL 
staticLL 
asyncLL 
TaskLL  
<LL  !
ListLL! %
<LL% &
TLL& '
>LL' (
>LL( )
ToListAsyncLL* 5
<LL5 6
TLL6 7
>LL7 8
(LL8 9
thisLL9 =
DbDataReaderLL> J

dataReaderLLK U
)LLU V
{MM 	
ifNN 
(NN 

dataReaderNN 
==NN 
nullNN "
||NN# %
!NN& '

dataReaderNN' 1
.NN1 2
HasRowsNN2 9
)NN9 :
returnOO 
nullOO 
;OO 
varQQ 
returnObjectListQQ  
=QQ! "
newQQ# &
ListQQ' +
<QQ+ ,
TQQ, -
>QQ- .
(QQ. /
)QQ/ 0
;QQ0 1
varRR 

returnTypeRR 
=RR 
typeofRR #
(RR# $
TRR$ %
)RR% &
;RR& '
varSS "
returnObjectPropertiesSS &
=SS' (

returnTypeSS) 3
.SS3 4
GetPropertiesSS4 A
(SSA B
BindingFlagsSSB N
.SSN O
InstanceSSO W
|SSX Y
BindingFlagsSSZ f
.SSf g
PublicSSg m
)SSm n
.TT 
ToDictionaryTT 
(TT 
propertyTT &
=>TT' )
propertyTT* 2
.TT2 3
NameTT3 7
,TT7 8
propertyTT9 A
=>TTB D
propertyTTE M
)TTM N
;TTN O
whileVV 
(VV 
awaitVV 

dataReaderVV #
.VV# $
	ReadAsyncVV$ -
(VV- .
)VV. /
)VV/ 0
{WW 
TXX 
returnObjectXX 
=XX  
(XX! "
TXX" #
)XX# $
	ActivatorXX$ -
.XX- .
CreateInstanceXX. <
(XX< =

returnTypeXX= G
)XXG H
;XXH I
forZZ 
(ZZ 
intZZ 
iZZ 
=ZZ 
$numZZ 
;ZZ 
iZZ  !
<ZZ" #

dataReaderZZ$ .
.ZZ. /

FieldCountZZ/ 9
;ZZ9 :
iZZ; <
++ZZ< >
)ZZ> ?
{[[ 
string\\ 
colName\\ "
=\\# $

dataReader\\% /
.\\/ 0
GetName\\0 7
(\\7 8
i\\8 9
)\\9 :
;\\: ;
if^^ 
(^^ "
returnObjectProperties^^ .
.^^. /
ContainsKey^^/ :
(^^: ;
colName^^; B
)^^B C
)^^C D
{__ 
var`` 
propertyInfo`` (
=``) *"
returnObjectProperties``+ A
[``A B
colName``B I
]``I J
;``J K
ifbb 
(bb 
propertyInfobb (
!=bb) +
nullbb, 0
&&bb1 3
propertyInfobb4 @
.bb@ A
CanWritebbA I
)bbI J
{cc 
vardd 
colValuedd  (
=dd) *

dataReaderdd+ 5
.dd5 6
GetValuedd6 >
(dd> ?
idd? @
)dd@ A
;ddA B
varee 
isNullee  &
=ee' (
stringee) /
.ee/ 0
IsNullOrEmptyee0 =
(ee= >
colValueee> F
.eeF G
ToStringeeG O
(eeO P
)eeP Q
)eeQ R
;eeR S
propertyInfoff (
.ff( )
SetValueff) 1
(ff1 2
returnObjectff2 >
,ff> ?
isNullff@ F
?ffG H
nullffI M
:ffN O
colValueffP X
)ffX Y
;ffY Z
}gg 
}hh 
}ii 
returnObjectListkk  
.kk  !
Addkk! $
(kk$ %
returnObjectkk% 1
)kk1 2
;kk2 3
}ll 
returnnn 
returnObjectListnn #
;nn# $
}oo 	
publicqq 
staticqq 
Listqq 
<qq 
Tqq 
>qq 
ToListqq $
<qq$ %
Tqq% &
>qq& '
(qq' (
thisqq( ,
DbDataReaderqq- 9

dataReaderqq: D
)qqD E
{rr 	
ifss 
(ss 

dataReaderss 
==ss 
nullss "
||ss# %
!ss& '

dataReaderss' 1
.ss1 2
HasRowsss2 9
)ss9 :
returntt 
nulltt 
;tt 
varvv 
returnObjectListvv  
=vv! "
newvv# &
Listvv' +
<vv+ ,
Tvv, -
>vv- .
(vv. /
)vv/ 0
;vv0 1
varww 

returnTypeww 
=ww 
typeofww #
(ww# $
Tww$ %
)ww% &
;ww& '
varxx "
returnObjectPropertiesxx &
=xx' (

returnTypexx) 3
.xx3 4
GetPropertiesxx4 A
(xxA B
BindingFlagsxxB N
.xxN O
InstancexxO W
|xxX Y
BindingFlagsxxZ f
.xxf g
Publicxxg m
)xxm n
.yy 
ToDictionaryyy 
(yy 
propertyyy &
=>yy' )
propertyyy* 2
.yy2 3
Nameyy3 7
,yy7 8
propertyyy9 A
=>yyB D
propertyyyE M
)yyM N
;yyN O
while{{ 
({{ 

dataReader{{ 
.{{ 
Read{{ "
({{" #
){{# $
){{$ %
{|| 
T}} 
returnObject}} 
=}}  
(}}! "
T}}" #
)}}# $
	Activator}}$ -
.}}- .
CreateInstance}}. <
(}}< =

returnType}}= G
)}}G H
;}}H I
for 
( 
int 
i 
= 
$num 
; 
i  !
<" #

dataReader$ .
.. /

FieldCount/ 9
;9 :
i; <
++< >
)> ?
{
ÄÄ 
string
ÅÅ 
colName
ÅÅ "
=
ÅÅ# $

dataReader
ÅÅ% /
.
ÅÅ/ 0
GetName
ÅÅ0 7
(
ÅÅ7 8
i
ÅÅ8 9
)
ÅÅ9 :
;
ÅÅ: ;
if
ÉÉ 
(
ÉÉ $
returnObjectProperties
ÉÉ .
.
ÉÉ. /
ContainsKey
ÉÉ/ :
(
ÉÉ: ;
colName
ÉÉ; B
)
ÉÉB C
)
ÉÉC D
{
ÑÑ 
var
ÖÖ 
propertyInfo
ÖÖ (
=
ÖÖ) *$
returnObjectProperties
ÖÖ+ A
[
ÖÖA B
colName
ÖÖB I
]
ÖÖI J
;
ÖÖJ K
if
áá 
(
áá 
propertyInfo
áá (
!=
áá) +
null
áá, 0
&&
áá1 3
propertyInfo
áá4 @
.
áá@ A
CanWrite
ááA I
)
ááI J
{
àà 
var
ââ 
colValue
ââ  (
=
ââ) *

dataReader
ââ+ 5
.
ââ5 6
GetValue
ââ6 >
(
ââ> ?
i
ââ? @
)
ââ@ A
;
ââA B
var
ää 
isNull
ää  &
=
ää' (
string
ää) /
.
ää/ 0
IsNullOrEmpty
ää0 =
(
ää= >
colValue
ää> F
.
ääF G
ToString
ääG O
(
ääO P
)
ääP Q
)
ääQ R
;
ääR S
propertyInfo
ãã (
.
ãã( )
SetValue
ãã) 1
(
ãã1 2
returnObject
ãã2 >
,
ãã> ?
isNull
ãã@ F
?
ããG H
null
ããI M
:
ããN O
colValue
ããP X
)
ããX Y
;
ããY Z
}
åå 
}
çç 
}
éé 
returnObjectList
êê  
.
êê  !
Add
êê! $
(
êê$ %
returnObject
êê% 1
)
êê1 2
;
êê2 3
}
ëë 
return
ìì 
returnObjectList
ìì #
;
ìì# $
}
îî 	
}
ïï 
}ññ ú
LD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\SessionExtensions.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{		 
public

 

static

 
class

 
SessionExtensions

 )
{ 
public 
static 
void 
	SetObject $
($ %
this% )
ISession* 2
session3 :
,: ;
string< B
keyC F
,F G
objectH N
valueO T
)T U
{ 	
session 
. 
	SetString 
( 
key !
,! "
JsonConvert# .
.. /
SerializeObject/ >
(> ?
value? D
)D E
)E F
;F G
} 	
public 
static 
T 
	GetObject !
<! "
T" #
># $
($ %
this% )
ISession* 2
session3 :
,: ;
string< B
keyC F
)F G
{ 	
var 
value 
= 
session 
.  
	GetString  )
() *
key* -
)- .
;. /
return 
value 
== 
null  
?! "
default# *
(* +
T+ ,
), -
:. /
JsonConvert0 ;
.; <
DeserializeObject< M
<M N
TN O
>O P
(P Q
valueQ V
)V W
;W X
} 	
} 
} Ë8
ID:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\SessionConstan.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{		 
public

 

class

 
SessionConstan

 
{ 
public 
static 
string 

Session_Id '
=( )
$str* 7
;7 8
public 
static 
string 
Session_User_Id ,
=- .
$str/ A
;A B
public 
const 
string  
Session_Nama_Pegawai 0
=1 2
$str3 J
;J K
public 
const 
string 
Session_NPP_Pegawai /
=0 1
$str2 H
;H I
public 
const 
string 
Session_Pegawai_Id .
=/ 0
$str1 F
;F G
public 
const 
string 
Session_Nama_Unit -
=. /
$str0 D
;D E
public 
const 
string 
Session_Unit_Id +
=, -
$str. @
;@ A
public 
const 
string 
Session_Role_Id +
=, -
$str. @
;@ A
public 
const 
string  
Session_Role_Unit_Id 0
=1 2
$str3 J
;J K
public 
const 
string 
Session_Nama_Role -
=. /
$str0 D
;D E
public 
const 
string "
Session_Role_Nama_Unit 2
=3 4
$str5 N
;N O
public 
const 
string 
Session_Status_Role /
=0 1
$str2 H
;H I
public 
const 
string  
Session_User_Role_Id 0
=1 2
$str3 J
;J K
public 
const 
string 
Session_SegmenId ,
=- .
$str/ B
;B C
public 
const 
string 
Session_Segmen *
=+ ,
$str- >
;> ?
public 
const 
string 
Session_Jabatan +
=, -
$str. @
;@ A
public 
const 
string 
Session_Menu (
=) *
$str+ :
;: ;
public 
const 
string $
Session_Username_Pegawai 4
=5 6
$str7 R
;R S
public 
const 
string 
Session_Province ,
=- .
$str/ B
;B C
public 
const 
string 
Session_District ,
=- .
$str/ B
;B C
public   
const   
string   
Session_Puskesmas   -
=  . /
$str  0 D
;  D E
public!! 
const!! 
string!! 
Session_LastLogin!! -
=!!. /
$str!!0 D
;!!D E
public"" 
const"" 
string"" 
Session_UnitId"" *
=""+ ,
$str""- >
;""> ?
public$$ 
static$$	 
string$$ 
Session_UserId$$ %
=$$& '
$str$$( 9
;$$9 :
public%% 
static%%	 
string%% 
Session_RoleKode%% '
=%%( )
$str%%* =
;%%= >
public&& 
static&&	 
string&& 
Session_RoleName&& '
=&&( )
$str&&* =
;&&= >
public'' 
static''	 
string'' 
Session_Name'' #
=''$ %
$str''& 5
;''5 6
public(( 
static((	 
string(( 
Session_Email(( $
=((% &
$str((' 7
;((7 8
public)) 
static))	 
string)) 
Session_Alamat)) %
=))& '
$str))( 9
;))9 :
public** 
static**	 
string** 
Session_NoHP** #
=**$ %
$str**& 5
;**5 6
public++ 
static++	 
string++ 
Session_IsOTP++ $
=++% &
$str++' 7
;++7 8
public,, 
static,,	 
string,,  
Session_IsVerifEmail,, +
=,,, -
$str,,. E
;,,E F
public-- 
static--	 
string-- !
Session_IsVerifNoTelp-- ,
=--- .
$str--/ G
;--G H
public.. 
static..	 
string.. 
Session_Token.. $
=..% &
$str..' 7
;..7 8
public// 
static//	 
string//  
Session_RefreshToken// +
=//, -
$str//. E
;//E F
public33 
static33	 
string33 
Sess_Nama_Pegawai33 (
;33( )
public44 
static44 
string44 
Sess_Pegawai_Id44 ,
;44, -
public55 
static55 
string55 
Sess_Unit_Id55 )
;55) *
public66 
static66 
string66 
Sess_Nama_Unit66 +
;66+ ,
public77 
static77 
string77 
Sess_Nama_Id77 )
;77) *
public88 
static88 
string88 
Sess_User_Role_Id88 .
;88. /
public99 
static99 
string99 
Sess_Role_Id99 )
;99) *
public:: 
static:: 
string:: 
Sess_Nama_Role:: +
;::+ ,
public;; 
static;; 
string;; 
Sess_Role_Nama_Unit;; 0
;;;0 1
public<< 
static<< 
string<< 
Sess_Images_User<< -
;<<- .
public== 
static== 
string== 
Sess_Status_Role== -
;==- .
public>> 
static>> 
string>> 
Sess_SegmenId>> *
;>>* +
public?? 
static?? 
string?? 
Sess_Segmen?? (
;??( )
public@@ 
static@@ 
string@@ 
Sess_Jabatan@@ )
;@@) *
publicAA 
staticAA 
stringAA 
	Sess_MenuAA &
;AA& '
publicBB 
staticBB 
stringBB 
CurrentPathBB (
;BB( )
publicCC 
staticCC 
stringCC 
Sess_ProvinceCC *
;CC* +
publicDD 
staticDD 
stringDD !
Sess_Username_PegawaiDD 2
;DD2 3
publicEE 
staticEE 
stringEE 
Sess_DistrictEE *
;EE* +
publicFF 
staticFF 
stringFF 
Sess_PuskesmasFF +
;FF+ ,
publicGG 
staticGG 
stringGG 
Sess_LastLoginGG +
;GG+ ,
}II 
}JJ ŸÕ
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\SendToDeva.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{		 
public

 

class

 

SendToDeva

 
{ 
private 
readonly 

IConverter #

_converter$ .
;. /
public 

SendToDeva 
( 

IConverter $
	converter% .
). /
{ 	

_converter 
= 
	converter "
;" #
} 	
public 
async 
Task 
SendToDevaNod '
(' (
string( .
Ids/ 2
)2 3
{ 	%
DbDashboardDevaBniContext %
_context& .
=/ 0
new1 4%
DbDashboardDevaBniContext5 N
(N O
)O P
;P Q
try 
{ 
string 
[ 
] 
ArrayIds !
=" #
Ids$ '
.' (
Split( -
(- .
$char. 1
)1 2
;2 3
foreach 
( 
var 
item !
in" $
ArrayIds% -
)- .
{ 
var 

dataAssign "
=# $
await% *
_context+ 3
.3 4$
TblNoticeOfDisbursements4 L
.L M
WhereM R
(R S
mS T
=>U W
mX Y
.Y Z
IdZ \
==] _
int` c
.c d
Parsed i
(i j
itemj n
)n o
&&p r
ms t
.t u
	IsDeletedu ~
==	 Å
$num
Ç É
)
É Ñ
.
Ñ Ö!
FirstOrDefaultAsync
Ö ò
(
ò ô
)
ô ö
;
ö õ0
$NoticeOfDisbursementToAPI_ViewModels 8
model9 >
=? @
newA D0
$NoticeOfDisbursementToAPI_ViewModelsE i
(i j
)j k
;k l
model   
.   
NodNo   
=    !

dataAssign  " ,
.  , -
NodNo  - 2
;  2 3
model!! 
.!! 
NodDate!! !
=!!" #

dataAssign!!$ .
.!!. /
NodDate!!/ 6
;!!6 7
model"" 
."" 
	ValueDate"" #
=""$ %

dataAssign""& 0
.""0 1
	ValueDate""1 :
;"": ;
model## 
.## 
Cur## 
=## 

dataAssign##  *
.##* +
Cur##+ .
;##. /
model$$ 
.$$ 
	NodDetail$$ #
=$$$ %
_context$$& .
.$$. /*
TblNoticeOfDisbursementDetails$$/ M
.$$M N
Where$$N S
($$S T
m$$T U
=>$$V X
m$$Y Z
.$$Z [
NodId$$[ `
==$$a c
int$$d g
.$$g h
Parse$$h m
($$m n
item$$n r
)$$r s
&&$$t v
m$$w x
.$$x y
	IsDeleted	$$y Ç
==
$$É Ö
$num
$$Ü á
)
$$á à
.
$$à â
ToList
$$â è
(
$$è ê
)
$$ê ë
;
$$ë í
if'' 
('' 

dataAssign'' "
.''" #
IdNodFromApi''# /
!=''0 2
null''3 7
)''7 8
{(( 
var))  
jsonParseReturnCheck)) 0
=))1 2
JsonConvert))3 >
.))> ?
DeserializeObject))? P
<))P Q
ResultStatusDataInt))Q d
<))d e
ResultStatusDataNod))e x
>))x y
>))y z
())z {
$str)){ }
)))} ~
;))~ 
var** 
urlCheck** $
=**% &
	GetConfig**' 0
.**0 1

AppSetting**1 ;
[**; <
$str**< M
]**M N
+**O P
	GetConfig**Q Z
.**Z [

AppSetting**[ e
[**e f
$str**f 
]	** Ä
+
**Å Ç

dataAssign
**É ç
.
**ç é
IdNodFromApi
**é ö
;
**ö õ
(++ 
bool++ 
resultApiCheck++ ,
,++, -
string++. 4
resultCheck++5 @
)++@ A
=++B C
RequestToAPI++D P
.++P Q
GetJsonStringWebApi++Q d
(++d e
urlCheck++e m
,++m n
null++o s
)++s t
;++t u
if,, 
(,, 
resultApiCheck,, *
&&,,+ -
!,,. /
string,,/ 5
.,,5 6
IsNullOrEmpty,,6 C
(,,C D
resultCheck,,D O
),,O P
),,P Q
{--  
jsonParseReturnCheck.. 0
=..1 2
JsonConvert..3 >
...> ?
DeserializeObject..? P
<..P Q
ResultStatusDataInt..Q d
<..d e
ResultStatusDataNod..e x
>..x y
>..y z
(..z {
resultCheck	..{ Ü
)
..Ü á
;
..á à
if// 
(//   
jsonParseReturnCheck//  4
.//4 5

StatusCode//5 ?
==//@ B
$num//C F
||//G I 
jsonParseReturnCheck//J ^
.//^ _

StatusCode//_ i
==//j l
$num//m p
)//p q
{00 
if11  "
(11# $ 
jsonParseReturnCheck11$ 8
.118 9
Data119 =
.11= >
Status11> D
==11E G
$str11H T
)11T U
{22  !
List44$ (
<44( ))
TblNoticeOfDisbursementDetail44) F
>44F G
dataAssignDetail44H X
=44Y Z
_context44[ c
.44c d+
TblNoticeOfDisbursementDetails	44d Ç
.
44Ç É
Where
44É à
(
44à â
m
44â ä
=>
44ã ç
m
44é è
.
44è ê
NodId
44ê ï
==
44ñ ò
int
44ô ú
.
44ú ù
Parse
44ù ¢
(
44¢ £
item
44£ ß
)
44ß ®
&&
44© ´
m
44¨ ≠
.
44≠ Æ
	IsDeleted
44Æ ∑
==
44∏ ∫
$num
44ª º
)
44º Ω
.
44Ω æ
ToList
44æ ƒ
(
44ƒ ≈
)
44≈ ∆
;
44∆ «
List55$ (
<55( ))
TblNoticeOfDisbursementDetail55) F
>55F G#
dataAssignDetailDeleted55H _
=55` a
_context55b j
.55j k+
TblNoticeOfDisbursementDetails	55k â
.
55â ä
Where
55ä è
(
55è ê
m
55ê ë
=>
55í î
m
55ï ñ
.
55ñ ó
NodId
55ó ú
==
55ù ü
int
55† £
.
55£ §
Parse
55§ ©
(
55© ™
item
55™ Æ
)
55Æ Ø
&&
55∞ ≤
m
55≥ ¥
.
55¥ µ 
IdNodDetailFromApi
55µ «
!=
55»  
null
55À œ
&&
55– “
m
55” ‘
.
55‘ ’
	IsDeleted
55’ ﬁ
==
55ﬂ ·
$num
55‚ „
&&
55‰ Ê
m
55Á Ë
.
55Ë È
IsActive
55È Ò
==
55Ú Ù
$num
55ı ˆ
)
55ˆ ˜
.
55˜ ¯
ToList
55¯ ˛
(
55˛ ˇ
)
55ˇ Ä
;
55Ä Å
foreach77$ +
(77, -
var77- 0
itemDetailDelete771 A
in77B D#
dataAssignDetailDeleted77E \
)77\ ]
{88$ %
if99( *
(99+ ,
itemDetailDelete99, <
.99< =
IdNodDetailFromApi99= O
!=99P R
null99S W
)99W X
{::( )
var;;, /'
jsonParseReturnUpdateDetail;;0 K
=;;L M
JsonConvert;;N Y
.;;Y Z
DeserializeObject;;Z k
<;;k l
ResultStatusDataInt;;l 
<	;; Ä!
ResultStatusDataNod
;;Ä ì
>
;;ì î
>
;;î ï
(
;;ï ñ
$str
;;ñ ò
)
;;ò ô
;
;;ô ö
var<<, /
urlUpdateDetail<<0 ?
=<<@ A
	GetConfig<<B K
.<<K L

AppSetting<<L V
[<<V W
$str<<W h
]<<h i
+<<j k
	GetConfig<<l u
.<<u v

AppSetting	<<v Ä
[
<<Ä Å
$str
<<Å õ
]
<<õ ú
+
<<ù û
itemDetailDelete
<<ü Ø
.
<<Ø ∞ 
IdNodDetailFromApi
<<∞ ¬
;
<<¬ √
(==, -
bool==- 1!
resultApiUpdateDetail==2 G
,==G H
string==I O
resultUpdateDetail==P b
)==b c
===d e
RequestToAPI==f r
.==r s"
DeleteRequestToWebApi	==s à
(
==à â
urlUpdateDetail
==â ò
,
==ò ô
null
==ö û
)
==û ü
;
==ü †
if>>, .
(>>/ 0!
resultApiUpdateDetail>>0 E
&&>>F H
!>>I J
string>>J P
.>>P Q
IsNullOrEmpty>>Q ^
(>>^ _
resultUpdateDetail>>_ q
)>>q r
)>>r s
{??, -'
jsonParseReturnUpdateDetail@@0 K
=@@L M
JsonConvert@@N Y
.@@Y Z
DeserializeObject@@Z k
<@@k l
ResultStatusDataInt@@l 
<	@@ Ä!
ResultStatusDataNod
@@Ä ì
>
@@ì î
>
@@î ï
(
@@ï ñ 
resultUpdateDetail
@@ñ ®
)
@@® ©
;
@@© ™
ifAA0 2
(AA3 4'
jsonParseReturnUpdateDetailAA4 O
.AAO P

StatusCodeAAP Z
==AA[ ]
$numAA^ a
||AAb d(
jsonParseReturnUpdateDetail	AAe Ä
.
AAÄ Å

StatusCode
AAÅ ã
==
AAå é
$num
AAè í
)
AAí ì
{BB0 1
itemDetailDeleteCC4 D
.CCD E
IsActiveCCE M
=CCN O
$numCCP Q
;CCQ R
itemDetailDeleteDD4 D
.DDD E
	IsDeletedDDE N
=DDO P
$numDDQ R
;DDR S
_contextEE4 <
.EE< =
EntryEE= B
(EEB C
itemDetailDeleteEEC S
)EES T
.EET U
StateEEU Z
=EE[ \
EntityStateEE] h
.EEh i
ModifiedEEi q
;EEq r
_contextFF4 <
.FF< =
SaveChangesFF= H
(FFH I
)FFI J
;FFJ K
}GG0 1
}HH, -
}II( )
}JJ$ %
foreachLL$ +
(LL, -
varLL- 0

itemDetailLL1 ;
inLL< >
dataAssignDetailLL? O
)LLO P
{MM$ %
ifOO( *
(OO+ ,

itemDetailOO, 6
.OO6 7
IdNodDetailFromApiOO7 I
!=OOJ L
nullOOM Q
)OOQ R
{PP( )
varQQ, /'
jsonParseReturnUpdateDetailQQ0 K
=QQL M
JsonConvertQQN Y
.QQY Z
DeserializeObjectQQZ k
<QQk l
ResultStatusDataIntQQl 
<	QQ Ä!
ResultStatusDataNod
QQÄ ì
>
QQì î
>
QQî ï
(
QQï ñ
$str
QQñ ò
)
QQò ô
;
QQô ö
varRR, /
urlUpdateDetailRR0 ?
=RR@ A
	GetConfigRRB K
.RRK L

AppSettingRRL V
[RRV W
$strRRW h
]RRh i
+RRj k
	GetConfigRRl u
.RRu v

AppSetting	RRv Ä
[
RRÄ Å
$str
RRÅ õ
]
RRõ ú
+
RRù û

itemDetail
RRü ©
.
RR© ™ 
IdNodDetailFromApi
RR™ º
;
RRº Ω
(SS, -
boolSS- 1!
resultApiUpdateDetailSS2 G
,SSG H
stringSSI O
resultUpdateDetailSSP b
)SSb c
=SSd e
RequestToAPISSf r
.SSr s
PutRequestToWebApi	SSs Ö
(
SSÖ Ü
urlUpdateDetail
SSÜ ï
,
SSï ñ
new
SSó ö
{TT, -
NodIdUU0 5
=UU6 7

dataAssignUU8 B
.UUB C
IdNodFromApiUUC O
,UUO P
CreditorRefVV0 ;
=VV< =

itemDetailVV> H
.VVH I
CreditorRefVVI T
,VVT U
AmountWW0 6
=WW7 8

itemDetailWW9 C
.WWC D
AmountWWD J
,WWJ K
	AmountIDRXX0 9
=XX: ;

itemDetailXX< F
.XXF G
	AmountIdrXXG P
}YY, -
,YY- .
nullYY/ 3
)YY3 4
;YY4 5
ifZZ, .
(ZZ/ 0!
resultApiUpdateDetailZZ0 E
&&ZZF H
!ZZI J
stringZZJ P
.ZZP Q
IsNullOrEmptyZZQ ^
(ZZ^ _
resultUpdateDetailZZ_ q
)ZZq r
)ZZr s
{[[, -'
jsonParseReturnUpdateDetail\\0 K
=\\L M
JsonConvert\\N Y
.\\Y Z
DeserializeObject\\Z k
<\\k l
ResultStatusDataInt\\l 
<	\\ Ä!
ResultStatusDataNod
\\Ä ì
>
\\ì î
>
\\î ï
(
\\ï ñ 
resultUpdateDetail
\\ñ ®
)
\\® ©
;
\\© ™
if]]0 2
(]]3 4'
jsonParseReturnUpdateDetail]]4 O
.]]O P

StatusCode]]P Z
==]][ ]
$num]]^ a
||]]b d(
jsonParseReturnUpdateDetail	]]e Ä
.
]]Ä Å

StatusCode
]]Å ã
==
]]å é
$num
]]è í
)
]]í ì
{^^0 1

itemDetail__4 >
.__> ?
IdNodDetailFromApi__? Q
=__R S'
jsonParseReturnUpdateDetail__T o
.__o p
Data__p t
.__t u
Id__u w
;__w x
_context``4 <
.``< =
Entry``= B
(``B C

itemDetail``C M
)``M N
.``N O
State``O T
=``U V
EntityState``W b
.``b c
Modified``c k
;``k l
_contextaa4 <
.aa< =
SaveChangesaa= H
(aaH I
)aaI J
;aaJ K
}bb0 1
}cc, -
}ff( )
elsegg( ,
{hh( )
varii, /$
jsonParseReturnAddDetailii0 H
=iiI J
JsonConvertiiK V
.iiV W
DeserializeObjectiiW h
<iih i
ResultStatusDataIntiii |
<ii| } 
ResultStatusDataNod	ii} ê
>
iiê ë
>
iië í
(
iií ì
$str
iiì ï
)
iiï ñ
;
iiñ ó
varjj, /
urlAddDetailjj0 <
=jj= >
	GetConfigjj? H
.jjH I

AppSettingjjI S
[jjS T
$strjjT e
]jje f
+jjg h
	GetConfigjji r
.jjr s

AppSettingjjs }
[jj} ~
$str	jj~ ï
]
jjï ñ
;
jjñ ó
(kk, -
boolkk- 1
resultApiAddDetailkk2 D
,kkD E
stringkkF L
resultAddDetailkkM \
)kk\ ]
=kk^ _
RequestToAPIkk` l
.kkl m 
PostRequestToWebApi	kkm Ä
(
kkÄ Å
urlAddDetail
kkÅ ç
,
kkç é
new
kkè í
{ll, -
NodIdmm0 5
=mm6 7

dataAssignmm8 B
.mmB C
IdNodFromApimmC O
,mmO P
CreditorRefnn0 ;
=nn< =

itemDetailnn> H
.nnH I
CreditorRefnnI T
,nnT U
Amountoo0 6
=oo7 8

itemDetailoo9 C
.ooC D
AmountooD J
,ooJ K
	AmountIDRpp0 9
=pp: ;

itemDetailpp< F
.ppF G
	AmountIdrppG P
}qq, -
,qq- .
nullqq/ 3
)qq3 4
;qq4 5
ifrr, .
(rr/ 0
resultApiAddDetailrr0 B
&&rrC E
!rrF G
stringrrG M
.rrM N
IsNullOrEmptyrrN [
(rr[ \
resultAddDetailrr\ k
)rrk l
)rrl m
{ss, -$
jsonParseReturnAddDetailtt0 H
=ttI J
JsonConvertttK V
.ttV W
DeserializeObjectttW h
<tth i
ResultStatusDataInttti |
<tt| } 
ResultStatusDataNod	tt} ê
>
ttê ë
>
ttë í
(
ttí ì
resultAddDetail
ttì ¢
)
tt¢ £
;
tt£ §
ifuu0 2
(uu3 4$
jsonParseReturnAddDetailuu4 L
.uuL M

StatusCodeuuM W
==uuX Z
$numuu[ ^
||uu_ a$
jsonParseReturnAddDetailuub z
.uuz {

StatusCode	uu{ Ö
==
uuÜ à
$num
uuâ å
)
uuå ç
{vv0 1

itemDetailww4 >
.ww> ?
IdNodDetailFromApiww? Q
=wwR S$
jsonParseReturnAddDetailwwT l
.wwl m
Datawwm q
.wwq r
Idwwr t
;wwt u
_contextxx4 <
.xx< =
Entryxx= B
(xxB C

itemDetailxxC M
)xxM N
.xxN O
StatexxO T
=xxU V
EntityStatexxW b
.xxb c
Modifiedxxc k
;xxk l
_contextyy4 <
.yy< =
SaveChangesyy= H
(yyH I
)yyI J
;yyJ K
}zz0 1
}
ÇÇ, -
}
ÉÉ( )
}
ÑÑ$ %
List
áá$ (
<
áá( )
TblFileUploadNod
áá) 9
>
áá9 :
dataAssignFile
áá; I
=
ááJ K
_context
ááL T
.
ááT U
TblFileUploadNods
ááU f
.
ááf g
Where
áág l
(
áál m
m
áám n
=>
ááo q
m
áár s
.
áás t
IdNod
áát y
==
ááz |
intáá} Ä
.ááÄ Å
ParseááÅ Ü
(ááÜ á
itemááá ã
)ááã å
&&ááç è
mááê ë
.ááë í
	IsDeletedááí õ
==ááú û
$numááü †
)áá† °
.áá° ¢
ToListáá¢ ®
(áá® ©
)áá© ™
;áá™ ´
List
àà$ (
<
àà( )
TblFileUploadNod
àà) 9
>
àà9 :#
dataAssignFileDeleted
àà; P
=
ààQ R
_context
ààS [
.
àà[ \
TblFileUploadNods
àà\ m
.
ààm n
Where
ààn s
(
ààs t
m
ààt u
=>
ààv x
m
àày z
.
ààz {
IdNodàà{ Ä
==ààÅ É
intààÑ á
.ààá à
Parseààà ç
(ààç é
itemààé í
)ààí ì
&&ààî ñ
mààó ò
.ààò ô
IdFileFromApiààô ¶
!=ààß ©
nullàà™ Æ
&&ààØ ±
màà≤ ≥
.àà≥ ¥
	IsDeletedàà¥ Ω
==ààæ ¿
$numàà¡ ¬
&&àà√ ≈
màà∆ «
.àà« »
IsActiveàà» –
==àà— ”
$numàà‘ ’
)àà’ ÷
.àà÷ ◊
ToListàà◊ ›
(àà› ﬁ
)ààﬁ ﬂ
;ààﬂ ‡
foreach
ää$ +
(
ää, -
var
ää- 0
itemFileDelete
ää1 ?
in
ää@ B#
dataAssignFileDeleted
ääC X
)
ääX Y
{
ãã$ %
if
åå( *
(
åå+ ,
itemFileDelete
åå, :
.
åå: ;
IdFileFromApi
åå; H
!=
ååI K
null
ååL P
)
ååP Q
{
çç( )
var
éé, /'
jsonParseReturnUpdateFile
éé0 I
=
ééJ K
JsonConvert
ééL W
.
ééW X
DeserializeObject
ééX i
<
ééi j!
ResultStatusDataInt
ééj }
<
éé} ~"
ResultStatusDataNodéé~ ë
>ééë í
>ééí ì
(ééì î
$strééî ñ
)ééñ ó
;ééó ò
var
èè, /
urlUpdateFile
èè0 =
=
èè> ?
	GetConfig
èè@ I
.
èèI J

AppSetting
èèJ T
[
èèT U
$str
èèU f
]
èèf g
+
èèh i
	GetConfig
èèj s
.
èès t

AppSetting
èèt ~
[
èè~ 
$strèè î
]èèî ï
+èèñ ó
itemFileDeleteèèò ¶
.èè¶ ß
IdFileFromApièèß ¥
;èè¥ µ
(
êê, -
bool
êê- 1!
resultApiUpdateFile
êê2 E
,
êêE F
string
êêG M
resultUpdateFile
êêN ^
)
êê^ _
=
êê` a
RequestToAPI
êêb n
.
êên o$
DeleteRequestToWebApiêêo Ñ
(êêÑ Ö
urlUpdateFileêêÖ í
,êêí ì
nullêêî ò
)êêò ô
;êêô ö
if
ëë, .
(
ëë/ 0!
resultApiUpdateFile
ëë0 C
&&
ëëD F
!
ëëG H
string
ëëH N
.
ëëN O
IsNullOrEmpty
ëëO \
(
ëë\ ]
resultUpdateFile
ëë] m
)
ëëm n
)
ëën o
{
íí, -'
jsonParseReturnUpdateFile
ìì0 I
=
ììJ K
JsonConvert
ììL W
.
ììW X
DeserializeObject
ììX i
<
ììi j!
ResultStatusDataInt
ììj }
<
ìì} ~"
ResultStatusDataNodìì~ ë
>ììë í
>ììí ì
(ììì î 
resultUpdateFileììî §
)ìì§ •
;ìì• ¶
if
îî0 2
(
îî3 4'
jsonParseReturnUpdateFile
îî4 M
.
îîM N

StatusCode
îîN X
==
îîY [
$num
îî\ _
||
îî` b'
jsonParseReturnUpdateFile
îîc |
.
îî| }

StatusCodeîî} á
==îîà ä
$numîîã é
)îîé è
{
ïï0 1
itemFileDelete
ññ4 B
.
ññB C
IsActive
ññC K
=
ññL M
$num
ññN O
;
ññO P
itemFileDelete
óó4 B
.
óóB C
	IsDeleted
óóC L
=
óóM N
$num
óóO P
;
óóP Q
_context
òò4 <
.
òò< =
Entry
òò= B
(
òòB C
itemFileDelete
òòC Q
)
òòQ R
.
òòR S
State
òòS X
=
òòY Z
EntityState
òò[ f
.
òòf g
Modified
òòg o
;
òòo p
_context
ôô4 <
.
ôô< =
SaveChanges
ôô= H
(
ôôH I
)
ôôI J
;
ôôJ K
}
öö0 1
}
õõ, -
if
úú, .
(
úú/ 0!
resultApiUpdateFile
úú0 C
)
úúC D
{
ùù, -
itemFileDelete
ûû0 >
.
ûû> ?
IsActive
ûû? G
=
ûûH I
$num
ûûJ K
;
ûûK L
itemFileDelete
üü0 >
.
üü> ?
	IsDeleted
üü? H
=
üüI J
$num
üüK L
;
üüL M
_context
††0 8
.
††8 9
Entry
††9 >
(
††> ?
itemFileDelete
††? M
)
††M N
.
††N O
State
††O T
=
††U V
EntityState
††W b
.
††b c
Modified
††c k
;
††k l
_context
°°0 8
.
°°8 9
SaveChanges
°°9 D
(
°°D E
)
°°E F
;
°°F G
}
¢¢, -
}
££( )
}
§§$ %
foreach
¶¶$ +
(
¶¶, -
var
¶¶- 0
itemFile
¶¶1 9
in
¶¶: <
dataAssignFile
¶¶= K
)
¶¶K L
{
ßß$ %
var
®®( +
data
®®, 0
=
®®1 2
new
®®3 6
object
®®7 =
(
®®= >
)
®®> ?
;
®®? @
var
©©( +
check
©©, 1
=
©©2 3
await
©©4 9
_context
©©: B
.
©©B C
TblFileUploadNods
©©C T
.
©©T U
Where
©©U Z
(
©©Z [
x
©©[ \
=>
©©] _
x
©©` a
.
©©a b
Id
©©b d
==
©©e g
itemFile
©©h p
.
©©p q
Id
©©q s
)
©©s t
.
©©t u"
FirstOrDefaultAsync©©u à
(©©à â
)©©â ä
;©©ä ã
if
™™( *
(
™™+ ,
System
™™, 2
.
™™2 3
IO
™™3 5
.
™™5 6
File
™™6 :
.
™™: ;
Exists
™™; A
(
™™A B
check
™™B G
.
™™G H
FilePath
™™H P
)
™™P Q
)
™™Q R
{
´´( )
byte
¨¨, 0
[
¨¨0 1
]
¨¨1 2
	fileBytes
¨¨3 <
=
¨¨= >
System
¨¨? E
.
¨¨E F
IO
¨¨F H
.
¨¨H I
File
¨¨I M
.
¨¨M N
ReadAllBytes
¨¨N Z
(
¨¨Z [
check
¨¨[ `
.
¨¨` a
FilePath
¨¨a i
)
¨¨i j
;
¨¨j k
string
ØØ, 2
base64String
ØØ3 ?
=
ØØ@ A
Convert
ØØB I
.
ØØI J
ToBase64String
ØØJ X
(
ØØX Y
	fileBytes
ØØY b
)
ØØb c
;
ØØc d
var
±±, /)
jsonParseReturnUploadBase64
±±0 K
=
±±L M
JsonConvert
±±N Y
.
±±Y Z
DeserializeObject
±±Z k
<
±±k l!
ResultStatusDataInt
±±l 
<±± Ä#
ResultStatusDataNod±±Ä ì
>±±ì î
>±±î ï
(±±ï ñ
$str±±ñ ò
)±±ò ô
;±±ô ö
var
≤≤, /
urlUploadBase64
≤≤0 ?
=
≤≤@ A
	GetConfig
≤≤B K
.
≤≤K L

AppSetting
≤≤L V
[
≤≤V W
$str
≤≤W h
]
≤≤h i
+
≤≤j k
	GetConfig
≤≤l u
.
≤≤u v

AppSetting≤≤v Ä
[≤≤Ä Å
$str≤≤Å õ
]≤≤õ ú
+≤≤ù û

dataAssign≤≤ü ©
.≤≤© ™
IdNodFromApi≤≤™ ∂
;≤≤∂ ∑
(
≥≥, -
bool
≥≥- 1#
resultApiUploadBase64
≥≥2 G
,
≥≥G H
string
≥≥I O 
resultUploadBase64
≥≥P b
)
≥≥b c
=
≥≥d e
RequestToAPI
≥≥f r
.
≥≥r s"
PostRequestToWebApi≥≥s Ü
(≥≥Ü á
urlUploadBase64≥≥á ñ
,≥≥ñ ó
new≥≥ò õ
{
¥¥, -
FileName
µµ0 8
=
µµ9 :
itemFile
µµ; C
.
µµC D
FileName
µµD L
,
µµL M
FileContent
∂∂0 ;
=
∂∂< =
base64String
∂∂> J
,
∂∂J K
}
∑∑, -
,
∑∑- .
null
∑∑/ 3
)
∑∑3 4
;
∑∑4 5
if
∏∏, .
(
∏∏/ 0#
resultApiUploadBase64
∏∏0 E
&&
∏∏F H
!
∏∏I J
string
∏∏J P
.
∏∏P Q
IsNullOrEmpty
∏∏Q ^
(
∏∏^ _ 
resultUploadBase64
∏∏_ q
)
∏∏q r
)
∏∏r s
{
ππ, -)
jsonParseReturnUploadBase64
∫∫0 K
=
∫∫L M
JsonConvert
∫∫N Y
.
∫∫Y Z
DeserializeObject
∫∫Z k
<
∫∫k l!
ResultStatusDataInt
∫∫l 
<∫∫ Ä#
ResultStatusDataNod∫∫Ä ì
>∫∫ì î
>∫∫î ï
(∫∫ï ñ"
resultUploadBase64∫∫ñ ®
)∫∫® ©
;∫∫© ™
if
ªª0 2
(
ªª3 4)
jsonParseReturnUploadBase64
ªª4 O
.
ªªO P

StatusCode
ªªP Z
==
ªª[ ]
$num
ªª^ a
||
ªªb d*
jsonParseReturnUploadBase64ªªe Ä
.ªªÄ Å

StatusCodeªªÅ ã
==ªªå é
$numªªè í
)ªªí ì
{
ºº0 1
itemFile
ΩΩ4 <
.
ΩΩ< =
IdFileFromApi
ΩΩ= J
=
ΩΩK L)
jsonParseReturnUploadBase64
ΩΩM h
.
ΩΩh i
Data
ΩΩi m
.
ΩΩm n
Key
ΩΩn q
;
ΩΩq r
_context
ææ4 <
.
ææ< =
Entry
ææ= B
(
ææB C
itemFile
ææC K
)
ææK L
.
ææL M
State
ææM R
=
ææS T
EntityState
ææU `
.
ææ` a
Modified
ææa i
;
ææi j
_context
øø4 <
.
øø< =
SaveChanges
øø= H
(
øøH I
)
øøI J
;
øøJ K
}
¿¿0 1
}
¡¡, -
}
¬¬( )
}
√√$ %
var
««$ '#
jsonParseReturnUpdate
««( =
=
««> ?
JsonConvert
««@ K
.
««K L
DeserializeObject
««L ]
<
««] ^!
ResultStatusDataInt
««^ q
<
««q r"
ResultStatusDataNod««r Ö
>««Ö Ü
>««Ü á
(««á à
$str««à ä
)««ä ã
;««ã å
var
»»$ '
	urlUpdate
»»( 1
=
»»2 3
	GetConfig
»»4 =
.
»»= >

AppSetting
»»> H
[
»»H I
$str
»»I Z
]
»»Z [
+
»»\ ]
	GetConfig
»»^ g
.
»»g h

AppSetting
»»h r
[
»»r s
$str»»s á
]»»á à
+»»â ä

dataAssign»»ã ï
.»»ï ñ
IdNodFromApi»»ñ ¢
;»»¢ £
(
……$ %
bool
……% )
resultApiUpdate
……* 9
,
……9 :
string
……; A
resultUpdate
……B N
)
……N O
=
……P Q
RequestToAPI
……R ^
.
……^ _ 
PutRequestToWebApi
……_ q
(
……q r
	urlUpdate
……r {
,
……{ |
model……} Ç
,……Ç É
null……Ñ à
)……à â
;……â ä
if
  $ &
(
  ' (
resultApiUpdate
  ( 7
&&
  8 :
!
  ; <
string
  < B
.
  B C
IsNullOrEmpty
  C P
(
  P Q
resultUpdate
  Q ]
)
  ] ^
)
  ^ _
{
ÀÀ$ %#
jsonParseReturnUpdate
ÃÃ( =
=
ÃÃ> ?
JsonConvert
ÃÃ@ K
.
ÃÃK L
DeserializeObject
ÃÃL ]
<
ÃÃ] ^!
ResultStatusDataInt
ÃÃ^ q
<
ÃÃq r"
ResultStatusDataNodÃÃr Ö
>ÃÃÖ Ü
>ÃÃÜ á
(ÃÃá à
resultUpdateÃÃà î
)ÃÃî ï
;ÃÃï ñ
if
ÕÕ( *
(
ÕÕ+ ,#
jsonParseReturnUpdate
ÕÕ, A
.
ÕÕA B

StatusCode
ÕÕB L
==
ÕÕM O
$num
ÕÕP S
||
ÕÕT V#
jsonParseReturnUpdate
ÕÕW l
.
ÕÕl m

StatusCode
ÕÕm w
==
ÕÕx z
$num
ÕÕ{ ~
)
ÕÕ~ 
{
ŒŒ( )

dataAssign
œœ, 6
.
œœ6 7
Status
œœ7 =
=
œœ> ?#
jsonParseReturnUpdate
œœ@ U
.
œœU V
Data
œœV Z
.
œœZ [
Status
œœ[ a
;
œœa b

dataAssign
––, 6
.
––6 7
LastSentDate
––7 C
=
––D E
DateTime
––F N
.
––N O
Now
––O R
;
––R S
_context
——, 4
.
——4 5
Entry
——5 :
(
——: ;

dataAssign
——; E
)
——E F
.
——F G
State
——G L
=
——M N
EntityState
——O Z
.
——Z [
Modified
——[ c
;
——c d
_context
““, 4
.
““4 5
SaveChanges
““5 @
(
““@ A
)
““A B
;
““B C
}
””( )
}
‘‘$ %
}
’’  !
else
÷÷  $
{
◊◊  !

dataAssign
ÿÿ$ .
.
ÿÿ. /
Status
ÿÿ/ 5
=
ÿÿ6 7"
jsonParseReturnCheck
ÿÿ8 L
.
ÿÿL M
Data
ÿÿM Q
.
ÿÿQ R
Status
ÿÿR X
;
ÿÿX Y

dataAssign
ŸŸ$ .
.
ŸŸ. /
LastSentDate
ŸŸ/ ;
=
ŸŸ< =
DateTime
ŸŸ> F
.
ŸŸF G
Now
ŸŸG J
;
ŸŸJ K
_context
⁄⁄$ ,
.
⁄⁄, -
Entry
⁄⁄- 2
(
⁄⁄2 3

dataAssign
⁄⁄3 =
)
⁄⁄= >
.
⁄⁄> ?
State
⁄⁄? D
=
⁄⁄E F
EntityState
⁄⁄G R
.
⁄⁄R S
Modified
⁄⁄S [
;
⁄⁄[ \
_context
€€$ ,
.
€€, -
SaveChanges
€€- 8
(
€€8 9
)
€€9 :
;
€€: ;
}
‹‹  !
}
›› 
}
ﬁﬁ 
}
ﬂﬂ 
else
‡‡ 
{
·· 
var
‚‚  
jsonParseReturnAdd
‚‚ .
=
‚‚/ 0
JsonConvert
‚‚1 <
.
‚‚< =
DeserializeObject
‚‚= N
<
‚‚N O!
ResultStatusDataInt
‚‚O b
<
‚‚b c!
ResultStatusDataNod
‚‚c v
>
‚‚v w
>
‚‚w x
(
‚‚x y
$str
‚‚y {
)
‚‚{ |
;
‚‚| }
var
„„ 
urlAdd
„„ "
=
„„# $
	GetConfig
„„% .
.
„„. /

AppSetting
„„/ 9
[
„„9 :
$str
„„: K
]
„„K L
+
„„M N
	GetConfig
„„O X
.
„„X Y

AppSetting
„„Y c
[
„„c d
$str
„„d u
]
„„u v
;
„„v w
(
‰‰ 
bool
‰‰ 
resultApiAdd
‰‰ *
,
‰‰* +
string
‰‰, 2
	resultAdd
‰‰3 <
)
‰‰< =
=
‰‰> ?
RequestToAPI
‰‰@ L
.
‰‰L M!
PostRequestToWebApi
‰‰M `
(
‰‰` a
urlAdd
‰‰a g
,
‰‰g h
model
‰‰i n
,
‰‰n o
null
‰‰p t
)
‰‰t u
;
‰‰u v
if
ÂÂ 
(
ÂÂ 
resultApiAdd
ÂÂ (
&&
ÂÂ) +
!
ÂÂ, -
string
ÂÂ- 3
.
ÂÂ3 4
IsNullOrEmpty
ÂÂ4 A
(
ÂÂA B
	resultAdd
ÂÂB K
)
ÂÂK L
)
ÂÂL M
{
ÊÊ  
jsonParseReturnAdd
ÁÁ .
=
ÁÁ/ 0
JsonConvert
ÁÁ1 <
.
ÁÁ< =
DeserializeObject
ÁÁ= N
<
ÁÁN O!
ResultStatusDataInt
ÁÁO b
<
ÁÁb c!
ResultStatusDataNod
ÁÁc v
>
ÁÁv w
>
ÁÁw x
(
ÁÁx y
	resultAddÁÁy Ç
)ÁÁÇ É
;ÁÁÉ Ñ
if
ËË 
(
ËË   
jsonParseReturnAdd
ËË  2
.
ËË2 3

StatusCode
ËË3 =
==
ËË> @
$num
ËËA D
||
ËËE G 
jsonParseReturnAdd
ËËH Z
.
ËËZ [

StatusCode
ËË[ e
==
ËËf h
$num
ËËi l
)
ËËl m
{
ÈÈ 

dataAssign
ÍÍ  *
.
ÍÍ* +
IdNodFromApi
ÍÍ+ 7
=
ÍÍ8 9 
jsonParseReturnAdd
ÍÍ: L
.
ÍÍL M
Data
ÍÍM Q
.
ÍÍQ R
Id
ÍÍR T
;
ÍÍT U

dataAssign
ÎÎ  *
.
ÎÎ* +
Status
ÎÎ+ 1
=
ÎÎ2 3 
jsonParseReturnAdd
ÎÎ4 F
.
ÎÎF G
Data
ÎÎG K
.
ÎÎK L
Status
ÎÎL R
;
ÎÎR S

dataAssign
ÏÏ  *
.
ÏÏ* +
LastSentDate
ÏÏ+ 7
=
ÏÏ8 9
DateTime
ÏÏ: B
.
ÏÏB C
Now
ÏÏC F
;
ÏÏF G
_context
ÌÌ  (
.
ÌÌ( )
Entry
ÌÌ) .
(
ÌÌ. /

dataAssign
ÌÌ/ 9
)
ÌÌ9 :
.
ÌÌ: ;
State
ÌÌ; @
=
ÌÌA B
EntityState
ÌÌC N
.
ÌÌN O
Modified
ÌÌO W
;
ÌÌW X
_context
ÓÓ  (
.
ÓÓ( )
SaveChanges
ÓÓ) 4
(
ÓÓ4 5
)
ÓÓ5 6
;
ÓÓ6 7
List
ÒÒ  $
<
ÒÒ$ %+
TblNoticeOfDisbursementDetail
ÒÒ% B
>
ÒÒB C
dataAssignDetail
ÒÒD T
=
ÒÒU V
_context
ÒÒW _
.
ÒÒ_ `,
TblNoticeOfDisbursementDetails
ÒÒ` ~
.
ÒÒ~ 
WhereÒÒ Ñ
(ÒÒÑ Ö
mÒÒÖ Ü
=>ÒÒá â
mÒÒä ã
.ÒÒã å
NodIdÒÒå ë
==ÒÒí î
intÒÒï ò
.ÒÒò ô
ParseÒÒô û
(ÒÒû ü
itemÒÒü £
)ÒÒ£ §
&&ÒÒ• ß
mÒÒ® ©
.ÒÒ© ™
	IsDeletedÒÒ™ ≥
==ÒÒ¥ ∂
$numÒÒ∑ ∏
)ÒÒ∏ π
.ÒÒπ ∫
ToListÒÒ∫ ¿
(ÒÒ¿ ¡
)ÒÒ¡ ¬
;ÒÒ¬ √
foreach
ÚÚ  '
(
ÚÚ( )
var
ÚÚ) ,

itemDetail
ÚÚ- 7
in
ÚÚ8 :
dataAssignDetail
ÚÚ; K
)
ÚÚK L
{
ÛÛ  !
var
ıı$ '&
jsonParseReturnAddDetail
ıı( @
=
ııA B
JsonConvert
ııC N
.
ııN O
DeserializeObject
ııO `
<
ıı` a!
ResultStatusDataInt
ııa t
<
ııt u"
ResultStatusDataNodııu à
>ııà â
>ııâ ä
(ııä ã
$strııã ç
)ııç é
;ııé è
var
ˆˆ$ '
urlAddDetail
ˆˆ( 4
=
ˆˆ5 6
	GetConfig
ˆˆ7 @
.
ˆˆ@ A

AppSetting
ˆˆA K
[
ˆˆK L
$str
ˆˆL ]
]
ˆˆ] ^
+
ˆˆ_ `
	GetConfig
ˆˆa j
.
ˆˆj k

AppSetting
ˆˆk u
[
ˆˆu v
$strˆˆv ç
]ˆˆç é
;ˆˆé è
(
˜˜$ %
bool
˜˜% ) 
resultApiAddDetail
˜˜* <
,
˜˜< =
string
˜˜> D
resultAddDetail
˜˜E T
)
˜˜T U
=
˜˜V W
RequestToAPI
˜˜X d
.
˜˜d e!
PostRequestToWebApi
˜˜e x
(
˜˜x y
urlAddDetail˜˜y Ö
,˜˜Ö Ü
new˜˜á ä
{
¯¯$ %
NodId
˘˘( -
=
˘˘. / 
jsonParseReturnAdd
˘˘0 B
.
˘˘B C
Data
˘˘C G
.
˘˘G H
Id
˘˘H J
,
˘˘J K
CreditorRef
˙˙( 3
=
˙˙4 5

itemDetail
˙˙6 @
.
˙˙@ A
CreditorRef
˙˙A L
,
˙˙L M
Amount
˚˚( .
=
˚˚/ 0

itemDetail
˚˚1 ;
.
˚˚; <
Amount
˚˚< B
,
˚˚B C
	AmountIDR
¸¸( 1
=
¸¸2 3

itemDetail
¸¸4 >
.
¸¸> ?
	AmountIdr
¸¸? H
}
˝˝$ %
,
˝˝% &
null
˝˝' +
)
˝˝+ ,
;
˝˝, -
if
˛˛$ &
(
˛˛' ( 
resultApiAddDetail
˛˛( :
&&
˛˛; =
!
˛˛> ?
string
˛˛? E
.
˛˛E F
IsNullOrEmpty
˛˛F S
(
˛˛S T
resultAddDetail
˛˛T c
)
˛˛c d
)
˛˛d e
{
ˇˇ$ %&
jsonParseReturnAddDetail
ÄÄ( @
=
ÄÄA B
JsonConvert
ÄÄC N
.
ÄÄN O
DeserializeObject
ÄÄO `
<
ÄÄ` a!
ResultStatusDataInt
ÄÄa t
<
ÄÄt u"
ResultStatusDataNodÄÄu à
>ÄÄà â
>ÄÄâ ä
(ÄÄä ã
resultAddDetailÄÄã ö
)ÄÄö õ
;ÄÄõ ú
if
ÅÅ( *
(
ÅÅ+ ,&
jsonParseReturnAddDetail
ÅÅ, D
.
ÅÅD E

StatusCode
ÅÅE O
==
ÅÅP R
$num
ÅÅS V
||
ÅÅW Y&
jsonParseReturnAddDetail
ÅÅZ r
.
ÅÅr s

StatusCode
ÅÅs }
==ÅÅ~ Ä
$numÅÅÅ Ñ
)ÅÅÑ Ö
{
ÇÇ( )

itemDetail
ÉÉ, 6
.
ÉÉ6 7 
IdNodDetailFromApi
ÉÉ7 I
=
ÉÉJ K&
jsonParseReturnAddDetail
ÉÉL d
.
ÉÉd e
Data
ÉÉe i
.
ÉÉi j
Id
ÉÉj l
;
ÉÉl m
_context
ÑÑ, 4
.
ÑÑ4 5
Entry
ÑÑ5 :
(
ÑÑ: ;

itemDetail
ÑÑ; E
)
ÑÑE F
.
ÑÑF G
State
ÑÑG L
=
ÑÑM N
EntityState
ÑÑO Z
.
ÑÑZ [
Modified
ÑÑ[ c
;
ÑÑc d
_context
ÖÖ, 4
.
ÖÖ4 5
SaveChanges
ÖÖ5 @
(
ÖÖ@ A
)
ÖÖA B
;
ÖÖB C
}
ÜÜ( )
else
áá( ,
{
àà( )

itemDetail
ââ, 6
.
ââ6 7
	IsDeleted
ââ7 @
=
ââA B
$num
ââC D
;
ââD E
_context
ää, 4
.
ää4 5
Entry
ää5 :
(
ää: ;

itemDetail
ää; E
)
ääE F
.
ääF G
State
ääG L
=
ääM N
EntityState
ääO Z
.
ääZ [
Modified
ää[ c
;
ääc d
_context
ãã, 4
.
ãã4 5
SaveChanges
ãã5 @
(
ãã@ A
)
ããA B
;
ããB C
}
åå( )
}
çç$ %
}
éé  !
List
ëë  $
<
ëë$ %
TblFileUploadNod
ëë% 5
>
ëë5 6
dataAssignFile
ëë7 E
=
ëëF G
_context
ëëH P
.
ëëP Q
TblFileUploadNods
ëëQ b
.
ëëb c
Where
ëëc h
(
ëëh i
m
ëëi j
=>
ëëk m
m
ëën o
.
ëëo p
IdNod
ëëp u
==
ëëv x
int
ëëy |
.
ëë| }
Parseëë} Ç
(ëëÇ É
itemëëÉ á
)ëëá à
&&ëëâ ã
mëëå ç
.ëëç é
	IsDeletedëëé ó
==ëëò ö
$numëëõ ú
)ëëú ù
.ëëù û
ToListëëû §
(ëë§ •
)ëë• ¶
;ëë¶ ß
foreach
íí  '
(
íí( )
var
íí) ,
itemFile
íí- 5
in
íí6 8
dataAssignFile
íí9 G
)
ííG H
{
ìì  !
var
îî$ '
data
îî( ,
=
îî- .
new
îî/ 2
object
îî3 9
(
îî9 :
)
îî: ;
;
îî; <
var
ïï$ '
check
ïï( -
=
ïï. /
await
ïï0 5
_context
ïï6 >
.
ïï> ?
TblFileUploadNods
ïï? P
.
ïïP Q
Where
ïïQ V
(
ïïV W
x
ïïW X
=>
ïïY [
x
ïï\ ]
.
ïï] ^
Id
ïï^ `
==
ïïa c
itemFile
ïïd l
.
ïïl m
Id
ïïm o
)
ïïo p
.
ïïp q"
FirstOrDefaultAsyncïïq Ñ
(ïïÑ Ö
)ïïÖ Ü
;ïïÜ á
if
ññ$ &
(
ññ' (
System
ññ( .
.
ññ. /
IO
ññ/ 1
.
ññ1 2
File
ññ2 6
.
ññ6 7
Exists
ññ7 =
(
ññ= >
check
ññ> C
.
ññC D
FilePath
ññD L
)
ññL M
)
ññM N
{
óó$ %
byte
òò( ,
[
òò, -
]
òò- .
	fileBytes
òò/ 8
=
òò9 :
System
òò; A
.
òòA B
IO
òòB D
.
òòD E
File
òòE I
.
òòI J
ReadAllBytes
òòJ V
(
òòV W
check
òòW \
.
òò\ ]
FilePath
òò] e
)
òòe f
;
òòf g
string
õõ( .
base64String
õõ/ ;
=
õõ< =
Convert
õõ> E
.
õõE F
ToBase64String
õõF T
(
õõT U
	fileBytes
õõU ^
)
õõ^ _
;
õõ_ `
var
ûû( +)
jsonParseReturnUploadBase64
ûû, G
=
ûûH I
JsonConvert
ûûJ U
.
ûûU V
DeserializeObject
ûûV g
<
ûûg h!
ResultStatusDataInt
ûûh {
<
ûû{ |"
ResultStatusDataNodûû| è
>ûûè ê
>ûûê ë
(ûûë í
$strûûí î
)ûûî ï
;ûûï ñ
var
üü( +
urlUploadBase64
üü, ;
=
üü< =
	GetConfig
üü> G
.
üüG H

AppSetting
üüH R
[
üüR S
$str
üüS d
]
üüd e
+
üüf g
	GetConfig
üüh q
.
üüq r

AppSetting
üür |
[
üü| }
$strüü} ó
]üüó ò
+üüô ö"
jsonParseReturnAddüüõ ≠
.üü≠ Æ
DataüüÆ ≤
.üü≤ ≥
Idüü≥ µ
;üüµ ∂
(
††( )
bool
††) -#
resultApiUploadBase64
††. C
,
††C D
string
††E K 
resultUploadBase64
††L ^
)
††^ _
=
††` a
RequestToAPI
††b n
.
††n o"
PostRequestToWebApi††o Ç
(††Ç É
urlUploadBase64††É í
,††í ì
new††î ó
{
°°( )
FileName
¢¢, 4
=
¢¢5 6
itemFile
¢¢7 ?
.
¢¢? @
FileName
¢¢@ H
,
¢¢H I
FileContent
££, 7
=
££8 9
base64String
££: F
,
££F G
}
§§( )
,
§§) *
null
§§+ /
)
§§/ 0
;
§§0 1
if
••( *
(
••+ ,#
resultApiUploadBase64
••, A
&&
••B D
!
••E F
string
••F L
.
••L M
IsNullOrEmpty
••M Z
(
••Z [ 
resultUploadBase64
••[ m
)
••m n
)
••n o
{
¶¶( ))
jsonParseReturnUploadBase64
ßß, G
=
ßßH I
JsonConvert
ßßJ U
.
ßßU V
DeserializeObject
ßßV g
<
ßßg h!
ResultStatusDataInt
ßßh {
<
ßß{ |"
ResultStatusDataNodßß| è
>ßßè ê
>ßßê ë
(ßßë í"
resultUploadBase64ßßí §
)ßß§ •
;ßß• ¶
if
®®, .
(
®®/ 0)
jsonParseReturnUploadBase64
®®0 K
.
®®K L

StatusCode
®®L V
==
®®W Y
$num
®®Z ]
||
®®^ `)
jsonParseReturnUploadBase64
®®a |
.
®®| }

StatusCode®®} á
==®®à ä
$num®®ã é
)®®é è
{
©©, -
itemFile
™™0 8
.
™™8 9
IdFileFromApi
™™9 F
=
™™G H)
jsonParseReturnUploadBase64
™™I d
.
™™d e
Data
™™e i
.
™™i j
Key
™™j m
;
™™m n
_context
´´0 8
.
´´8 9
Entry
´´9 >
(
´´> ?
itemFile
´´? G
)
´´G H
.
´´H I
State
´´I N
=
´´O P
EntityState
´´Q \
.
´´\ ]
Modified
´´] e
;
´´e f
_context
¨¨0 8
.
¨¨8 9
SaveChanges
¨¨9 D
(
¨¨D E
)
¨¨E F
;
¨¨F G
}
≠≠, -
}
ÆÆ( )
}
ØØ$ %
}
∞∞  !
}
±± 
}
≤≤ 
}
≥≥ 
}
¥¥ 
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
throw
ππ 
;
ππ 
}
∫∫ 
}
ªª 	
public
ΩΩ 
async
ΩΩ 
Task
ΩΩ 
SendToDevaNop
ΩΩ '
(
ΩΩ' (
string
ΩΩ( .
Ids
ΩΩ/ 2
)
ΩΩ2 3
{
ææ 	'
DbDashboardDevaBniContext
øø %
_context
øø& .
=
øø/ 0
new
øø1 4'
DbDashboardDevaBniContext
øø5 N
(
øøN O
)
øøO P
;
øøP Q
try
¡¡ 
{
¬¬ 
string
√√ 
[
√√ 
]
√√ 
ArrayIds
√√ !
=
√√" #
Ids
√√$ '
.
√√' (
Split
√√( -
(
√√- .
$char
√√. 1
)
√√1 2
;
√√2 3
foreach
≈≈ 
(
≈≈ 
var
≈≈ 
item
≈≈ !
in
≈≈" $
ArrayIds
≈≈% -
)
≈≈- .
{
∆∆  
TblNoticeOfPayment
«« &

dataAssign
««' 1
=
««2 3
_context
««4 <
.
««< =!
TblNoticeOfPayments
««= P
.
««P Q
Where
««Q V
(
««V W
m
««W X
=>
««Y [
m
««\ ]
.
««] ^
Id
««^ `
==
««a c
int
««d g
.
««g h
Parse
««h m
(
««m n
item
««n r
)
««r s
&&
««t v
m
««w x
.
««x y
	IsDeleted««y Ç
==««É Ö
$num««Ü á
)««á à
.««à â
FirstOrDefault««â ó
(««ó ò
)««ò ô
;««ô ö-
NoticeOfPaymentToAPI_ViewModels
…… 3
model
……4 9
=
……: ;
new
……< ?-
NoticeOfPaymentToAPI_ViewModels
……@ _
(
……_ `
)
……` a
;
……a b
model
   
.
   
NopNo
   
=
    !

dataAssign
  " ,
.
  , -
NopNo
  - 2
;
  2 3
model
ÀÀ 
.
ÀÀ 
DueDate
ÀÀ !
=
ÀÀ" #

dataAssign
ÀÀ$ .
.
ÀÀ. /
DueDate
ÀÀ/ 6
;
ÀÀ6 7
model
ÃÃ 
.
ÃÃ 
RekId
ÃÃ 
=
ÃÃ  !

dataAssign
ÃÃ" ,
.
ÃÃ, -
RekId
ÃÃ- 2
;
ÃÃ2 3
model
ÕÕ 
.
ÕÕ 
InterestRate
ÕÕ &
=
ÕÕ' (

dataAssign
ÕÕ) 3
.
ÕÕ3 4
InterestRate
ÕÕ4 @
;
ÕÕ@ A
model
ŒŒ 
.
ŒŒ 
InterestDays
ŒŒ &
=
ŒŒ' (

dataAssign
ŒŒ) 3
.
ŒŒ3 4
InterestDays
ŒŒ4 @
;
ŒŒ@ A
model
œœ 
.
œœ 
Cur
œœ 
=
œœ 

dataAssign
œœ  *
.
œœ* +
Cur
œœ+ .
;
œœ. /
model
–– 
.
–– 
	NopDetail
–– #
=
––$ %
_context
––& .
.
––. /'
TblNoticeOfPaymentDetails
––/ H
.
––H I
Where
––I N
(
––N O
m
––O P
=>
––Q S
m
––T U
.
––U V
NopId
––V [
==
––\ ^
int
––_ b
.
––b c
Parse
––c h
(
––h i
item
––i m
)
––m n
&&
––o q
m
––r s
.
––s t
	IsDeleted
––t }
==––~ Ä
$num––Å Ç
)––Ç É
.––É Ñ
ToList––Ñ ä
(––ä ã
)––ã å
;––å ç
if
”” 
(
”” 

dataAssign
”” "
.
””" #
IdNopFromApi
””# /
!=
””0 2
null
””3 7
)
””7 8
{
‘‘ 
var
’’ "
jsonParseReturnCheck
’’ 0
=
’’1 2
JsonConvert
’’3 >
.
’’> ?
DeserializeObject
’’? P
<
’’P Q!
ResultStatusDataInt
’’Q d
<
’’d e!
ResultStatusDataNop
’’e x
>
’’x y
>
’’y z
(
’’z {
$str
’’{ }
)
’’} ~
;
’’~ 
var
÷÷ 
urlCheck
÷÷ $
=
÷÷% &
	GetConfig
÷÷' 0
.
÷÷0 1

AppSetting
÷÷1 ;
[
÷÷; <
$str
÷÷< M
]
÷÷M N
+
÷÷O P
	GetConfig
÷÷Q Z
.
÷÷Z [

AppSetting
÷÷[ e
[
÷÷e f
$str
÷÷f 
]÷÷ Ä
+÷÷Å Ç

dataAssign÷÷É ç
.÷÷ç é
IdNopFromApi÷÷é ö
;÷÷ö õ
(
◊◊ 
bool
◊◊ 
resultApiCheck
◊◊ ,
,
◊◊, -
string
◊◊. 4
resultCheck
◊◊5 @
)
◊◊@ A
=
◊◊B C
RequestToAPI
◊◊D P
.
◊◊P Q!
GetJsonStringWebApi
◊◊Q d
(
◊◊d e
urlCheck
◊◊e m
,
◊◊m n
null
◊◊o s
)
◊◊s t
;
◊◊t u
if
ÿÿ 
(
ÿÿ 
resultApiCheck
ÿÿ *
&&
ÿÿ+ -
!
ÿÿ. /
string
ÿÿ/ 5
.
ÿÿ5 6
IsNullOrEmpty
ÿÿ6 C
(
ÿÿC D
resultCheck
ÿÿD O
)
ÿÿO P
)
ÿÿP Q
{
ŸŸ "
jsonParseReturnCheck
⁄⁄ 0
=
⁄⁄1 2
JsonConvert
⁄⁄3 >
.
⁄⁄> ?
DeserializeObject
⁄⁄? P
<
⁄⁄P Q!
ResultStatusDataInt
⁄⁄Q d
<
⁄⁄d e!
ResultStatusDataNop
⁄⁄e x
>
⁄⁄x y
>
⁄⁄y z
(
⁄⁄z {
resultCheck⁄⁄{ Ü
)⁄⁄Ü á
;⁄⁄á à
}
€€ 
if
›› 
(
›› "
jsonParseReturnCheck
›› 0
.
››0 1

StatusCode
››1 ;
==
››< >
$num
››? B
||
››C E"
jsonParseReturnCheck
››F Z
.
››Z [

StatusCode
››[ e
==
››f h
$num
››i l
)
››l m
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ  "
jsonParseReturnCheck
ﬂﬂ  4
.
ﬂﬂ4 5
Data
ﬂﬂ5 9
.
ﬂﬂ9 :
Status
ﬂﬂ: @
==
ﬂﬂA C
$str
ﬂﬂD P
)
ﬂﬂP Q
{
‡‡ 
List
‚‚  $
<
‚‚$ %&
TblNoticeOfPaymentDetail
‚‚% =
>
‚‚= >
dataAssignDetail
‚‚? O
=
‚‚P Q
_context
‚‚R Z
.
‚‚Z ['
TblNoticeOfPaymentDetails
‚‚[ t
.
‚‚t u
Where
‚‚u z
(
‚‚z {
m
‚‚{ |
=>
‚‚} 
m‚‚Ä Å
.‚‚Å Ç
NopId‚‚Ç á
==‚‚à ä
int‚‚ã é
.‚‚é è
Parse‚‚è î
(‚‚î ï
item‚‚ï ô
)‚‚ô ö
&&‚‚õ ù
m‚‚û ü
.‚‚ü †
IsActive‚‚† ®
==‚‚© ´
$num‚‚¨ ≠
&&‚‚Æ ∞
m‚‚± ≤
.‚‚≤ ≥
	IsDeleted‚‚≥ º
==‚‚Ω ø
$num‚‚¿ ¡
)‚‚¡ ¬
.‚‚¬ √
ToList‚‚√ …
(‚‚…  
)‚‚  À
;‚‚À Ã
List
„„  $
<
„„$ %&
TblNoticeOfPaymentDetail
„„% =
>
„„= >%
dataAssignDetailDeleted
„„? V
=
„„W X
_context
„„Y a
.
„„a b'
TblNoticeOfPaymentDetails
„„b {
.
„„{ |
Where„„| Å
(„„Å Ç
m„„Ç É
=>„„Ñ Ü
m„„á à
.„„à â
NopId„„â é
==„„è ë
int„„í ï
.„„ï ñ
Parse„„ñ õ
(„„õ ú
item„„ú †
)„„† °
&&„„¢ §
m„„• ¶
.„„¶ ß"
IdNopDetailFromApi„„ß π
!=„„∫ º
null„„Ω ¡
&&„„¬ ƒ
m„„≈ ∆
.„„∆ «
	IsDeleted„„« –
==„„— ”
$num„„‘ ’
&&„„÷ ÿ
m„„Ÿ ⁄
.„„⁄ €
IsActive„„€ „
==„„‰ Ê
$num„„Á Ë
)„„Ë È
.„„È Í
ToList„„Í 
(„„ Ò
)„„Ò Ú
;„„Ú Û
foreach
ÂÂ  '
(
ÂÂ( )
var
ÂÂ) ,
itemDetailDelete
ÂÂ- =
in
ÂÂ> @%
dataAssignDetailDeleted
ÂÂA X
)
ÂÂX Y
{
ÊÊ  !
if
ÁÁ$ &
(
ÁÁ' (
itemDetailDelete
ÁÁ( 8
.
ÁÁ8 9 
IdNopDetailFromApi
ÁÁ9 K
!=
ÁÁL N
null
ÁÁO S
)
ÁÁS T
{
ËË$ %
var
ÈÈ( +)
jsonParseReturnUpdateDetail
ÈÈ, G
=
ÈÈH I
JsonConvert
ÈÈJ U
.
ÈÈU V
DeserializeObject
ÈÈV g
<
ÈÈg h!
ResultStatusDataInt
ÈÈh {
<
ÈÈ{ |"
ResultStatusDataNopÈÈ| è
>ÈÈè ê
>ÈÈê ë
(ÈÈë í
$strÈÈí î
)ÈÈî ï
;ÈÈï ñ
var
ÍÍ( +
urlUpdateDetail
ÍÍ, ;
=
ÍÍ< =
	GetConfig
ÍÍ> G
.
ÍÍG H

AppSetting
ÍÍH R
[
ÍÍR S
$str
ÍÍS d
]
ÍÍd e
+
ÍÍf g
	GetConfig
ÍÍh q
.
ÍÍq r

AppSetting
ÍÍr |
[
ÍÍ| }
$strÍÍ} ó
]ÍÍó ò
+ÍÍô ö 
itemDetailDeleteÍÍõ ´
.ÍÍ´ ¨"
IdNopDetailFromApiÍÍ¨ æ
;ÍÍæ ø
(
ÎÎ( )
bool
ÎÎ) -#
resultApiUpdateDetail
ÎÎ. C
,
ÎÎC D
string
ÎÎE K 
resultUpdateDetail
ÎÎL ^
)
ÎÎ^ _
=
ÎÎ` a
RequestToAPI
ÎÎb n
.
ÎÎn o$
DeleteRequestToWebApiÎÎo Ñ
(ÎÎÑ Ö
urlUpdateDetailÎÎÖ î
,ÎÎî ï
nullÎÎñ ö
)ÎÎö õ
;ÎÎõ ú
if
ÏÏ( *
(
ÏÏ+ ,#
resultApiUpdateDetail
ÏÏ, A
&&
ÏÏB D
!
ÏÏE F
string
ÏÏF L
.
ÏÏL M
IsNullOrEmpty
ÏÏM Z
(
ÏÏZ [ 
resultUpdateDetail
ÏÏ[ m
)
ÏÏm n
)
ÏÏn o
{
ÌÌ( ))
jsonParseReturnUpdateDetail
ÓÓ, G
=
ÓÓH I
JsonConvert
ÓÓJ U
.
ÓÓU V
DeserializeObject
ÓÓV g
<
ÓÓg h!
ResultStatusDataInt
ÓÓh {
<
ÓÓ{ |"
ResultStatusDataNopÓÓ| è
>ÓÓè ê
>ÓÓê ë
(ÓÓë í"
resultUpdateDetailÓÓí §
)ÓÓ§ •
;ÓÓ• ¶
if
ÔÔ, .
(
ÔÔ/ 0)
jsonParseReturnUpdateDetail
ÔÔ0 K
.
ÔÔK L

StatusCode
ÔÔL V
==
ÔÔW Y
$num
ÔÔZ ]
||
ÔÔ^ `)
jsonParseReturnUpdateDetail
ÔÔa |
.
ÔÔ| }

StatusCodeÔÔ} á
==ÔÔà ä
$numÔÔã é
)ÔÔé è
{
, -
itemDetailDelete
ÒÒ0 @
.
ÒÒ@ A
IsActive
ÒÒA I
=
ÒÒJ K
$num
ÒÒL M
;
ÒÒM N
itemDetailDelete
ÚÚ0 @
.
ÚÚ@ A
	IsDeleted
ÚÚA J
=
ÚÚK L
$num
ÚÚM N
;
ÚÚN O
_context
ÛÛ0 8
.
ÛÛ8 9
Entry
ÛÛ9 >
(
ÛÛ> ?
itemDetailDelete
ÛÛ? O
)
ÛÛO P
.
ÛÛP Q
State
ÛÛQ V
=
ÛÛW X
EntityState
ÛÛY d
.
ÛÛd e
Modified
ÛÛe m
;
ÛÛm n
_context
ÙÙ0 8
.
ÙÙ8 9
SaveChanges
ÙÙ9 D
(
ÙÙD E
)
ÙÙE F
;
ÙÙF G
}
ıı, -
}
ˆˆ( )
}
˜˜$ %
}
¯¯  !
foreach
˙˙  '
(
˙˙( )
var
˙˙) ,

itemDetail
˙˙- 7
in
˙˙8 :
dataAssignDetail
˙˙; K
)
˙˙K L
{
˚˚  !
if
˝˝$ &
(
˝˝' (

itemDetail
˝˝( 2
.
˝˝2 3 
IdNopDetailFromApi
˝˝3 E
!=
˝˝F H
null
˝˝I M
)
˝˝M N
{
˛˛$ %
var
ˇˇ( +)
jsonParseReturnUpdateDetail
ˇˇ, G
=
ˇˇH I
JsonConvert
ˇˇJ U
.
ˇˇU V
DeserializeObject
ˇˇV g
<
ˇˇg h!
ResultStatusDataInt
ˇˇh {
<
ˇˇ{ |"
ResultStatusDataNopˇˇ| è
>ˇˇè ê
>ˇˇê ë
(ˇˇë í
$strˇˇí î
)ˇˇî ï
;ˇˇï ñ
var
ÄÄ( +
urlUpdateDetail
ÄÄ, ;
=
ÄÄ< =
	GetConfig
ÄÄ> G
.
ÄÄG H

AppSetting
ÄÄH R
[
ÄÄR S
$str
ÄÄS d
]
ÄÄd e
+
ÄÄf g
	GetConfig
ÄÄh q
.
ÄÄq r

AppSetting
ÄÄr |
[
ÄÄ| }
$strÄÄ} ó
]ÄÄó ò
+ÄÄô ö

itemDetailÄÄõ •
.ÄÄ• ¶"
IdNopDetailFromApiÄÄ¶ ∏
;ÄÄ∏ π
(
ÅÅ( )
bool
ÅÅ) -#
resultApiUpdateDetail
ÅÅ. C
,
ÅÅC D
string
ÅÅE K 
resultUpdateDetail
ÅÅL ^
)
ÅÅ^ _
=
ÅÅ` a
RequestToAPI
ÅÅb n
.
ÅÅn o!
PutRequestToWebApiÅÅo Å
(ÅÅÅ Ç
urlUpdateDetailÅÅÇ ë
,ÅÅë í
newÅÅì ñ
{
ÇÇ( )
NopId
ÉÉ, 1
=
ÉÉ2 3

dataAssign
ÉÉ4 >
.
ÉÉ> ?
IdNopFromApi
ÉÉ? K
,
ÉÉK L
CreditorRef
ÑÑ, 7
=
ÑÑ8 9

itemDetail
ÑÑ: D
.
ÑÑD E
CreditorRef
ÑÑE P
,
ÑÑP Q
Outstanding
ÖÖ, 7
=
ÖÖ8 9

itemDetail
ÖÖ: D
.
ÖÖD E
Outstanding
ÖÖE P
,
ÖÖP Q
	Principal
ÜÜ, 5
=
ÜÜ6 7

itemDetail
ÜÜ8 B
.
ÜÜB C
	Principal
ÜÜC L
,
ÜÜL M
Interest
áá, 4
=
áá5 6

itemDetail
áá7 A
.
ááA B
Interest
ááB J
,
ááJ K
Fee
àà, /
=
àà0 1

itemDetail
àà2 <
.
àà< =
Fee
àà= @
}
ââ( )
,
ââ) *
null
ââ+ /
)
ââ/ 0
;
ââ0 1
if
ää( *
(
ää+ ,#
resultApiUpdateDetail
ää, A
&&
ääB D
!
ääE F
string
ääF L
.
ääL M
IsNullOrEmpty
ääM Z
(
ääZ [ 
resultUpdateDetail
ää[ m
)
ääm n
)
ään o
{
ãã( ))
jsonParseReturnUpdateDetail
åå, G
=
ååH I
JsonConvert
ååJ U
.
ååU V
DeserializeObject
ååV g
<
ååg h!
ResultStatusDataInt
ååh {
<
åå{ |"
ResultStatusDataNopåå| è
>ååè ê
>ååê ë
(ååë í"
resultUpdateDetailååí §
)åå§ •
;åå• ¶
if
çç, .
(
çç/ 0)
jsonParseReturnUpdateDetail
çç0 K
.
ççK L

StatusCode
ççL V
==
ççW Y
$num
ççZ ]
||
çç^ `)
jsonParseReturnUpdateDetail
çça |
.
çç| }

StatusCodeçç} á
==ççà ä
$numççã é
)ççé è
{
éé, -

itemDetail
èè0 :
.
èè: ; 
IdNopDetailFromApi
èè; M
=
èèN O)
jsonParseReturnUpdateDetail
èèP k
.
èèk l
Data
èèl p
.
èèp q
Id
èèq s
;
èès t
_context
êê0 8
.
êê8 9
Entry
êê9 >
(
êê> ?

itemDetail
êê? I
)
êêI J
.
êêJ K
State
êêK P
=
êêQ R
EntityState
êêS ^
.
êê^ _
Modified
êê_ g
;
êêg h
_context
ëë0 8
.
ëë8 9
SaveChanges
ëë9 D
(
ëëD E
)
ëëE F
;
ëëF G
}
íí, -
}
ìì( )
}
ññ$ %
else
óó$ (
{
òò$ %
var
ôô( +&
jsonParseReturnAddDetail
ôô, D
=
ôôE F
JsonConvert
ôôG R
.
ôôR S
DeserializeObject
ôôS d
<
ôôd e!
ResultStatusDataInt
ôôe x
<
ôôx y"
ResultStatusDataNopôôy å
>ôôå ç
>ôôç é
(ôôé è
$strôôè ë
)ôôë í
;ôôí ì
var
öö( +
urlAddDetail
öö, 8
=
öö9 :
	GetConfig
öö; D
.
ööD E

AppSetting
ööE O
[
ööO P
$str
ööP a
]
ööa b
+
ööc d
	GetConfig
ööe n
.
öön o

AppSetting
ööo y
[
ööy z
$strööz ë
]ööë í
;ööí ì
(
õõ( )
bool
õõ) - 
resultApiAddDetail
õõ. @
,
õõ@ A
string
õõB H
resultAddDetail
õõI X
)
õõX Y
=
õõZ [
RequestToAPI
õõ\ h
.
õõh i!
PostRequestToWebApi
õõi |
(
õõ| }
urlAddDetailõõ} â
,õõâ ä
newõõã é
{
úú( )
NopId
ùù, 1
=
ùù2 3

dataAssign
ùù4 >
.
ùù> ?
IdNopFromApi
ùù? K
,
ùùK L
CreditorRef
ûû, 7
=
ûû8 9

itemDetail
ûû: D
.
ûûD E
CreditorRef
ûûE P
,
ûûP Q
Outstanding
üü, 7
=
üü8 9

itemDetail
üü: D
.
üüD E
Outstanding
üüE P
,
üüP Q
	Principal
††, 5
=
††6 7

itemDetail
††8 B
.
††B C
	Principal
††C L
,
††L M
Interest
°°, 4
=
°°5 6

itemDetail
°°7 A
.
°°A B
Interest
°°B J
,
°°J K
Fee
¢¢, /
=
¢¢0 1

itemDetail
¢¢2 <
.
¢¢< =
Fee
¢¢= @
}
££( )
,
££) *
null
££+ /
)
££/ 0
;
££0 1
if
§§( *
(
§§+ , 
resultApiAddDetail
§§, >
&&
§§? A
!
§§B C
string
§§C I
.
§§I J
IsNullOrEmpty
§§J W
(
§§W X
resultAddDetail
§§X g
)
§§g h
)
§§h i
{
••( )&
jsonParseReturnAddDetail
¶¶, D
=
¶¶E F
JsonConvert
¶¶G R
.
¶¶R S
DeserializeObject
¶¶S d
<
¶¶d e!
ResultStatusDataInt
¶¶e x
<
¶¶x y"
ResultStatusDataNop¶¶y å
>¶¶å ç
>¶¶ç é
(¶¶é è
resultAddDetail¶¶è û
)¶¶û ü
;¶¶ü †
if
ßß, .
(
ßß/ 0&
jsonParseReturnAddDetail
ßß0 H
.
ßßH I

StatusCode
ßßI S
==
ßßT V
$num
ßßW Z
||
ßß[ ]&
jsonParseReturnAddDetail
ßß^ v
.
ßßv w

StatusCodeßßw Å
==ßßÇ Ñ
$numßßÖ à
)ßßà â
{
®®, -

itemDetail
©©0 :
.
©©: ; 
IdNopDetailFromApi
©©; M
=
©©N O&
jsonParseReturnAddDetail
©©P h
.
©©h i
Data
©©i m
.
©©m n
Id
©©n p
;
©©p q
_context
™™0 8
.
™™8 9
Entry
™™9 >
(
™™> ?

itemDetail
™™? I
)
™™I J
.
™™J K
State
™™K P
=
™™Q R
EntityState
™™S ^
.
™™^ _
Modified
™™_ g
;
™™g h
_context
´´0 8
.
´´8 9
SaveChanges
´´9 D
(
´´D E
)
´´E F
;
´´F G
}
¨¨, -
}
¥¥( )
}
µµ$ %
}
∂∂  !
List
ππ  $
<
ππ$ %
TblFileUploadNop
ππ% 5
>
ππ5 6
dataAssignFile
ππ7 E
=
ππF G
_context
ππH P
.
ππP Q
TblFileUploadNops
ππQ b
.
ππb c
Where
ππc h
(
ππh i
m
ππi j
=>
ππk m
m
ππn o
.
ππo p
IdNop
ππp u
==
ππv x
int
ππy |
.
ππ| }
Parseππ} Ç
(ππÇ É
itemππÉ á
)ππá à
&&ππâ ã
mππå ç
.ππç é
	IsDeletedππé ó
==ππò ö
$numππõ ú
)ππú ù
.ππù û
ToListππû §
(ππ§ •
)ππ• ¶
;ππ¶ ß
List
∫∫  $
<
∫∫$ %
TblFileUploadNop
∫∫% 5
>
∫∫5 6#
dataAssignFileDeleted
∫∫7 L
=
∫∫M N
_context
∫∫O W
.
∫∫W X
TblFileUploadNops
∫∫X i
.
∫∫i j
Where
∫∫j o
(
∫∫o p
m
∫∫p q
=>
∫∫r t
m
∫∫u v
.
∫∫v w
IdNop
∫∫w |
==
∫∫} 
int∫∫Ä É
.∫∫É Ñ
Parse∫∫Ñ â
(∫∫â ä
item∫∫ä é
)∫∫é è
&&∫∫ê í
m∫∫ì î
.∫∫î ï
IdFileFromApi∫∫ï ¢
!=∫∫£ •
null∫∫¶ ™
&&∫∫´ ≠
m∫∫Æ Ø
.∫∫Ø ∞
	IsDeleted∫∫∞ π
==∫∫∫ º
$num∫∫Ω æ
&&∫∫ø ¡
m∫∫¬ √
.∫∫√ ƒ
IsActive∫∫ƒ Ã
==∫∫Õ œ
$num∫∫– —
)∫∫— “
.∫∫“ ”
ToList∫∫” Ÿ
(∫∫Ÿ ⁄
)∫∫⁄ €
;∫∫€ ‹
foreach
ºº  '
(
ºº( )
var
ºº) ,
itemFileDelete
ºº- ;
in
ºº< >#
dataAssignFileDeleted
ºº? T
)
ººT U
{
ΩΩ  !
if
ææ$ &
(
ææ' (
itemFileDelete
ææ( 6
.
ææ6 7
IdFileFromApi
ææ7 D
!=
ææE G
null
ææH L
)
ææL M
{
øø$ %
var
¿¿( +'
jsonParseReturnUpdateFile
¿¿, E
=
¿¿F G
JsonConvert
¿¿H S
.
¿¿S T
DeserializeObject
¿¿T e
<
¿¿e f!
ResultStatusDataInt
¿¿f y
<
¿¿y z"
ResultStatusDataNop¿¿z ç
>¿¿ç é
>¿¿é è
(¿¿è ê
$str¿¿ê í
)¿¿í ì
;¿¿ì î
var
¡¡( +
urlUpdateFile
¡¡, 9
=
¡¡: ;
	GetConfig
¡¡< E
.
¡¡E F

AppSetting
¡¡F P
[
¡¡P Q
$str
¡¡Q b
]
¡¡b c
+
¡¡d e
	GetConfig
¡¡f o
.
¡¡o p

AppSetting
¡¡p z
[
¡¡z {
$str¡¡{ ê
]¡¡ê ë
+¡¡í ì
itemFileDelete¡¡î ¢
.¡¡¢ £
IdFileFromApi¡¡£ ∞
;¡¡∞ ±
(
¬¬( )
bool
¬¬) -!
resultApiUpdateFile
¬¬. A
,
¬¬A B
string
¬¬C I
resultUpdateFile
¬¬J Z
)
¬¬Z [
=
¬¬\ ]
RequestToAPI
¬¬^ j
.
¬¬j k$
DeleteRequestToWebApi¬¬k Ä
(¬¬Ä Å
urlUpdateFile¬¬Å é
,¬¬é è
null¬¬ê î
)¬¬î ï
;¬¬ï ñ
if
√√( *
(
√√+ ,!
resultApiUpdateFile
√√, ?
&&
√√@ B
!
√√C D
string
√√D J
.
√√J K
IsNullOrEmpty
√√K X
(
√√X Y
resultUpdateFile
√√Y i
)
√√i j
)
√√j k
{
ƒƒ( )'
jsonParseReturnUpdateFile
≈≈, E
=
≈≈F G
JsonConvert
≈≈H S
.
≈≈S T
DeserializeObject
≈≈T e
<
≈≈e f!
ResultStatusDataInt
≈≈f y
<
≈≈y z"
ResultStatusDataNop≈≈z ç
>≈≈ç é
>≈≈é è
(≈≈è ê 
resultUpdateFile≈≈ê †
)≈≈† °
;≈≈° ¢
if
∆∆, .
(
∆∆/ 0'
jsonParseReturnUpdateFile
∆∆0 I
.
∆∆I J

StatusCode
∆∆J T
==
∆∆U W
$num
∆∆X [
||
∆∆\ ^'
jsonParseReturnUpdateFile
∆∆_ x
.
∆∆x y

StatusCode∆∆y É
==∆∆Ñ Ü
$num∆∆á ä
)∆∆ä ã
{
««, -
itemFileDelete
»»0 >
.
»»> ?
IsActive
»»? G
=
»»H I
$num
»»J K
;
»»K L
itemFileDelete
……0 >
.
……> ?
	IsDeleted
……? H
=
……I J
$num
……K L
;
……L M
_context
  0 8
.
  8 9
Entry
  9 >
(
  > ?
itemFileDelete
  ? M
)
  M N
.
  N O
State
  O T
=
  U V
EntityState
  W b
.
  b c
Modified
  c k
;
  k l
_context
ÀÀ0 8
.
ÀÀ8 9
SaveChanges
ÀÀ9 D
(
ÀÀD E
)
ÀÀE F
;
ÀÀF G
}
ÃÃ, -
}
ÕÕ( )
if
ŒŒ( *
(
ŒŒ+ ,!
resultApiUpdateFile
ŒŒ, ?
)
ŒŒ? @
{
œœ( )
itemFileDelete
––, :
.
––: ;
IsActive
––; C
=
––D E
$num
––F G
;
––G H
itemFileDelete
——, :
.
——: ;
	IsDeleted
——; D
=
——E F
$num
——G H
;
——H I
_context
““, 4
.
““4 5
Entry
““5 :
(
““: ;
itemFileDelete
““; I
)
““I J
.
““J K
State
““K P
=
““Q R
EntityState
““S ^
.
““^ _
Modified
““_ g
;
““g h
_context
””, 4
.
””4 5
SaveChanges
””5 @
(
””@ A
)
””A B
;
””B C
}
‘‘( )
}
’’$ %
}
÷÷  !
foreach
ÿÿ  '
(
ÿÿ( )
var
ÿÿ) ,
itemFile
ÿÿ- 5
in
ÿÿ6 8
dataAssignFile
ÿÿ9 G
)
ÿÿG H
{
ŸŸ  !
var
⁄⁄$ '
data
⁄⁄( ,
=
⁄⁄- .
new
⁄⁄/ 2
object
⁄⁄3 9
(
⁄⁄9 :
)
⁄⁄: ;
;
⁄⁄; <
var
€€$ '
check
€€( -
=
€€. /
await
€€0 5
_context
€€6 >
.
€€> ?
TblFileUploadNops
€€? P
.
€€P Q
Where
€€Q V
(
€€V W
x
€€W X
=>
€€Y [
x
€€\ ]
.
€€] ^
Id
€€^ `
==
€€a c
itemFile
€€d l
.
€€l m
Id
€€m o
)
€€o p
.
€€p q"
FirstOrDefaultAsync€€q Ñ
(€€Ñ Ö
)€€Ö Ü
;€€Ü á
if
‹‹$ &
(
‹‹' (
System
‹‹( .
.
‹‹. /
IO
‹‹/ 1
.
‹‹1 2
File
‹‹2 6
.
‹‹6 7
Exists
‹‹7 =
(
‹‹= >
check
‹‹> C
.
‹‹C D
FilePath
‹‹D L
)
‹‹L M
)
‹‹M N
{
››$ %
byte
ﬁﬁ( ,
[
ﬁﬁ, -
]
ﬁﬁ- .
	fileBytes
ﬁﬁ/ 8
=
ﬁﬁ9 :
System
ﬁﬁ; A
.
ﬁﬁA B
IO
ﬁﬁB D
.
ﬁﬁD E
File
ﬁﬁE I
.
ﬁﬁI J
ReadAllBytes
ﬁﬁJ V
(
ﬁﬁV W
check
ﬁﬁW \
.
ﬁﬁ\ ]
FilePath
ﬁﬁ] e
)
ﬁﬁe f
;
ﬁﬁf g
string
··( .
base64String
··/ ;
=
··< =
Convert
··> E
.
··E F
ToBase64String
··F T
(
··T U
	fileBytes
··U ^
)
··^ _
;
··_ `
var
„„( +)
jsonParseReturnUploadBase64
„„, G
=
„„H I
JsonConvert
„„J U
.
„„U V
DeserializeObject
„„V g
<
„„g h!
ResultStatusDataInt
„„h {
<
„„{ |"
ResultStatusDataNop„„| è
>„„è ê
>„„ê ë
(„„ë í
$str„„í î
)„„î ï
;„„ï ñ
var
‰‰( +
urlUploadBase64
‰‰, ;
=
‰‰< =
	GetConfig
‰‰> G
.
‰‰G H

AppSetting
‰‰H R
[
‰‰R S
$str
‰‰S d
]
‰‰d e
+
‰‰f g
	GetConfig
‰‰h q
.
‰‰q r

AppSetting
‰‰r |
[
‰‰| }
$str‰‰} ó
]‰‰ó ò
+‰‰ô ö

dataAssign‰‰õ •
.‰‰• ¶
IdNopFromApi‰‰¶ ≤
;‰‰≤ ≥
(
ÂÂ( )
bool
ÂÂ) -#
resultApiUploadBase64
ÂÂ. C
,
ÂÂC D
string
ÂÂE K 
resultUploadBase64
ÂÂL ^
)
ÂÂ^ _
=
ÂÂ` a
RequestToAPI
ÂÂb n
.
ÂÂn o"
PostRequestToWebApiÂÂo Ç
(ÂÂÇ É
urlUploadBase64ÂÂÉ í
,ÂÂí ì
newÂÂî ó
{
ÊÊ( )
FileName
ÁÁ, 4
=
ÁÁ5 6
itemFile
ÁÁ7 ?
.
ÁÁ? @
FileName
ÁÁ@ H
,
ÁÁH I
FileContent
ËË, 7
=
ËË8 9
base64String
ËË: F
,
ËËF G
}
ÈÈ( )
,
ÈÈ) *
null
ÈÈ+ /
)
ÈÈ/ 0
;
ÈÈ0 1
if
ÍÍ( *
(
ÍÍ+ ,#
resultApiUploadBase64
ÍÍ, A
&&
ÍÍB D
!
ÍÍE F
string
ÍÍF L
.
ÍÍL M
IsNullOrEmpty
ÍÍM Z
(
ÍÍZ [ 
resultUploadBase64
ÍÍ[ m
)
ÍÍm n
)
ÍÍn o
{
ÎÎ( ))
jsonParseReturnUploadBase64
ÏÏ, G
=
ÏÏH I
JsonConvert
ÏÏJ U
.
ÏÏU V
DeserializeObject
ÏÏV g
<
ÏÏg h!
ResultStatusDataInt
ÏÏh {
<
ÏÏ{ |"
ResultStatusDataNopÏÏ| è
>ÏÏè ê
>ÏÏê ë
(ÏÏë í"
resultUploadBase64ÏÏí §
)ÏÏ§ •
;ÏÏ• ¶
if
ÌÌ, .
(
ÌÌ/ 0)
jsonParseReturnUploadBase64
ÌÌ0 K
.
ÌÌK L

StatusCode
ÌÌL V
==
ÌÌW Y
$num
ÌÌZ ]
||
ÌÌ^ `)
jsonParseReturnUploadBase64
ÌÌa |
.
ÌÌ| }

StatusCodeÌÌ} á
==ÌÌà ä
$numÌÌã é
)ÌÌé è
{
ÓÓ, -
itemFile
ÔÔ0 8
.
ÔÔ8 9
IdFileFromApi
ÔÔ9 F
=
ÔÔG H)
jsonParseReturnUploadBase64
ÔÔI d
.
ÔÔd e
Data
ÔÔe i
.
ÔÔi j
Key
ÔÔj m
;
ÔÔm n
_context
0 8
.
8 9
Entry
9 >
(
> ?
itemFile
? G
)
G H
.
H I
State
I N
=
O P
EntityState
Q \
.
\ ]
Modified
] e
;
e f
_context
ÒÒ0 8
.
ÒÒ8 9
SaveChanges
ÒÒ9 D
(
ÒÒD E
)
ÒÒE F
;
ÒÒF G
}
ÚÚ, -
}
ÛÛ( )
}
ÙÙ$ %
}
ıı  !
var
˘˘  ##
jsonParseReturnUpdate
˘˘$ 9
=
˘˘: ;
JsonConvert
˘˘< G
.
˘˘G H
DeserializeObject
˘˘H Y
<
˘˘Y Z!
ResultStatusDataInt
˘˘Z m
<
˘˘m n"
ResultStatusDataNop˘˘n Å
>˘˘Å Ç
>˘˘Ç É
(˘˘É Ñ
$str˘˘Ñ Ü
)˘˘Ü á
;˘˘á à
var
˙˙  #
	urlUpdate
˙˙$ -
=
˙˙. /
	GetConfig
˙˙0 9
.
˙˙9 :

AppSetting
˙˙: D
[
˙˙D E
$str
˙˙E V
]
˙˙V W
+
˙˙X Y
	GetConfig
˙˙Z c
.
˙˙c d

AppSetting
˙˙d n
[
˙˙n o
$str˙˙o É
]˙˙É Ñ
+˙˙Ö Ü

dataAssign˙˙á ë
.˙˙ë í
IdNopFromApi˙˙í û
;˙˙û ü
(
˚˚  !
bool
˚˚! %
resultApiUpdate
˚˚& 5
,
˚˚5 6
string
˚˚7 =
resultUpdate
˚˚> J
)
˚˚J K
=
˚˚L M
RequestToAPI
˚˚N Z
.
˚˚Z [ 
PutRequestToWebApi
˚˚[ m
(
˚˚m n
	urlUpdate
˚˚n w
,
˚˚w x
model
˚˚y ~
,
˚˚~ 
null˚˚Ä Ñ
)˚˚Ñ Ö
;˚˚Ö Ü
if
¸¸  "
(
¸¸# $
resultApiUpdate
¸¸$ 3
&&
¸¸4 6
!
¸¸7 8
string
¸¸8 >
.
¸¸> ?
IsNullOrEmpty
¸¸? L
(
¸¸L M
resultUpdate
¸¸M Y
)
¸¸Y Z
)
¸¸Z [
{
˝˝  !#
jsonParseReturnUpdate
˛˛$ 9
=
˛˛: ;
JsonConvert
˛˛< G
.
˛˛G H
DeserializeObject
˛˛H Y
<
˛˛Y Z!
ResultStatusDataInt
˛˛Z m
<
˛˛m n"
ResultStatusDataNop˛˛n Å
>˛˛Å Ç
>˛˛Ç É
(˛˛É Ñ
resultUpdate˛˛Ñ ê
)˛˛ê ë
;˛˛ë í
if
ˇˇ$ &
(
ˇˇ' (#
jsonParseReturnUpdate
ˇˇ( =
.
ˇˇ= >

StatusCode
ˇˇ> H
==
ˇˇI K
$num
ˇˇL O
||
ˇˇP R#
jsonParseReturnUpdate
ˇˇS h
.
ˇˇh i

StatusCode
ˇˇi s
==
ˇˇt v
$num
ˇˇw z
)
ˇˇz {
{
ÄÄ$ %

dataAssign
ÅÅ( 2
.
ÅÅ2 3
Status
ÅÅ3 9
=
ÅÅ: ;#
jsonParseReturnUpdate
ÅÅ< Q
.
ÅÅQ R
Data
ÅÅR V
.
ÅÅV W
Status
ÅÅW ]
;
ÅÅ] ^

dataAssign
ÇÇ( 2
.
ÇÇ2 3
LastSentDate
ÇÇ3 ?
=
ÇÇ@ A
DateTime
ÇÇB J
.
ÇÇJ K
Now
ÇÇK N
;
ÇÇN O
_context
ÉÉ( 0
.
ÉÉ0 1
Entry
ÉÉ1 6
(
ÉÉ6 7

dataAssign
ÉÉ7 A
)
ÉÉA B
.
ÉÉB C
State
ÉÉC H
=
ÉÉI J
EntityState
ÉÉK V
.
ÉÉV W
Modified
ÉÉW _
;
ÉÉ_ `
_context
ÑÑ( 0
.
ÑÑ0 1
SaveChanges
ÑÑ1 <
(
ÑÑ< =
)
ÑÑ= >
;
ÑÑ> ?
}
ÖÖ$ %
}
ÜÜ  !
}
áá 
else
àà  
{
ââ 

dataAssign
ää  *
.
ää* +
Status
ää+ 1
=
ää2 3"
jsonParseReturnCheck
ää4 H
.
ääH I
Data
ääI M
.
ääM N
Status
ääN T
;
ääT U

dataAssign
ãã  *
.
ãã* +
LastSentDate
ãã+ 7
=
ãã8 9
DateTime
ãã: B
.
ããB C
Now
ããC F
;
ããF G
_context
åå  (
.
åå( )
Entry
åå) .
(
åå. /

dataAssign
åå/ 9
)
åå9 :
.
åå: ;
State
åå; @
=
ååA B
EntityState
ååC N
.
ååN O
Modified
ååO W
;
ååW X
_context
çç  (
.
çç( )
SaveChanges
çç) 4
(
çç4 5
)
çç5 6
;
çç6 7
}
éé 
}
èè 
}
êê 
else
ëë 
{
íí 
var
ìì  
jsonParseReturnAdd
ìì .
=
ìì/ 0
JsonConvert
ìì1 <
.
ìì< =
DeserializeObject
ìì= N
<
ììN O!
ResultStatusDataInt
ììO b
<
ììb c!
ResultStatusDataNop
ììc v
>
ììv w
>
ììw x
(
ììx y
$str
ììy {
)
ìì{ |
;
ìì| }
var
îî 
urlAdd
îî "
=
îî# $
	GetConfig
îî% .
.
îî. /

AppSetting
îî/ 9
[
îî9 :
$str
îî: K
]
îîK L
+
îîM N
	GetConfig
îîO X
.
îîX Y

AppSetting
îîY c
[
îîc d
$str
îîd u
]
îîu v
;
îîv w
(
ïï 
bool
ïï 
resultApiAdd
ïï *
,
ïï* +
string
ïï, 2
	resultAdd
ïï3 <
)
ïï< =
=
ïï> ?
RequestToAPI
ïï@ L
.
ïïL M!
PostRequestToWebApi
ïïM `
(
ïï` a
urlAdd
ïïa g
,
ïïg h
model
ïïi n
,
ïïn o
null
ïïp t
)
ïït u
;
ïïu v
if
ññ 
(
ññ 
resultApiAdd
ññ (
&&
ññ) +
!
ññ, -
string
ññ- 3
.
ññ3 4
IsNullOrEmpty
ññ4 A
(
ññA B
	resultAdd
ññB K
)
ññK L
)
ññL M
{
óó  
jsonParseReturnAdd
òò .
=
òò/ 0
JsonConvert
òò1 <
.
òò< =
DeserializeObject
òò= N
<
òòN O!
ResultStatusDataInt
òòO b
<
òòb c!
ResultStatusDataNop
òòc v
>
òòv w
>
òòw x
(
òòx y
	resultAddòòy Ç
)òòÇ É
;òòÉ Ñ
if
ôô 
(
ôô   
jsonParseReturnAdd
ôô  2
.
ôô2 3

StatusCode
ôô3 =
==
ôô> @
$num
ôôA D
||
ôôE G 
jsonParseReturnAdd
ôôH Z
.
ôôZ [

StatusCode
ôô[ e
==
ôôf h
$num
ôôi l
)
ôôl m
{
öö 

dataAssign
õõ  *
.
õõ* +
IdNopFromApi
õõ+ 7
=
õõ8 9 
jsonParseReturnAdd
õõ: L
.
õõL M
Data
õõM Q
.
õõQ R
Id
õõR T
;
õõT U

dataAssign
úú  *
.
úú* +
Status
úú+ 1
=
úú2 3 
jsonParseReturnAdd
úú4 F
.
úúF G
Data
úúG K
.
úúK L
Status
úúL R
;
úúR S

dataAssign
ùù  *
.
ùù* +
LastSentDate
ùù+ 7
=
ùù8 9
DateTime
ùù: B
.
ùùB C
Now
ùùC F
;
ùùF G
_context
ûû  (
.
ûû( )
Entry
ûû) .
(
ûû. /

dataAssign
ûû/ 9
)
ûû9 :
.
ûû: ;
State
ûû; @
=
ûûA B
EntityState
ûûC N
.
ûûN O
Modified
ûûO W
;
ûûW X
_context
üü  (
.
üü( )
SaveChanges
üü) 4
(
üü4 5
)
üü5 6
;
üü6 7
List
¢¢  $
<
¢¢$ %&
TblNoticeOfPaymentDetail
¢¢% =
>
¢¢= >
dataAssignDetail
¢¢? O
=
¢¢P Q
_context
¢¢R Z
.
¢¢Z ['
TblNoticeOfPaymentDetails
¢¢[ t
.
¢¢t u
Where
¢¢u z
(
¢¢z {
m
¢¢{ |
=>
¢¢} 
m¢¢Ä Å
.¢¢Å Ç
NopId¢¢Ç á
==¢¢à ä
int¢¢ã é
.¢¢é è
Parse¢¢è î
(¢¢î ï
item¢¢ï ô
)¢¢ô ö
&&¢¢õ ù
m¢¢û ü
.¢¢ü †
	IsDeleted¢¢† ©
==¢¢™ ¨
$num¢¢≠ Æ
)¢¢Æ Ø
.¢¢Ø ∞
ToList¢¢∞ ∂
(¢¢∂ ∑
)¢¢∑ ∏
;¢¢∏ π
foreach
££  '
(
££( )
var
££) ,

itemDetail
££- 7
in
££8 :
dataAssignDetail
££; K
)
££K L
{
§§  !
var
¶¶$ '&
jsonParseReturnAddDetail
¶¶( @
=
¶¶A B
JsonConvert
¶¶C N
.
¶¶N O
DeserializeObject
¶¶O `
<
¶¶` a!
ResultStatusDataInt
¶¶a t
<
¶¶t u"
ResultStatusDataNop¶¶u à
>¶¶à â
>¶¶â ä
(¶¶ä ã
$str¶¶ã ç
)¶¶ç é
;¶¶é è
var
ßß$ '
urlAddDetail
ßß( 4
=
ßß5 6
	GetConfig
ßß7 @
.
ßß@ A

AppSetting
ßßA K
[
ßßK L
$str
ßßL ]
]
ßß] ^
+
ßß_ `
	GetConfig
ßßa j
.
ßßj k

AppSetting
ßßk u
[
ßßu v
$strßßv ç
]ßßç é
;ßßé è
(
®®$ %
bool
®®% ) 
resultApiAddDetail
®®* <
,
®®< =
string
®®> D
resultAddDetail
®®E T
)
®®T U
=
®®V W
RequestToAPI
®®X d
.
®®d e!
PostRequestToWebApi
®®e x
(
®®x y
urlAddDetail®®y Ö
,®®Ö Ü
new®®á ä
{
©©$ %
NopId
™™( -
=
™™. /

dataAssign
™™0 :
.
™™: ;
IdNopFromApi
™™; G
,
™™G H
CreditorRef
´´( 3
=
´´4 5

itemDetail
´´6 @
.
´´@ A
CreditorRef
´´A L
,
´´L M
Outstanding
¨¨( 3
=
¨¨4 5

itemDetail
¨¨6 @
.
¨¨@ A
Outstanding
¨¨A L
,
¨¨L M
	Principal
≠≠( 1
=
≠≠2 3

itemDetail
≠≠4 >
.
≠≠> ?
	Principal
≠≠? H
,
≠≠H I
Interest
ÆÆ( 0
=
ÆÆ1 2

itemDetail
ÆÆ3 =
.
ÆÆ= >
Interest
ÆÆ> F
,
ÆÆF G
Fee
ØØ( +
=
ØØ, -

itemDetail
ØØ. 8
.
ØØ8 9
Fee
ØØ9 <
}
∞∞$ %
,
∞∞% &
null
∞∞' +
)
∞∞+ ,
;
∞∞, -
if
±±$ &
(
±±' ( 
resultApiAddDetail
±±( :
&&
±±; =
!
±±> ?
string
±±? E
.
±±E F
IsNullOrEmpty
±±F S
(
±±S T
resultAddDetail
±±T c
)
±±c d
)
±±d e
{
≤≤$ %&
jsonParseReturnAddDetail
≥≥( @
=
≥≥A B
JsonConvert
≥≥C N
.
≥≥N O
DeserializeObject
≥≥O `
<
≥≥` a!
ResultStatusDataInt
≥≥a t
<
≥≥t u"
ResultStatusDataNop≥≥u à
>≥≥à â
>≥≥â ä
(≥≥ä ã
resultAddDetail≥≥ã ö
)≥≥ö õ
;≥≥õ ú
if
¥¥( *
(
¥¥+ ,&
jsonParseReturnAddDetail
¥¥, D
.
¥¥D E

StatusCode
¥¥E O
==
¥¥P R
$num
¥¥S V
||
¥¥W Y&
jsonParseReturnAddDetail
¥¥Z r
.
¥¥r s

StatusCode
¥¥s }
==¥¥~ Ä
$num¥¥Å Ñ
)¥¥Ñ Ö
{
µµ( )

itemDetail
∂∂, 6
.
∂∂6 7 
IdNopDetailFromApi
∂∂7 I
=
∂∂J K&
jsonParseReturnAddDetail
∂∂L d
.
∂∂d e
Data
∂∂e i
.
∂∂i j
Id
∂∂j l
;
∂∂l m
_context
∑∑, 4
.
∑∑4 5
Entry
∑∑5 :
(
∑∑: ;

itemDetail
∑∑; E
)
∑∑E F
.
∑∑F G
State
∑∑G L
=
∑∑M N
EntityState
∑∑O Z
.
∑∑Z [
Modified
∑∑[ c
;
∑∑c d
_context
∏∏, 4
.
∏∏4 5
SaveChanges
∏∏5 @
(
∏∏@ A
)
∏∏A B
;
∏∏B C
}
ππ( )
else
∫∫( ,
{
ªª( )

itemDetail
ºº, 6
.
ºº6 7
	IsDeleted
ºº7 @
=
ººA B
$num
ººC D
;
ººD E
_context
ΩΩ, 4
.
ΩΩ4 5
Entry
ΩΩ5 :
(
ΩΩ: ;

itemDetail
ΩΩ; E
)
ΩΩE F
.
ΩΩF G
State
ΩΩG L
=
ΩΩM N
EntityState
ΩΩO Z
.
ΩΩZ [
Modified
ΩΩ[ c
;
ΩΩc d
_context
ææ, 4
.
ææ4 5
SaveChanges
ææ5 @
(
ææ@ A
)
ææA B
;
ææB C
}
øø( )
}
¿¿$ %
}
¡¡  !
List
ƒƒ  $
<
ƒƒ$ %
TblFileUploadNop
ƒƒ% 5
>
ƒƒ5 6
dataAssignFile
ƒƒ7 E
=
ƒƒF G
_context
ƒƒH P
.
ƒƒP Q
TblFileUploadNops
ƒƒQ b
.
ƒƒb c
Where
ƒƒc h
(
ƒƒh i
m
ƒƒi j
=>
ƒƒk m
m
ƒƒn o
.
ƒƒo p
IdNop
ƒƒp u
==
ƒƒv x
int
ƒƒy |
.
ƒƒ| }
Parseƒƒ} Ç
(ƒƒÇ É
itemƒƒÉ á
)ƒƒá à
&&ƒƒâ ã
mƒƒå ç
.ƒƒç é
	IsDeletedƒƒé ó
==ƒƒò ö
$numƒƒõ ú
)ƒƒú ù
.ƒƒù û
ToListƒƒû §
(ƒƒ§ •
)ƒƒ• ¶
;ƒƒ¶ ß
foreach
≈≈  '
(
≈≈( )
var
≈≈) ,
itemFile
≈≈- 5
in
≈≈6 8
dataAssignFile
≈≈9 G
)
≈≈G H
{
∆∆  !
var
««$ '
data
««( ,
=
««- .
new
««/ 2
object
««3 9
(
««9 :
)
««: ;
;
««; <
var
»»$ '
check
»»( -
=
»». /
await
»»0 5
_context
»»6 >
.
»»> ?
TblFileUploadNops
»»? P
.
»»P Q
Where
»»Q V
(
»»V W
x
»»W X
=>
»»Y [
x
»»\ ]
.
»»] ^
Id
»»^ `
==
»»a c
itemFile
»»d l
.
»»l m
Id
»»m o
)
»»o p
.
»»p q"
FirstOrDefaultAsync»»q Ñ
(»»Ñ Ö
)»»Ö Ü
;»»Ü á
if
……$ &
(
……' (
System
……( .
.
……. /
IO
……/ 1
.
……1 2
File
……2 6
.
……6 7
Exists
……7 =
(
……= >
check
……> C
.
……C D
FilePath
……D L
)
……L M
)
……M N
{
  $ %
byte
ÀÀ( ,
[
ÀÀ, -
]
ÀÀ- .
	fileBytes
ÀÀ/ 8
=
ÀÀ9 :
System
ÀÀ; A
.
ÀÀA B
IO
ÀÀB D
.
ÀÀD E
File
ÀÀE I
.
ÀÀI J
ReadAllBytes
ÀÀJ V
(
ÀÀV W
check
ÀÀW \
.
ÀÀ\ ]
FilePath
ÀÀ] e
)
ÀÀe f
;
ÀÀf g
string
ŒŒ( .
base64String
ŒŒ/ ;
=
ŒŒ< =
Convert
ŒŒ> E
.
ŒŒE F
ToBase64String
ŒŒF T
(
ŒŒT U
	fileBytes
ŒŒU ^
)
ŒŒ^ _
;
ŒŒ_ `
var
——( +)
jsonParseReturnUploadBase64
——, G
=
——H I
JsonConvert
——J U
.
——U V
DeserializeObject
——V g
<
——g h!
ResultStatusDataInt
——h {
<
——{ |"
ResultStatusDataNop——| è
>——è ê
>——ê ë
(——ë í
$str——í î
)——î ï
;——ï ñ
var
““( +
urlUploadBase64
““, ;
=
““< =
	GetConfig
““> G
.
““G H

AppSetting
““H R
[
““R S
$str
““S d
]
““d e
+
““f g
	GetConfig
““h q
.
““q r

AppSetting
““r |
[
““| }
$str““} ó
]““ó ò
+““ô ö"
jsonParseReturnAdd““õ ≠
.““≠ Æ
Data““Æ ≤
.““≤ ≥
Id““≥ µ
;““µ ∂
(
””( )
bool
””) -#
resultApiUploadBase64
””. C
,
””C D
string
””E K 
resultUploadBase64
””L ^
)
””^ _
=
””` a
RequestToAPI
””b n
.
””n o"
PostRequestToWebApi””o Ç
(””Ç É
urlUploadBase64””É í
,””í ì
new””î ó
{
‘‘( )
FileName
’’, 4
=
’’5 6
itemFile
’’7 ?
.
’’? @
FileName
’’@ H
,
’’H I
FileContent
÷÷, 7
=
÷÷8 9
base64String
÷÷: F
,
÷÷F G
}
◊◊( )
,
◊◊) *
null
◊◊+ /
)
◊◊/ 0
;
◊◊0 1
if
ÿÿ( *
(
ÿÿ+ ,#
resultApiUploadBase64
ÿÿ, A
&&
ÿÿB D
!
ÿÿE F
string
ÿÿF L
.
ÿÿL M
IsNullOrEmpty
ÿÿM Z
(
ÿÿZ [ 
resultUploadBase64
ÿÿ[ m
)
ÿÿm n
)
ÿÿn o
{
ŸŸ( ))
jsonParseReturnUploadBase64
⁄⁄, G
=
⁄⁄H I
JsonConvert
⁄⁄J U
.
⁄⁄U V
DeserializeObject
⁄⁄V g
<
⁄⁄g h!
ResultStatusDataInt
⁄⁄h {
<
⁄⁄{ |"
ResultStatusDataNop⁄⁄| è
>⁄⁄è ê
>⁄⁄ê ë
(⁄⁄ë í"
resultUploadBase64⁄⁄í §
)⁄⁄§ •
;⁄⁄• ¶
if
€€, .
(
€€/ 0)
jsonParseReturnUploadBase64
€€0 K
.
€€K L

StatusCode
€€L V
==
€€W Y
$num
€€Z ]
||
€€^ `)
jsonParseReturnUploadBase64
€€a |
.
€€| }

StatusCode€€} á
==€€à ä
$num€€ã é
)€€é è
{
‹‹, -
itemFile
››0 8
.
››8 9
IdFileFromApi
››9 F
=
››G H)
jsonParseReturnUploadBase64
››I d
.
››d e
Data
››e i
.
››i j
Key
››j m
;
››m n
_context
ﬁﬁ0 8
.
ﬁﬁ8 9
Entry
ﬁﬁ9 >
(
ﬁﬁ> ?
itemFile
ﬁﬁ? G
)
ﬁﬁG H
.
ﬁﬁH I
State
ﬁﬁI N
=
ﬁﬁO P
EntityState
ﬁﬁQ \
.
ﬁﬁ\ ]
Modified
ﬁﬁ] e
;
ﬁﬁe f
_context
ﬂﬂ0 8
.
ﬂﬂ8 9
SaveChanges
ﬂﬂ9 D
(
ﬂﬂD E
)
ﬂﬂE F
;
ﬂﬂF G
}
‡‡, -
}
··( )
}
‚‚$ %
}
„„  !
}
‰‰ 
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÍÍ 
throw
ÎÎ 
;
ÎÎ 
}
ÏÏ 
}
ÌÌ 	
}
ÓÓ 
}ÔÔ ®Ø
GD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\RequestToApi.cs
public 
class 
RequestToAPI 
{ 
public 

static 
( 
bool 
, 
string 
)  
GetJsonStringWebApi! 4
(4 5
string5 ;
apiUrl< B
,B C
stringD J
tokenK P
=Q R
nullS W
,W X
intY \
TimeOutSecond] j
=k l
$numm o
)o p
{ 
bool 
	resultApi 
= 
false 
; 
string 

JsonString 
= 
string "
." #
Empty# (
;( )
try 
{ 	
using 
( 

HttpClient 

httpClient (
=) *
new+ .

HttpClient/ 9
(9 :
): ;
); <
{ 

httpClient 
. !
DefaultRequestHeaders 0
.0 1
Accept1 7
.7 8
Clear8 =
(= >
)> ?
;? @

httpClient 
. !
DefaultRequestHeaders 0
.0 1
Accept1 7
.7 8
Add8 ;
(; <
new< ?+
MediaTypeWithQualityHeaderValue@ _
(_ `
$str` r
)r s
)s t
;t u
if   
(   
!   
string   
.   
IsNullOrEmpty   )
(  ) *
token  * /
)  / 0
)  0 1

httpClient!! 
.!! !
DefaultRequestHeaders!! 4
.!!4 5
Add!!5 8
(!!8 9
$str!!9 H
,!!H I
$str!!J S
+!!T U
token!!V [
)!![ \
;!!\ ]

httpClient## 
.## 
Timeout## "
=### $
TimeSpan##% -
.##- .
FromSeconds##. 9
(##9 :
TimeOutSecond##: G
)##G H
;##H I
var$$ 
result$$ 
=$$ 

httpClient$$ '
.$$' (
GetAsync$$( 0
($$0 1
apiUrl$$1 7
)$$7 8
.$$8 9
Result$$9 ?
;$$? @
if%% 
(%% 
result%% 
.%% 
IsSuccessStatusCode%% .
)%%. /
{&& 
	resultApi'' 
='' 
true''  $
;''$ %

JsonString(( 
=((  
result((! '
.((' (
Content((( /
.((/ 0
ReadAsStringAsync((0 A
(((A B
)((B C
.((C D
Result((D J
;((J K
})) 
}** 
}++ 	
catch,, 
{-- 	
throw.. 
;.. 
}// 	
return00 
(00 
	resultApi00 
,00 

JsonString00 %
)00% &
;00& '
}11 
public88 

static88 
async88 
Task88 
<88 
string88 #
>88# $$
GetJsonStringWebApiAsync88% =
(88= >
string88> D
apiUrl88E K
,88K L
int88M P
TimeOutSecond88Q ^
=88_ `
$num88a c
)88c d
{99 
string:: 

JsonString:: 
=:: 
string:: "
.::" #
Empty::# (
;::( )
try;; 
{<< 	
using== 
(== 

HttpClient== 

httpClient== (
===) *
new==+ .

HttpClient==/ 9
(==9 :
)==: ;
)==; <
{>> 

httpClient?? 
.?? !
DefaultRequestHeaders?? 0
.??0 1
Accept??1 7
.??7 8
Clear??8 =
(??= >
)??> ?
;??? @

httpClient@@ 
.@@ !
DefaultRequestHeaders@@ 0
.@@0 1
Accept@@1 7
.@@7 8
Add@@8 ;
(@@; <
new@@< ?+
MediaTypeWithQualityHeaderValue@@@ _
(@@_ `
$str@@` r
)@@r s
)@@s t
;@@t u

httpClientAA 
.AA 
TimeoutAA "
=AA# $
TimeSpanAA% -
.AA- .
FromSecondsAA. 9
(AA9 :
TimeOutSecondAA: G
)AAG H
;AAH I
varBB 
resultBB 
=BB 
awaitBB "

httpClientBB# -
.BB- .
GetAsyncBB. 6
(BB6 7
apiUrlBB7 =
)BB= >
;BB> ?
ifCC 
(CC 
resultCC 
.CC 
IsSuccessStatusCodeCC .
)CC. /
{DD 

JsonStringEE 
=EE  
awaitEE! &
resultEE' -
.EE- .
ContentEE. 5
.EE5 6
ReadAsStringAsyncEE6 G
(EEG H
)EEH I
;EEI J
}FF 
}GG 
}HH 	
catchII 
{JJ 	
throwKK 
;KK 
}LL 	
returnMM 

JsonStringMM 
;MM 
}NN 
publicWW 

staticWW 
(WW 
boolWW 
,WW 
stringWW 
)WW  
PostRequestToWebApiWW! 4
(WW4 5
stringWW5 ;
apiUrlWW< B
,WWB C
objectWWD J
requestWWK R
,WWR S
stringWWT Z
tokenWW[ `
=WWa b
nullWWc g
,WWg h
intWWi l
TimeOutSecondWWm z
=WW{ |
$numWW} 
)	WW Ä
{XX 
boolYY 
	resultApiYY 
=YY 
falseYY 
;YY 
stringZZ 

JsonStringZZ 
=ZZ 
stringZZ "
.ZZ" #
EmptyZZ# (
;ZZ( )
using[[ 
([[ 

HttpClient[[ 

httpClient[[ $
=[[% &
new[[' *

HttpClient[[+ 5
([[5 6
)[[6 7
)[[7 8
{\\ 	
var]] 
someData]] 
=]] 
JsonConvert]] &
.]]& '
SerializeObject]]' 6
(]]6 7
request]]7 >
)]]> ?
;]]? @
var^^ 
content^^ 
=^^ 
new^^ 
StringContent^^ +
(^^+ ,
someData^^, 4
,^^4 5
System^^6 <
.^^< =
Text^^= A
.^^A B
Encoding^^B J
.^^J K
UTF8^^K O
,^^O P
$str^^Q c
)^^c d
;^^d e
if__ 
(__ 
!__ 
string__ 
.__ 
IsNullOrEmpty__ %
(__% &
token__& +
)__+ ,
)__, -

httpClient`` 
.`` !
DefaultRequestHeaders`` 0
.``0 1
Add``1 4
(``4 5
$str``5 D
,``D E
$str``F O
+``P Q
token``R W
)``W X
;``X Y

httpClientbb 
.bb 
Timeoutbb 
=bb  
TimeSpanbb! )
.bb) *
FromSecondsbb* 5
(bb5 6
TimeOutSecondbb6 C
)bbC D
;bbD E

httpClientcc 
.cc !
DefaultRequestHeaderscc ,
.cc, -
Acceptcc- 3
.cc3 4
Clearcc4 9
(cc9 :
)cc: ;
;cc; <
vardd 
resultdd 
=dd 

httpClientdd #
.dd# $
	PostAsyncdd$ -
(dd- .
apiUrldd. 4
,dd4 5
contentdd6 =
)dd= >
.dd> ?
Resultdd? E
;ddE F
ifee 
(ee 
resultee 
.ee 
IsSuccessStatusCodeee *
)ee* +
{ff 
	resultApigg 
=gg 
truegg  
;gg  !

JsonStringhh 
=hh 
resulthh #
.hh# $
Contenthh$ +
.hh+ ,
ReadAsStringAsynchh, =
(hh= >
)hh> ?
.hh? @
Resulthh@ F
;hhF G
}ii 
elsejj 
{kk 

JsonStringll 
=ll 
resultll #
.ll# $
Contentll$ +
.ll+ ,
ReadAsStringAsyncll, =
(ll= >
)ll> ?
.ll? @
Resultll@ F
;llF G
}mm 
}nn 	
returnoo 
(oo 
	resultApioo 
,oo 

JsonStringoo %
)oo% &
;oo& '
}pp 
publiczz 

staticzz 
asynczz 
Taskzz 
<zz 
stringzz #
>zz# $$
PostRequestToWebApiAsynczz% =
(zz= >
stringzz> D
apiUrlzzE K
,zzK L
objectzzM S
requestzzT [
,zz[ \
intzz] `
TimeOutSecondzza n
=zzo p
$numzzq s
)zzs t
{{{ 
string|| 

JsonString|| 
=|| 
string|| "
.||" #
Empty||# (
;||( )
using}} 
(}} 

HttpClient}} 

httpClient}} $
=}}% &
new}}' *

HttpClient}}+ 5
(}}5 6
)}}6 7
)}}7 8
{~~ 	
var 
someData 
= 
JsonConvert &
.& '
SerializeObject' 6
(6 7
request7 >
)> ?
;? @
var
ÄÄ 
content
ÄÄ 
=
ÄÄ 
new
ÄÄ 
StringContent
ÄÄ +
(
ÄÄ+ ,
someData
ÄÄ, 4
,
ÄÄ4 5
System
ÄÄ6 <
.
ÄÄ< =
Text
ÄÄ= A
.
ÄÄA B
Encoding
ÄÄB J
.
ÄÄJ K
UTF8
ÄÄK O
,
ÄÄO P
$str
ÄÄQ c
)
ÄÄc d
;
ÄÄd e

httpClient
ÅÅ 
.
ÅÅ 
Timeout
ÅÅ 
=
ÅÅ  
TimeSpan
ÅÅ! )
.
ÅÅ) *
FromSeconds
ÅÅ* 5
(
ÅÅ5 6
TimeOutSecond
ÅÅ6 C
)
ÅÅC D
;
ÅÅD E

httpClient
ÇÇ 
.
ÇÇ #
DefaultRequestHeaders
ÇÇ ,
.
ÇÇ, -
Accept
ÇÇ- 3
.
ÇÇ3 4
Clear
ÇÇ4 9
(
ÇÇ9 :
)
ÇÇ: ;
;
ÇÇ; <
var
ÉÉ 
result
ÉÉ 
=
ÉÉ 
await
ÉÉ 

httpClient
ÉÉ )
.
ÉÉ) *
	PostAsync
ÉÉ* 3
(
ÉÉ3 4
apiUrl
ÉÉ4 :
,
ÉÉ: ;
content
ÉÉ< C
)
ÉÉC D
;
ÉÉD E
if
ÑÑ 
(
ÑÑ 
result
ÑÑ 
.
ÑÑ !
IsSuccessStatusCode
ÑÑ *
)
ÑÑ* +
{
ÖÖ 

JsonString
ÜÜ 
=
ÜÜ 
await
ÜÜ "
result
ÜÜ# )
.
ÜÜ) *
Content
ÜÜ* 1
.
ÜÜ1 2
ReadAsStringAsync
ÜÜ2 C
(
ÜÜC D
)
ÜÜD E
;
ÜÜE F
}
áá 
}
àà 	
return
ââ 

JsonString
ââ 
;
ââ 
}
ää 
public
ìì 

static
ìì 
(
ìì 
bool
ìì 
,
ìì 
string
ìì 
)
ìì  "
PostFormDataToWebApi
ìì! 5
(
ìì5 6
string
ìì6 <
apiUrl
ìì= C
,
ììC D
object
ììE K
request
ììL S
,
ììS T
string
ììU [
token
ìì\ a
=
ììb c
null
ììd h
,
ììh i
int
ììj m
TimeOutSecond
ììn {
=
ìì| }
$numìì~ Ä
)ììÄ Å
{
îî 
bool
ïï 
	resultApi
ïï 
=
ïï 
false
ïï 
;
ïï 
string
ññ 

JsonString
ññ 
=
ññ 
string
ññ "
.
ññ" #
Empty
ññ# (
;
ññ( )
using
óó 
(
óó 

HttpClient
óó 

httpClient
óó $
=
óó% &
new
óó' *

HttpClient
óó+ 5
(
óó5 6
)
óó6 7
)
óó7 8
{
òò 	
var
ôô 
formData
ôô 
=
ôô 
new
ôô &
MultipartFormDataContent
ôô 7
(
ôô7 8
)
ôô8 9
;
ôô9 :
foreach
õõ 
(
õõ 
var
õõ 
prop
õõ 
in
õõ  
request
õõ! (
.
õõ( )
GetType
õõ) 0
(
õõ0 1
)
õõ1 2
.
õõ2 3
GetProperties
õõ3 @
(
õõ@ A
)
õõA B
)
õõB C
{
úú 
string
ùù 
name
ùù 
=
ùù 
prop
ùù "
.
ùù" #
Name
ùù# '
;
ùù' (
if
üü 
(
üü 
prop
üü 
.
üü 
PropertyType
üü %
==
üü& (
typeof
üü) /
(
üü/ 0
	IFormFile
üü0 9
)
üü9 :
)
üü: ;
{
†† 
	IFormFile
°° 
file
°° "
=
°°# $
(
°°% &
(
°°& '
	IFormFile
°°' 0
)
°°0 1
prop
°°1 5
.
°°5 6
GetValue
°°6 >
(
°°> ?
request
°°? F
,
°°F G
null
°°H L
)
°°L M
)
°°M N
;
°°N O
if
¢¢ 
(
¢¢ 
file
¢¢ 
!=
¢¢ 
null
¢¢  $
)
¢¢$ %
formData
££  
.
££  !
Add
££! $
(
££$ %
new
££% (
StreamContent
££) 6
(
££6 7
file
££7 ;
.
££; <
OpenReadStream
££< J
(
££J K
)
££K L
)
££L M
,
££M N
prop
££O S
.
££S T
Name
££T X
,
££X Y
file
££Z ^
.
££^ _
FileName
££_ g
)
££g h
;
££h i
}
§§ 
else
•• 
if
•• 
(
•• 
prop
•• 
.
•• 
PropertyType
•• *
==
••+ -
typeof
••. 4
(
••4 5
	IFormFile
••5 >
[
••> ?
]
••? @
)
••@ A
)
••A B
{
¶¶ 
	IFormFile
ßß 
[
ßß 
]
ßß 
files
ßß  %
=
ßß& '
(
ßß( )
(
ßß) *
	IFormFile
ßß* 3
[
ßß3 4
]
ßß4 5
)
ßß5 6
prop
ßß6 :
.
ßß: ;
GetValue
ßß; C
(
ßßC D
request
ßßD K
,
ßßK L
null
ßßM Q
)
ßßQ R
)
ßßR S
;
ßßS T
if
®® 
(
®® 
files
®® 
!=
®®  
null
®®! %
)
®®% &
{
©© 
foreach
™™ 
(
™™  !
var
™™! $
file
™™% )
in
™™* ,
files
™™- 2
)
™™2 3
{
´´ 
if
¨¨ 
(
¨¨  
file
¨¨  $
!=
¨¨% '
null
¨¨( ,
)
¨¨, -
{
≠≠ 
formData
ÆÆ  (
.
ÆÆ( )
Add
ÆÆ) ,
(
ÆÆ, -
new
ÆÆ- 0
StreamContent
ÆÆ1 >
(
ÆÆ> ?
file
ÆÆ? C
.
ÆÆC D
OpenReadStream
ÆÆD R
(
ÆÆR S
)
ÆÆS T
)
ÆÆT U
,
ÆÆU V
prop
ÆÆW [
.
ÆÆ[ \
Name
ÆÆ\ `
,
ÆÆ` a
file
ÆÆb f
.
ÆÆf g
FileName
ÆÆg o
)
ÆÆo p
;
ÆÆp q
}
ØØ 
}
∞∞ 
}
±± 
}
≤≤ 
else
≥≥ 
{
¥¥ 
var
µµ 
value
µµ 
=
µµ 
(
µµ  !
prop
µµ! %
.
µµ% &
GetValue
µµ& .
(
µµ. /
request
µµ/ 6
,
µµ6 7
null
µµ8 <
)
µµ< =
??
µµ> @
string
µµA G
.
µµG H
Empty
µµH M
)
µµM N
.
µµN O
ToString
µµO W
(
µµW X
)
µµX Y
;
µµY Z
formData
∂∂ 
.
∂∂ 
Add
∂∂  
(
∂∂  !
new
∂∂! $
StringContent
∂∂% 2
(
∂∂2 3
value
∂∂3 8
)
∂∂8 9
,
∂∂9 :
prop
∂∂; ?
.
∂∂? @
Name
∂∂@ D
)
∂∂D E
;
∂∂E F
}
∑∑ 
}
∏∏ 
if
∫∫ 
(
∫∫ 
!
∫∫ 
string
∫∫ 
.
∫∫ 
IsNullOrEmpty
∫∫ %
(
∫∫% &
token
∫∫& +
)
∫∫+ ,
)
∫∫, -

httpClient
ªª 
.
ªª #
DefaultRequestHeaders
ªª 0
.
ªª0 1
Add
ªª1 4
(
ªª4 5
$str
ªª5 D
,
ªªD E
$str
ªªF O
+
ªªP Q
token
ªªR W
)
ªªW X
;
ªªX Y

httpClient
ΩΩ 
.
ΩΩ 
Timeout
ΩΩ 
=
ΩΩ  
TimeSpan
ΩΩ! )
.
ΩΩ) *
FromSeconds
ΩΩ* 5
(
ΩΩ5 6
TimeOutSecond
ΩΩ6 C
)
ΩΩC D
;
ΩΩD E

httpClient
øø 
.
øø #
DefaultRequestHeaders
øø ,
.
øø, -
Accept
øø- 3
.
øø3 4
Clear
øø4 9
(
øø9 :
)
øø: ;
;
øø; <
var
¿¿ 
result
¿¿ 
=
¿¿ 

httpClient
¿¿ #
.
¿¿# $
	PostAsync
¿¿$ -
(
¿¿- .
apiUrl
¿¿. 4
,
¿¿4 5
formData
¿¿6 >
)
¿¿> ?
.
¿¿? @
Result
¿¿@ F
;
¿¿F G
if
¡¡ 
(
¡¡ 
result
¡¡ 
.
¡¡ !
IsSuccessStatusCode
¡¡ *
)
¡¡* +
{
¬¬ 
	resultApi
√√ 
=
√√ 
true
√√  
;
√√  !

JsonString
ƒƒ 
=
ƒƒ 
result
ƒƒ #
.
ƒƒ# $
Content
ƒƒ$ +
.
ƒƒ+ ,
ReadAsStringAsync
ƒƒ, =
(
ƒƒ= >
)
ƒƒ> ?
.
ƒƒ? @
Result
ƒƒ@ F
;
ƒƒF G
}
≈≈ 
else
∆∆ 
{
«« 

JsonString
»» 
=
»» 
result
»» #
.
»»# $
Content
»»$ +
.
»»+ ,
ReadAsStringAsync
»», =
(
»»= >
)
»»> ?
.
»»? @
Result
»»@ F
;
»»F G
}
…… 
}
   	
return
ÀÀ 
(
ÀÀ 
	resultApi
ÀÀ 
,
ÀÀ 

JsonString
ÀÀ %
)
ÀÀ% &
;
ÀÀ& '
}
ÃÃ 
public
’’ 

static
’’ 
(
’’ 
bool
’’ 
,
’’ 
string
’’ 
)
’’  &
PostFormDataJsonToWebApi
’’! 9
(
’’9 :
string
’’: @
apiUrl
’’A G
,
’’G H
object
’’I O
request
’’P W
,
’’W X
object
’’Y _
requestJson
’’` k
,
’’k l
string
’’m s
token
’’t y
=
’’z {
null’’| Ä
,’’Ä Å
int’’Ç Ö
TimeOutSecond’’Ü ì
=’’î ï
$num’’ñ ò
)’’ò ô
{
÷÷ 
bool
◊◊ 
	resultApi
◊◊ 
=
◊◊ 
false
◊◊ 
;
◊◊ 
string
ÿÿ 

JsonString
ÿÿ 
=
ÿÿ 
string
ÿÿ "
.
ÿÿ" #
Empty
ÿÿ# (
;
ÿÿ( )
using
ŸŸ 
(
ŸŸ 

HttpClient
ŸŸ 

httpClient
ŸŸ $
=
ŸŸ% &
new
ŸŸ' *

HttpClient
ŸŸ+ 5
(
ŸŸ5 6
)
ŸŸ6 7
)
ŸŸ7 8
{
⁄⁄ 	
var
€€ 
formData
€€ 
=
€€ 
new
€€ &
MultipartFormDataContent
€€ 7
(
€€7 8
)
€€8 9
;
€€9 :
var
‹‹ 
json
‹‹ 
=
‹‹ 
JsonConvert
‹‹ "
.
‹‹" #
SerializeObject
‹‹# 2
(
‹‹2 3
requestJson
‹‹3 >
)
‹‹> ?
;
‹‹? @
formData
ﬁﬁ 
.
ﬁﬁ 
Add
ﬁﬁ 
(
ﬁﬁ 
new
ﬁﬁ 
StringContent
ﬁﬁ *
(
ﬁﬁ* +
json
ﬁﬁ+ /
,
ﬁﬁ/ 0
Encoding
ﬁﬁ1 9
.
ﬁﬁ9 :
Unicode
ﬁﬁ: A
,
ﬁﬁA B
$str
ﬁﬁC U
)
ﬁﬁU V
)
ﬁﬁV W
;
ﬁﬁW X
foreach
ﬂﬂ 
(
ﬂﬂ 
var
ﬂﬂ 
prop
ﬂﬂ 
in
ﬂﬂ  
request
ﬂﬂ! (
.
ﬂﬂ( )
GetType
ﬂﬂ) 0
(
ﬂﬂ0 1
)
ﬂﬂ1 2
.
ﬂﬂ2 3
GetProperties
ﬂﬂ3 @
(
ﬂﬂ@ A
)
ﬂﬂA B
)
ﬂﬂB C
{
‡‡ 
string
·· 
name
·· 
=
·· 
prop
·· "
.
··" #
Name
··# '
;
··' (
if
„„ 
(
„„ 
prop
„„ 
.
„„ 
PropertyType
„„ %
==
„„& (
typeof
„„) /
(
„„/ 0
	IFormFile
„„0 9
)
„„9 :
)
„„: ;
{
‰‰ 
	IFormFile
ÂÂ 
file
ÂÂ "
=
ÂÂ# $
(
ÂÂ% &
(
ÂÂ& '
	IFormFile
ÂÂ' 0
)
ÂÂ0 1
prop
ÂÂ1 5
.
ÂÂ5 6
GetValue
ÂÂ6 >
(
ÂÂ> ?
request
ÂÂ? F
,
ÂÂF G
null
ÂÂH L
)
ÂÂL M
)
ÂÂM N
;
ÂÂN O
if
ÊÊ 
(
ÊÊ 
file
ÊÊ 
!=
ÊÊ 
null
ÊÊ  $
)
ÊÊ$ %
formData
ÁÁ  
.
ÁÁ  !
Add
ÁÁ! $
(
ÁÁ$ %
new
ÁÁ% (
StreamContent
ÁÁ) 6
(
ÁÁ6 7
file
ÁÁ7 ;
.
ÁÁ; <
OpenReadStream
ÁÁ< J
(
ÁÁJ K
)
ÁÁK L
)
ÁÁL M
,
ÁÁM N
prop
ÁÁO S
.
ÁÁS T
Name
ÁÁT X
,
ÁÁX Y
file
ÁÁZ ^
.
ÁÁ^ _
FileName
ÁÁ_ g
)
ÁÁg h
;
ÁÁh i
}
ËË 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
prop
ÈÈ 
.
ÈÈ 
PropertyType
ÈÈ *
==
ÈÈ+ -
typeof
ÈÈ. 4
(
ÈÈ4 5
	IFormFile
ÈÈ5 >
[
ÈÈ> ?
]
ÈÈ? @
)
ÈÈ@ A
)
ÈÈA B
{
ÍÍ 
	IFormFile
ÎÎ 
[
ÎÎ 
]
ÎÎ 
files
ÎÎ  %
=
ÎÎ& '
(
ÎÎ( )
(
ÎÎ) *
	IFormFile
ÎÎ* 3
[
ÎÎ3 4
]
ÎÎ4 5
)
ÎÎ5 6
prop
ÎÎ6 :
.
ÎÎ: ;
GetValue
ÎÎ; C
(
ÎÎC D
request
ÎÎD K
,
ÎÎK L
null
ÎÎM Q
)
ÎÎQ R
)
ÎÎR S
;
ÎÎS T
if
ÏÏ 
(
ÏÏ 
files
ÏÏ 
!=
ÏÏ  
null
ÏÏ! %
)
ÏÏ% &
{
ÌÌ 
foreach
ÓÓ 
(
ÓÓ  !
var
ÓÓ! $
file
ÓÓ% )
in
ÓÓ* ,
files
ÓÓ- 2
)
ÓÓ2 3
{
ÔÔ 
if
 
(
  
file
  $
!=
% '
null
( ,
)
, -
{
ÒÒ 
formData
ÚÚ  (
.
ÚÚ( )
Add
ÚÚ) ,
(
ÚÚ, -
new
ÚÚ- 0
StreamContent
ÚÚ1 >
(
ÚÚ> ?
file
ÚÚ? C
.
ÚÚC D
OpenReadStream
ÚÚD R
(
ÚÚR S
)
ÚÚS T
)
ÚÚT U
,
ÚÚU V
prop
ÚÚW [
.
ÚÚ[ \
Name
ÚÚ\ `
,
ÚÚ` a
file
ÚÚb f
.
ÚÚf g
FileName
ÚÚg o
)
ÚÚo p
;
ÚÚp q
}
ÛÛ 
}
ÙÙ 
}
ıı 
}
ˆˆ 
else
˜˜ 
{
¯¯ 
var
˘˘ 
value
˘˘ 
=
˘˘ 
(
˘˘  !
prop
˘˘! %
.
˘˘% &
GetValue
˘˘& .
(
˘˘. /
request
˘˘/ 6
,
˘˘6 7
null
˘˘8 <
)
˘˘< =
??
˘˘> @
string
˘˘A G
.
˘˘G H
Empty
˘˘H M
)
˘˘M N
.
˘˘N O
ToString
˘˘O W
(
˘˘W X
)
˘˘X Y
;
˘˘Y Z
formData
˙˙ 
.
˙˙ 
Add
˙˙  
(
˙˙  !
new
˙˙! $
StringContent
˙˙% 2
(
˙˙2 3
value
˙˙3 8
)
˙˙8 9
,
˙˙9 :
prop
˙˙; ?
.
˙˙? @
Name
˙˙@ D
)
˙˙D E
;
˙˙E F
}
˚˚ 
}
¸¸ 
if
˛˛ 
(
˛˛ 
!
˛˛ 
string
˛˛ 
.
˛˛ 
IsNullOrEmpty
˛˛ %
(
˛˛% &
token
˛˛& +
)
˛˛+ ,
)
˛˛, -

httpClient
ˇˇ 
.
ˇˇ #
DefaultRequestHeaders
ˇˇ 0
.
ˇˇ0 1
Add
ˇˇ1 4
(
ˇˇ4 5
$str
ˇˇ5 D
,
ˇˇD E
$str
ˇˇF O
+
ˇˇP Q
token
ˇˇR W
)
ˇˇW X
;
ˇˇX Y

httpClient
ÅÅ 
.
ÅÅ 
Timeout
ÅÅ 
=
ÅÅ  
TimeSpan
ÅÅ! )
.
ÅÅ) *
FromSeconds
ÅÅ* 5
(
ÅÅ5 6
TimeOutSecond
ÅÅ6 C
)
ÅÅC D
;
ÅÅD E

httpClient
ÉÉ 
.
ÉÉ #
DefaultRequestHeaders
ÉÉ ,
.
ÉÉ, -
Accept
ÉÉ- 3
.
ÉÉ3 4
Clear
ÉÉ4 9
(
ÉÉ9 :
)
ÉÉ: ;
;
ÉÉ; <
var
ÑÑ 
result
ÑÑ 
=
ÑÑ 

httpClient
ÑÑ #
.
ÑÑ# $
	PostAsync
ÑÑ$ -
(
ÑÑ- .
apiUrl
ÑÑ. 4
,
ÑÑ4 5
formData
ÑÑ6 >
)
ÑÑ> ?
.
ÑÑ? @
Result
ÑÑ@ F
;
ÑÑF G
if
ÖÖ 
(
ÖÖ 
result
ÖÖ 
.
ÖÖ !
IsSuccessStatusCode
ÖÖ *
)
ÖÖ* +
{
ÜÜ 
	resultApi
áá 
=
áá 
true
áá  
;
áá  !

JsonString
àà 
=
àà 
result
àà #
.
àà# $
Content
àà$ +
.
àà+ ,
ReadAsStringAsync
àà, =
(
àà= >
)
àà> ?
.
àà? @
Result
àà@ F
;
ààF G
}
ââ 
else
ää 
{
ãã 

JsonString
åå 
=
åå 
result
åå #
.
åå# $
Content
åå$ +
.
åå+ ,
ReadAsStringAsync
åå, =
(
åå= >
)
åå> ?
.
åå? @
Result
åå@ F
;
ååF G
}
çç 
}
éé 	
return
èè 
(
èè 
	resultApi
èè 
,
èè 

JsonString
èè %
)
èè% &
;
èè& '
}
êê 
public
õõ 

static
õõ 
(
õõ 
bool
õõ 
,
õõ 
string
õõ 
)
õõ   
PutRequestToWebApi
õõ! 3
(
õõ3 4
string
õõ4 :
apiUrl
õõ; A
,
õõA B
object
õõC I
request
õõJ Q
,
õõQ R
string
õõS Y
token
õõZ _
=
õõ` a
null
õõb f
,
õõf g
int
õõh k
TimeOutSecond
õõl y
=
õõz {
$num
õõ| ~
)
õõ~ 
{
úú 
bool
ùù 
	resultApi
ùù 
=
ùù 
false
ùù 
;
ùù 
string
ûû 

JsonString
ûû 
=
ûû 
string
ûû "
.
ûû" #
Empty
ûû# (
;
ûû( )
using
üü 
(
üü 

HttpClient
üü 

httpClient
üü $
=
üü% &
new
üü' *

HttpClient
üü+ 5
(
üü5 6
)
üü6 7
)
üü7 8
{
†† 	
var
°° 
someData
°° 
=
°° 
JsonConvert
°° &
.
°°& '
SerializeObject
°°' 6
(
°°6 7
request
°°7 >
)
°°> ?
;
°°? @
var
¢¢ 
content
¢¢ 
=
¢¢ 
new
¢¢ 
StringContent
¢¢ +
(
¢¢+ ,
someData
¢¢, 4
,
¢¢4 5
System
¢¢6 <
.
¢¢< =
Text
¢¢= A
.
¢¢A B
Encoding
¢¢B J
.
¢¢J K
UTF8
¢¢K O
,
¢¢O P
$str
¢¢Q c
)
¢¢c d
;
¢¢d e
if
§§ 
(
§§ 
!
§§ 
string
§§ 
.
§§ 
IsNullOrEmpty
§§ %
(
§§% &
token
§§& +
)
§§+ ,
)
§§, -

httpClient
•• 
.
•• #
DefaultRequestHeaders
•• 0
.
••0 1
Add
••1 4
(
••4 5
$str
••5 D
,
••D E
$str
••F O
+
••P Q
token
••R W
)
••W X
;
••X Y

httpClient
ßß 
.
ßß 
Timeout
ßß 
=
ßß  
TimeSpan
ßß! )
.
ßß) *
FromSeconds
ßß* 5
(
ßß5 6
TimeOutSecond
ßß6 C
)
ßßC D
;
ßßD E

httpClient
®® 
.
®® #
DefaultRequestHeaders
®® ,
.
®®, -
Accept
®®- 3
.
®®3 4
Clear
®®4 9
(
®®9 :
)
®®: ;
;
®®; <
var
©© 
result
©© 
=
©© 

httpClient
©© #
.
©©# $
PutAsync
©©$ ,
(
©©, -
apiUrl
©©- 3
,
©©3 4
content
©©5 <
)
©©< =
.
©©= >
Result
©©> D
;
©©D E
if
™™ 
(
™™ 
result
™™ 
.
™™ !
IsSuccessStatusCode
™™ *
)
™™* +
{
´´ 
	resultApi
¨¨ 
=
¨¨ 
true
¨¨  
;
¨¨  !

JsonString
≠≠ 
=
≠≠ 
result
≠≠ #
.
≠≠# $
Content
≠≠$ +
.
≠≠+ ,
ReadAsStringAsync
≠≠, =
(
≠≠= >
)
≠≠> ?
.
≠≠? @
Result
≠≠@ F
;
≠≠F G
}
ÆÆ 
}
ØØ 	
return
∞∞ 
(
∞∞ 
	resultApi
∞∞ 
,
∞∞ 

JsonString
∞∞ %
)
∞∞% &
;
∞∞& '
}
±± 
public
∫∫ 

static
∫∫ 
async
∫∫ 
Task
∫∫ 
<
∫∫ 
string
∫∫ #
>
∫∫# $%
PutRequestToWebApiAsync
∫∫% <
(
∫∫< =
string
∫∫= C
apiUrl
∫∫D J
,
∫∫J K
object
∫∫L R
request
∫∫S Z
,
∫∫Z [
int
∫∫\ _
TimeOutSecond
∫∫` m
=
∫∫n o
$num
∫∫p r
)
∫∫r s
{
ªª 
string
ºº 

JsonString
ºº 
=
ºº 
string
ºº "
.
ºº" #
Empty
ºº# (
;
ºº( )
using
ΩΩ 
(
ΩΩ 

HttpClient
ΩΩ 

httpClient
ΩΩ $
=
ΩΩ% &
new
ΩΩ' *

HttpClient
ΩΩ+ 5
(
ΩΩ5 6
)
ΩΩ6 7
)
ΩΩ7 8
{
ææ 	
var
øø 
someData
øø 
=
øø 
JsonConvert
øø &
.
øø& '
SerializeObject
øø' 6
(
øø6 7
request
øø7 >
)
øø> ?
;
øø? @
var
¿¿ 
content
¿¿ 
=
¿¿ 
new
¿¿ 
StringContent
¿¿ +
(
¿¿+ ,
someData
¿¿, 4
,
¿¿4 5
System
¿¿6 <
.
¿¿< =
Text
¿¿= A
.
¿¿A B
Encoding
¿¿B J
.
¿¿J K
UTF8
¿¿K O
,
¿¿O P
$str
¿¿Q c
)
¿¿c d
;
¿¿d e

httpClient
¡¡ 
.
¡¡ 
Timeout
¡¡ 
=
¡¡  
TimeSpan
¡¡! )
.
¡¡) *
FromSeconds
¡¡* 5
(
¡¡5 6
TimeOutSecond
¡¡6 C
)
¡¡C D
;
¡¡D E

httpClient
¬¬ 
.
¬¬ #
DefaultRequestHeaders
¬¬ ,
.
¬¬, -
Accept
¬¬- 3
.
¬¬3 4
Clear
¬¬4 9
(
¬¬9 :
)
¬¬: ;
;
¬¬; <
var
√√ 
result
√√ 
=
√√ 
await
√√ 

httpClient
√√ )
.
√√) *
PutAsync
√√* 2
(
√√2 3
apiUrl
√√3 9
,
√√9 :
content
√√; B
)
√√B C
;
√√C D
if
ƒƒ 
(
ƒƒ 
result
ƒƒ 
.
ƒƒ !
IsSuccessStatusCode
ƒƒ *
)
ƒƒ* +
{
≈≈ 

JsonString
∆∆ 
=
∆∆ 
await
∆∆ "
result
∆∆# )
.
∆∆) *
Content
∆∆* 1
.
∆∆1 2
ReadAsStringAsync
∆∆2 C
(
∆∆C D
)
∆∆D E
;
∆∆E F
}
«« 
}
»» 	
return
…… 

JsonString
…… 
;
…… 
}
   
public
”” 

static
”” 
async
”” 
Task
”” 
<
”” 
string
”” #
>
””# $(
DeleteRequestToWebApiAsync
””% ?
(
””? @
string
””@ F
apiUrl
””G M
,
””M N
int
””O R
TimeOutSecond
””S `
=
””a b
$num
””c e
)
””e f
{
‘‘ 
string
’’ 

JsonString
’’ 
=
’’ 
string
’’ "
.
’’" #
Empty
’’# (
;
’’( )
using
÷÷ 
(
÷÷ 

HttpClient
÷÷ 

httpClient
÷÷ $
=
÷÷% &
new
÷÷' *

HttpClient
÷÷+ 5
(
÷÷5 6
)
÷÷6 7
)
÷÷7 8
{
◊◊ 	

httpClient
ÿÿ 
.
ÿÿ 
Timeout
ÿÿ 
=
ÿÿ  
TimeSpan
ÿÿ! )
.
ÿÿ) *
FromSeconds
ÿÿ* 5
(
ÿÿ5 6
TimeOutSecond
ÿÿ6 C
)
ÿÿC D
;
ÿÿD E

httpClient
ŸŸ 
.
ŸŸ #
DefaultRequestHeaders
ŸŸ ,
.
ŸŸ, -
Accept
ŸŸ- 3
.
ŸŸ3 4
Clear
ŸŸ4 9
(
ŸŸ9 :
)
ŸŸ: ;
;
ŸŸ; <
var
⁄⁄ 
result
⁄⁄ 
=
⁄⁄ 
await
⁄⁄ 

httpClient
⁄⁄ )
.
⁄⁄) *
DeleteAsync
⁄⁄* 5
(
⁄⁄5 6
apiUrl
⁄⁄6 <
)
⁄⁄< =
;
⁄⁄= >
if
€€ 
(
€€ 
result
€€ 
.
€€ !
IsSuccessStatusCode
€€ *
)
€€* +
{
‹‹ 

JsonString
›› 
=
›› 
await
›› "
result
››# )
.
››) *
Content
››* 1
.
››1 2
ReadAsStringAsync
››2 C
(
››C D
)
››D E
;
››E F
}
ﬁﬁ 
}
ﬂﬂ 	
return
‡‡ 

JsonString
‡‡ 
;
‡‡ 
}
·· 
public
ÈÈ 

static
ÈÈ 
(
ÈÈ 
bool
ÈÈ 
,
ÈÈ 
string
ÈÈ 
)
ÈÈ  #
DeleteRequestToWebApi
ÈÈ! 6
(
ÈÈ6 7
string
ÈÈ7 =
apiUrl
ÈÈ> D
,
ÈÈD E
string
ÈÈF L
token
ÈÈM R
=
ÈÈS T
null
ÈÈU Y
,
ÈÈY Z
int
ÈÈ[ ^
TimeOutSecond
ÈÈ_ l
=
ÈÈm n
$num
ÈÈo q
)
ÈÈq r
{
ÍÍ 
bool
ÎÎ 
	resultApi
ÎÎ 
=
ÎÎ 
false
ÎÎ 
;
ÎÎ 
string
ÏÏ 

JsonString
ÏÏ 
=
ÏÏ 
string
ÏÏ "
.
ÏÏ" #
Empty
ÏÏ# (
;
ÏÏ( )
using
ÌÌ 
(
ÌÌ 

HttpClient
ÌÌ 

httpClient
ÌÌ $
=
ÌÌ% &
new
ÌÌ' *

HttpClient
ÌÌ+ 5
(
ÌÌ5 6
)
ÌÌ6 7
)
ÌÌ7 8
{
ÓÓ 	
if
ÔÔ 
(
ÔÔ 
!
ÔÔ 
string
ÔÔ 
.
ÔÔ 
IsNullOrEmpty
ÔÔ %
(
ÔÔ% &
token
ÔÔ& +
)
ÔÔ+ ,
)
ÔÔ, -

httpClient
 
.
 #
DefaultRequestHeaders
 0
.
0 1
Add
1 4
(
4 5
$str
5 D
,
D E
$str
F O
+
P Q
token
R W
)
W X
;
X Y

httpClient
ÚÚ 
.
ÚÚ 
Timeout
ÚÚ 
=
ÚÚ  
TimeSpan
ÚÚ! )
.
ÚÚ) *
FromSeconds
ÚÚ* 5
(
ÚÚ5 6
TimeOutSecond
ÚÚ6 C
)
ÚÚC D
;
ÚÚD E

httpClient
ÛÛ 
.
ÛÛ #
DefaultRequestHeaders
ÛÛ ,
.
ÛÛ, -
Accept
ÛÛ- 3
.
ÛÛ3 4
Clear
ÛÛ4 9
(
ÛÛ9 :
)
ÛÛ: ;
;
ÛÛ; <
var
ÙÙ 
result
ÙÙ 
=
ÙÙ 

httpClient
ÙÙ #
.
ÙÙ# $
DeleteAsync
ÙÙ$ /
(
ÙÙ/ 0
apiUrl
ÙÙ0 6
)
ÙÙ6 7
.
ÙÙ7 8
Result
ÙÙ8 >
;
ÙÙ> ?
if
ıı 
(
ıı 
result
ıı 
.
ıı !
IsSuccessStatusCode
ıı *
)
ıı* +
{
ˆˆ 
	resultApi
˜˜ 
=
˜˜ 
true
˜˜  
;
˜˜  !

JsonString
¯¯ 
=
¯¯ 
result
¯¯ #
.
¯¯# $
Content
¯¯$ +
.
¯¯+ ,
ReadAsStringAsync
¯¯, =
(
¯¯= >
)
¯¯> ?
.
¯¯? @
Result
¯¯@ F
;
¯¯F G
}
˘˘ 
}
˙˙ 	
return
˚˚ 
(
˚˚ 
	resultApi
˚˚ 
,
˚˚ 

JsonString
˚˚ %
)
˚˚% &
;
˚˚& '
}
¸¸ 
public
ˇˇ 
static
ˇˇ 
(
ˇˇ 
bool
ˇˇ 
,
ˇˇ 
string
ˇˇ 
)
ˇˇ 
PostJsonOTP
ˇˇ )
(
ˇˇ) *
string
ˇˇ* 0
apiUrl
ˇˇ1 7
,
ˇˇ7 8
object
ˇˇ9 ?
request
ˇˇ@ G
,
ˇˇG H
int
ˇˇI L
TimeOutSecond
ˇˇM Z
=
ˇˇ[ \
$num
ˇˇ] _
)
ˇˇ_ `
{
ÄÄ 
string
ÅÅ 

JsonString
ÅÅ	 
=
ÅÅ 
string
ÅÅ 
.
ÅÅ 
Empty
ÅÅ "
;
ÅÅ" #
using
ÉÉ 
(
ÉÉ 	

HttpClient
ÉÉ	 

httpClient
ÉÉ 
=
ÉÉ  
new
ÉÉ! $

HttpClient
ÉÉ% /
(
ÉÉ/ 0
)
ÉÉ0 1
)
ÉÉ1 2
{
ÑÑ 
var
ÜÜ 
response
ÜÜ 
=
ÜÜ 

httpClient
ÜÜ 
.
ÜÜ 
PostAsJsonAsync
ÜÜ ,
(
ÜÜ, -
apiUrl
ÜÜ- 3
,
ÜÜ3 4
request
ÜÜ5 <
)
ÜÜ< =
.
ÜÜ= >
Result
ÜÜ> D
;
ÜÜD E

JsonString
áá 
=
áá 
response
áá 
.
áá 
Content
áá  
.
áá  !
ReadAsStringAsync
áá! 2
(
áá2 3
)
áá3 4
.
áá4 5
Result
áá5 ;
;
áá; <
var
àà  
verificationResult
àà 
=
àà 
JsonConvert
àà '
.
àà' (
DeserializeObject
àà( 9
<
àà9 :
WhatsappResponse
àà: J
>
ààJ K
(
ààK L

JsonString
ààL V
)
ààV W
;
ààW X
if
ää 
(
ää  
verificationResult
ää 
.
ää 
sent
ää 
==
ää !
true
ää" &
)
ää& '
{
ãã 
return
åå 

(
åå 
true
åå 
,
åå 

JsonString
åå 
)
åå 
;
åå 
}
éé 
else
èè 
{
êê 
return
ëë 

(
ëë 
false
ëë 
,
ëë 

JsonString
ëë 
)
ëë 
;
ëë 
}
íí 
}
ìì 
}
îî 
}ïï üe
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\ReportExcel.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public 

class 
ReportExcel 
{ 
public		 
ISheet		 
standartSheet		 #
(		# $
ISheet		$ *
sheet		+ 0
)		0 1
{

 	
sheet 
. 
DefaultColumnWidth $
=% &
$num' )
;) *
sheet 
. 
DisplayGridlines "
=# $
true% )
;) *
sheet 
. !
DisplayRowColHeadings '
=( )
true* .
;. /
return 
sheet 
; 
} 	
public 

ICellStyle 
getHeaderStyle1 )
() *
	IWorkbook* 3
workbook4 <
,< =
string> D
	TypeExcelE N
)N O
{ 	
IFont 

HeaderFont 
= 
workbook '
.' (

CreateFont( 2
(2 3
)3 4
;4 5

HeaderFont 
. 
FontHeightInPoints )
=* +
$num, .
;. /

HeaderFont   
.   
FontName   
=    !
$str  " +
;  + ,

ICellStyle!! 
HeaderCellStyle!! &
=!!' (
workbook!!) 1
.!!1 2
CreateCellStyle!!2 A
(!!A B
)!!B C
;!!C D
if"" 
("" 
	TypeExcel"" 
=="" 
$str"" #
)""# $
{## 

HeaderFont$$ 
.$$ 
Color$$  
=$$! "
IndexedColors$$# 0
.$$0 1
Black$$1 6
.$$6 7
Index$$7 <
;$$< =
HeaderCellStyle%% 
.%%  
FillForegroundColor%%  3
=%%4 5
IndexedColors%%6 C
.%%C D
LightOrange%%D O
.%%O P
Index%%P U
;%%U V
}&& 
else'' 
if'' 
('' 
	TypeExcel'' 
=='' !
$str''" '
)''' (
{(( 

HeaderFont)) 
.)) 
Color))  
=))! "
	HSSFColor))# ,
.)), -
Black))- 2
.))2 3
Index))3 8
;))8 9
HeaderCellStyle** 
.**  
FillForegroundColor**  3
=**4 5
	HSSFColor**6 ?
.**? @
LightOrange**@ K
.**K L
Index**L Q
;**Q R
}++ 
HeaderCellStyle-- 
.-- 
FillPattern-- '
=--( )
FillPattern--* 5
.--5 6
SolidForeground--6 E
;--E F
HeaderCellStyle.. 
... 
SetFont.. #
(..# $

HeaderFont..$ .
)... /
;../ 0
return// 
HeaderCellStyle// "
;//" #
}00 	
public22 

ICellStyle22 
getJudulStyle122 (
(22( )
	IWorkbook22) 2
workbook223 ;
,22; <
string22= C
	TypeExcel22D M
)22M N
{33 	
IFont44 

HeaderFont44 
=44 
workbook44 '
.44' (

CreateFont44( 2
(442 3
)443 4
;444 5

HeaderFont55 
.55 
FontHeightInPoints55 )
=55* +
$num55, .
;55. /

HeaderFont66 
.66 
FontName66 
=66  !
$str66" +
;66+ ,

HeaderFont77 
.77 

Boldweight77 !
=77" #
(77$ %
short77% *
)77* +
NPOI77+ /
.77/ 0
SS770 2
.772 3
	UserModel773 <
.77< =
FontBoldWeight77= K
.77K L
Bold77L P
;77P Q
if88 
(88 
	TypeExcel88 
==88 
$str88 #
)88# $
{99 

HeaderFont:: 
.:: 
Color::  
=::! "
IndexedColors::# 0
.::0 1
Black::1 6
.::6 7
Index::7 <
;::< =
};; 
else<< 
if<< 
(<< 
	TypeExcel<< 
==<< !
$str<<" '
)<<' (
{== 

HeaderFont>> 
.>> 
Color>>  
=>>! "
	HSSFColor>># ,
.>>, -
Black>>- 2
.>>2 3
Index>>3 8
;>>8 9
}?? 

ICellStyleAA 
HeaderCellStyleAA &
=AA' (
workbookAA) 1
.AA1 2
CreateCellStyleAA2 A
(AAA B
)AAB C
;AAC D
HeaderCellStyleBB 
.BB 
SetFontBB #
(BB# $

HeaderFontBB$ .
)BB. /
;BB/ 0
returnCC 
HeaderCellStyleCC "
;CC" #
}DD 	
publicFF 

ICellStyleFF 
GenerateDateStyleFF +
(FF+ ,
	IWorkbookFF, 5
workbookFF6 >
)FF> ?
{GG 	
IFontHH 

HeaderFontHH 
=HH 
workbookHH '
.HH' (

CreateFontHH( 2
(HH2 3
)HH3 4
;HH4 5

HeaderFontII 
.II 
FontHeightInPointsII )
=II* +
$numII, -
;II- .

HeaderFontJJ 
.JJ 
FontNameJJ 
=JJ  !
$strJJ" +
;JJ+ ,

HeaderFontKK 
.KK 

BoldweightKK !
=KK" #
(KK$ %
shortKK% *
)KK* +
NPOIKK+ /
.KK/ 0
SSKK0 2
.KK2 3
	UserModelKK3 <
.KK< =
FontBoldWeightKK= K
.KKK L
NoneKKL P
;KKP Q

HeaderFontLL 
.LL 
ColorLL 
=LL 
	HSSFColorLL (
.LL( )
Grey80PercentLL) 6
.LL6 7
IndexLL7 <
;LL< =

ICellStyleMM 
HeaderCellStyleMM &
=MM' (
workbookMM) 1
.MM1 2
CreateCellStyleMM2 A
(MMA B
)MMB C
;MMC D
HeaderCellStyleNN 
.NN 
SetFontNN #
(NN# $

HeaderFontNN$ .
)NN. /
;NN/ 0
returnOO 
HeaderCellStyleOO "
;OO" #
}PP 	
publicRR 
ISheetRR 
setColoumWidthRR $
(RR$ %
ISheetRR% +
sheetRR, 1
,RR1 2
intRR3 6
[RR6 7
]RR7 8
widthRR9 >
,RR> ?
intRR@ C
startColoumRRD O
)RRO P
{SS 	
foreachUU 
(UU 
intUU 
colwidthUU !
inUU" $
widthUU% *
)UU* +
{VV 
sheetWW 
.WW 
SetColumnWidthWW $
(WW$ %
startColoumWW% 0
,WW0 1
colwidthWW2 :
)WW: ;
;WW; <
startColoumXX 
++XX 
;XX 
}YY 
returnZZ 
sheetZZ 
;ZZ 
}[[ 	
public]] 
ISheet]] 

setDataRow]]  
(]]  !
ISheet]]! '
sheet]]( -
,]]- .
object]]/ 5
[]]5 6
]]]6 7
ArrObj]]8 >
,]]> ?
int]]@ C
indexRow]]D L
,]]L M
int]]N Q
indexCol]]R Z
)]]Z [
{^^ 	
var__ 
row__ 
=__ 
sheet__ 
.__ 
	CreateRow__ %
(__% &
indexRow__& .
)__. /
;__/ 0
foreachaa 
(aa 
objectaa 
objaa 
inaa  "
ArrObjaa# )
)aa) *
{bb 
ifcc 
(cc 
objcc 
iscc 
bytecc 
)cc  
{dd 
rowee 
.ee 

CreateCellee "
(ee" #
indexColee# +
)ee+ ,
.ee, -
SetCellValueee- 9
(ee9 :
(ee: ;
byteee; ?
)ee? @
objee@ C
)eeC D
;eeD E
}ff 
ifgg 
(gg 
objgg 
isgg 
DateTimegg #
)gg# $
{hh 
rowii 
.ii 

CreateCellii "
(ii" #
indexColii# +
)ii+ ,
.ii, -
SetCellValueii- 9
(ii9 :
(ii: ;
DateTimeii; C
)iiC D
objiiD G
)iiG H
;iiH I
}jj 
ifkk 
(kk 
objkk 
iskk 
Systemkk !
.kk! "
DateTimekk" *
)kk* +
{ll 
ifmm 
(mm 
objmm 
!=mm 
nullmm #
)mm# $
rownn 
.nn 

CreateCellnn &
(nn& '
indexColnn' /
)nn/ 0
.nn0 1
SetCellValuenn1 =
(nn= >
(nn> ?
Systemnn? E
.nnE F
DateTimennF N
)nnN O
objnnO R
)nnR S
;nnS T
}oo 
ifpp 
(pp 
objpp 
ispp 
intpp 
)pp 
{qq 
rowrr 
.rr 

CreateCellrr "
(rr" #
indexColrr# +
)rr+ ,
.rr, -
SetCellValuerr- 9
(rr9 :
(rr: ;
intrr; >
)rr> ?
objrr? B
)rrB C
;rrC D
}ss 
iftt 
(tt 
objtt 
istt 
doublett !
)tt! "
{uu 
rowvv 
.vv 

CreateCellvv "
(vv" #
indexColvv# +
)vv+ ,
.vv, -
SetCellValuevv- 9
(vv9 :
(vv: ;
doublevv; A
)vvA B
objvvB E
)vvE F
;vvF G
}ww 
ifyy 
(yy 
objyy 
isyy 
boolyy 
)yy  
{zz 
row{{ 
.{{ 

CreateCell{{ "
({{" #
indexCol{{# +
){{+ ,
.{{, -
SetCellValue{{- 9
({{9 :
({{: ;
bool{{; ?
){{? @
obj{{@ C
){{C D
;{{D E
}|| 
if}} 
(}} 
obj}} 
is}} 
string}} !
)}}! "
{~~ 
row 
. 

CreateCell "
(" #
indexCol# +
)+ ,
., -
SetCellValue- 9
(9 :
(: ;
string; A
)A B
objB E
)E F
;F G
}
ÄÄ 
indexCol
ÅÅ 
++
ÅÅ 
;
ÅÅ 
}
ÇÇ 
return
ÉÉ 
sheet
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
public
ÜÜ 
ISheet
ÜÜ 

setDataRow
ÜÜ  
(
ÜÜ  !
ISheet
ÜÜ! '
sheet
ÜÜ( -
,
ÜÜ- .
object
ÜÜ/ 5
[
ÜÜ5 6
]
ÜÜ6 7
ArrObj
ÜÜ8 >
,
ÜÜ> ?
int
ÜÜ@ C
indexRow
ÜÜD L
)
ÜÜL M
{
áá 	
return
àà 

setDataRow
àà 
(
àà 
sheet
àà #
,
àà# $
ArrObj
àà% +
,
àà+ ,
indexRow
àà- 5
,
àà5 6
$num
àà7 8
)
àà8 9
;
àà9 :
}
ââ 	
public
ãã 

ICellStyle
ãã 
getHeaderStyle1
ãã )
(
ãã) *
HSSFWorkbook
ãã* 6
workbook
ãã7 ?
)
ãã? @
{
åå 	
IFont
çç 

HeaderFont
çç 
=
çç 
workbook
çç '
.
çç' (

CreateFont
çç( 2
(
çç2 3
)
çç3 4
;
çç4 5

HeaderFont
éé 
.
éé  
FontHeightInPoints
éé )
=
éé* +
$num
éé, .
;
éé. /

HeaderFont
èè 
.
èè 
Color
èè 
=
èè 
IndexedColors
èè ,
.
èè, -
Black
èè- 2
.
èè2 3
Index
èè3 8
;
èè8 9

HeaderFont
êê 
.
êê 
FontName
êê 
=
êê  !
$str
êê" +
;
êê+ ,

ICellStyle
ëë 
HeaderCellStyle
ëë &
=
ëë' (
workbook
ëë) 1
.
ëë1 2
CreateCellStyle
ëë2 A
(
ëëA B
)
ëëB C
;
ëëC D
HeaderCellStyle
íí 
.
íí !
FillForegroundColor
íí /
=
íí0 1
IndexedColors
íí2 ?
.
íí? @
Coral
íí@ E
.
ííE F
Index
ííF K
;
ííK L
HeaderCellStyle
îî 
.
îî 
SetFont
îî #
(
îî# $

HeaderFont
îî$ .
)
îî. /
;
îî/ 0
return
ïï 
HeaderCellStyle
ïï "
;
ïï" #
}
ññ 	
}
óó 
}òò •G
GD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\RegexRequest.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public 
class 
RegexRequest 
{ 
public

 
static

	 
async

 
Task

 
<

 
bool

 
>

  
RegexValidation

! 0
(

0 1
Object

1 7
data

8 <
)

< =
{ 
try 
{ 
var 
pattern 
= 
new 
Regex 
( 
$str #
)# $
;$ %
Type 

objectType	 
= 
data 
. 
GetType "
(" #
)# $
;$ %
PropertyInfo 
[ 
] 

properties 
= 

objectType  *
.* +
GetProperties+ 8
(8 9
BindingFlags9 E
.E F
PublicF L
|M N
BindingFlagsO [
.[ \
Instance\ d
)d e
;e f
foreach 
( 
PropertyInfo 
property "
in# %

properties& 0
)0 1
{ 
if 
( 	
property	 
. 
PropertyType 
. 
Name #
==$ &
$str' /
&&0 2
property3 ;
.; <
GetValue< D
(D E
dataE I
)I J
!=K M
nullN R
)R S
{ 
if 
(	 

pattern
 
. 
IsMatch 
( 
property "
." #
GetValue# +
(+ ,
data, 0
)0 1
.1 2
ToString2 :
(: ;
); <
)< =
==> @
trueA E
)E F
{ 
return 
false 
; 
} 
} 
} 
return 

true 
; 
} 
catch 
(	 

	Exception
 
ex 
) 
{ 
return 

false 
; 
}   
}!! 
public## 
static##	 
bool## 
RegexSQLInjection## &
(##& '
SqlParameter##' 3
[##3 4
]##4 5
data##6 :
)##: ;
{$$ 
try%% 
{&& 
foreach'' 
('' 
SqlParameter'' 
property'' "
in''# %
data''& *
)''* +
{(( 
if)) 
()) 	
property))	 
.)) 
Value)) 
is)) 
not)) 
null)) #
&&))$ &
())' (
property))( 0
.))0 1
Value))1 6
.))6 7
ToString))7 ?
())? @
)))@ A
.))A B
Contains))B J
())J K
$str))K R
)))R S
||))T V
property))W _
.))_ `
Value))` e
.))e f
ToString))f n
())n o
)))o p
.))p q
Contains))q y
())y z
$str	))z Ä
)
))Ä Å
||
))Ç Ñ
property
))Ö ç
.
))ç é
Value
))é ì
.
))ì î
ToString
))î ú
(
))ú ù
)
))ù û
.
))û ü
Contains
))ü ß
(
))ß ®
$str
))® Ø
)
))Ø ∞
||
))± ≥
property
))¥ º
.
))º Ω
Value
))Ω ¬
.
))¬ √
ToString
))√ À
(
))À Ã
)
))Ã Õ
.
))Õ Œ
Contains
))Œ ÷
(
))÷ ◊
$str
))◊ ›
)
))› ﬁ
)
))ﬁ ﬂ
)
))ﬂ ‡
{** 
return++ 
false++ 
;++ 
},, 
}-- 
return.. 

true.. 
;.. 
}// 
catch00 
(00	 

	Exception00
 
ex00 
)00 
{11 
return22 

false22 
;22 
}33 
}44 
public66 
static66	 
async66 
Task66 
<66 
bool66 
>66  "
RegexSQLInjectionAsync66! 7
(667 8
SqlParameter668 D
[66D E
]66E F
data66G K
)66K L
{77 
try88 
{99 
foreach:: 
(:: 
SqlParameter:: 
property:: "
in::# %
data::& *
)::* +
{;; 
if<< 
(<< 	
property<<	 
.<< 
Value<< 
is<< 
not<< 
null<< #
&&<<$ &
(<<' (
property<<( 0
.<<0 1
Value<<1 6
.<<6 7
ToString<<7 ?
(<<? @
)<<@ A
.<<A B
Contains<<B J
(<<J K
$str<<K R
)<<R S
||<<T V
property<<W _
.<<_ `
Value<<` e
.<<e f
ToString<<f n
(<<n o
)<<o p
.<<p q
Contains<<q y
(<<y z
$str	<<z Ä
)
<<Ä Å
||
<<Ç Ñ
property
<<Ö ç
.
<<ç é
Value
<<é ì
.
<<ì î
ToString
<<î ú
(
<<ú ù
)
<<ù û
.
<<û ü
Contains
<<ü ß
(
<<ß ®
$str
<<® Ø
)
<<Ø ∞
||
<<± ≥
property
<<¥ º
.
<<º Ω
Value
<<Ω ¬
.
<<¬ √
ToString
<<√ À
(
<<À Ã
)
<<Ã Õ
.
<<Õ Œ
Contains
<<Œ ÷
(
<<÷ ◊
$str
<<◊ ›
)
<<› ﬁ
)
<<ﬁ ﬂ
)
<<ﬂ ‡
{== 
return>> 
false>> 
;>> 
}?? 
}@@ 
returnAA 

trueAA 
;AA 
}BB 
catchCC 
(CC	 

	ExceptionCC
 
exCC 
)CC 
{DD 
returnEE 

falseEE 
;EE 
}FF 
}GG 
publicII 
staticII	 
boolII 
ValidatePasswordII %
(II% &
stringII& ,
passwordII- 5
)II5 6
{JJ 
RegexKK 
uppercaseRegexKK	 
=KK 
newKK 
RegexKK #
(KK# $
$strKK$ +
)KK+ ,
;KK, -
RegexLL 
numbersRegexLL	 
=LL 
newLL 
RegexLL !
(LL! "
$strLL" )
)LL) *
;LL* +
RegexMM 
specialCharsRegexMM	 
=MM 
newMM  
RegexMM! &
(MM& '
$strMM' M
)MMM N
;MMN O
MatchCollectionOO 
uppercaseLettersOO #
=OO$ %
uppercaseRegexOO& 4
.OO4 5
MatchesOO5 <
(OO< =
passwordOO= E
)OOE F
;OOF G
MatchCollectionPP 
numbersPP 
=PP 
numbersRegexPP )
.PP) *
MatchesPP* 1
(PP1 2
passwordPP2 :
)PP: ;
;PP; <
MatchCollectionQQ 
specialCharactersQQ $
=QQ% &
specialCharsRegexQQ' 8
.QQ8 9
MatchesQQ9 @
(QQ@ A
passwordQQA I
)QQI J
;QQJ K
ifSS 
(SS 
passwordSS 
.SS 
LengthSS 
<SS 
$numSS 
||SS 
passwordSS &
.SS& '
LengthSS' -
>SS. /
$numSS0 2
)SS2 3
{TT 
ConsoleUU 
.UU 
	WriteLineUU 
(UU 
$strUU K
)UUK L
;UUL M
returnVV 

falseVV 
;VV 
}WW 
elseXX 
ifXX 

(XX 
uppercaseLettersXX 
.XX 
CountXX "
<XX# $
$numXX% &
)XX& '
{YY 
ConsoleZZ 
.ZZ 
	WriteLineZZ 
(ZZ 
$strZZ J
)ZZJ K
;ZZK L
return[[ 

false[[ 
;[[ 
}\\ 
else]] 
if]] 

(]] 
numbers]] 
.]] 
Count]] 
<]] 
$num]] 
)]] 
{^^ 
Console__ 
.__ 
	WriteLine__ 
(__ 
$str__ D
)__D E
;__E F
return`` 

false`` 
;`` 
}aa 
elsebb 
ifbb 

(bb 
specialCharactersbb 
.bb 
Countbb #
<bb$ %
$numbb& '
)bb' (
{cc 
Consoledd 
.dd 
	WriteLinedd 
(dd 
$strdd N
)ddN O
;ddO P
returnee 

falseee 
;ee 
}ff 
returnhh 	
truehh
 
;hh 
}ii 
}kk 
}ll Ãí
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\PrintExport.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public 

class 
PrintExport 
{ 
private   
readonly   

IConverter   #

_converter  $ .
;  . /
public"" 
PrintExport"" 
("" 

IConverter"" %
	converter""& /
)""/ 0
{## 	

_converter$$ 
=$$ 
	converter$$ "
;$$" #
}%% 	
public'' 
async'' 
Task'' 
PrintNoDExcel'' '
(''' (
string''( .
	TypeExcel''/ 8
,''8 9
string'': @
FileName''A I
,''I J
int''K N
IdFile''O U
,''U V
string''W ]
Tanggal''^ e
)''e f
{(( 	%
DbDashboardDevaBniContext)) %
_context))& .
=))/ 0
new))1 4%
DbDashboardDevaBniContext))5 N
())N O
)))O P
;))P Q
try++ 
{,, 
CultureInfo-- 
culture-- #
=--$ %
new--& )
CultureInfo--* 5
(--5 6
$str--6 =
)--= >
;--> ?
var.. 
	dateArray.. 
=.. 
new..  #
string..$ *
[..* +
]..+ ,
{..- .
}../ 0
;..0 1
if00 
(00 
!00 
string00 
.00 
IsNullOrEmpty00 )
(00) *
Tanggal00* 1
)001 2
)002 3
{11 
	dateArray22 
=22 
Tanggal22  '
.22' (
Split22( -
(22- .
$str22. 4
)224 5
;225 6
}33 
var55 
data55 
=55 #
StoredProcedureExecutor55 2
.552 3
ExecuteSPList553 @
<55@ A#
TblNoticeOfDisbursement55A X
>55X Y
(55Y Z
_context55Z b
,55b c
$str	55d à
,
55à â
new
55ä ç
SqlParameter
55é ö
[
55ö õ
]
55õ ú
{
55ú ù
new66 
SqlParameter66 $
(66$ %
$str66% 3
,663 4
	dateArray665 >
.66> ?
Count66? D
(66D E
)66E F
==66G I
$num66J K
?66L M
$str66N P
:66Q R
DateTime66S [
.66[ \
Parse66\ a
(66a b
	dateArray66b k
[66k l
$num66l m
]66m n
,66n o
culture66p w
)66w x
)66x y
,66y z
new77 
SqlParameter77 $
(77$ %
$str77% 1
,771 2
	dateArray773 <
.77< =
Count77= B
(77B C
)77C D
==77E G
$num77H I
?77J K
$str77L N
:77O P
DateTime77Q Y
.77Y Z
Parse77Z _
(77_ `
	dateArray77` i
[77i j
$num77j k
]77k l
,77l m
culture77n u
)77u v
)77v w
,77w x
new88 
SqlParameter88 $
(88$ %
$str88% 2
,882 3
$str884 8
)888 9
,889 :
new99 
SqlParameter99 $
(99$ %
$str99% 5
,995 6
$str997 =
)99= >
,99> ?
new:: 
SqlParameter:: $
(::$ %
$str::% 2
,::2 3
$num::4 5
)::5 6
,::6 7
new;; 
SqlParameter;; $
(;;$ %
$str;;% 0
,;;0 1
$num;;2 7
);;7 8
}<< 
)<< 
;<< 
var>> 

updateFile>> 
=>>  
await>>! &
_context>>' /
.>>/ 0
TblDownloadBigFiles>>0 C
.>>C D
Where>>D I
(>>I J
x>>J K
=>>>L N
x>>O P
.>>P Q
Id>>Q S
==>>T V
IdFile>>W ]
)>>] ^
.>>^ _
FirstOrDefaultAsync>>_ r
(>>r s
)>>s t
;>>t u
ifAA 
(AA 
!AA 
	DirectoryAA 
.AA 
ExistsAA %
(AA% &
	GetConfigAA& /
.AA/ 0

AppSettingAA0 :
[AA: ;
$strAA; A
]AAA B
)AAB C
)AAC D
{BB 
	DirectoryCC 
.CC 
CreateDirectoryCC -
(CC- .
	GetConfigCC. 7
.CC7 8

AppSettingCC8 B
[CCB C
$strCCC I
]CCI J
)CCJ K
;CCK L
}DD 
ifuu 
(uu 
datauu 
!=uu 
nulluu  
)uu  !
{vv 
	IWorkbookww 
workbookww &
;ww& '
ifyy 
(yy 
	TypeExcelyy !
==yy" $
$stryy% +
)yy+ ,
{zz 
workbook{{  
={{! "
new{{# &
XSSFWorkbook{{' 3
({{3 4
){{4 5
;{{5 6
}|| 
else}} 
if}} 
(}} 
	TypeExcel}} &
==}}' )
$str}}* /
)}}/ 0
{~~ 
workbook  
=! "
new# &
HSSFWorkbook' 3
(3 4
)4 5
;5 6
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
throw
ÉÉ 
new
ÉÉ !
	Exception
ÉÉ" +
(
ÉÉ+ ,
$str
ÉÉ, J
)
ÉÉJ K
;
ÉÉK L
}
ÑÑ 
ReportExcel
áá 
reportExcel
áá  +
=
áá, -
new
áá. 1
ReportExcel
áá2 =
(
áá= >
)
áá> ?
;
áá? @
ISheet
àà 
sheet
àà  
=
àà! "
workbook
àà# +
.
àà+ ,
CreateSheet
àà, 7
(
àà7 8
$str
àà8 >
)
àà> ?
;
àà? @
sheet
ââ 
=
ââ 
reportExcel
ââ '
.
ââ' (
standartSheet
ââ( 5
(
ââ5 6
sheet
ââ6 ;
)
ââ; <
;
ââ< =

ICellStyle
ää 
HeaderCellStyle
ää .
=
ää/ 0
reportExcel
ää1 <
.
ää< =
getJudulStyle1
ää= K
(
ääK L
workbook
ääL T
,
ääT U
	TypeExcel
ääV _
)
ää_ `
;
ää` a
HeaderCellStyle
ãã #
.
ãã# $
	Alignment
ãã$ -
=
ãã. /
NPOI
ãã0 4
.
ãã4 5
SS
ãã5 7
.
ãã7 8
	UserModel
ãã8 A
.
ããA B!
HorizontalAlignment
ããB U
.
ããU V
Center
ããV \
;
ãã\ ]
HeaderCellStyle
åå #
.
åå# $
VerticalAlignment
åå$ 5
=
åå6 7
NPOI
åå8 <
.
åå< =
SS
åå= ?
.
åå? @
	UserModel
åå@ I
.
ååI J
VerticalAlignment
ååJ [
.
åå[ \
Center
åå\ b
;
ååb c
HeaderCellStyle
çç #
.
çç# $!
FillForegroundColor
çç$ 7
=
çç8 9
IndexedColors
çç: G
.
ççG H
White
ççH M
.
ççM N
Index
ççN S
;
ççS T
int
éé 
rowExcel
éé  
=
éé! "
$num
éé# $
;
éé$ %
reportExcel
êê 
.
êê  
setColoumWidth
êê  .
(
êê. /
sheet
êê/ 4
,
êê4 5
new
êê6 9
int
êê: =
[
êê= >
]
êê> ?
{
ëë 
$num
ëë 
,
ëë 
$num
ëë  
,
ëë  !
$num
ëë" &
,
ëë& '
$num
ëë( ,
,
ëë, -
$num
ëë. 2
,
ëë2 3
$num
ëë4 8
}
ëë9 :
,
ëë: ;
$num
ëë< =
)
ëë= >
;
ëë> ?
reportExcel
ìì 
.
ìì  

setDataRow
ìì  *
(
ìì* +
sheet
ìì+ 0
,
ìì0 1
new
ìì2 5
object
ìì6 <
[
ìì< =
]
ìì= >
{
îî 
$str
îî 
,
îî 
$str
îî  *
,
îî* +
$str
îî, 8
,
îî8 9
$str
îî9 C
,
îîC D
$str
îîE S
,
îîS T
$str
îîU ]
}
îî] ^
,
îî^ _
rowExcel
îî` h
++
îîh j
)
îîj k
;
îîk l
foreach
ññ 
(
ññ 
var
ññ  
cell
ññ! %
in
ññ& (
sheet
ññ) .
.
ññ. /
GetRow
ññ/ 5
(
ññ5 6
rowExcel
ññ6 >
-
ññ? @
$num
ññA B
)
ññB C
.
ññC D
Cells
ññD I
)
ññI J
{
óó 
cell
òò 
.
òò 
	CellStyle
òò &
=
òò' (
HeaderCellStyle
òò) 8
;
òò8 9
}
ôô 
foreach
°° 
(
°° 
var
°°  
cell
°°! %
in
°°& (
sheet
°°) .
.
°°. /
GetRow
°°/ 5
(
°°5 6
rowExcel
°°6 >
-
°°? @
$num
°°A B
)
°°B C
.
°°C D
Cells
°°D I
)
°°I J
{
¢¢ 
cell
££ 
.
££ 
	CellStyle
££ &
=
££' (
HeaderCellStyle
££) 8
;
££8 9
cell
§§ 
.
§§ 
	CellStyle
§§ &
.
§§& '
	Alignment
§§' 0
=
§§1 2
NPOI
§§3 7
.
§§7 8
SS
§§8 :
.
§§: ;
	UserModel
§§; D
.
§§D E!
HorizontalAlignment
§§E X
.
§§X Y
Center
§§Y _
;
§§_ `
}
•• 
int
ßß 
row
ßß 
=
ßß 
$num
ßß 
;
ßß  
foreach
®® 
(
®® 
var
®®  
vw
®®! #
in
®®$ &
data
®®' +
)
®®+ ,
{
©© 
reportExcel
™™ #
.
™™# $

setDataRow
™™$ .
(
™™. /
sheet
™™/ 4
,
™™4 5
new
™™6 9
object
™™: @
[
™™@ A
]
™™A B
{
´´ 
vw
¨¨ 
.
¨¨ 
NodNo
¨¨ $
,
¨¨$ %
vw
≠≠ 
.
≠≠ 
NodDate
≠≠ &
?
≠≠& '
.
≠≠' (
ToString
≠≠( 0
(
≠≠0 1
$str
≠≠1 =
)
≠≠= >
,
≠≠> ?
vw
ÆÆ 
.
ÆÆ 
	ValueDate
ÆÆ (
?
ÆÆ( )
.
ÆÆ) *
ToString
ÆÆ* 2
(
ÆÆ2 3
$str
ÆÆ3 ?
)
ÆÆ? @
,
ÆÆ@ A
vw
ØØ 
.
ØØ 
Cur
ØØ "
,
ØØ" #
vw
∞∞ 
.
∞∞ 
LastSentDate
∞∞ +
?
∞∞+ ,
.
∞∞, -
ToString
∞∞- 5
(
∞∞5 6
$str
∞∞6 B
)
∞∞B C
,
∞∞C D
vw
±± 
.
±± 
Status
±± %
,
±±% &
}
≤≤ 
,
≤≤ 
rowExcel
≤≤ #
++
≤≤# %
)
≤≤% &
;
≤≤& '
}
≥≥ 
MemoryStream
∂∂  
output
∂∂! '
=
∂∂( )
new
∂∂* -
MemoryStream
∂∂. :
(
∂∂: ;
)
∂∂; <
;
∂∂< =
workbook
∑∑ 
.
∑∑ 
Write
∑∑ "
(
∑∑" #
output
∑∑# )
,
∑∑) *
true
∑∑+ /
)
∑∑/ 0
;
∑∑0 1
using
ππ 
(
ππ 

FileStream
ππ %

fileStream
ππ& 0
=
ππ1 2
new
ππ3 6

FileStream
ππ7 A
(
ππA B

updateFile
ππB L
.
ππL M
Path
ππM Q
,
ππQ R
FileMode
ππS [
.
ππ[ \
Create
ππ\ b
,
ππb c

FileAccess
ππd n
.
ππn o
Write
ππo t
)
ππt u
)
ππu v
{
∫∫ 
output
ºº 
.
ºº 
WriteTo
ºº &
(
ºº& '

fileStream
ºº' 1
)
ºº1 2
;
ºº2 3
}
ΩΩ 

updateFile
øø 
.
øø 
StatusDownload
øø -
=
øø. /
$num
øø0 1
;
øø1 2
_context
¿¿ 
.
¿¿ !
TblDownloadBigFiles
¿¿ 0
.
¿¿0 1
Update
¿¿1 7
(
¿¿7 8

updateFile
¿¿8 B
)
¿¿B C
;
¿¿C D
_context
¡¡ 
.
¡¡ 
SaveChanges
¡¡ (
(
¡¡( )
)
¡¡) *
;
¡¡* +
}
¬¬ 
else
√√ 
{
ƒƒ 

updateFile
≈≈ 
.
≈≈ 
StatusDownload
≈≈ -
=
≈≈. /
$num
≈≈0 1
;
≈≈1 2
_context
∆∆ 
.
∆∆ !
TblDownloadBigFiles
∆∆ 0
.
∆∆0 1
Update
∆∆1 7
(
∆∆7 8

updateFile
∆∆8 B
)
∆∆B C
;
∆∆C D
_context
«« 
.
«« 
SaveChanges
«« (
(
««( )
)
««) *
;
««* +
}
»» 
}
…… 
catch
   
(
   
	Exception
   
ex
   
)
    
{
ÀÀ 
var
ÃÃ 
log
ÃÃ 
=
ÃÃ 
new
ÃÃ 
TblLogErrorPrint
ÃÃ .
(
ÃÃ. /
)
ÃÃ/ 0
;
ÃÃ0 1
log
ÕÕ 
.
ÕÕ 
IdFile
ÕÕ 
=
ÕÕ 
IdFile
ÕÕ #
;
ÕÕ# $
log
ŒŒ 
.
ŒŒ 
ErrorMessage
ŒŒ  
=
ŒŒ! "
ex
ŒŒ# %
.
ŒŒ% &
Message
ŒŒ& -
+
ŒŒ. /
$str
ŒŒ0 5
+
ŒŒ6 7
ex
ŒŒ8 :
.
ŒŒ: ;
InnerException
ŒŒ; I
;
ŒŒI J
log
œœ 
.
œœ 
CreatedTime
œœ 
=
œœ  !
DateTime
œœ" *
.
œœ* +
Now
œœ+ .
;
œœ. /
await
–– 
_context
–– 
.
–– 
TblLogErrorPrints
–– 0
.
––0 1
AddAsync
––1 9
(
––9 :
log
––: =
)
––= >
;
––> ?
await
—— 
_context
—— 
.
—— 
SaveChangesAsync
—— /
(
——/ 0
)
——0 1
;
——1 2
}
““ 
}
”” 	
public
’’ 
async
’’ 
Task
’’ 
PrintNoDPDF
’’ %
(
’’% &
string
’’& ,
Tanggal
’’- 4
,
’’4 5
string
’’6 <
namaPegawai
’’= H
,
’’H I
string
’’J P
Scheme
’’Q W
,
’’W X
string
’’Y _
Host
’’` d
,
’’d e
int
’’f i
IdFile
’’j p
)
’’p q
{
÷÷ 	'
DbDashboardDevaBniContext
◊◊ %
_context
◊◊& .
=
◊◊/ 0
new
◊◊1 4'
DbDashboardDevaBniContext
◊◊5 N
(
◊◊N O
)
◊◊O P
;
◊◊P Q
try
ÿÿ 
{
ŸŸ 
var
⁄⁄ 

updateFile
⁄⁄ 
=
⁄⁄  
await
⁄⁄! &
_context
⁄⁄' /
.
⁄⁄/ 0!
TblDownloadBigFiles
⁄⁄0 C
.
⁄⁄C D
Where
⁄⁄D I
(
⁄⁄I J
x
⁄⁄J K
=>
⁄⁄L N
x
⁄⁄O P
.
⁄⁄P Q
Id
⁄⁄Q S
==
⁄⁄T V
IdFile
⁄⁄W ]
)
⁄⁄] ^
.
⁄⁄^ _!
FirstOrDefaultAsync
⁄⁄_ r
(
⁄⁄r s
)
⁄⁄s t
;
⁄⁄t u
if
‹‹ 
(
‹‹ 
!
‹‹ 
	Directory
‹‹ 
.
‹‹ 
Exists
‹‹ %
(
‹‹% &
	GetConfig
‹‹& /
.
‹‹/ 0

AppSetting
‹‹0 :
[
‹‹: ;
$str
‹‹; A
]
‹‹A B
)
‹‹B C
)
‹‹C D
{
›› 
	Directory
ﬁﬁ 
.
ﬁﬁ 
CreateDirectory
ﬁﬁ -
(
ﬁﬁ- .
	GetConfig
ﬁﬁ. 7
.
ﬁﬁ7 8

AppSetting
ﬁﬁ8 B
[
ﬁﬁB C
$str
ﬁﬁC I
]
ﬁﬁI J
)
ﬁﬁJ K
;
ﬁﬁK L
}
ﬂﬂ 
CultureInfo
·· 
culture
·· #
=
··$ %
new
··& )
CultureInfo
··* 5
(
··5 6
$str
··6 =
)
··= >
;
··> ?
var
‚‚ 
	dateArray
‚‚ 
=
‚‚ 
new
‚‚  #
string
‚‚$ *
[
‚‚* +
]
‚‚+ ,
{
‚‚- .
}
‚‚/ 0
;
‚‚0 1
if
‰‰ 
(
‰‰ 
!
‰‰ 
string
‰‰ 
.
‰‰ 
IsNullOrEmpty
‰‰ )
(
‰‰) *
Tanggal
‰‰* 1
)
‰‰1 2
)
‰‰2 3
{
ÂÂ 
	dateArray
ÊÊ 
=
ÊÊ 
Tanggal
ÊÊ  '
.
ÊÊ' (
Split
ÊÊ( -
(
ÊÊ- .
$str
ÊÊ. 4
)
ÊÊ4 5
;
ÊÊ5 6
}
ÁÁ 
var
ÈÈ 
headerToExport
ÈÈ "
=
ÈÈ# $%
StoredProcedureExecutor
ÈÈ% <
.
ÈÈ< =
ExecuteSPList
ÈÈ= J
<
ÈÈJ K%
TblNoticeOfDisbursement
ÈÈK b
>
ÈÈb c
(
ÈÈc d
_context
ÈÈd l
,
ÈÈl m
$strÈÈn í
,ÈÈí ì
newÈÈî ó
SqlParameterÈÈò §
[ÈÈ§ •
]ÈÈ• ¶
{
ÍÍ 
new
ÎÎ 
SqlParameter
ÎÎ (
(
ÎÎ( )
$str
ÎÎ) 7
,
ÎÎ7 8
	dateArray
ÎÎ9 B
.
ÎÎB C
Count
ÎÎC H
(
ÎÎH I
)
ÎÎI J
==
ÎÎK M
$num
ÎÎN O
?
ÎÎP Q
$str
ÎÎR T
:
ÎÎU V
DateTime
ÎÎW _
.
ÎÎ_ `
Parse
ÎÎ` e
(
ÎÎe f
	dateArray
ÎÎf o
[
ÎÎo p
$num
ÎÎp q
]
ÎÎq r
,
ÎÎr s
culture
ÎÎt {
)
ÎÎ{ |
)
ÎÎ| }
,
ÎÎ} ~
new
ÏÏ 
SqlParameter
ÏÏ (
(
ÏÏ( )
$str
ÏÏ) 5
,
ÏÏ5 6
	dateArray
ÏÏ7 @
.
ÏÏ@ A
Count
ÏÏA F
(
ÏÏF G
)
ÏÏG H
==
ÏÏI K
$num
ÏÏL M
?
ÏÏN O
$str
ÏÏP R
:
ÏÏS T
DateTime
ÏÏU ]
.
ÏÏ] ^
Parse
ÏÏ^ c
(
ÏÏc d
	dateArray
ÏÏd m
[
ÏÏm n
$num
ÏÏn o
]
ÏÏo p
,
ÏÏp q
culture
ÏÏr y
)
ÏÏy z
)
ÏÏz {
,
ÏÏ{ |
new
ÌÌ 
SqlParameter
ÌÌ (
(
ÌÌ( )
$str
ÌÌ) 6
,
ÌÌ6 7
$str
ÌÌ8 <
)
ÌÌ< =
,
ÌÌ= >
new
ÓÓ 
SqlParameter
ÓÓ (
(
ÓÓ( )
$str
ÓÓ) 9
,
ÓÓ9 :
$str
ÓÓ; A
)
ÓÓA B
,
ÓÓB C
new
ÔÔ 
SqlParameter
ÔÔ (
(
ÔÔ( )
$str
ÔÔ) 6
,
ÔÔ6 7
$num
ÔÔ8 9
)
ÔÔ9 :
,
ÔÔ: ;
new
 
SqlParameter
 (
(
( )
$str
) 4
,
4 5
$num
6 ;
)
; <
}
ÒÒ 
)
ÒÒ 
;
ÒÒ 
if
ÛÛ 
(
ÛÛ 
headerToExport
ÛÛ "
!=
ÛÛ# %
null
ÛÛ& *
)
ÛÛJ K
{
ÙÙ 
var
ıı 
locationnow
ıı #
=
ıı$ %
new
ıı& )
Uri
ıı* -
(
ıı- .
$"
ıı. 0
{
ıı0 1
Scheme
ıı1 7
}
ıı7 8
$str
ıı8 ;
{
ıı; <
Host
ıı< @
}
ıı@ A
"
ııA B
)
ııB C
;
ııC D
string
ˆˆ 
	imagePath
ˆˆ $
=
ˆˆ% &
$str
ˆˆ' G
;
ˆˆG H
byte
˜˜ 
[
˜˜ 
]
˜˜ 

imageBytes
˜˜ %
=
˜˜& '
System
˜˜( .
.
˜˜. /
IO
˜˜/ 1
.
˜˜1 2
File
˜˜2 6
.
˜˜6 7
ReadAllBytes
˜˜7 C
(
˜˜C D
	imagePath
˜˜D M
)
˜˜M N
;
˜˜N O
string
¯¯ 
base64String
¯¯ '
=
¯¯( )
Convert
¯¯* 1
.
¯¯1 2
ToBase64String
¯¯2 @
(
¯¯@ A

imageBytes
¯¯A K
)
¯¯K L
;
¯¯L M&
ExportToPDFNoD_ViewModel
˙˙ ,
model
˙˙- 2
=
˙˙3 4
new
˙˙5 8&
ExportToPDFNoD_ViewModel
˙˙9 Q
(
˙˙Q R
)
˙˙R S
;
˙˙S T
model
˚˚ 
.
˚˚ 
Domain
˚˚  
=
˚˚! "
locationnow
˚˚# .
.
˚˚. /
AbsoluteUri
˚˚/ :
;
˚˚: ;
model
¸¸ 
.
¸¸ 
	UserLogin
¸¸ #
=
¸¸$ %
namaPegawai
¸¸& 1
;
¸¸1 2
model
˝˝ 
.
˝˝ 
TanggalCetak
˝˝ &
=
˝˝' (
DateTime
˝˝) 1
.
˝˝1 2
Now
˝˝2 5
.
˝˝5 6
ToString
˝˝6 >
(
˝˝> ?
$str
˝˝? Q
,
˝˝Q R
culture
˝˝S Z
)
˝˝Z [
;
˝˝[ \
model
˛˛ 
.
˛˛ 
Logo
˛˛ 
=
˛˛  
base64String
˛˛! -
;
˛˛- .
model
ˇˇ 
.
ˇˇ 
ListData
ˇˇ "
=
ˇˇ# $
headerToExport
ˇˇ% 3
;
ˇˇ3 4
var
ÅÅ 
engine
ÅÅ 
=
ÅÅ  
new
ÅÅ! $%
RazorLightEngineBuilder
ÅÅ% <
(
ÅÅ< =
)
ÅÅ= >
.
ÇÇ &
UseMemoryCachingProvider
ÇÇ -
(
ÇÇ- .
)
ÇÇ. /
.
ÉÉ 
Build
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
string
ÖÖ 
templateFilePath
ÖÖ +
=
ÖÖ, -
$str
ÖÖ. _
;
ÖÖ_ `
string
ÜÜ 
template
ÜÜ #
=
ÜÜ$ %
File
ÜÜ& *
.
ÜÜ* +
ReadAllText
ÜÜ+ 6
(
ÜÜ6 7
templateFilePath
ÜÜ7 G
)
ÜÜG H
;
ÜÜH I
string
áá 
result
áá !
=
áá" #
string
áá$ *
.
áá* +
Empty
áá+ 0
;
áá0 1
try
ââ 
{
ää 
result
ãã 
=
ãã  
await
ãã! &
engine
ãã' -
.
ãã- .&
CompileRenderStringAsync
ãã. F
(
ããF G
$str
ããG T
,
ããT U
template
ããV ^
,
ãã^ _
model
ãã` e
)
ããe f
;
ããf g
}
åå 
catch
çç 
(
çç 
	Exception
çç $
ex
çç% '
)
çç' (
{
éé 
var
èè 
log
èè 
=
èè  !
new
èè" %
TblLogErrorPrint
èè& 6
(
èè6 7
)
èè7 8
;
èè8 9
log
êê 
.
êê 
IdFile
êê "
=
êê# $
IdFile
êê% +
;
êê+ ,
log
ëë 
.
ëë 
ErrorMessage
ëë (
=
ëë) *
ex
ëë+ -
.
ëë- .
Message
ëë. 5
+
ëë6 7
$str
ëë8 =
+
ëë> ?
ex
ëë@ B
.
ëëB C
InnerException
ëëC Q
;
ëëQ R
log
íí 
.
íí 
CreatedTime
íí '
=
íí( )
DateTime
íí* 2
.
íí2 3
Now
íí3 6
;
íí6 7
await
ìì 
_context
ìì &
.
ìì& '
TblLogErrorPrints
ìì' 8
.
ìì8 9
AddAsync
ìì9 A
(
ììA B
log
ììB E
)
ììE F
;
ììF G
await
îî 
_context
îî &
.
îî& '
SaveChangesAsync
îî' 7
(
îî7 8
)
îî8 9
;
îî9 :
}
ïï 
var
ññ 
globalSettings
ññ &
=
ññ' (
new
ññ) ,
GlobalSettings
ññ- ;
{
óó 
	ColorMode
òò !
=
òò" #
	ColorMode
òò$ -
.
òò- .
Color
òò. 3
,
òò3 4
Orientation
ôô #
=
ôô$ %
Orientation
ôô& 1
.
ôô1 2
	Landscape
ôô2 ;
,
ôô; <
	PaperSize
öö !
=
öö" #
	PaperKind
öö$ -
.
öö- .
A4
öö. 0
,
öö0 1
Margins
õõ 
=
õõ  !
new
õõ" %
MarginSettings
õõ& 4
{
õõ5 6
Top
õõ7 :
=
õõ; <
$num
õõ= >
,
õõ> ?
Right
õõ@ E
=
õõF G
$num
õõH I
,
õõI J
Left
õõK O
=
õõP Q
$num
õõR S
,
õõS T
Bottom
õõU [
=
õõ\ ]
$num
õõ^ _
}
õõ` a
,
õõa b
}
ùù 
;
ùù 
var
üü 
objectSettings
üü &
=
üü' (
new
üü) ,
ObjectSettings
üü- ;
{
†† 

PagesCount
°° "
=
°°# $
true
°°% )
,
°°) *
HtmlContent
¢¢ #
=
¢¢$ %
result
¢¢& ,
,
¢¢, -
FooterSettings
££ &
=
££' (
new
££) ,
FooterSettings
££- ;
{
§§ 
FontSize
•• $
=
••% &
$num
••' (
,
••( )
FontName
¶¶ $
=
¶¶% &
$str
¶¶' 8
,
¶¶8 9
Left
ßß  
=
ßß! "
$str
ßß# 8
,
ßß8 9
Center
®® "
=
®®# $
$str
®®% S
,
®®S T
Right
©© !
=
©©" #
$"
©©$ &
$str
©©& >
{
©©> ?
model
©©? D
.
©©D E
	UserLogin
©©E N
}
©©N O
$str
©©O Q
{
©©Q R
model
©©R W
.
©©W X
TanggalCetak
©©X d
}
©©d e
"
©©e f
}
™™ 
}
´´ 
;
´´ 
var
≠≠ 
pdf
≠≠ 
=
≠≠ 
new
≠≠ !
HtmlToPdfDocument
≠≠" 3
(
≠≠3 4
)
≠≠4 5
{
ÆÆ 
GlobalSettings
ØØ &
=
ØØ' (
globalSettings
ØØ) 7
,
ØØ7 8
Objects
∞∞ 
=
∞∞  !
{
∞∞" #
objectSettings
∞∞$ 2
}
∞∞3 4
}
±± 
;
±± 
using
¥¥ 
(
¥¥ 
var
¥¥ 
pdfTools
¥¥ '
=
¥¥( )
new
¥¥* -
PdfTools
¥¥. 6
(
¥¥6 7
)
¥¥7 8
)
¥¥8 9
{
µµ 
var
∂∂ 
	converter
∂∂ %
=
∂∂& '
new
∂∂( +#
SynchronizedConverter
∂∂, A
(
∂∂A B
pdfTools
∂∂B J
)
∂∂J K
;
∂∂K L
byte
∑∑ 
[
∑∑ 
]
∑∑ 
file
∑∑ #
=
∑∑$ %
	converter
∑∑& /
.
∑∑/ 0
Convert
∑∑0 7
(
∑∑7 8
pdf
∑∑8 ;
)
∑∑; <
;
∑∑< =
using
ππ 
(
ππ 
MemoryStream
ππ +
inputMemoryStream
ππ, =
=
ππ> ?
new
ππ@ C
MemoryStream
ππD P
(
ππP Q
file
ππQ U
)
ππU V
)
ππV W
using
∫∫ 
(
∫∫ 
MemoryStream
∫∫ + 
outputMemoryStream
∫∫, >
=
∫∫? @
new
∫∫A D
MemoryStream
∫∫E Q
(
∫∫Q R
)
∫∫R S
)
∫∫S T
{
ªª 
	PdfReader
ºº %
	pdfReader
ºº& /
=
ºº0 1
new
ºº2 5
	PdfReader
ºº6 ?
(
ºº? @
inputMemoryStream
ºº@ Q
)
ººQ R
;
ººR S
	PdfWriter
ΩΩ %
	pdfWriter
ΩΩ& /
=
ΩΩ0 1
new
ΩΩ2 5
	PdfWriter
ΩΩ6 ?
(
ΩΩ? @ 
outputMemoryStream
ΩΩ@ R
)
ΩΩR S
;
ΩΩS T
using
ææ !
(
ææ" #
PdfDocument
ææ# .
pdfDocument
ææ/ :
=
ææ; <
new
ææ= @
PdfDocument
ææA L
(
ææL M
	pdfReader
ææM V
,
ææV W
	pdfWriter
ææX a
)
ææa b
)
ææb c
{
øø 
Document
¿¿  (
document
¿¿) 1
=
¿¿2 3
new
¿¿4 7
Document
¿¿8 @
(
¿¿@ A
pdfDocument
¿¿A L
)
¿¿L M
;
¿¿M N
	Paragraph
√√  )
	watermark
√√* 3
=
√√4 5
new
√√6 9
	Paragraph
√√: C
(
√√C D
$"
√√D F
{
√√F G
model
√√G L
.
√√L M
	UserLogin
√√M V
}
√√V W
$str
√√W Z
{
√√Z [
model
√√[ `
.
√√` a
TanggalCetak
√√a m
.
√√m n
Replace
√√n u
(
√√u v
$str
√√v y
,
√√y z
$str
√√{ ~
)
√√~ 
}√√ Ä
$str√√Ä Ñ
"√√Ñ Ö
)√√Ö Ü
.
ƒƒ$ %
SetFontColor
ƒƒ% 1
(
ƒƒ1 2
iText
ƒƒ2 7
.
ƒƒ7 8
Kernel
ƒƒ8 >
.
ƒƒ> ?
Colors
ƒƒ? E
.
ƒƒE F
ColorConstants
ƒƒF T
.
ƒƒT U

LIGHT_GRAY
ƒƒU _
)
ƒƒ_ `
.
≈≈$ %
SetFontSize
≈≈% 0
(
≈≈0 1
$num
≈≈1 3
)
≈≈3 4
.
∆∆$ %

SetOpacity
∆∆% /
(
∆∆/ 0
$num
∆∆0 4
)
∆∆4 5
.
««$ %
SetWidth
««% -
(
««- .
$num
««. 2
)
««2 3
.
»»$ %
SetRotationAngle
»»% 5
(
»»5 6
-
»»6 7
$num
»»7 :
)
»»: ;
;
»»; <
for
ÀÀ  #
(
ÀÀ$ %
int
ÀÀ% (
i
ÀÀ) *
=
ÀÀ+ ,
$num
ÀÀ- .
;
ÀÀ. /
i
ÀÀ0 1
<=
ÀÀ2 4
pdfDocument
ÀÀ5 @
.
ÀÀ@ A
GetNumberOfPages
ÀÀA Q
(
ÀÀQ R
)
ÀÀR S
;
ÀÀS T
i
ÀÀU V
++
ÀÀV X
)
ÀÀX Y
{
ÃÃ  !
float
ÕÕ$ )
centerX
ÕÕ* 1
=
ÕÕ2 3
document
ÕÕ4 <
.
ÕÕ< =
GetPdfDocument
ÕÕ= K
(
ÕÕK L
)
ÕÕL M
.
ÕÕM N 
GetDefaultPageSize
ÕÕN `
(
ÕÕ` a
)
ÕÕa b
.
ÕÕb c
GetWidth
ÕÕc k
(
ÕÕk l
)
ÕÕl m
/
ÕÕn o
$num
ÕÕp q
;
ÕÕq r
float
ŒŒ$ )
centerY
ŒŒ* 1
=
ŒŒ2 3
document
ŒŒ4 <
.
ŒŒ< =
GetPdfDocument
ŒŒ= K
(
ŒŒK L
)
ŒŒL M
.
ŒŒM N 
GetDefaultPageSize
ŒŒN `
(
ŒŒ` a
)
ŒŒa b
.
ŒŒb c
	GetHeight
ŒŒc l
(
ŒŒl m
)
ŒŒm n
/
ŒŒo p
$num
ŒŒq r
;
ŒŒr s
document
œœ$ ,
.
œœ, -
ShowTextAligned
œœ- <
(
œœ< =
	watermark
œœ= F
,
œœF G
$num
œœH K
,
œœK L
$num
œœM P
,
œœP Q
i
œœR S
,
œœS T
TextAlignment
œœU b
.
œœb c
CENTER
œœc i
,
œœi j
iText
œœk p
.
œœp q
Layout
œœq w
.
œœw x

Propertiesœœx Ç
.œœÇ É!
VerticalAlignmentœœÉ î
.œœî ï
MIDDLEœœï õ
,œœõ ú
$numœœù ü
)œœü †
;œœ† °
}
––  !
}
““ 
File
‘‘  
.
‘‘  !
WriteAllBytes
‘‘! .
(
‘‘. /

updateFile
‘‘/ 9
.
‘‘9 :
Path
‘‘: >
,
‘‘> ? 
outputMemoryStream
‘‘@ R
.
‘‘R S
ToArray
‘‘S Z
(
‘‘Z [
)
‘‘[ \
)
‘‘\ ]
;
‘‘] ^
}
’’ 

updateFile
÷÷ "
.
÷÷" #
StatusDownload
÷÷# 1
=
÷÷2 3
$num
÷÷4 5
;
÷÷5 6
_context
◊◊  
.
◊◊  !!
TblDownloadBigFiles
◊◊! 4
.
◊◊4 5
Update
◊◊5 ;
(
◊◊; <

updateFile
◊◊< F
)
◊◊F G
;
◊◊G H
_context
ÿÿ  
.
ÿÿ  !
SaveChanges
ÿÿ! ,
(
ÿÿ, -
)
ÿÿ- .
;
ÿÿ. /
}
ŸŸ 
}
⁄⁄ 
else
€€ 
{
‹‹ 

updateFile
›› 
.
›› 
StatusDownload
›› -
=
››. /
$num
››0 1
;
››1 2
_context
ﬁﬁ 
.
ﬁﬁ !
TblDownloadBigFiles
ﬁﬁ 0
.
ﬁﬁ0 1
Update
ﬁﬁ1 7
(
ﬁﬁ7 8

updateFile
ﬁﬁ8 B
)
ﬁﬁB C
;
ﬁﬁC D
_context
ﬂﬂ 
.
ﬂﬂ 
SaveChanges
ﬂﬂ (
(
ﬂﬂ( )
)
ﬂﬂ) *
;
ﬂﬂ* +
}
‡‡ 
}
·· 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
„„ 
var
‰‰ 
log
‰‰ 
=
‰‰ 
new
‰‰ 
TblLogErrorPrint
‰‰ .
(
‰‰. /
)
‰‰/ 0
;
‰‰0 1
log
ÂÂ 
.
ÂÂ 
IdFile
ÂÂ 
=
ÂÂ 
IdFile
ÂÂ #
;
ÂÂ# $
log
ÊÊ 
.
ÊÊ 
ErrorMessage
ÊÊ  
=
ÊÊ! "
ex
ÊÊ# %
.
ÊÊ% &
Message
ÊÊ& -
+
ÊÊ. /
$str
ÊÊ0 5
+
ÊÊ6 7
ex
ÊÊ8 :
.
ÊÊ: ;
InnerException
ÊÊ; I
;
ÊÊI J
log
ÁÁ 
.
ÁÁ 
CreatedTime
ÁÁ 
=
ÁÁ  !
DateTime
ÁÁ" *
.
ÁÁ* +
Now
ÁÁ+ .
;
ÁÁ. /
await
ËË 
_context
ËË 
.
ËË 
TblLogErrorPrints
ËË 0
.
ËË0 1
AddAsync
ËË1 9
(
ËË9 :
log
ËË: =
)
ËË= >
;
ËË> ?
await
ÈÈ 
_context
ÈÈ 
.
ÈÈ 
SaveChangesAsync
ÈÈ /
(
ÈÈ/ 0
)
ÈÈ0 1
;
ÈÈ1 2
}
ÍÍ 
}
ÎÎ 	
public
ÌÌ 
async
ÌÌ 
Task
ÌÌ 
PrintNoPExcel
ÌÌ '
(
ÌÌ' (
string
ÌÌ( .
	TypeExcel
ÌÌ/ 8
,
ÌÌ8 9
string
ÌÌ: @
FileName
ÌÌA I
,
ÌÌI J
int
ÌÌK N
IdFile
ÌÌO U
,
ÌÌU V
string
ÌÌW ]
Tanggal
ÌÌ^ e
)
ÌÌe f
{
ÓÓ 	'
DbDashboardDevaBniContext
ÔÔ %
_context
ÔÔ& .
=
ÔÔ/ 0
new
ÔÔ1 4'
DbDashboardDevaBniContext
ÔÔ5 N
(
ÔÔN O
)
ÔÔO P
;
ÔÔP Q
try
ÒÒ 
{
ÚÚ 
CultureInfo
ÛÛ 
culture
ÛÛ #
=
ÛÛ$ %
new
ÛÛ& )
CultureInfo
ÛÛ* 5
(
ÛÛ5 6
$str
ÛÛ6 =
)
ÛÛ= >
;
ÛÛ> ?
var
ÙÙ 
	dateArray
ÙÙ 
=
ÙÙ 
new
ÙÙ  #
string
ÙÙ$ *
[
ÙÙ* +
]
ÙÙ+ ,
{
ÙÙ- .
}
ÙÙ/ 0
;
ÙÙ0 1
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
string
ˆˆ 
.
ˆˆ 
IsNullOrEmpty
ˆˆ )
(
ˆˆ) *
Tanggal
ˆˆ* 1
)
ˆˆ1 2
)
ˆˆ2 3
{
˜˜ 
	dateArray
¯¯ 
=
¯¯ 
Tanggal
¯¯  '
.
¯¯' (
Split
¯¯( -
(
¯¯- .
$str
¯¯. 4
)
¯¯4 5
;
¯¯5 6
}
˘˘ 
var
˚˚ 
data
˚˚ 
=
˚˚ %
StoredProcedureExecutor
˚˚ 2
.
˚˚2 3
ExecuteSPList
˚˚3 @
<
˚˚@ A 
TblNoticeOfPayment
˚˚A S
>
˚˚S T
(
˚˚T U
_context
˚˚U ]
,
˚˚] ^
$str
˚˚_ }
,
˚˚} ~
new˚˚ Ç
SqlParameter˚˚É è
[˚˚è ê
]˚˚ê ë
{˚˚ë í
new
¸¸ 
SqlParameter
¸¸ $
(
¸¸$ %
$str
¸¸% 3
,
¸¸3 4
	dateArray
¸¸5 >
.
¸¸> ?
Count
¸¸? D
(
¸¸D E
)
¸¸E F
==
¸¸G I
$num
¸¸J K
?
¸¸L M
$str
¸¸N P
:
¸¸Q R
DateTime
¸¸S [
.
¸¸[ \
Parse
¸¸\ a
(
¸¸a b
	dateArray
¸¸b k
[
¸¸k l
$num
¸¸l m
]
¸¸m n
,
¸¸n o
culture
¸¸p w
)
¸¸w x
)
¸¸x y
,
¸¸y z
new
˝˝ 
SqlParameter
˝˝ $
(
˝˝$ %
$str
˝˝% 1
,
˝˝1 2
	dateArray
˝˝3 <
.
˝˝< =
Count
˝˝= B
(
˝˝B C
)
˝˝C D
==
˝˝E G
$num
˝˝H I
?
˝˝J K
$str
˝˝L N
:
˝˝O P
DateTime
˝˝Q Y
.
˝˝Y Z
Parse
˝˝Z _
(
˝˝_ `
	dateArray
˝˝` i
[
˝˝i j
$num
˝˝j k
]
˝˝k l
,
˝˝l m
culture
˝˝n u
)
˝˝u v
)
˝˝v w
,
˝˝w x
new
˛˛ 
SqlParameter
˛˛ $
(
˛˛$ %
$str
˛˛% 2
,
˛˛2 3
$str
˛˛4 8
)
˛˛8 9
,
˛˛9 :
new
ˇˇ 
SqlParameter
ˇˇ $
(
ˇˇ$ %
$str
ˇˇ% 5
,
ˇˇ5 6
$str
ˇˇ7 =
)
ˇˇ= >
,
ˇˇ> ?
new
ÄÄ 
SqlParameter
ÄÄ $
(
ÄÄ$ %
$str
ÄÄ% 2
,
ÄÄ2 3
$num
ÄÄ4 5
)
ÄÄ5 6
,
ÄÄ6 7
new
ÅÅ 
SqlParameter
ÅÅ $
(
ÅÅ$ %
$str
ÅÅ% 0
,
ÅÅ0 1
$num
ÅÅ2 7
)
ÅÅ7 8
}
ÇÇ 
)
ÇÇ 
;
ÇÇ 
var
ÑÑ 

updateFile
ÑÑ 
=
ÑÑ  
await
ÑÑ! &
_context
ÑÑ' /
.
ÑÑ/ 0!
TblDownloadBigFiles
ÑÑ0 C
.
ÑÑC D
Where
ÑÑD I
(
ÑÑI J
x
ÑÑJ K
=>
ÑÑL N
x
ÑÑO P
.
ÑÑP Q
Id
ÑÑQ S
==
ÑÑT V
IdFile
ÑÑW ]
)
ÑÑ] ^
.
ÑÑ^ _!
FirstOrDefaultAsync
ÑÑ_ r
(
ÑÑr s
)
ÑÑs t
;
ÑÑt u
if
áá 
(
áá 
!
áá 
	Directory
áá 
.
áá 
Exists
áá %
(
áá% &
	GetConfig
áá& /
.
áá/ 0

AppSetting
áá0 :
[
áá: ;
$str
áá; A
]
ááA B
)
ááB C
)
ááC D
{
àà 
	Directory
ââ 
.
ââ 
CreateDirectory
ââ -
(
ââ- .
	GetConfig
ââ. 7
.
ââ7 8

AppSetting
ââ8 B
[
ââB C
$str
ââC I
]
ââI J
)
ââJ K
;
ââK L
}
ää 
if
ªª 
(
ªª 
data
ªª 
!=
ªª 
null
ªª  
)
ªª  !
{
ºº 
	IWorkbook
ΩΩ 
workbook
ΩΩ &
;
ΩΩ& '
if
øø 
(
øø 
	TypeExcel
øø !
==
øø" $
$str
øø% +
)
øø+ ,
{
¿¿ 
workbook
¡¡  
=
¡¡! "
new
¡¡# &
XSSFWorkbook
¡¡' 3
(
¡¡3 4
)
¡¡4 5
;
¡¡5 6
}
¬¬ 
else
√√ 
if
√√ 
(
√√ 
	TypeExcel
√√ &
==
√√' )
$str
√√* /
)
√√/ 0
{
ƒƒ 
workbook
≈≈  
=
≈≈! "
new
≈≈# &
HSSFWorkbook
≈≈' 3
(
≈≈3 4
)
≈≈4 5
;
≈≈5 6
}
∆∆ 
else
«« 
{
»» 
throw
…… 
new
…… !
	Exception
……" +
(
……+ ,
$str
……, J
)
……J K
;
……K L
}
   
ReportExcel
ÕÕ 
reportExcel
ÕÕ  +
=
ÕÕ, -
new
ÕÕ. 1
ReportExcel
ÕÕ2 =
(
ÕÕ= >
)
ÕÕ> ?
;
ÕÕ? @
ISheet
ŒŒ 
sheet
ŒŒ  
=
ŒŒ! "
workbook
ŒŒ# +
.
ŒŒ+ ,
CreateSheet
ŒŒ, 7
(
ŒŒ7 8
$str
ŒŒ8 >
)
ŒŒ> ?
;
ŒŒ? @
sheet
œœ 
=
œœ 
reportExcel
œœ '
.
œœ' (
standartSheet
œœ( 5
(
œœ5 6
sheet
œœ6 ;
)
œœ; <
;
œœ< =

ICellStyle
–– 
HeaderCellStyle
–– .
=
––/ 0
reportExcel
––1 <
.
––< =
getJudulStyle1
––= K
(
––K L
workbook
––L T
,
––T U
	TypeExcel
––V _
)
––_ `
;
––` a
HeaderCellStyle
—— #
.
——# $
	Alignment
——$ -
=
——. /
NPOI
——0 4
.
——4 5
SS
——5 7
.
——7 8
	UserModel
——8 A
.
——A B!
HorizontalAlignment
——B U
.
——U V
Center
——V \
;
——\ ]
HeaderCellStyle
““ #
.
““# $
VerticalAlignment
““$ 5
=
““6 7
NPOI
““8 <
.
““< =
SS
““= ?
.
““? @
	UserModel
““@ I
.
““I J
VerticalAlignment
““J [
.
““[ \
Center
““\ b
;
““b c
HeaderCellStyle
”” #
.
””# $!
FillForegroundColor
””$ 7
=
””8 9
IndexedColors
””: G
.
””G H
White
””H M
.
””M N
Index
””N S
;
””S T
int
‘‘ 
rowExcel
‘‘  
=
‘‘! "
$num
‘‘# $
;
‘‘$ %
reportExcel
÷÷ 
.
÷÷  
setColoumWidth
÷÷  .
(
÷÷. /
sheet
÷÷/ 4
,
÷÷4 5
new
÷÷6 9
int
÷÷: =
[
÷÷= >
]
÷÷> ?
{
◊◊ 
$num
◊◊ 
,
◊◊ 
$num
◊◊  
,
◊◊  !
$num
◊◊" &
,
◊◊& '
$num
◊◊( ,
,
◊◊, -
$num
◊◊. 2
,
◊◊2 3
$num
◊◊4 8
}
◊◊8 9
,
◊◊9 :
$num
◊◊; <
)
◊◊< =
;
◊◊= >
reportExcel
ŸŸ 
.
ŸŸ  

setDataRow
ŸŸ  *
(
ŸŸ* +
sheet
ŸŸ+ 0
,
ŸŸ0 1
new
ŸŸ2 5
object
ŸŸ6 <
[
ŸŸ< =
]
ŸŸ= >
{
⁄⁄ 
$str
⁄⁄ 
,
⁄⁄ 
$str
⁄⁄  *
,
⁄⁄* +
$str
⁄⁄, 6
,
⁄⁄6 7
$str
⁄⁄7 F
,
⁄⁄F G
$str
⁄⁄H W
,
⁄⁄W X
$str
⁄⁄Y c
,
⁄⁄c d
$str
⁄⁄e p
,
⁄⁄p q
$str
⁄⁄r z
}
⁄⁄z {
,
⁄⁄{ |
rowExcel⁄⁄} Ö
++⁄⁄Ö á
)⁄⁄á à
;⁄⁄à â
foreach
‹‹ 
(
‹‹ 
var
‹‹  
cell
‹‹! %
in
‹‹& (
sheet
‹‹) .
.
‹‹. /
GetRow
‹‹/ 5
(
‹‹5 6
rowExcel
‹‹6 >
-
‹‹? @
$num
‹‹A B
)
‹‹B C
.
‹‹C D
Cells
‹‹D I
)
‹‹I J
{
›› 
cell
ﬁﬁ 
.
ﬁﬁ 
	CellStyle
ﬁﬁ &
=
ﬁﬁ' (
HeaderCellStyle
ﬁﬁ) 8
;
ﬁﬁ8 9
}
ﬂﬂ 
foreach
ÁÁ 
(
ÁÁ 
var
ÁÁ  
cell
ÁÁ! %
in
ÁÁ& (
sheet
ÁÁ) .
.
ÁÁ. /
GetRow
ÁÁ/ 5
(
ÁÁ5 6
rowExcel
ÁÁ6 >
-
ÁÁ? @
$num
ÁÁA B
)
ÁÁB C
.
ÁÁC D
Cells
ÁÁD I
)
ÁÁI J
{
ËË 
cell
ÈÈ 
.
ÈÈ 
	CellStyle
ÈÈ &
=
ÈÈ' (
HeaderCellStyle
ÈÈ) 8
;
ÈÈ8 9
cell
ÍÍ 
.
ÍÍ 
	CellStyle
ÍÍ &
.
ÍÍ& '
	Alignment
ÍÍ' 0
=
ÍÍ1 2
NPOI
ÍÍ3 7
.
ÍÍ7 8
SS
ÍÍ8 :
.
ÍÍ: ;
	UserModel
ÍÍ; D
.
ÍÍD E!
HorizontalAlignment
ÍÍE X
.
ÍÍX Y
Center
ÍÍY _
;
ÍÍ_ `
}
ÎÎ 
int
ÌÌ 
row
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
;
ÌÌ  
foreach
ÓÓ 
(
ÓÓ 
var
ÓÓ  
vw
ÓÓ! #
in
ÓÓ$ &
data
ÓÓ' +
)
ÓÓ+ ,
{
ÔÔ 
reportExcel
 #
.
# $

setDataRow
$ .
(
. /
sheet
/ 4
,
4 5
new
6 9
object
: @
[
@ A
]
A B
{
ÒÒ 
vw
ÚÚ 
.
ÚÚ 
NopNo
ÚÚ $
,
ÚÚ$ %
vw
ÛÛ 
.
ÛÛ 

RekNameAcc
ÛÛ )
,
ÛÛ) *
vw
ÙÙ 
.
ÙÙ 
DueDate
ÙÙ &
?
ÙÙ& '
.
ÙÙ' (
ToString
ÙÙ( 0
(
ÙÙ0 1
$str
ÙÙ1 =
)
ÙÙ= >
,
ÙÙ> ?
String
ıı "
.
ıı" #
Format
ıı# )
(
ıı) *
new
ıı* -
CultureInfo
ıı. 9
(
ıı9 :
$str
ıı: A
)
ııA B
,
ııB C
$str
ııD L
,
ııL M
decimal
ııN U
.
ııU V
Parse
ııV [
(
ıı[ \
vw
ıı\ ^
.
ıı^ _
InterestDays
ıı_ k
==
ııl n
null
ııo s
?
ııs t
$str
ııu {
:
ıı| }
vwıı~ Ä
.ııÄ Å
InterestDaysııÅ ç
.ııç é
ToStringııé ñ
(ııñ ó
)ııó ò
)ııò ô
)ııô ö
.ııö õ
Replaceııõ ¢
(ıı¢ £
$strıı£ ß
,ııß ®
$strıı® ™
)ıı™ ´
.ıı´ ¨
Replaceıı¨ ≥
(ıı≥ ¥
$strıı¥ π
,ııπ ∫
$strıı∫ º
)ııº Ω
,ııΩ æ
String
ˆˆ "
.
ˆˆ" #
Format
ˆˆ# )
(
ˆˆ) *
new
ˆˆ* -
CultureInfo
ˆˆ. 9
(
ˆˆ9 :
$str
ˆˆ: A
)
ˆˆA B
,
ˆˆB C
$str
ˆˆD L
,
ˆˆL M
decimal
ˆˆN U
.
ˆˆU V
Parse
ˆˆV [
(
ˆˆ[ \
vw
ˆˆ\ ^
.
ˆˆ^ _
InterestRate
ˆˆ_ k
==
ˆˆl n
null
ˆˆo s
?
ˆˆs t
$str
ˆˆu {
:
ˆˆ| }
vwˆˆ~ Ä
.ˆˆÄ Å
InterestRateˆˆÅ ç
.ˆˆç é
ToStringˆˆé ñ
(ˆˆñ ó
)ˆˆó ò
)ˆˆò ô
)ˆˆô ö
.ˆˆö õ
Replaceˆˆõ ¢
(ˆˆ¢ £
$strˆˆ£ ß
,ˆˆß ®
$strˆˆ® ™
)ˆˆ™ ´
.ˆˆ´ ¨
Replaceˆˆ¨ ≥
(ˆˆ≥ ¥
$strˆˆ¥ π
,ˆˆπ ∫
$strˆˆ∫ º
)ˆˆº Ω
,ˆˆΩ æ
vw
˘˘ 
.
˘˘ 
Cur
˘˘ "
,
˘˘" #
vw
˙˙ 
.
˙˙ 
LastSentDate
˙˙ +
?
˙˙+ ,
.
˙˙, -
ToString
˙˙- 5
(
˙˙5 6
$str
˙˙6 B
)
˙˙B C
,
˙˙C D
vw
˚˚ 
.
˚˚ 
Status
˚˚ %
,
˚˚% &
}
¸¸ 
,
¸¸ 
rowExcel
¸¸ #
++
¸¸# %
)
¸¸% &
;
¸¸& '
}
˝˝ 
MemoryStream
ÄÄ  
output
ÄÄ! '
=
ÄÄ( )
new
ÄÄ* -
MemoryStream
ÄÄ. :
(
ÄÄ: ;
)
ÄÄ; <
;
ÄÄ< =
workbook
ÅÅ 
.
ÅÅ 
Write
ÅÅ "
(
ÅÅ" #
output
ÅÅ# )
,
ÅÅ) *
true
ÅÅ+ /
)
ÅÅ/ 0
;
ÅÅ0 1
using
ÉÉ 
(
ÉÉ 

FileStream
ÉÉ %

fileStream
ÉÉ& 0
=
ÉÉ1 2
new
ÉÉ3 6

FileStream
ÉÉ7 A
(
ÉÉA B

updateFile
ÉÉB L
.
ÉÉL M
Path
ÉÉM Q
,
ÉÉQ R
FileMode
ÉÉS [
.
ÉÉ[ \
Create
ÉÉ\ b
,
ÉÉb c

FileAccess
ÉÉd n
.
ÉÉn o
Write
ÉÉo t
)
ÉÉt u
)
ÉÉu v
{
ÑÑ 
output
ÖÖ 
.
ÖÖ 
WriteTo
ÖÖ &
(
ÖÖ& '

fileStream
ÖÖ' 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ 

updateFile
àà 
.
àà 
StatusDownload
àà -
=
àà. /
$num
àà0 1
;
àà1 2
_context
ââ 
.
ââ !
TblDownloadBigFiles
ââ 0
.
ââ0 1
Update
ââ1 7
(
ââ7 8

updateFile
ââ8 B
)
ââB C
;
ââC D
_context
ää 
.
ää 
SaveChanges
ää (
(
ää( )
)
ää) *
;
ää* +
}
ãã 
else
åå 
{
çç 

updateFile
éé 
.
éé 
StatusDownload
éé -
=
éé. /
$num
éé0 1
;
éé1 2
_context
èè 
.
èè !
TblDownloadBigFiles
èè 0
.
èè0 1
Update
èè1 7
(
èè7 8

updateFile
èè8 B
)
èèB C
;
èèC D
_context
êê 
.
êê 
SaveChanges
êê (
(
êê( )
)
êê) *
;
êê* +
}
ëë 
}
íí 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
îî 
var
ïï 
log
ïï 
=
ïï 
new
ïï 
TblLogErrorPrint
ïï .
(
ïï. /
)
ïï/ 0
;
ïï0 1
log
ññ 
.
ññ 
IdFile
ññ 
=
ññ 
IdFile
ññ #
;
ññ# $
log
óó 
.
óó 
ErrorMessage
óó  
=
óó! "
ex
óó# %
.
óó% &
Message
óó& -
+
óó. /
$str
óó0 5
+
óó6 7
ex
óó8 :
.
óó: ;
InnerException
óó; I
;
óóI J
log
òò 
.
òò 
CreatedTime
òò 
=
òò  !
DateTime
òò" *
.
òò* +
Now
òò+ .
;
òò. /
await
ôô 
_context
ôô 
.
ôô 
TblLogErrorPrints
ôô 0
.
ôô0 1
AddAsync
ôô1 9
(
ôô9 :
log
ôô: =
)
ôô= >
;
ôô> ?
await
öö 
_context
öö 
.
öö 
SaveChangesAsync
öö /
(
öö/ 0
)
öö0 1
;
öö1 2
}
õõ 
}
úú 	
public
ûû 
async
ûû 
Task
ûû 
PrintNoPPDF
ûû %
(
ûû% &
string
ûû& ,
Tanggal
ûû- 4
,
ûû4 5
string
ûû6 <
namaPegawai
ûû= H
,
ûûH I
string
ûûJ P
Scheme
ûûQ W
,
ûûW X
string
ûûY _
Host
ûû` d
,
ûûd e
int
ûûf i
IdFile
ûûj p
)
ûûp q
{
üü 	'
DbDashboardDevaBniContext
†† %
_context
††& .
=
††/ 0
new
††1 4'
DbDashboardDevaBniContext
††5 N
(
††N O
)
††O P
;
††P Q
try
¢¢ 
{
££ 
var
§§ 

updateFile
§§ 
=
§§  
await
§§! &
_context
§§' /
.
§§/ 0!
TblDownloadBigFiles
§§0 C
.
§§C D
Where
§§D I
(
§§I J
x
§§J K
=>
§§L N
x
§§O P
.
§§P Q
Id
§§Q S
==
§§T V
IdFile
§§W ]
)
§§] ^
.
§§^ _!
FirstOrDefaultAsync
§§_ r
(
§§r s
)
§§s t
;
§§t u
if
¶¶ 
(
¶¶ 
!
¶¶ 
	Directory
¶¶ 
.
¶¶ 
Exists
¶¶ %
(
¶¶% &
	GetConfig
¶¶& /
.
¶¶/ 0

AppSetting
¶¶0 :
[
¶¶: ;
$str
¶¶; A
]
¶¶A B
)
¶¶B C
)
¶¶C D
{
ßß 
	Directory
®® 
.
®® 
CreateDirectory
®® -
(
®®- .
	GetConfig
®®. 7
.
®®7 8

AppSetting
®®8 B
[
®®B C
$str
®®C I
]
®®I J
)
®®J K
;
®®K L
}
©© 
CultureInfo
´´ 
culture
´´ #
=
´´$ %
new
´´& )
CultureInfo
´´* 5
(
´´5 6
$str
´´6 =
)
´´= >
;
´´> ?
var
¨¨ 
	dateArray
¨¨ 
=
¨¨ 
new
¨¨  #
string
¨¨$ *
[
¨¨* +
]
¨¨+ ,
{
¨¨- .
}
¨¨/ 0
;
¨¨0 1
if
ÆÆ 
(
ÆÆ 
!
ÆÆ 
string
ÆÆ 
.
ÆÆ 
IsNullOrEmpty
ÆÆ )
(
ÆÆ) *
Tanggal
ÆÆ* 1
)
ÆÆ1 2
)
ÆÆ2 3
{
ØØ 
	dateArray
∞∞ 
=
∞∞ 
Tanggal
∞∞  '
.
∞∞' (
Split
∞∞( -
(
∞∞- .
$str
∞∞. 4
)
∞∞4 5
;
∞∞5 6
}
±± 
var
≥≥ 
headerToExport
≥≥ "
=
≥≥# $%
StoredProcedureExecutor
≥≥% <
.
≥≥< =
ExecuteSPList
≥≥= J
<
≥≥J K 
TblNoticeOfPayment
≥≥K ]
>
≥≥] ^
(
≥≥^ _
_context
≥≥_ g
,
≥≥g h
$str≥≥i á
,≥≥á à
new≥≥â å
SqlParameter≥≥ç ô
[≥≥ô ö
]≥≥ö õ
{
¥¥ 
new
µµ 
SqlParameter
µµ $
(
µµ$ %
$str
µµ% 3
,
µµ3 4
	dateArray
µµ5 >
.
µµ> ?
Count
µµ? D
(
µµD E
)
µµE F
==
µµG I
$num
µµJ K
?
µµL M
$str
µµN P
:
µµQ R
DateTime
µµS [
.
µµ[ \
Parse
µµ\ a
(
µµa b
	dateArray
µµb k
[
µµk l
$num
µµl m
]
µµm n
,
µµn o
culture
µµp w
)
µµw x
)
µµx y
,
µµy z
new
∂∂ 
SqlParameter
∂∂ $
(
∂∂$ %
$str
∂∂% 1
,
∂∂1 2
	dateArray
∂∂3 <
.
∂∂< =
Count
∂∂= B
(
∂∂B C
)
∂∂C D
==
∂∂E G
$num
∂∂H I
?
∂∂J K
$str
∂∂L N
:
∂∂O P
DateTime
∂∂Q Y
.
∂∂Y Z
Parse
∂∂Z _
(
∂∂_ `
	dateArray
∂∂` i
[
∂∂i j
$num
∂∂j k
]
∂∂k l
,
∂∂l m
culture
∂∂n u
)
∂∂u v
)
∂∂v w
,
∂∂w x
new
∑∑ 
SqlParameter
∑∑ $
(
∑∑$ %
$str
∑∑% 2
,
∑∑2 3
$str
∑∑4 8
)
∑∑8 9
,
∑∑9 :
new
∏∏ 
SqlParameter
∏∏ $
(
∏∏$ %
$str
∏∏% 5
,
∏∏5 6
$str
∏∏7 =
)
∏∏= >
,
∏∏> ?
new
ππ 
SqlParameter
ππ $
(
ππ$ %
$str
ππ% 2
,
ππ2 3
$num
ππ4 5
)
ππ5 6
,
ππ6 7
new
∫∫ 
SqlParameter
∫∫ $
(
∫∫$ %
$str
∫∫% 0
,
∫∫0 1
$num
∫∫2 7
)
∫∫7 8
}
ªª 
)
ªª 
;
ªª 
if
ΩΩ 
(
ΩΩ 
headerToExport
ΩΩ "
!=
ΩΩ# %
null
ΩΩ& *
)
ΩΩJ K
{
ææ 
var
øø 
locationnow
øø #
=
øø$ %
new
øø& )
Uri
øø* -
(
øø- .
$"
øø. 0
{
øø0 1
Scheme
øø1 7
}
øø7 8
$str
øø8 ;
{
øø; <
Host
øø< @
}
øø@ A
"
øøA B
)
øøB C
;
øøC D
string
¿¿ 
	imagePath
¿¿ $
=
¿¿% &
$str
¿¿' G
;
¿¿G H
byte
¡¡ 
[
¡¡ 
]
¡¡ 

imageBytes
¡¡ %
=
¡¡& '
System
¡¡( .
.
¡¡. /
IO
¡¡/ 1
.
¡¡1 2
File
¡¡2 6
.
¡¡6 7
ReadAllBytes
¡¡7 C
(
¡¡C D
	imagePath
¡¡D M
)
¡¡M N
;
¡¡N O
string
¬¬ 
base64String
¬¬ '
=
¬¬( )
Convert
¬¬* 1
.
¬¬1 2
ToBase64String
¬¬2 @
(
¬¬@ A

imageBytes
¬¬A K
)
¬¬K L
;
¬¬L M&
ExportToPDFNoP_ViewModel
ƒƒ ,
model
ƒƒ- 2
=
ƒƒ3 4
new
ƒƒ5 8&
ExportToPDFNoP_ViewModel
ƒƒ9 Q
(
ƒƒQ R
)
ƒƒR S
;
ƒƒS T
model
≈≈ 
.
≈≈ 
Domain
≈≈  
=
≈≈! "
locationnow
≈≈# .
.
≈≈. /
AbsoluteUri
≈≈/ :
;
≈≈: ;
model
∆∆ 
.
∆∆ 
	UserLogin
∆∆ #
=
∆∆$ %
namaPegawai
∆∆& 1
;
∆∆1 2
model
«« 
.
«« 
TanggalCetak
«« &
=
««' (
DateTime
««) 1
.
««1 2
Now
««2 5
.
««5 6
ToString
««6 >
(
««> ?
$str
««? Q
,
««Q R
culture
««S Z
)
««Z [
;
««[ \
model
»» 
.
»» 
Logo
»» 
=
»»  
base64String
»»! -
;
»»- .
model
…… 
.
…… 
ListData
…… "
=
……# $
headerToExport
……% 3
;
……3 4
var
ÀÀ 
engine
ÀÀ 
=
ÀÀ  
new
ÀÀ! $%
RazorLightEngineBuilder
ÀÀ% <
(
ÀÀ< =
)
ÀÀ= >
.
ÃÃ &
UseMemoryCachingProvider
ÃÃ -
(
ÃÃ- .
)
ÃÃ. /
.
ÕÕ 
Build
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
string
œœ 
templateFilePath
œœ +
=
œœ, -
$str
œœ. Z
;
œœZ [
string
–– 
template
–– #
=
––$ %
File
––& *
.
––* +
ReadAllText
––+ 6
(
––6 7
templateFilePath
––7 G
)
––G H
;
––H I
string
—— 
result
—— !
=
——" #
string
——$ *
.
——* +
Empty
——+ 0
;
——0 1
try
”” 
{
‘‘ 
result
’’ 
=
’’  
await
’’! &
engine
’’' -
.
’’- .&
CompileRenderStringAsync
’’. F
(
’’F G
$str
’’G T
,
’’T U
template
’’V ^
,
’’^ _
model
’’` e
)
’’e f
;
’’f g
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ $
ex
◊◊% '
)
◊◊' (
{
ÿÿ 
var
ŸŸ 
log
ŸŸ 
=
ŸŸ  !
new
ŸŸ" %
TblLogErrorPrint
ŸŸ& 6
(
ŸŸ6 7
)
ŸŸ7 8
;
ŸŸ8 9
log
⁄⁄ 
.
⁄⁄ 
IdFile
⁄⁄ "
=
⁄⁄# $
IdFile
⁄⁄% +
;
⁄⁄+ ,
log
€€ 
.
€€ 
ErrorMessage
€€ (
=
€€) *
ex
€€+ -
.
€€- .
Message
€€. 5
+
€€6 7
$str
€€8 =
+
€€> ?
ex
€€@ B
.
€€B C
InnerException
€€C Q
;
€€Q R
log
‹‹ 
.
‹‹ 
CreatedTime
‹‹ '
=
‹‹( )
DateTime
‹‹* 2
.
‹‹2 3
Now
‹‹3 6
;
‹‹6 7
await
›› 
_context
›› &
.
››& '
TblLogErrorPrints
››' 8
.
››8 9
AddAsync
››9 A
(
››A B
log
››B E
)
››E F
;
››F G
await
ﬁﬁ 
_context
ﬁﬁ &
.
ﬁﬁ& '
SaveChangesAsync
ﬁﬁ' 7
(
ﬁﬁ7 8
)
ﬁﬁ8 9
;
ﬁﬁ9 :
}
ﬂﬂ 
var
‡‡ 
globalSettings
‡‡ &
=
‡‡' (
new
‡‡) ,
GlobalSettings
‡‡- ;
{
·· 
	ColorMode
‚‚ !
=
‚‚" #
	ColorMode
‚‚$ -
.
‚‚- .
Color
‚‚. 3
,
‚‚3 4
Orientation
„„ #
=
„„$ %
Orientation
„„& 1
.
„„1 2
	Landscape
„„2 ;
,
„„; <
	PaperSize
‰‰ !
=
‰‰" #
	PaperKind
‰‰$ -
.
‰‰- .
A4
‰‰. 0
,
‰‰0 1
Margins
ÂÂ 
=
ÂÂ  !
new
ÂÂ" %
MarginSettings
ÂÂ& 4
{
ÂÂ5 6
Top
ÂÂ7 :
=
ÂÂ; <
$num
ÂÂ= >
,
ÂÂ> ?
Right
ÂÂ@ E
=
ÂÂF G
$num
ÂÂH I
,
ÂÂI J
Left
ÂÂK O
=
ÂÂP Q
$num
ÂÂR S
,
ÂÂS T
Bottom
ÂÂU [
=
ÂÂ\ ]
$num
ÂÂ^ _
}
ÂÂ` a
,
ÂÂa b
}
ÁÁ 
;
ÁÁ 
var
ÈÈ 
objectSettings
ÈÈ &
=
ÈÈ' (
new
ÈÈ) ,
ObjectSettings
ÈÈ- ;
{
ÍÍ 

PagesCount
ÎÎ "
=
ÎÎ# $
true
ÎÎ% )
,
ÎÎ) *
HtmlContent
ÏÏ #
=
ÏÏ$ %
result
ÏÏ& ,
,
ÏÏ, -
FooterSettings
ÌÌ &
=
ÌÌ' (
new
ÌÌ) ,
FooterSettings
ÌÌ- ;
{
ÓÓ 
FontSize
ÔÔ $
=
ÔÔ% &
$num
ÔÔ' (
,
ÔÔ( )
FontName
 $
=
% &
$str
' 8
,
8 9
Left
ÒÒ  
=
ÒÒ! "
$str
ÒÒ# 8
,
ÒÒ8 9
Center
ÚÚ "
=
ÚÚ# $
$str
ÚÚ% S
,
ÚÚS T
Right
ÛÛ !
=
ÛÛ" #
$"
ÛÛ$ &
$str
ÛÛ& >
{
ÛÛ> ?
model
ÛÛ? D
.
ÛÛD E
	UserLogin
ÛÛE N
}
ÛÛN O
$str
ÛÛO Q
{
ÛÛQ R
model
ÛÛR W
.
ÛÛW X
TanggalCetak
ÛÛX d
}
ÛÛd e
"
ÛÛe f
}
ÙÙ 
}
ıı 
;
ıı 
var
˜˜ 
pdf
˜˜ 
=
˜˜ 
new
˜˜ !
HtmlToPdfDocument
˜˜" 3
(
˜˜3 4
)
˜˜4 5
{
¯¯ 
GlobalSettings
˘˘ &
=
˘˘' (
globalSettings
˘˘) 7
,
˘˘7 8
Objects
˙˙ 
=
˙˙  !
{
˙˙" #
objectSettings
˙˙$ 2
}
˙˙3 4
}
˚˚ 
;
˚˚ 
using
˛˛ 
(
˛˛ 
var
˛˛ 
pdfTools
˛˛ '
=
˛˛( )
new
˛˛* -
PdfTools
˛˛. 6
(
˛˛6 7
)
˛˛7 8
)
˛˛8 9
{
ˇˇ 
var
ÄÄ 
	converter
ÄÄ %
=
ÄÄ& '
new
ÄÄ( +#
SynchronizedConverter
ÄÄ, A
(
ÄÄA B
pdfTools
ÄÄB J
)
ÄÄJ K
;
ÄÄK L
byte
ÅÅ 
[
ÅÅ 
]
ÅÅ 
file
ÅÅ #
=
ÅÅ$ %
	converter
ÅÅ& /
.
ÅÅ/ 0
Convert
ÅÅ0 7
(
ÅÅ7 8
pdf
ÅÅ8 ;
)
ÅÅ; <
;
ÅÅ< =
using
ÉÉ 
(
ÉÉ 
MemoryStream
ÉÉ +
inputMemoryStream
ÉÉ, =
=
ÉÉ> ?
new
ÉÉ@ C
MemoryStream
ÉÉD P
(
ÉÉP Q
file
ÉÉQ U
)
ÉÉU V
)
ÉÉV W
using
ÑÑ 
(
ÑÑ 
MemoryStream
ÑÑ + 
outputMemoryStream
ÑÑ, >
=
ÑÑ? @
new
ÑÑA D
MemoryStream
ÑÑE Q
(
ÑÑQ R
)
ÑÑR S
)
ÑÑS T
{
ÖÖ 
	PdfReader
ÜÜ %
	pdfReader
ÜÜ& /
=
ÜÜ0 1
new
ÜÜ2 5
	PdfReader
ÜÜ6 ?
(
ÜÜ? @
inputMemoryStream
ÜÜ@ Q
)
ÜÜQ R
;
ÜÜR S
	PdfWriter
áá %
	pdfWriter
áá& /
=
áá0 1
new
áá2 5
	PdfWriter
áá6 ?
(
áá? @ 
outputMemoryStream
áá@ R
)
ááR S
;
ááS T
using
àà !
(
àà" #
PdfDocument
àà# .
pdfDocument
àà/ :
=
àà; <
new
àà= @
PdfDocument
ààA L
(
ààL M
	pdfReader
ààM V
,
ààV W
	pdfWriter
ààX a
)
ààa b
)
ààb c
{
ââ 
Document
ää  (
document
ää) 1
=
ää2 3
new
ää4 7
Document
ää8 @
(
ää@ A
pdfDocument
ääA L
)
ääL M
;
ääM N
	Paragraph
çç  )
	watermark
çç* 3
=
çç4 5
new
çç6 9
	Paragraph
çç: C
(
ççC D
$"
ççD F
{
ççF G
model
ççG L
.
ççL M
	UserLogin
ççM V
}
ççV W
$str
ççW Z
{
ççZ [
model
çç[ `
.
çç` a
TanggalCetak
çça m
.
ççm n
Replace
ççn u
(
ççu v
$str
ççv y
,
ççy z
$str
çç{ ~
)
çç~ 
}çç Ä
$strççÄ Ñ
"ççÑ Ö
)ççÖ Ü
.
éé$ %
SetFontColor
éé% 1
(
éé1 2
iText
éé2 7
.
éé7 8
Kernel
éé8 >
.
éé> ?
Colors
éé? E
.
ééE F
ColorConstants
ééF T
.
ééT U

LIGHT_GRAY
ééU _
)
éé_ `
.
èè$ %
SetFontSize
èè% 0
(
èè0 1
$num
èè1 3
)
èè3 4
.
êê$ %

SetOpacity
êê% /
(
êê/ 0
$num
êê0 4
)
êê4 5
.
ëë$ %
SetWidth
ëë% -
(
ëë- .
$num
ëë. 2
)
ëë2 3
.
íí$ %
SetRotationAngle
íí% 5
(
íí5 6
-
íí6 7
$num
íí7 :
)
íí: ;
;
íí; <
for
ïï  #
(
ïï$ %
int
ïï% (
i
ïï) *
=
ïï+ ,
$num
ïï- .
;
ïï. /
i
ïï0 1
<=
ïï2 4
pdfDocument
ïï5 @
.
ïï@ A
GetNumberOfPages
ïïA Q
(
ïïQ R
)
ïïR S
;
ïïS T
i
ïïU V
++
ïïV X
)
ïïX Y
{
ññ  !
float
óó$ )
centerX
óó* 1
=
óó2 3
document
óó4 <
.
óó< =
GetPdfDocument
óó= K
(
óóK L
)
óóL M
.
óóM N 
GetDefaultPageSize
óóN `
(
óó` a
)
óóa b
.
óób c
GetWidth
óóc k
(
óók l
)
óól m
/
óón o
$num
óóp q
;
óóq r
float
òò$ )
centerY
òò* 1
=
òò2 3
document
òò4 <
.
òò< =
GetPdfDocument
òò= K
(
òòK L
)
òòL M
.
òòM N 
GetDefaultPageSize
òòN `
(
òò` a
)
òòa b
.
òòb c
	GetHeight
òòc l
(
òòl m
)
òòm n
/
òòo p
$num
òòq r
;
òòr s
document
ôô$ ,
.
ôô, -
ShowTextAligned
ôô- <
(
ôô< =
	watermark
ôô= F
,
ôôF G
$num
ôôH K
,
ôôK L
$num
ôôM P
,
ôôP Q
i
ôôR S
,
ôôS T
TextAlignment
ôôU b
.
ôôb c
CENTER
ôôc i
,
ôôi j
iText
ôôk p
.
ôôp q
Layout
ôôq w
.
ôôw x

Propertiesôôx Ç
.ôôÇ É!
VerticalAlignmentôôÉ î
.ôôî ï
MIDDLEôôï õ
,ôôõ ú
$numôôù ü
)ôôü †
;ôô† °
}
öö  !
}
úú 
File
ûû  
.
ûû  !
WriteAllBytes
ûû! .
(
ûû. /

updateFile
ûû/ 9
.
ûû9 :
Path
ûû: >
,
ûû> ? 
outputMemoryStream
ûû@ R
.
ûûR S
ToArray
ûûS Z
(
ûûZ [
)
ûû[ \
)
ûû\ ]
;
ûû] ^
}
üü 

updateFile
†† "
.
††" #
StatusDownload
††# 1
=
††2 3
$num
††4 5
;
††5 6
_context
°°  
.
°°  !!
TblDownloadBigFiles
°°! 4
.
°°4 5
Update
°°5 ;
(
°°; <

updateFile
°°< F
)
°°F G
;
°°G H
_context
¢¢  
.
¢¢  !
SaveChanges
¢¢! ,
(
¢¢, -
)
¢¢- .
;
¢¢. /
}
££ 
}
§§ 
else
•• 
{
¶¶ 

updateFile
ßß 
.
ßß 
StatusDownload
ßß -
=
ßß. /
$num
ßß0 1
;
ßß1 2
_context
®® 
.
®® !
TblDownloadBigFiles
®® 0
.
®®0 1
Update
®®1 7
(
®®7 8

updateFile
®®8 B
)
®®B C
;
®®C D
_context
©© 
.
©© 
SaveChanges
©© (
(
©©( )
)
©©) *
;
©©* +
}
™™ 
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
≠≠ 
var
ÆÆ 
log
ÆÆ 
=
ÆÆ 
new
ÆÆ 
TblLogErrorPrint
ÆÆ .
(
ÆÆ. /
)
ÆÆ/ 0
;
ÆÆ0 1
log
ØØ 
.
ØØ 
IdFile
ØØ 
=
ØØ 
IdFile
ØØ #
;
ØØ# $
log
∞∞ 
.
∞∞ 
ErrorMessage
∞∞  
=
∞∞! "
ex
∞∞# %
.
∞∞% &
Message
∞∞& -
+
∞∞. /
$str
∞∞0 5
+
∞∞6 7
ex
∞∞8 :
.
∞∞: ;
InnerException
∞∞; I
;
∞∞I J
log
±± 
.
±± 
CreatedTime
±± 
=
±±  !
DateTime
±±" *
.
±±* +
Now
±±+ .
;
±±. /
await
≤≤ 
_context
≤≤ 
.
≤≤ 
TblLogErrorPrints
≤≤ 0
.
≤≤0 1
AddAsync
≤≤1 9
(
≤≤9 :
log
≤≤: =
)
≤≤= >
;
≤≤> ?
await
≥≥ 
_context
≥≥ 
.
≥≥ 
SaveChangesAsync
≥≥ /
(
≥≥/ 0
)
≥≥0 1
;
≥≥1 2
}
¥¥ 
}
µµ 	
}
∂∂ 
}∑∑ ˜O
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\LastSession.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public 

class 
LastSessionLog 
{		  
IHttpContextAccessor

  
_httpContextAccessor

 1
;

1 2
private 
readonly %
DbDashboardDevaBniContext 2
_context3 ;
;; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
public 
LastSessionLog 
(  
IHttpContextAccessor 2
httpContextAccessor3 F
,F G%
DbDashboardDevaBniContextH a
contextb i
,i j
IConfigurationk y
config	z Ä
)
Ä Å
{ 	 
_httpContextAccessor  
=! "
httpContextAccessor# 6
;6 7
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
} 	
public 
bool 
Update 
( 
) 
{ 	
bool 
	isSession 
= 
false "
;" #
IPHostEntry 
heserver  
=! "
Dns# &
.& '
GetHostEntry' 3
(3 4
Dns4 7
.7 8
GetHostName8 C
(C D
)D E
)E F
;F G
var 
	ipAddress 
= 
heserver $
.$ %
AddressList% 0
.0 1
ToList1 7
(7 8
)8 9
.9 :
Where: ?
(? @
ip@ B
=>C E
ipF H
.H I
AddressFamilyI V
==W Y
SystemZ `
.` a
Neta d
.d e
Socketse l
.l m
AddressFamilym z
.z {
InterNetwork	{ á
)
á à
.
à â
FirstOrDefault
â ó
(
ó ò
)
ò ô
.
ô ö
ToString
ö ¢
(
¢ £
)
£ §
;
§ •
var 
	userAgent 
=  
_httpContextAccessor 0
.0 1
HttpContext1 <
.< =
Request= D
.D E
HeadersE L
[L M
$strM Y
]Y Z
;Z [
string 
uaString 
= 
Convert %
.% &
ToString& .
(. /
	userAgent/ 8
[8 9
$num9 :
]: ;
); <
;< =
var 
uaParser 
= 
Parser !
.! "

GetDefault" ,
(, -
)- .
;. /

ClientInfo 
c 
= 
uaParser #
.# $
Parse$ )
() *
uaString* 2
)2 3
;3 4
var 
url 
=  
_httpContextAccessor *
.* +
HttpContext+ 6
.6 7
Request7 >
.> ?
GetDisplayUrl? L
(L M
)M N
;N O
TblUserSession!! 
UserSession!! &
=!!' (
new!!) ,
TblUserSession!!- ;
(!!; <
)!!< =
;!!= >
if## 
(##  
_httpContextAccessor## $
.##$ %
HttpContext##% 0
.##0 1
Session##1 8
.##8 9
	GetString##9 B
(##B C
SessionConstan##C Q
.##Q R
Session_UserId##R `
)##` a
==##b d
null##e i
)##i j
{$$ 
	isSession'' 
='' 
false'' !
;''! "
}(( 
else)) 
{** 
var++ 
UserId++ 
=++ 
int++  
.++  !
Parse++! &
(++& ' 
_httpContextAccessor++' ;
.++; <
HttpContext++< G
.++G H
Session++H O
.++O P
	GetString++P Y
(++Y Z
SessionConstan++Z h
.++h i
Session_UserId++i w
)++w x
)++x y
;++y z
TblUserSession.. 
ds.. !
=.." #
_context..$ ,
..., -
TblUserSessions..- <
...< =
Where..= B
(..B C
f..C D
=>..E G
f..H I
...I J
UserId..J P
==..Q S
UserId..T Z
)..Z [
...[ \
FirstOrDefault..\ j
(..j k
)..k l
;..l m
if// 
(// 
ds// 
!=// 
null// 
)// 
{00 
ds11 
.11 
	SessionId11  
=11! " 
_httpContextAccessor11# 7
.117 8
HttpContext118 C
.11C D
Session11D K
.11K L
Id11L N
;11N O
ds22 
.22 

LastActive22 !
=22" #
DateTime22$ ,
.22, -
Now22- 0
;220 1
ds33 
.33 
RoleId33 
=33 
int33  #
.33# $
Parse33$ )
(33) * 
_httpContextAccessor33* >
.33> ?
HttpContext33? J
.33J K
Session33K R
.33R S
	GetString33S \
(33\ ]
SessionConstan33] k
.33k l
Session_RoleKode33l |
)33| }
)33} ~
;33~ 
ds44 
.44 
Info44 
=44 
	ipAddress44 '
;44' (
_context66 
.66 
TblUserSessions66 ,
.66, -
Update66- 3
(663 4
ds664 6
)666 7
;667 8
_context77 
.77 
SaveChanges77 (
(77( )
)77) *
;77* +
}88 
else99 
{:: 
UserSession;; 
.;;  
UserId;;  &
=;;' (
int;;) ,
.;;, -
Parse;;- 2
(;;2 3 
_httpContextAccessor;;3 G
.;;G H
HttpContext;;H S
.;;S T
Session;;T [
.;;[ \
	GetString;;\ e
(;;e f
SessionConstan;;f t
.;;t u
Session_UserId	;;u É
)
;;É Ñ
)
;;Ñ Ö
;
;;Ö Ü
UserSession<< 
.<<  
	SessionId<<  )
=<<* + 
_httpContextAccessor<<, @
.<<@ A
HttpContext<<A L
.<<L M
Session<<M T
.<<T U
Id<<U W
;<<W X
UserSession== 
.==  

LastActive==  *
===+ ,
DateTime==- 5
.==5 6
Now==6 9
;==9 :
UserSession>> 
.>>  
Info>>  $
=>>% &
	ipAddress>>' 0
;>>0 1
UserSession?? 
.??  
RoleId??  &
=??' (
int??) ,
.??, -
Parse??- 2
(??2 3 
_httpContextAccessor??3 G
.??G H
HttpContext??H S
.??S T
Session??T [
.??[ \
	GetString??\ e
(??e f
SessionConstan??f t
.??t u
Session_RoleKode	??u Ö
)
??Ö Ü
)
??Ü á
;
??á à
_contextAA 
.AA 
TblUserSessionsAA ,
.AA, -
AddAA- 0
(AA0 1
UserSessionAA1 <
)AA< =
;AA= >
_contextBB 
.BB 
SaveChangesBB (
(BB( )
)BB) *
;BB* +
}CC 
TblLogActivityFF 
dataLogFF &
=FF' (
newFF) ,
TblLogActivityFF- ;
(FF; <
)FF< =
;FF= >
dataLogGG 
.GG 
UserIdGG 
=GG  
UserIdGG! '
;GG' (
dataLogII 
.II 
UrlII 
=II 
urlII !
;II! "
dataLogJJ 
.JJ 

ActionTimeJJ "
=JJ# $
DateTimeJJ% -
.JJ- .
NowJJ. 1
;JJ1 2
ifKK 
(KK 
cKK 
!=KK 
nullKK 
)KK 
{LL 
ifMM 
(MM 
cMM 
.MM 
	UserAgentMM #
!=MM$ &
nullMM' +
)MM+ ,
{NN 
dataLogOO 
.OO  
BrowserOO  '
=OO( )
cOO* +
.OO+ ,
	UserAgentOO, 5
.OO5 6
FamilyOO6 <
+OO= >
$strOO? B
+OOC D
cOOE F
.OOF G
	UserAgentOOG P
.OOP Q
MajorOOQ V
+OOW X
$strOOY \
+OO] ^
cOO_ `
.OO` a
	UserAgentOOa j
.OOj k
MinorOOk p
;OOp q
}QQ 
ifSS 
(SS 
cSS 
.SS 
OSSS 
!=SS 
nullSS  $
)SS$ %
{TT 
dataLogUU 
.UU  
OsUU  "
=UU# $
cUU% &
.UU& '
OSUU' )
.UU) *
FamilyUU* 0
+UU1 2
$strUU3 6
+UU7 8
cUU9 :
.UU: ;
OSUU; =
.UU= >
MajorUU> C
+UUD E
$strUUF I
+UUJ K
cUUL M
.UUM N
OSUUN P
.UUP Q
MinorUUQ V
;UUV W
}VV 
}WW 
dataLogXX 
.XX 
IpXX 
=XX 
	ipAddressXX &
;XX& '
dataLogYY 
.YY 

ClientInfoYY "
=YY# $
cYY% &
.YY& '
StringYY' -
;YY- .
_contextZZ 
.ZZ 
TblLogActivitiesZZ )
.ZZ) *
AddZZ* -
(ZZ- .
dataLogZZ. 5
)ZZ5 6
;ZZ6 7
_context[[ 
.[[ 
SaveChanges[[ $
([[$ %
)[[% &
;[[& '
	isSession\\ 
=\\ 
true\\  
;\\  !
}]] 
return^^ 
	isSession^^ 
;^^ 
}__ 	
}`` 
}aa Á
DD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\GetConfig.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{		 
public

 

class

 
	GetConfig

 
{ 
public 
static 
IConfiguration $

AppSetting% /
{0 1
get2 5
;5 6
}7 8
static 
	GetConfig 
( 
) 
{ 	

AppSetting 
= 
new  
ConfigurationBuilder 1
(1 2
)2 3
. #
AddEnvironmentVariables ,
(, -
prefix- 3
:3 4
$str5 <
)< =
. 
SetBasePath  
(  !
	Directory! *
.* +
GetCurrentDirectory+ >
(> ?
)? @
)@ A
. 
AddJsonFile  
(  !
$str! 3
)3 4
. 
Build 
( 
) 
; 
} 	
} 
} …Y
FD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\ExternalAPI.cs
	namespace 	
Trustee
 
. 
	Component 
{ 
public 

class 
ExternalAPI 
{ 
private 
static 
string  
GenerateRandomString 2
(2 3
int3 6
length7 =
)= >
{ 	
using 
( 
var 
randomGenerator &
=' (!
RandomNumberGenerator) >
.> ?
Create? E
(E F
)F G
)G H
{ 
byte 
[ 
] 
data 
= 
new !
byte" &
[& '
$num' (
]( )
;) *
randomGenerator 
.  
GetBytes  (
(( )
data) -
)- .
;. /
int 
value 
= 
BitConverter (
.( )
ToInt32) 0
(0 1
data1 5
,5 6
$num7 8
)8 9
&: ;
$num< F
;F G
int 
fiveDigitNumber #
=$ %
value& +
%, -
$num. 3
+4 5
$num6 ;
;; <
return!! 
fiveDigitNumber!! &
.!!& '
ToString!!' /
(!!/ 0
)!!0 1
;!!1 2
}"" 
}## 	
public33 
async33 
static33 
Task33  
<33  !
bool33! %
>33% &
UploadMinio33' 2
(332 3
MemoryStream333 ?
file33@ D
,33D E
string33F L
fileName33M U
)33U V
{44 	
try55 
{66 
var77 
minioEndpoint77 !
=77" #
	GetConfig77$ -
.77- .

AppSetting77. 8
[778 9
$str779 I
]77I J
;77J K
var88 
	accessKey88 
=88 
	GetConfig88  )
.88) *

AppSetting88* 4
[884 5
$str885 F
]88F G
;88G H
var99 
	secretKey99 
=99 
	GetConfig99  )
.99) *

AppSetting99* 4
[994 5
$str995 F
]99F G
;99G H
var:: 
secure:: 
=:: 
false:: "
;::" #
var;; 
bucket;; 
=;; 
	GetConfig;; &
.;;& '

AppSetting;;' 1
[;;1 2
$str;;2 @
];;@ A
;;;A B
var== 
_minio== 
=== 
new==  
MinioClient==! ,
(==, -
)==- .
.==. /
WithEndpoint==/ ;
(==; <
minioEndpoint==< I
)==I J
.==J K
WithCredentials==K Z
(==Z [
	accessKey==[ d
,==d e
	secretKey==f o
)==o p
.==p q
WithSSL==q x
(==x y
secure==y 
)	== Ä
.
==Ä Å
Build
==Å Ü
(
==Ü á
)
==á à
;
==à â
bool>> 
found>> 
=>> 
await>> "
_minio>># )
.>>) *
BucketExistsAsync>>* ;
(>>; <
new>>< ?
BucketExistsArgs>>@ P
(>>P Q
)>>Q R
.>>R S

WithBucket>>S ]
(>>] ^
bucket>>^ d
)>>d e
)>>e f
;>>f g
if?? 
(?? 
!?? 
found?? 
)?? 
{@@ 
awaitAA 
_minioAA  
.AA  !
MakeBucketAsyncAA! 0
(AA0 1
newAA1 4
MakeBucketArgsAA5 C
(AAC D
)AAD E
.AAE F

WithBucketAAF P
(AAP Q
bucketAAQ W
)AAW X
)AAX Y
;AAY Z
}BB 
varDD 
poaDD 
=DD 
newDD 
PutObjectArgsDD +
(DD+ ,
)DD, -
.DD- .

WithBucketDD. 8
(DD8 9
	GetConfigDD9 B
.DDB C

AppSettingDDC M
[DDM N
$strDDN \
]DD\ ]
)DD] ^
.EE< =

WithObjectEE= G
(EEG H
fileNameEEH P
)EEP Q
.FF< =
WithStreamDataFF= K
(FFK L
newFFL O
MemoryStreamFFP \
(FF\ ]
fileFF] a
.FFa b
ToArrayFFb i
(FFi j
)FFj k
)FFk l
)FFl m
.GG< =
WithObjectSizeGG= K
(GGK L
fileGGL P
.GGP Q
LengthGGQ W
)GGW X
.HH< =
WithContentTypeHH= L
(HHL M
$strHHM g
)HHg h
;HHh i
awaitII 
_minioII 
.II 
PutObjectAsyncII +
(II+ ,
poaII, /
)II/ 0
;II0 1
returnJJ 
trueJJ 
;JJ 
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 
returnNN 
falseNN 
;NN 
}OO 
}PP 	
publicRR 
asyncRR 
staticRR 
TaskRR  
<RR  !
boolRR! %
>RR% &

CheckMinioRR' 1
(RR1 2
stringRR2 8
fileNameRR9 A
)RRA B
{SS 	
tryTT 
{UU 
varVV 
minioEndpointVV !
=VV" #
	GetConfigVV$ -
.VV- .

AppSettingVV. 8
[VV8 9
$strVV9 I
]VVI J
;VVJ K
varWW 
	accessKeyWW 
=WW 
	GetConfigWW  )
.WW) *

AppSettingWW* 4
[WW4 5
$strWW5 F
]WWF G
;WWG H
varXX 
	secretKeyXX 
=XX 
	GetConfigXX  )
.XX) *

AppSettingXX* 4
[XX4 5
$strXX5 F
]XXF G
;XXG H
varYY 
secureYY 
=YY 
falseYY "
;YY" #
varZZ 
bucketZZ 
=ZZ 
	GetConfigZZ &
.ZZ& '

AppSettingZZ' 1
[ZZ1 2
$strZZ2 @
]ZZ@ A
;ZZA B
var\\ 
_minio\\ 
=\\ 
new\\  
MinioClient\\! ,
(\\, -
)\\- .
.\\. /
WithEndpoint\\/ ;
(\\; <
minioEndpoint\\< I
)\\I J
.\\J K
WithCredentials\\K Z
(\\Z [
	accessKey\\[ d
,\\d e
	secretKey\\f o
)\\o p
.\\p q
WithSSL\\q x
(\\x y
secure\\y 
)	\\ Ä
.
\\Ä Å
Build
\\Å Ü
(
\\Ü á
)
\\á à
;
\\à â
var^^ 
poa^^ 
=^^ 
new^^ 
StatObjectArgs^^ ,
(^^, -
)^^- .
.^^. /

WithBucket^^/ 9
(^^9 :
	GetConfig^^: C
.^^C D

AppSetting^^D N
[^^N O
$str^^O ]
]^^] ^
)^^^ _
.__< =

WithObject__= G
(__G H
fileName__H P
)__P Q
;__Q R
await`` 
_minio`` 
.`` 
StatObjectAsync`` ,
(``, -
poa``- 0
)``0 1
;``1 2
returnbb 
truebb 
;bb 
}cc 
catchdd 
(dd 
	Exceptiondd 
)dd 
{ee 
returnff 
falseff 
;ff 
}gg 
}hh 	
publicjj 
asyncjj 
staticjj 
Taskjj  
<jj  !
bytejj! %
[jj% &
]jj& '
>jj' (
DownloadMiniojj) 6
(jj6 7
stringjj7 =
fileNamejj> F
)jjF G
{kk 	
tryll 
{mm 
varnn 
minioEndpointnn !
=nn" #
	GetConfignn$ -
.nn- .

AppSettingnn. 8
[nn8 9
$strnn9 I
]nnI J
;nnJ K
varoo 
	accessKeyoo 
=oo 
	GetConfigoo  )
.oo) *

AppSettingoo* 4
[oo4 5
$stroo5 F
]ooF G
;ooG H
varpp 
	secretKeypp 
=pp 
	GetConfigpp  )
.pp) *

AppSettingpp* 4
[pp4 5
$strpp5 F
]ppF G
;ppG H
varqq 
secureqq 
=qq 
falseqq "
;qq" #
varrr 
bucketrr 
=rr 
	GetConfigrr &
.rr& '

AppSettingrr' 1
[rr1 2
$strrr2 @
]rr@ A
;rrA B
vartt 
_miniott 
=tt 
newtt  
MinioClienttt! ,
(tt, -
)tt- .
.tt. /
WithEndpointtt/ ;
(tt; <
minioEndpointtt< I
)ttI J
.ttJ K
WithCredentialsttK Z
(ttZ [
	accessKeytt[ d
,ttd e
	secretKeyttf o
)tto p
.ttp q
WithSSLttq x
(ttx y
securetty 
)	tt Ä
.
ttÄ Å
Build
ttÅ Ü
(
ttÜ á
)
ttá à
;
ttà â
booluu 
founduu 
=uu 
awaituu "
_miniouu# )
.uu) *
BucketExistsAsyncuu* ;
(uu; <
newuu< ?
BucketExistsArgsuu@ P
(uuP Q
)uuQ R
.uuR S

WithBucketuuS ]
(uu] ^
bucketuu^ d
)uud e
)uue f
;uuf g
ifvv 
(vv 
!vv 
foundvv 
)vv 
{ww 
awaitxx 
_minioxx  
.xx  !
MakeBucketAsyncxx! 0
(xx0 1
newxx1 4
MakeBucketArgsxx5 C
(xxC D
)xxD E
.xxE F

WithBucketxxF P
(xxP Q
bucketxxQ W
)xxW X
)xxX Y
;xxY Z
returnyy 
nullyy 
;yy  
}zz 
var|| 
downloadFile||  
=||! "
new||# &
MemoryStream||' 3
(||3 4
)||4 5
;||5 6
var~~ 
poa~~ 
=~~ 
new~~ 
GetObjectArgs~~ +
(~~+ ,
)~~, -
.~~- .

WithBucket~~. 8
(~~8 9
	GetConfig~~9 B
.~~B C

AppSetting~~C M
[~~M N
$str~~N \
]~~\ ]
)~~] ^
.< =

WithObject= G
(G H
fileNameH P
)P Q
.
ÄÄ< = 
WithCallbackStream
ÄÄ= O
(
ÄÄO P
(
ÄÄP Q
stream
ÄÄQ W
)
ÄÄW X
=>
ÄÄY [
{
ÅÅ< =
stream
ÇÇ@ F
.
ÇÇF G
CopyTo
ÇÇG M
(
ÇÇM N
downloadFile
ÇÇN Z
)
ÇÇZ [
;
ÇÇ[ \
}
ÉÉ< =
)
ÉÉ= >
;
ÉÉ> ?
await
ÑÑ 
_minio
ÑÑ 
.
ÑÑ 
GetObjectAsync
ÑÑ +
(
ÑÑ+ ,
poa
ÑÑ, /
)
ÑÑ/ 0
;
ÑÑ0 1
return
ÖÖ 
downloadFile
ÖÖ #
.
ÖÖ# $
ToArray
ÖÖ$ +
(
ÖÖ+ ,
)
ÖÖ, -
;
ÖÖ- .
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá 
)
áá 
{
àà 
return
ââ 
null
ââ 
;
ââ 
}
ää 
}
ãã 	
}
åå 
}çç °G
ED:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\EncryptAES.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public		 

class		 

EncryptAES		 
{

 
public 
static 
byte 
[ 
] 
DeriveKeyFromString 0
(0 1
string1 7
input8 =
,= >
int? B
lengthC I
)I J
{ 	
using 
( 
var 
sha256 
= 
SHA256  &
.& '
Create' -
(- .
). /
)/ 0
{ 
byte 
[ 
] 
hash 
= 
sha256 $
.$ %
ComputeHash% 0
(0 1
Encoding1 9
.9 :
UTF8: >
.> ?
GetBytes? G
(G H
inputH M
)M N
)N O
;O P
byte 
[ 
] 
result 
= 
new  #
byte$ (
[( )
length) /
]/ 0
;0 1
Buffer 
. 
	BlockCopy  
(  !
hash! %
,% &
$num' (
,( )
result* 0
,0 1
$num2 3
,3 4
length5 ;
); <
;< =
return 
result 
; 
} 
} 	
public 
static 
string 
Encrypt $
($ %
string% +
	plainText, 5
)5 6
{ 	
var 
Key 
= 
	GetConfig 
.  

AppSetting  *
[* +
$str+ <
]< =
;= >
var 
Nonce 
= 
	GetConfig !
.! "

AppSetting" ,
[, -
$str- @
]@ A
;A B
try 
{ 
byte 
[ 
] 
keyBytes 
=  !
DeriveKeyFromString" 5
(5 6
Key6 9
,9 :
$num; =
)= >
;> ?
byte 
[ 
] 

nonceBytes !
=" #
DeriveKeyFromString$ 7
(7 8
Nonce8 =
,= >
$num? A
)A B
;B C
byte   
[   
]   

plainBytes   !
=  " #
Encoding  $ ,
.  , -
UTF8  - 1
.  1 2
GetBytes  2 :
(  : ;
	plainText  ; D
)  D E
;  E F
byte!! 
[!! 
]!! 
cipherBytes!! "
=!!# $
new!!% (
byte!!) -
[!!- .

plainBytes!!. 8
.!!8 9
Length!!9 ?
]!!? @
;!!@ A
byte"" 
["" 
]"" 
tag"" 
="" 
new""  
byte""! %
[""% &
$num""& (
]""( )
;"") *
using$$ 
($$ 
var$$ 
aesGcm$$ !
=$$" #
new$$$ '
AesGcm$$( .
($$. /
keyBytes$$/ 7
)$$7 8
)$$8 9
{%% 
aesGcm&& 
.&& 
Encrypt&& "
(&&" #

nonceBytes&&# -
,&&- .

plainBytes&&/ 9
,&&9 :
cipherBytes&&; F
,&&F G
tag&&H K
)&&K L
;&&L M
}'' 
byte** 
[** 
]** 
combinedBytes** $
=**% &
new**' *
byte**+ /
[**/ 0

nonceBytes**0 :
.**: ;
Length**; A
+**B C
tag**D G
.**G H
Length**H N
+**O P
cipherBytes**Q \
.**\ ]
Length**] c
]**c d
;**d e
Buffer++ 
.++ 
	BlockCopy++  
(++  !

nonceBytes++! +
,+++ ,
$num++- .
,++. /
combinedBytes++0 =
,++= >
$num++? @
,++@ A

nonceBytes++B L
.++L M
Length++M S
)++S T
;++T U
Buffer,, 
.,, 
	BlockCopy,,  
(,,  !
tag,,! $
,,,$ %
$num,,& '
,,,' (
combinedBytes,,) 6
,,,6 7

nonceBytes,,8 B
.,,B C
Length,,C I
,,,I J
tag,,K N
.,,N O
Length,,O U
),,U V
;,,V W
Buffer-- 
.-- 
	BlockCopy--  
(--  !
cipherBytes--! ,
,--, -
$num--. /
,--/ 0
combinedBytes--1 >
,--> ?

nonceBytes--@ J
.--J K
Length--K Q
+--R S
tag--T W
.--W X
Length--X ^
,--^ _
cipherBytes--` k
.--k l
Length--l r
)--r s
;--s t
return// 
Convert// 
.// 
ToBase64String// -
(//- .
combinedBytes//. ;
)//; <
;//< =
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
return33 
ex33 
.33 
Message33 !
;33! "
}44 
}55 	
public88 
static88 
string88 
Decrypt88 $
(88$ %
string88% +
encryptedText88, 9
)889 :
{99 	
var:: 
Key:: 
=:: 
	GetConfig:: 
.::  

AppSetting::  *
[::* +
$str::+ <
]::< =
;::= >
var;; 
Nonce;; 
=;; 
	GetConfig;; !
.;;! "

AppSetting;;" ,
[;;, -
$str;;- @
];;@ A
;;;A B
try== 
{>> 
byte?? 
[?? 
]?? 
keyBytes?? 
=??  !
DeriveKeyFromString??" 5
(??5 6
Key??6 9
,??9 :
$num??; =
)??= >
;??> ?
byte@@ 
[@@ 
]@@ 

nonceBytes@@ !
=@@" #
DeriveKeyFromString@@$ 7
(@@7 8
Nonce@@8 =
,@@= >
$num@@? A
)@@A B
;@@B C
byteBB 
[BB 
]BB 
combinedBytesBB $
=BB% &
ConvertBB' .
.BB. /
FromBase64StringBB/ ?
(BB? @
encryptedTextBB@ M
)BBM N
;BBN O
byteDD 
[DD 
]DD 
tagDD 
=DD 
newDD  
byteDD! %
[DD% &
$numDD& (
]DD( )
;DD) *
byteEE 
[EE 
]EE 
cipherBytesEE "
=EE# $
newEE% (
byteEE) -
[EE- .
combinedBytesEE. ;
.EE; <
LengthEE< B
-EEC D

nonceBytesEEE O
.EEO P
LengthEEP V
-EEW X
tagEEY \
.EE\ ]
LengthEE] c
]EEc d
;EEd e
BufferGG 
.GG 
	BlockCopyGG  
(GG  !
combinedBytesGG! .
,GG. /

nonceBytesGG0 :
.GG: ;
LengthGG; A
,GGA B
tagGGC F
,GGF G
$numGGH I
,GGI J
tagGGK N
.GGN O
LengthGGO U
)GGU V
;GGV W
BufferHH 
.HH 
	BlockCopyHH  
(HH  !
combinedBytesHH! .
,HH. /

nonceBytesHH0 :
.HH: ;
LengthHH; A
+HHB C
tagHHD G
.HHG H
LengthHHH N
,HHN O
cipherBytesHHP [
,HH[ \
$numHH] ^
,HH^ _
cipherBytesHH` k
.HHk l
LengthHHl r
)HHr s
;HHs t
byteJJ 
[JJ 
]JJ 

plainBytesJJ !
=JJ" #
newJJ$ '
byteJJ( ,
[JJ, -
cipherBytesJJ- 8
.JJ8 9
LengthJJ9 ?
]JJ? @
;JJ@ A
usingLL 
(LL 
varLL 
aesGcmLL !
=LL" #
newLL$ '
AesGcmLL( .
(LL. /
keyBytesLL/ 7
)LL7 8
)LL8 9
{MM 
aesGcmNN 
.NN 
DecryptNN "
(NN" #

nonceBytesNN# -
,NN- .
cipherBytesNN/ :
,NN: ;
tagNN< ?
,NN? @

plainBytesNNA K
)NNK L
;NNL M
}OO 
returnQQ 
EncodingQQ 
.QQ  
UTF8QQ  $
.QQ$ %
	GetStringQQ% .
(QQ. /

plainBytesQQ/ 9
)QQ9 :
;QQ: ;
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 
returnUU 
exUU 
.UU 
MessageUU !
;UU! "
}VV 
}WW 	
}XX 
}YY ˙G
BD:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\DellECS.cs
	namespace 	
DashboadVaBPDLH
 
. 
	Component #
{ 
public 

class 
DellECS 
{ 
private		 
static		 
IConfiguration		 %
_configuration		& 4
;		4 5
static 
async 
Task 
Main 
( 
string %
[% &
]& '
args( ,
), -
{ 	
var 
builder 
= 
new  
ConfigurationBuilder 2
(2 3
)3 4
. 
SetBasePath 
( 
	Directory &
.& '
GetCurrentDirectory' :
(: ;
); <
)< =
. 
AddJsonFile 
( 
$str /
)/ 0
;0 1
_configuration 
= 
builder $
.$ %
Build% *
(* +
)+ ,
;, -
var 
s3Client 
= 
new 
AmazonS3Client -
(- .
_configuration 
[ 
$str .
]. /
,/ 0
_configuration 
[ 
$str .
]. /
,/ 0
new 
AmazonS3Config "
{ 

ServiceURL 
=  
_configuration! /
[/ 0
$str0 @
]@ A
,A B
ForcePathStyle "
=# $
true% )
} 
) 
; 
var 

bucketName 
= 
$str ,
;, -
await 
CreateBucketAsync #
(# $
s3Client$ ,
,, -

bucketName. 8
)8 9
;9 :
var!! 
filePath!! 
=!! 
$str!! 2
;!!2 3
await"" 
UploadFileAsync"" !
(""! "
s3Client""" *
,""* +

bucketName"", 6
,""6 7
filePath""8 @
)""@ A
;""A B
await%% 
ListObjectsAsync%% "
(%%" #
s3Client%%# +
,%%+ ,

bucketName%%- 7
)%%7 8
;%%8 9
var(( 
downloadPath(( 
=(( 
$str(( C
;((C D
await)) 
DownloadFileAsync)) #
())# $
s3Client))$ ,
,)), -

bucketName)). 8
,))8 9
$str)): D
,))D E
downloadPath))F R
)))R S
;))S T
}** 	
private,, 
static,, 
async,, 
Task,, !
CreateBucketAsync,," 3
(,,3 4
	IAmazonS3,,4 =
client,,> D
,,,D E
string,,F L

bucketName,,M W
),,W X
{-- 	
try.. 
{// 
var00 
putBucketRequest00 $
=00% &
new00' *
PutBucketRequest00+ ;
{11 

BucketName22 
=22  

bucketName22! +
}33 
;33 
var55 
response55 
=55 
await55 $
client55% +
.55+ ,
PutBucketAsync55, :
(55: ;
putBucketRequest55; K
)55K L
;55L M
Console66 
.66 
	WriteLine66 !
(66! "
$"66" $
$str66$ 4
{664 5

bucketName665 ?
}66? @
"66@ A
)66A B
;66B C
}77 
catch88 
(88 
AmazonS3Exception88 $
e88% &
)88& '
{99 
Console:: 
.:: 
	WriteLine:: !
(::! "
$"::" $
$str::$ J
{::J K
e::K L
.::L M
Message::M T
}::T U
$str::U m
"::m n
)::n o
;::o p
};; 
}<< 	
private>> 
static>> 
async>> 
Task>> !
UploadFileAsync>>" 1
(>>1 2
	IAmazonS3>>2 ;
client>>< B
,>>B C
string>>D J

bucketName>>K U
,>>U V
string>>W ]
filePath>>^ f
)>>f g
{?? 	
try@@ 
{AA 
varBB 
fileTransferUtilityBB '
=BB( )
newBB* -
TransferUtilityBB. =
(BB= >
clientBB> D
)BBD E
;BBE F
awaitCC 
fileTransferUtilityCC )
.CC) *
UploadAsyncCC* 5
(CC5 6
filePathCC6 >
,CC> ?

bucketNameCC@ J
)CCJ K
;CCK L
ConsoleDD 
.DD 
	WriteLineDD !
(DD! "
$"DD" $
$strDD$ 3
{DD3 4
filePathDD4 <
}DD< =
"DD= >
)DD> ?
;DD? @
}EE 
catchFF 
(FF 
AmazonS3ExceptionFF $
eFF% &
)FF& '
{GG 
ConsoleHH 
.HH 
	WriteLineHH !
(HH! "
$"HH" $
$strHH$ J
{HHJ K
eHHK L
.HHL M
MessageHHM T
}HHT U
$strHHU m
"HHm n
)HHn o
;HHo p
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
ConsoleLL 
.LL 
	WriteLineLL !
(LL! "
$"LL" $
$strLL$ L
{LLL M
eLLM N
.LLN O
MessageLLO V
}LLV W
$strLLW o
"LLo p
)LLp q
;LLq r
}MM 
}NN 	
privatePP 
staticPP 
asyncPP 
TaskPP !
ListObjectsAsyncPP" 2
(PP2 3
	IAmazonS3PP3 <
clientPP= C
,PPC D
stringPPE K

bucketNamePPL V
)PPV W
{QQ 	
tryRR 
{SS 
varTT 
requestTT 
=TT 
newTT ! 
ListObjectsV2RequestTT" 6
{UU 

BucketNameVV 
=VV  

bucketNameVV! +
,VV+ ,
}WW 
;WW 
varYY 
responseYY 
=YY 
awaitYY $
clientYY% +
.YY+ ,
ListObjectsV2AsyncYY, >
(YY> ?
requestYY? F
)YYF G
;YYG H
foreach[[ 
([[ 
S3Object[[ !
entry[[" '
in[[( *
response[[+ 3
.[[3 4
	S3Objects[[4 =
)[[= >
{\\ 
Console]] 
.]] 
	WriteLine]] %
(]]% &
$"]]& (
$str]]( 1
{]]1 2
entry]]2 7
.]]7 8
Key]]8 ;
}]]; <
$str]]< D
{]]D E
entry]]E J
.]]J K
Size]]K O
}]]O P
"]]P Q
)]]Q R
;]]R S
}^^ 
}__ 
catch`` 
(`` 
AmazonS3Exception`` $
e``% &
)``& '
{aa 
Consolebb 
.bb 
	WriteLinebb !
(bb! "
$"bb" $
$strbb$ J
{bbJ K
ebbK L
.bbL M
MessagebbM T
}bbT U
$strbbU k
"bbk l
)bbl m
;bbm n
}cc 
}dd 	
privateff 
staticff 
asyncff 
Taskff !
DownloadFileAsyncff" 3
(ff3 4
	IAmazonS3ff4 =
clientff> D
,ffD E
stringffF L

bucketNameffM W
,ffW X
stringffY _
keyNameff` g
,ffg h
stringffi o
filePathffp x
)ffx y
{gg 	
tryhh 
{ii 
varjj 
fileTransferUtilityjj '
=jj( )
newjj* -
TransferUtilityjj. =
(jj= >
clientjj> D
)jjD E
;jjE F
awaitkk 
fileTransferUtilitykk )
.kk) *
DownloadAsynckk* 7
(kk7 8
filePathkk8 @
,kk@ A

bucketNamekkB L
,kkL M
keyNamekkN U
)kkU V
;kkV W
Consolell 
.ll 
	WriteLinell !
(ll! "
$"ll" $
$strll$ 5
{ll5 6
filePathll6 >
}ll> ?
"ll? @
)ll@ A
;llA B
}mm 
catchnn 
(nn 
AmazonS3Exceptionnn $
enn% &
)nn& '
{oo 
Consolepp 
.pp 
	WriteLinepp !
(pp! "
$"pp" $
$strpp$ J
{ppJ K
eppK L
.ppL M
MessageppM T
}ppT U
$strppU q
"ppq r
)ppr s
;pps t
}qq 
catchrr 
(rr 
	Exceptionrr 
err 
)rr 
{ss 
Consolett 
.tt 
	WriteLinett !
(tt! "
$"tt" $
$strtt$ L
{ttL M
ettM N
.ttN O
MessagettO V
}ttV W
$strttW s
"tts t
)ttt u
;ttu v
}uu 
}vv 	
}ww 
}xx ∫<
ID:\GitLab BNI\dashboard-deva\DashboardDevaBNI\Component\AccessSecurity.cs
	namespace 	
DashboardDevaBNI
 
. 
	Component $
{ 
public 

class 
AccessSecurity 
{  
IHttpContextAccessor		  
_httpContextAccessor		 1
;		1 2
private

 
readonly

 %
DbDashboardDevaBniContext

 2
_context

3 ;
;

; <
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
public 
AccessSecurity 
(  
IHttpContextAccessor 2
httpContextAccessor3 F
,F G%
DbDashboardDevaBniContextH a
contextb i
,i j
IConfigurationk y
config	z Ä
)
Ä Å
{ 	 
_httpContextAccessor  
=! "
httpContextAccessor# 6
;6 7
_context 
= 
context 
; 
_configuration 
= 
config #
;# $
} 	
public 
bool 
IsGetAccess 
(  
string  &
fullpath' /
)/ 0
{ 	
bool 
	getAccess 
= 
false "
;" #
var 
Role_Id 
=  
_httpContextAccessor .
.. /
HttpContext/ :
.: ;
Session; B
.B C
	GetStringC L
(L M
SessionConstanM [
.[ \
Session_RoleKode\ l
)l m
;m n
var 
Username 
=  
_httpContextAccessor /
./ 0
HttpContext0 ;
.; <
Session< C
.C D
	GetStringD M
(M N
SessionConstanN \
.\ ]$
Session_Username_Pegawai] u
)u v
;v w
var 
CheckVerifEmail 
=  !
_context" *
.* +
TblMasterUserVerifs+ >
.> ?
Where? D
(D E
mE F
=>G I
mJ K
.K L
UsernameL T
==U W
UsernameX `
&&a c
md e
.e f
IsActivef n
==o q
truer v
&&w y
(z {
m{ |
.| }
	IsDeleted	} Ü
==
á â
false
ä è
||
ê í
m
ì î
.
î ï
	IsDeleted
ï û
==
ü °
null
¢ ¶
)
¶ ß
)
ß ®
.
® ©
Select
© Ø
(
Ø ∞
m
∞ ±
=>
≤ ¥
m
µ ∂
.
∂ ∑
IsEmailVerif
∑ √
)
√ ƒ
.
ƒ ≈
FirstOrDefault
≈ ”
(
” ‘
)
‘ ’
;
’ ÷
var 
CheckVerifWhatsapp "
=# $
_context% -
.- .
TblMasterUserVerifs. A
.A B
WhereB G
(G H
mH I
=>J L
mM N
.N O
UsernameO W
==X Z
Username[ c
&&d f
mg h
.h i
IsActivei q
==r t
trueu y
&&z |
(} ~
m~ 
.	 Ä
	IsDeleted
Ä â
==
ä å
false
ç í
||
ì ï
m
ñ ó
.
ó ò
	IsDeleted
ò °
==
¢ §
null
• ©
)
© ™
)
™ ´
.
´ ¨
Select
¨ ≤
(
≤ ≥
m
≥ ¥
=>
µ ∑
m
∏ π
.
π ∫
IsNoTelpVerif
∫ «
)
« »
.
» …
FirstOrDefault
… ◊
(
◊ ÿ
)
ÿ Ÿ
;
Ÿ ⁄
var !
CheckVerifEmailMaster %
=& '
_context( 0
.0 1%
TblMasterSystemParameters1 J
.J K
WhereK P
(P Q
mQ R
=>S U
mV W
.W X
KeyX [
==\ ^
$str_ n
&&o q
mr s
.s t
IsActivet |
==} 
true
Ä Ñ
&&
Ö á
(
à â
m
â ä
.
ä ã
	IsDeleted
ã î
==
ï ó
false
ò ù
||
û †
m
° ¢
.
¢ £
	IsDeleted
£ ¨
==
≠ Ø
null
∞ ¥
)
¥ µ
)
µ ∂
.
∂ ∑
Select
∑ Ω
(
Ω æ
m
æ ø
=>
¿ ¬
m
√ ƒ
.
ƒ ≈
Value
≈  
)
  À
.
À Ã
FirstOrDefault
Ã ⁄
(
⁄ €
)
€ ‹
;
‹ ›
var $
CheckVerifWhatsappMaster (
=) *
_context+ 3
.3 4%
TblMasterSystemParameters4 M
.M N
WhereN S
(S T
mT U
=>V X
mY Z
.Z [
Key[ ^
==_ a
$strb n
&&o q
mr s
.s t
IsActivet |
==} 
true
Ä Ñ
&&
Ö á
(
à â
m
â ä
.
ä ã
	IsDeleted
ã î
==
ï ó
false
ò ù
||
û †
m
° ¢
.
¢ £
	IsDeleted
£ ¨
==
≠ Ø
null
∞ ¥
)
¥ µ
)
µ ∂
.
∂ ∑
Select
∑ Ω
(
Ω æ
m
æ ø
=>
¿ ¬
m
√ ƒ
.
ƒ ≈
Value
≈  
)
  À
.
À Ã
FirstOrDefault
Ã ⁄
(
⁄ €
)
€ ‹
;
‹ ›
if 
( !
CheckVerifEmailMaster %
==& (
$str) ,
&&- /$
CheckVerifWhatsappMaster0 H
==I K
$strL O
)O P
{ 
	getAccess 
= #
StoredProcedureExecutor 3
.3 4
ExecuteScalarBool4 E
(E F
_contextF N
,N O
$strP d
,d e
newf i
SqlParameterj v
[v w
]w x
{x y
new   
SqlParameter   (
(  ( )
$str  ) 2
,  2 3
Role_Id  4 ;
)  < =
,  = >
new!! 
SqlParameter!! (
(!!( )
$str!!) /
,!!/ 0
fullpath!!1 9
)!!9 :
}!!: ;
)!!; <
;!!< =
}"" 
else## 
if## 
(## 
CheckVerifEmail## $
==##% '
false##( -
&&##. 0
CheckVerifWhatsapp##1 C
==##D F
false##G L
)##L M
{$$ 
	getAccess%% 
=%% 
false%% !
;%%! "
}&& 
else'' 
{(( 
	getAccess)) 
=)) #
StoredProcedureExecutor)) 3
.))3 4
ExecuteScalarBool))4 E
())E F
_context))F N
,))N O
$str))P d
,))d e
new))f i
SqlParameter))j v
[))v w
]))w x
{))x y
new** 
SqlParameter** (
(**( )
$str**) 2
,**2 3
Role_Id**4 ;
)**< =
,**= >
new++ 
SqlParameter++ (
(++( )
$str++) /
,++/ 0
fullpath++1 9
)++9 :
}++: ;
)++; <
;++< =
},, 
return66 
	getAccess66 
;66 
}77 	
}88 
}99 